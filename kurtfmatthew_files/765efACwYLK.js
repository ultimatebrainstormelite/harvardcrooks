/*!CK:958015443!*//*1440430535,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["V8897"]); }

__d("PhotosUploadWaterfallErrorCodes",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={SECURITY:1,FILE_IO:2,IMAGE_IO:3,UPLOAD_IO:4,INVALID_SERVER_RESULT:5,RESIZE_FAILURE:6,ENCODE_FAILURE:7,INVALID_DOMAIN:8,BAD_JPEG_MARKERS:9,BAD_SERVER_RESPONSE:10,EXTERNAL_INTERFACE_UNAVAILABLE:11,JS_CALL_FAILED:12,UNCAUGHT_ERROR:13,UPLOAD_SWF_FAILED_LOAD:14,FILE_IO_TIMEOUT:15,IMAGE_SECURITY:16,BAD_IMAGE_FILE:17,IMAGE_IO_TIMEOUT:18,BLACK_PHOTO:19,EMPTY_FILE_LOADED:20,FILE_READ_DISABLED:21,BAD_NETWORK:22,FLASH_LOAD_TIMEOUT:23,FLASH_LOAD_FAILURE:24,FLASH_UPGRADE_REQUIRED:25};},null,{});
__d('ImageResizer',['ArbiterMixin','BlobFactory','DOM','UserAgent_DEPRECATED'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=function(m,n,o,p,q){this._input=m;this._image=null;this._canvas=null;this._rotation=0;this._maxWidth=n;this._maxHeight=o;this._outputMime=p||'image/jpeg';this._outputQuality=q===undefined?.87:q;};l.isSupported=function(){if(window.File&&window.FileReader){var m=j.create('canvas');if(m.toBlob||m.toDataURL&&window.ArrayBuffer&&window.Uint8Array&&i.isSupported())return true;}return false;};Object.assign(l.prototype,h);Object.assign(l.prototype,{setOrientation:function(m){this._rotation=({1:0,3:180,6:90,8:270})[m]||0;},resize:function(){if(this._input instanceof HTMLCanvasElement||this._input instanceof HTMLImageElement){this._image=this._input;this._handleImage();}else if(typeof this._input=="string"){this._loadImage(this._input);}else if(this._input instanceof window.File)this._loadFile(this._input);},_rotatedToSide:function(){return this._rotation%180==90;},_prepareError:function(m){return (function(){this.inform.bind(this,"error",m);}).bind(this);},_loadFile:function(m){this._fileLoadTime=Date.now();var n=new FileReader();n.onload=this._handleFile.bind(this);n.onerror=this._prepareError("Could not read tile.");n.readAsDataURL(m);},_handleFile:function(event){this._fileLoadTime=Date.now()-this._fileLoadTime;var m=event.target.result;this._loadImage(m);},_loadImage:function(m){this._imageLoadTime=Date.now();this._image=j.create('img');this._image.onload=this._handleImage.bind(this);this._image.onerror=this._prepareError("Could not load image.");this._image.src=m;},_handleImage:function(){if(this._imageLoadTime)this._imageLoadTime=Date.now()-this._imageLoadTime;if(this._input instanceof window.File){var m=this._calculateRatio();if(m>=1){this._skippedResizing=true;return this._handleBlob(this._input);}}this._skippedResizing=false;this._drawTransformed();this._extractBlob();},_drawTransformed:function(){var m=Date.now(),n=this._calculateRatio(),o=0;if(k.chrome())if(n<.25){o=2;}else if(n<.5)o=1;var p=this._drawResizedCanvas(this._image,n*Math.pow(2,o));for(var q=0;q<o;q++)p=this._drawResizedCanvas(p,.5);if(this._rotation)p=this._drawRotatedCanvas(p);this._canvas=p;this._drawTime=Date.now()-m;},_drawResizedCanvas:function(m,n){var o=j.create('canvas');o.width=m.width*n;o.height=m.height*n;var p=o.getContext("2d");p.scale(n,n);p.drawImage(m,0,0);return o;},_drawRotatedCanvas:function(m){var n=j.create('canvas');if(this._rotatedToSide()){n.width=m.height;n.height=m.width;}else{n.width=m.width;n.height=m.height;}var o=n.getContext("2d");o.translate(n.width*.5,n.height*.5);o.rotate(Math.PI*(this._rotation/180));o.translate(m.width*-.5,m.height*-.5);o.drawImage(m,0,0,m.width,m.height);return n;},_calculateRatio:function(){var m=1,n=this._rotatedToSide()?this._maxHeight:this._maxWidth,o=this._rotatedToSide()?this._maxWidth:this._maxHeight,p=n/this._image.width,q=o/this._image.height;if(p<m&&p>0)m=p;if(q<m&&q>0)m=q;return m;},_extractBlob:function(){this._extractionStart=Date.now();if(this._canvas.toBlob){this._canvas.toBlob(this._handleBlob.bind(this),this._outputMime,this._outputQuality);return;}var m=this._canvas.toDataURL(this._outputMime,this._outputQuality),n=m.match(/^data:(.*?);base64,/);if(!n){this._prepareError("Couldn't get base64 encoded data from canvas.")();return;}var o=n[1],p=m.substr(n[0].length),q=window.atob(p),r=new ArrayBuffer(q.length),s=new Uint8Array(r);for(var t=0;t<q.length;t++)s[t]=q.charCodeAt(t);var u=i.getBlob([r],{type:o});this._handleBlob(u);},_handleBlob:function(m){this._canvas=this._canvas||j.create('canvas');m.performanceData={blockingDraw:+true,blockingExtraction:+!this._canvas.toBlob,imageLoadTime:this._imageLoadTime,fileLoadTime:this._fileLoadTime,skippedResizing:+this._skippedResizing};if(!this._skippedResizing)Object.assign(m.performanceData,{extractionTime:Date.now()-this._extractionStart,drawTime:this._drawTime});this.inform('resized',m);}});f.exports=l;},null);
__d('ComposerXMediaPostTab',['Arbiter','ComposerXMediaUploadHandler','Event'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();function k(l,m){'use strict';h.inform('composer/reset_pab_nux');var n=new i(l);j.listen(m.getContainer(),'click',function(){h.inform('composerprivacy/aborteducation');n.fetchAttachments();m.getInput().disabled=false;});m.subscribe('change',function(){n.handleFileSelected(m);});}f.exports=k;},null);
__d('EntstreamStoryDeduper',['DOM','csx','CSS'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();function k(m,n){var o={};for(var p=0;p<m.length;p++){var q=m[p],r=q.getAttribute('data-dedupekey');if(o[r]){if(n){j.hide(q);}else h.remove(q);}else o[r]=1;}}var l={dedupe:function(m,n){n=n||"._5jmm";var o=h.scry(m,n);o=o.filter(function(p){return p.getAttribute('data-dedupekey');});k(o,false);},dedupeHide:function(m,n){n=n||"._5jmm";var o=h.scry(m,n),p=o.filter(function(q){return q.getAttribute('data-dedupekey')&&j.shown(q);});k(p,true);}};f.exports=l;},null);
__d('FeedLiveUpdateBar',['ArbiterMixin','Animation','BanzaiScuba','CurrentUser','Ease','DOM','DOMScroll','Event','Vector','csx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();var r=300,s=false;function t(v){this.element=v;this.init();}function u(v){new j('feed_newstoriescard').addNormal('user_id',k.getID()).addNormal('event',v).addInteger('time',Math.round(Date.now()/1000)).addInteger('bar_at_top',1).post();}Object.assign(t.prototype,h,{init:function(){if(!this.element)return;this.hide();var v=m.find(this.element,"._2f6b");o.listen(v,'click',this._handleClick.bind(this));},_handleClick:function(event){if(s)u('click');this.hide();var v=new p(p.getScrollPosition().x,0,'document');n.scrollTo(v,r,false,false,0,(function(){n.scrollTo(v,0);this.inform('click');}).bind(this));event.kill();},setAtTop:function(){s=true;},hide:function(){s=false;new i(this.element).from('top',42).to('top',-50).ease(l.sineOut()).duration(250).hide().go();},show:function(){if(!this.element)return;new i(this.element).from('top',-50).to('top',42).ease(l.makePowerOut(3)).duration(400).show().go();if(s)u('render');}});f.exports=t;},null);
__d('runAfterScrollingStops',['Arbiter','Event','Run','debounceAcrossTransitions','emptyFunction'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();function m(x,y,z){if(y&&p[y])return;if(!o){h.subscribe('page_transition',w);o=true;}if(!n){x();return;}y&&(p[y]=1);q.push(x);if(!z){if(s){j.onLeave(w);s=false;}r.push(q.length-1);}}var n,o,p={},q=[],r=[],s=true,t=500,u=k(function(){n=false;var x=q;q=[];r=[];p={};for(var y=0,z=x.length;y<z;++y)x[y]();},t);function v(){n=true;u();}function w(){var x=r;r=[];s=true;for(var y=0,z=x.length;y<z;++y)q[x[y]]=l;}i.listen(window,'scroll',v);f.exports=m;},null);
__d('LitestandOffscreenController',['Arbiter','CSS','DOMQuery','Event','NavigationMessage','Run','Scroll','Style','SubscriptionsHandler','Vector','cx','csx','getOrCreateDOMID','queryThenMutateDOM','runAfterScrollingStops','throttle'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){if(c.__markCompiled)c.__markCompiled();var x=1,y=9,z=10,aa={},ba=false,ca,da,ea,fa,ga=[];function ha(){ca&&ca.release();ca=null;ba=false;}function ia(){aa={};ga=[];}function ja(){if(i.hasClass(document.body,"_5vb_"))return z;return y;}function ka(){fa=fa||q.getViewportDimensions().y;da=q.getScrollPosition().y;ea=da+fa;if(x){da-=fa*x;ea+=fa*x;}for(var sa in aa){var ta=aa[sa];ta.position=q.getElementPosition(ta.element).y;if(!ta.hidden)ta.height=ta.element.offsetHeight;}}function la(){var sa=[];for(var ta in aa){var ua=aa[ta],va=ua.position,wa=va+ua.height<da,xa=va>ea;if(!ua.hidden&&(wa||xa)){ma(ua);}else if(!wa&&!xa){ua.pendingHide=false;if(ua.hidden){if(ua.dirty&&va<da){sa.push(ta);i.addClass(na(ua),"_49nu");}else o.apply(ua.element,{height:'',marginBottom:''});i.show(na(ua));ua.dirty=false;ua.hidden=false;}}}if(!sa.length)return;var ya=0;u(function(){for(var za=0,ab=sa.length;za<ab;za++){var bb=aa[sa[za]];ya+=bb.height-na(bb).offsetHeight+o.getFloat(bb.element,'marginBottom');}},function(){for(var za=0,ab=sa.length;za<ab;za++){var bb=aa[sa[za]];i.removeClass(na(bb),"_49nu");o.apply(bb.element,{height:'',marginBottom:''});}ya&&n.setTop(document.body,n.getTop(document.body)-ya);});}function ma(sa){if(!sa.pendingHide){ga.push(sa);sa.pendingHide=true;}}function na(sa){if(sa.wrapperElement)return sa.wrapperElement;var ta=sa.element;if(ta.firstElementChild)return sa.wrapperElement=ta.firstElementChild;for(var ua=0;ua<ta.childNodes.length;ua++)if(ta.childNodes[ua].tagName)return sa.wrapperElement=ta.childNodes[ua];}function oa(){var sa=ja()+'px';for(var ta=0;ta<ga.length;ta++){var ua=ga[ta];if(j.scry(ua.element,"._52fb").length)ua.pendingHide=false;if(ua&&ua.element&&ua.pendingHide&&!ua.hidden){o.apply(ua.element,{height:ua.height+'px',marginBottom:sa});i.hide(na(ua));ua.hidden=true;ua.pendingHide=false;}}ga=[];}function pa(){v(oa,'LitestandOffscreenController/hide');u(ka,la,'LitestandOffscreenController');}function qa(){m.onLeave(ha);ca=new p();ca.addSubscriptions(h.subscribe(l.NAVIGATION_BEGIN,ia),k.listen(window,'scroll',w(pa)),k.listen(window,'resize',w(function(){fa=null;pa();})));ba=true;}var ra={attachSubstream:function(sa){ba||qa();aa[t(sa)]={element:sa};}};f.exports=ra;},null);
__d('LitestandNewStoryController',['Animation','Arbiter','AsyncRequest','CSS','csx','DOMQuery','Event','LitestandMessages','LitestandStream','NavigationMessage','Run','Style','SubscriptionsHandler','UITinyViewportAction','ge','getScrollPosition','memoize','$','queryThenMutateDOM','requestAnimationFrame'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa){if(c.__markCompiled)c.__markCompiled();var ba=1,ca,da,ea=500,fa=600,ga,ha;function ia(){ha&&clearTimeout(ha);ha=null;}function ja(){ha=setTimeout(function(){ha=null;ka();},ea);}function ka(){var eb;z(function(){eb=p.canInsertNewerStories();},function(){if(eb){bb();}else ja();},'LitestandNewStoryController/tryShowingStories');}var la=0,ma,na=true,oa;function pa(){if(!oa){oa=new t();oa.addSubscriptions(i.subscribe(q.NAVIGATION_BEGIN,ya),n.listen(window,'resize',qa),n.listen(window,'scroll',wa));r.onLeave(ya);}}function qa(){if(!sa())ya();}var ra=x(function(){var eb=v('blueBarNAXAnchor');return eb&&k.hasClass(eb,'fixed_elem');});function sa(){return ra()&&!u.isTiny();}function ta(){return m.scry(document,"div._vox").length;}function ua(eb,fb){var gb=v(eb);if(gb)gb.style.marginTop=fb?fb+'px':'';}function va(eb){if(!sa()){eb=0;}else eb=Math.max(eb,0);la=eb;ua('rightCol',eb);if(!ta())ua('leftCol',eb);}function wa(){var eb=w(window).y;if(eb<=0){ya();return;}if(eb<la){na=false;va(eb);}if(da&&eb>da+50&&ca){ca.hide();da=null;}da=eb;}function xa(){if(!na){ma&&ma.stop();ma=null;}}function ya(){if(oa){oa&&oa.release();na=false;va(0);oa=null;if(ca){ca.hide();da=null;}}}function za(eb,fb){ma=new h(eb).from('opacity',0).to('opacity',1).duration(fa);if(fb){na=true;for(var gb=0;gb<ba;gb++)ma.checkpoint(1,xa).from('opacity',1).to('opacity',0).duration(fa).checkpoint().from('opacity',0).to('opacity',1).duration(fa);}ma.go();}function ab(eb){ia();if(!ga)return;if(eb)var fb=w(window),gb=ga.nextSibling,hb=gb.offsetTop,ib=function(){va(fb.y+gb.offsetTop-hb);window.scrollTo(fb.x,la);};s.apply(ga,{height:'',left:'',overflow:'',position:'',width:''});if(eb){ib();var jb=ga;aa(function(){pa();ib();za(jb,true);if(ca){ca.setAtTop();ca.show();}});}else za(ga,false);i.inform(o.STORIES_INSERTED);i.inform(o.NEWER_STORIES_INSERTED);setTimeout(function(){i.inform('reflow');},0);new j().setURI('/ajax/litestand/update_filter_viewtime').setData({section_id:p.getSectionID()}).send();ga=null;i.inform(o.NEW_STORIES_DISPLAYED);}function bb(){ab(sa());}function cb(){ab(false);}var db={waitForDisplay:function(eb){if(!ga)ga=y(eb);if(p.canInsertNewerStories()){bb();}else ja();},showStoriesNow:function(eb){ga=eb;cb();},setNewStoryPill:function(eb){ca=eb;}};f.exports=db;},null);
__d('ViewportAtFeedTop',['getElementPosition','LitestandStream','ViewportBounds'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k={isTrue:function(){if(j.getTop()>h(i.getStreamRoot()).y)return false;return true;}};f.exports=k;},null);
__d('LitestandStreamLoader',['Arbiter','Bootloader','CSS','DOM','EntstreamStoryDeduper','Event','JSXDOM','LitestandStreamConfig','LitestandStoryInsertionStatus','LitestandMessages','LitestandOffscreenController','LitestandStream','NavigationMessage','OnVisible','Run','throttle','UserActivity','$','ge','getElementPosition','getViewportDimensions','getUnboundedScrollPosition','ForceFetchAfterLongInactiveQE','NewStoriesPillConfig','ViewportAtFeedTop','URI'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga){if(c.__markCompiled)c.__markCompiled();var ha=Object.assign||function(ub){for(var vb=1;vb<arguments.length;vb++){var wb=arguments[vb];for(var xb in wb)if(Object.prototype.hasOwnProperty.call(wb,xb))ub[xb]=wb[xb];}return ub;},ia=0,ja=false,ka={},la,ma,na,oa,pa,qa,ra,sa=0,ta,ua,va=[],wa=60000,xa=30,ya=200,za=0,ab,bb;function cb(){v.onLeave(db);ia=0;va=[h.subscribe(t.NAVIGATION_BEGIN,db),h.subscribe(q.NEWER_STORIES_INSERTED,function(){bb=null;}),h.subscribe('useractivity/focus',function(){var ub=Date.now()-x.getLastLeaveTime(),vb=xa*wa,wb=ya*wa;if(da.forceRefresh&&p.canInsert())if(ub>wb){window.location.href=window.location.href;}else if(ub>vb){var xb=new ga('/home.php');xb.go();}})];if(ea.no_insert_when_dialog){va.push(h.subscribe('layer_shown',function(ub,vb){if(vb&&vb.type==='DialogX')ia++;}),h.subscribe('layer_hidden',function(ub,vb){if(vb&&vb.type==='DialogX')ia--;}));p.registerBlocker(function(){return ia>0;});}ja=true;}function db(){h.inform(q.LEAVE_HOME);ka={};ua=null;sa=0;va.forEach(h.unsubscribe);va=[];la&&la.remove();pa&&clearTimeout(pa);pa=null;qa&&clearTimeout(qa);qa=null;oa=null;bb=null;ta&&ta.remove();ta=null;ja=false;za=0;}function eb(ub){qa&&clearTimeout(qa);qa=setTimeout(function(){qa=null;lb(false);},ub);}function fb(ub){pa&&clearTimeout(pa);pa=setTimeout(function(){pa=null;lb(true);},ub);}function gb(){if(ua&&oa&&ua.pollIntervalMS&&ua.pollIntervalMS>1000){x.setIdleTime(ua.newStoryIdleTime);fb(ua.pollIntervalMS);if(ea.show_new_stories_pill)eb(ea.middle_feed_polling_time);}}function hb(){la=new u(k.find(ma,'a'),sb.bind(null),false,ua.bufferPixels);}function ib(){var ub=ca(window).y;return ub>ua.firstPagerScrollBuffer;}function jb(){if(ib()){hb();ta&&ta.remove();ta=null;}}function kb(ub){var vb=k.find(ma,'a');m.listen(vb,'click',function(event){sb();ta&&ta.remove();ta=null;event.preventDefault();});var wb=aa(ma),xb=ba();if(ub&&wb.y<xb.height){sb();}else if(ub&&!ib()){ta=m.listen(window,'scroll',w(jb));}else hb();}function lb(ub){if(!oa)return;if(!x.isActive(ua.newStoryIdleTime)){x.subscribeOnce(lb.bind(null,ub));return;}if(x.hasBeenInactive()){x.resetActiveStatus();var vb=ua.pollIntervalMS,wb=Date.now()-x.getLastInActiveEnds();if(wb<vb){if(ub){fb(vb-wb);}else eb(vb-wb);return;}}if(ub){if(!s.canInsertNewerStories()){fb(ua.pollIntervalMS);return;}}else if(fa.isTrue()||!p.canInsert()){eb(ea.middle_feed_polling_time);return;}mb(false);}function mb(ub){if(!oa)return;pa&&clearTimeout(pa);qa&&clearTimeout(qa);if(!bb){var vb=s.getStreamRoot();bb=n.div({style:{height:0,width:vb.offsetWidth+'px',left:'-10000px',opacity:0,overflow:'hidden',position:'absolute'}});k.prependContent(vb,bb);h.inform(q.NEW_STORIES_CONTAINER_CREATED,bb);}var wb=n.div(null);k.prependContent(bb,wb);i.loadModules(["UIPagelet"],function(xb){xb.loadFromEndpoint('LitestandNewerStoriesPagelet',wb,Object.assign(oa,{cursor:ab,containerID:k.getID(bb),fblogo:ub}),{crossPage:true});});h.inform(q.PILL_PAGELET_REQUEST_SENT);}function nb(){var ub=k.getID(ma);j.addClass(ma,'async_saving');var vb=qb(),wb=vb.cursor,xb=vb.storiesCount;if(ka[wb])throw new Error('This cursor has been used before, stories will be '+'repeated. Cursor: '+wb);ka[wb]=wb;var yb={cursor:wb,pager_config:na,pager_id:ub,scroll_count:++sa,feed_stream_id:s.getFeedStreamID(),client_stories_count:xb};i.loadModules(["UIPagelet"],function(zb){zb.loadFromEndpoint(ua.pagerController,k.getID(ra),yb,{append:true,automatic:true,usePipe:true,crossPage:ua.crossPage,errorHandler:ob,transportErrorHandler:ob});});}function ob(ub){var vb=qb();delete ka[vb.cursor];j.removeClass(ma,'async_saving');}function pb(){var ub=rb();if(ub.length){return ub[0].getAttribute('data-cursor');}else return ma&&ma.getAttribute('data-cursor');}function qb(){var ub=rb(),vb={};if(ub.length){vb.cursor=ub[ub.length-1].getAttribute('data-cursor');vb.storiesCount=ub.length;}else{vb.cursor=ma&&ma.getAttribute('data-cursor');vb.storiesCount=0;}return vb;}function rb(){var ub=k.scry(ra,s.getStoriesSelector());return ub.filter(function(vb){return vb.getAttribute('data-cursor');});}function sb(){nb();la&&la.remove();la=null;}var tb={register:function(ub,vb,wb,xb){ja||cb();ua=ha({bufferPixels:1000,firstPagerScrollBuffer:100,pagerController:'LitestandMoreStoriesPagelet',pollIntervalMS:null,newStoryIdleTime:60000},vb);na=wb;ra=y(ub);ab=pb();ma=xb;kb(true);gb();},removeOldPager:function(ub,vb){if(ub)k.remove(y(ub));j.show(y(vb));},removeLoadingIndicator:function(ub,vb){var wb=z(ub);if(wb)k.remove(wb);j.show(vb);},moreStoriesInserted:function(ub){h.inform(q.STORIES_INSERTED,{substream_id:ub});var vb=y(ub);if(o.hide_offscreen_substreams)r.attachSubstream(vb);},attachNewPager:function(ub){l.dedupeHide(s.getStreamRoot(),s.getStoriesSelector());ma=ub;ma&&kb(false);},setPollerData:function(ub){if(ub){oa=ub;gb();}},headLoadCompleted:function(ub){ab=ub.newCursor;gb();var vb=ub.stories;if(vb&&vb.length>0){for(var wb=vb.length-1;wb>=0;wb--)vb[wb].setAttribute('data-insertion-position',--za);var xb=s.getStoriesSelector();l.dedupe(s.getStreamRoot(),xb);var yb=k.scry(bb,xb);h.inform('Stream/totalHeadLoadedStories',{count:-za,hiddenCount:yb.length,fblogo:ub.fblogo});}},forceNewFetch:function(){mb(true);}};f.exports=tb;},null);
__d('collectSubtreeData',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(j,k,l,m,n){if(j.offsetWidth===0&&j.offsetHeight===0)return n;var o={};if(j.getAttribute)for(s=0;s<k.length;s++){u=k[s];var p=j.getAttribute(l[u]);if(p){o[u]={};var q=JSON.parse(p);for(var r in m)if(q[r]!==undefined){o[u][r]=true;if(n[u]===undefined)n[u]={};if(n[u][r]===undefined)n[u][r]=[];if(m[r].length>0)n[u][r].push(m[r]);n[u][r].push('('+q[r]);}}}for(var s=0;s<j.childNodes.length;s++){var t=j.childNodes[s];h(t,k,l,m,n);}for(var u in o)for(var v in o[u]){var w=n[u][v][n[u][v].length-1];if(w.length>0&&w.charAt(0)=='('){n[u][v][n[u][v].length-1]=w.substr(1);}else n[u][v].push(')');}return n;}function i(j,k){var l={};for(var m=0;m<k.length;++m)l[k[m]]='data-'+k[m];var n={tn:"","tn-debug":","},o={};h(j,k,l,n,o);for(var p in o)for(var q in o[p])o[p][q]=o[p][q].join('');return o;}f.exports=i;},null);
__d('recordTNTreeData',['collectSubtreeData'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(j,k){var l={},m=h(j,['ft']);for(var n in m.ft){l[n+'_tree']=m.ft[n];if(n==='tn-debug')j.setAttribute('tn-debug_subtree',m.ft[n]);}l.evt_value=j.offsetHeight;if(k)l.offset=Math.max(0,j.offsetTop-k.offsetTop);return l;}f.exports=i;},null);
__d('PhotosUploadWaterfallMixin',['Flash','PhotosUploadWaterfall','emptyFunction'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=Object.assign||function(n){for(var o=1;o<arguments.length;o++){var p=arguments[o];for(var q in p)if(Object.prototype.hasOwnProperty.call(p,q))n[q]=p[q];}return n;},l=j,m={getUploaderApp:l,getWaterfallID:l,getAdditionalData:function(){return {};},logWaterfallStep:function(n,o,p){i.sendSignal(k({qn:this.getWaterfallID(),uploader:this.getUploaderApp(),step:n,flash_version:h.getVersionString(),ref:this.getWaterfallSource&&this.getWaterfallSource()},this.getAdditionalData(),o),p);},logWaterfallStepUsingBanzai:function(n,o,p){i.sendBanzai(k({qn:this.getWaterfallID(),uploader:this.getUploaderApp(),step:n,ref:this.getWaterfallSource&&this.getWaterfallSource()},this.getAdditionalData(),o),p);}};f.exports=m;},null);
__d('PhotoSourceTypes',['keyMirror'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();f.exports=h({COMPUTER:null,POSTED_PHOTOS:null,SYNCED_PHOTOS:null,SUGGESTIONS:null,PAGES_POSTED_PHOTOS:null});},null);
__d('BaseSelectionContainer',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=0;function i(){'use strict';this.$BaseSelectionContainer1=(h++).toString();}i.prototype.getSelectionContainerID=function(){'use strict';return this.$BaseSelectionContainer1;};i.prototype.getSource=function(){'use strict';throw 'This must be implemented by the child class';};i.prototype.getName=function(){'use strict';return null;};i.prototype.getSize=function(){'use strict';return null;};i.prototype.hasPlaceholderUI=function(){'use strict';throw 'This must be implemented by the child class';};f.exports=i;},null);
__d('SelectionSource',['PhotoSourceTypes'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i={FILE:'file',FLASH:'flash',VAULT:'vault',SUGGESTIONS:'suggestions',POSTED_PHOTOS:'posted_photos',PAGES_POSTED_PHOTOS:'pages_posted_photos',toPhotoSourceType:function(j){switch(j){case i.FILE:case i.FLASH:return h.COMPUTER;case i.VAULT:return h.SYNCED_PHOTOS;case i.SUGGESTIONS:return h.SUGGESTIONS;case i.POSTED_PHOTOS:return h.POSTED_PHOTOS;case i.PAGES_POSTED_PHOTOS:return h.PAGES_POSTED_PHOTOS;default:throw 'No mapping for SelectionSource: '+j;}}};f.exports=i;},null);
__d('FileSelectionContainer',['BaseSelectionContainer','SelectionSource'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j,k;j=h;k=j&&j.prototype;Object.assign(l,j);l.prototype=Object.create(j.prototype);l.prototype.constructor=l;l.__superConstructor__=j;function l(m){'use strict';k.constructor.call(this);this.$FileSelectionContainer1=m;}l.prototype.getFile=function(){'use strict';return this.$FileSelectionContainer1;};l.prototype.getSource=function(){'use strict';return i.FILE;};l.prototype.getName=function(){'use strict';return this.$FileSelectionContainer1.fileName||this.$FileSelectionContainer1.name;};l.prototype.getSize=function(){'use strict';return this.$FileSelectionContainer1.fileSize||this.$FileSelectionContainer1.size;};l.prototype.hasPlaceholderUI=function(){'use strict';return false;};f.exports=l;},null);
__d('FilePickerEvent',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();f.exports={BEGIN:'FilePickerEvent/BEGIN',SELECT_START:'FilePickerEvent/SELECT_START',SELECTED:'FilePickerEvent/SELECTED_FILES',ALBUM_LIMIT_EXCEEDED:'FilePickerEvent/ALBUM_LIMIT_EXCEEDED',SESSION_LIMIT_EXCEEDED:'FilePickerEvent/SESSION_LIMIT_EXCEEDED',SELECT_CANCELED:'FilePickerEvent/SELECT_CANCELED',FALLBACK:'FilePickerEvent/FALLBACK'};},null);
__d('FlashArbiterEvents',['Arbiter','Run'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();function j(k){'use strict';this._flashID=k;this._subscriptions=[];i.onLeave(this.unsubscribeAll.bind(this));}j.prototype.subscribe=function(k,l){'use strict';var m=this._flashID;this._subscriptions.push(h.subscribe(k,function(n,o){if(m===o.divID)l(o);}));return this;};j.prototype.unsubscribeAll=function(){'use strict';while(this._subscriptions.length)h.unsubscribe(this._subscriptions.pop());};f.exports=j;},null);
__d('compareFlashVersions',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(j){return j.replace(/\d+/g,function(k){return '000'.substring(k.length)+k;});}function i(j,k){j=h(j);k=h(k);if(j>k){return 1;}else if(j<k)return -1;return 0;}f.exports=i;},null);
__d('FlashLoadEvent',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();f.exports={READY:'flash/ready',FAILED:'flash/failed',MOUSE_CANCELED:'UploadEvent/SELECT_CANCELED',MOUSE_DOWN:'UploadEvent/SELECT_DOWN',MOUSE_OUT:'UploadEvent/SELECT_OUT',MOUSE_OVER:'UploadEvent/SELECT_OVER',MOUSE_UP:'UploadEvent/SELECT_UP',ERROR_FLASH_LOAD_TIMEOUT:1,ERROR_FLASH_LOAD_FAILURE:2,ERROR_FLASH_UPGRADE_REQUIRED:3};},null);
__d('UploadEvent',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={UPLOAD_START:'UploadEvent/UPLOAD_START',UPLOAD_HIRES_RESTART:'UploadEvent/UPLOAD_HIRES_RESTART',START:'UploadEvent/START',DONE:'UploadEvent/DONE',ERROR:'UploadEvent/ERROR',FINISHED_UPLOADING:'UploadEvent/FINISHED_UPLOADING',LOADED:'UploadEvent/LOADED',READY:'UploadEvent/READY',UPLOAD_FAILED:'UploadEvent/UPLOAD_FAILED',UPLOAD_PROGRESS:'UploadEvent/UPLOAD_PROGRESS',COMPRESS_PROGRESS:'UploadEvent/COMPRESS_PROGRESS',HI_RES_ATTACH_START:'UploadEvent/HI_RES_ATTACH_START',IMAGE_COMPRESS_ERROR:'UploadEvent/IMAGE_COMPRESS_ERROR',IMAGE_COMPRESS_BEGIN:'UploadEvent/IMAGE_COMPRESS_BEGIN',IMAGE_COMPRESSED:'UploadEvent/IMAGE_COMPRESSED',IMAGE_UPLOAD_ERROR:'UploadEvent/IMAGE_UPLOAD_ERROR',IMAGE_UPLOADED:'UploadEvent/IMAGE_UPLOADED',SELECT_START:'UploadEvent/SELECT_START',SELECT_CANCELED:'UploadEvent/SELECT_CANCELED',IMAGES_SELECTED:'UploadEvent/IMAGES_SELECTED',HEARTBEAT:'UploadEvent/HEARTBEAT',CANCELED_PROCESSING_PHOTO:'UploadEvent/CANCELED_PROCESSING_PHOTO',CANCELED_PHOTO_UPLOADED_ANYWAY:'UploadEvent/CANCELED_PHOTO_UPLOADED_ANYWAY'};f.exports=h;},null);
__d('FlashFilePicker',['Arbiter','ArbiterMixin','AsyncUploadBase','BrowserSupport','compareFlashVersions','ImageResizer','CSS','FilePickerEvent','Flash','FlashArbiterEvents','FlashLoadEvent','FlashUploaderConfig','HTML','Parent','PhotosUploadWaterfall','PhotosUploadWaterfallErrorCodes','PhotosUploadWaterfallMixin','PhotosUploadWaterfallXMixin','PUWApplications','UploadEvent','URI','PUWSteps','$'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da){if(c.__markCompiled)c.__markCompiled();function ea(ia){for(var ja=0;ja<ia.length;++ja)if(p.checkMinVersion(ia[ja].toString()))return true;return false;}function fa(ia){var ja=u.byClass(ia,'addPhotosDisabled');if(ja){n.removeClass(ja,'addPhotosDisabled');n.addClass(ja,'addPhotosEnabled');}}function ga(ia,ja){ja.style.width=ia.offsetWidth+'px';ja.style.height=ia.offsetHeight+'px';}function ha(ia,ja,ka){this._swfID=ia;this._button=ja;this._waterfallID=ka.qn;this._ref=ka.ref;this._beginInformed=false;this._isReady=false;this._fallbackHref=ka.fallbackHref;this._fallbackToHTML5=ka.fallbackToHTML5;if(!ea(s.flashVersionInfo.minimumVersion)){this.logWaterfallStep(v.UPGRADE_REQUIRED);this._flashError(w.FLASH_UPGRADE_REQUIRED||25);return;}if(ka.flashObjectsPerVersion)this._constructAndAppendFlashObject(ka.flashObjectsPerVersion);this._flashEvents=new q(this._swfID).subscribe(r.READY,this._handleReady.bind(this)).subscribe(r.FAILED,this._handleFailed.bind(this)).subscribe(r.MOUSE_OVER,this._handleMouseIn.bind(this)).subscribe(r.MOUSE_OUT,this._handleMouseOut.bind(this)).subscribe(aa.SELECT_START||'UploadEvent/SELECT_START',this._handleSelectStart.bind(this)).subscribe(aa.IMAGES_SELECTED,this._handleSelected.bind(this)).subscribe(aa.SELECT_CANCELED,this._handleCancelSelected.bind(this));this._timeout=setTimeout((function(){if(!this._isReady)this._flashError(w.FLASH_LOAD_TIMEOUT||23);}).bind(this),s.flashLoadTimeout);ka.logDetailed&&this.logDetailed();}Object.assign(ha.prototype,i,x,y,{_constructAndAppendFlashObject:function(ia){var ja=ia['default'];delete ia['default'];var ka=Object.keys(ia).sort(function(pa,qa){return l(qa,pa);}),la=ja;for(var ma=0;ma<ka.length;ma++){var na=ka[ma];if(p.checkMinVersion(na)){la=ia[na];break;}}var oa=t.replaceJSONWrapper(la).getRootNode();this._button.parentNode.appendChild(oa);},getUploaderApp:function(){return v.APP_FLASH;},getWaterfallID:function(){return this._waterfallID;},getWaterfallAppName:function(){return z.WEB_FLASH;},getWaterfallSource:function(){return this._ref;},getSwfID:function(){return this._swfID;},logDetailed:function(){this.logWaterfallStep(v.VERSION,{version:p.getVersionString()});if(j.isSupported()){this.logWaterfallStep(v.ASYNC_AVAILABLE);if(m.isSupported()){this.logWaterfallStep(v.RESIZER_AVAILABLE);}else this.logStep(ca.CLIENT_PROCESS_UNAVAILABLE,{error:'no_resizer'});}else this.logStep(ca.CLIENT_PROCESS_UNAVAILABLE,{error:'no_async_upload'});},_handleReady:function(ia){setTimeout((function(){return ga(this._button,da(this._swfID));}).bind(this));fa(this._button);this._isReady=true;clearTimeout(this._timeout);h.inform(aa.READY,{divID:this._swfID},h.BEHAVIOR_PERSISTENT);},_handleFailed:function(ia){this._flashError(w.FLASH_LOAD_FAILURE||24);},_flashError:function(ia){if(this._fallbackToHTML5&&k.hasFileAPI()){var ja=new ba(this._button.getAttribute('ajaxify'));this._button.setAttribute('ajaxify',ja.addQueryData({application:v.APP_HTML5,xapplication:z.WEB_HTML5}).toString());fa(this._button);this.logWaterfallStep(v.FALLBACK_TO_HTML5||130);return;}if(this._fallbackHref){var ka=new ba(this._fallbackHref).addQueryData({error:ia}).toString();this._button.removeAttribute('rel');this._button.removeAttribute('ajaxify');this._button.setAttribute('href',ka);fa(this._button);}this.logWaterfallStep(v.CLIENT_ERROR,{code:ia,scuba_tags:{fallback_simple:true}});this.logStep(ca.CLIENT_FLOW_FATAL,{error_code:ia,fallback_simple:true});},_handleMouseIn:function(ia){n.addClass(this._button,'selectOver');},_handleMouseOut:function(ia){n.removeClass(this._button,'selectOver');},_handleSelectStart:function(ia){if(!this._beginInformed){this._beginInformed=true;this.inform(o.BEGIN||'FilePickerEvent/BEGIN');}this.inform(o.SELECT_START);},_handleSelected:function(ia){var ja;if(ia.files){ja=ia.files;}else{ja=[{uploadID:ia.divID+'.'}];ja.length=ia.count;}this.inform(o.SELECTED,{sender:this,files:ja},h.BEHAVIOR_PERSISTENT);if(ia.albumLimitExceeded)this.inform(o.ALBUM_LIMIT_EXCEEDED,{},h.BEHAVIOR_PERSISTENT);if(ia.sessionLimitExceeded)this.inform(o.SESSION_LIMIT_EXCEEDED,{},h.BEHAVIOR_PERSISTENT);},_handleCancelSelected:function(ia){this.inform(o.SELECT_CANCELED);}});f.exports=ha;},null);
__d('HTML5FilePicker',['ArbiterMixin','BrowserSupport','CSS','DOM','FilePickerEvent','FileSelectionContainer','Parent','PhotosUploadID','PhotosUploadWaterfall','PhotosUploadWaterfallMixin','PhotosUploadWaterfallXMixin','PUWApplications','URI','PUWSteps','createArrayFromMixed','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){if(c.__markCompiled)c.__markCompiled();var x=Object.assign||function(z){for(var aa=1;aa<arguments.length;aa++){var ba=arguments[aa];for(var ca in ba)if(Object.prototype.hasOwnProperty.call(ba,ca))z[ca]=ba[ca];}return z;};function y(z,aa){this._config=x({accept:undefined,multiple:undefined},aa);this._button=z;this._beginInformed=false;if(!i.hasFileAPI()){this.logStep(u.CLIENT_PROCESS_UNAVAILABLE,{error:'no_file_api'});if(this._config.hasOwnProperty('fallbackFunction')){this._config.fallbackFunction.call(this);return;}var ba=new t(this._button.getAttribute('ajaxify'));this._button.setAttribute('ajaxify',ba.addQueryData({app:p.APP_FLASH}).toString());this.logWaterfallStep(p.FALLBACK_TO_FLASH);return;}this._subscriptions=[];var ca=this._config.input||k.create('input',{type:'file',className:"_n"});if(this._config.hasOwnProperty('accept'))ca.accept=this._config.accept;if(this._config.hasOwnProperty('multiple'))ca.multiple=this._config.multiple;if(this._config.hasOwnProperty('title'))ca.title=this._config.title;var da=k.create('label',{className:'accessible_elem','for':k.getID(ca)},ca.title),ea=k.create('div',{className:"_3jk"},[da,ca]);j.addClass(this._button,"_m");k.appendContent(this._button,ea);this._button.setAttribute('rel','ignore');this._bindInput(ca);var fa=n.byClass(this._button,'addPhotosDisabled');if(fa){j.removeClass(fa,'addPhotosDisabled');j.addClass(fa,'addPhotosEnabled');}}Object.assign(y.prototype,h,q,r,{getUploaderApp:function(){return p.APP_HTML5;},getWaterfallID:function(){return this._config.qn;},getWaterfallAppName:function(){return s.WEB_HTML5;},getWaterfallSource:function(){return this._config.ref;},getSwfID:function(){return null;},_constructFileList:function(){var z=v(this._input.files);z.forEach(function(aa){aa.uploadID=o.getNewID();});return z;},_constructFileSelectionContainerList:function(){var z=v(this._input.files);return z.map(function(aa){return new m(aa);});},cleanup:function(){if(this._input){this._input.onclick=null;this._input.onchange=null;}},_bindInput:function(z){this.cleanup();z.onclick=(function(){this.logWaterfallStep(p.SELECT_START);if(!this._beginInformed){this._beginInformed=true;this.inform(l.BEGIN||'FilePickerEvent/BEGIN');}this.inform(l.SELECT_START);}).bind(this);z.onchange=(function(){this.inform(l.SELECTED,{sender:this,files:this._constructFileList(),selections:this._constructFileSelectionContainerList()});this._bindInput(this._input.cloneNode(false));}).bind(this);if(this._input)k.replace(this._input,z);this._input=z;}});f.exports=y;},null);
__d('UploadSession',['AsyncRequest','FilePickerEvent','PhotosUploadWaterfall','PUWSteps','URI','arrayContains'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n={};function o(q){'use strict';this._sessionID=q;this._asyncBootstrapped=false;this._controller=null;this._overlay=null;this._pickers=[];this._pendingFileLists=[];this._beginLogged=false;this._albumLimitWasExceeded=false;this._sessionLimitWasExceeded=false;}o.prototype.addFilePicker=function(q){'use strict';if(!m(this._pickers,q)){this._pickers.push(q);if(this._controller&&q.getSwfID&&q.getSwfID())this._controller.preregisterSwf&&this._controller.preregisterSwf(q.getSwfID());q.subscribe(i.BEGIN,(function(r,s){if(!this._beginLogged){this._beginLogged=true;q.logWaterfallStep(j.BEGIN);q.logStep(k.CLIENT_FLOW_BEGIN);}}).bind(this));q.subscribe(i.SELECTED,(function(r,s){q.logStep(k.CLIENT_SELECT_SUCCESS,{volume:s.files.length});if(this._controller){this._controller.uploadFiles(s.files);}else this._pendingFileLists.push(s);if(this._asyncBootstrapped)return;var t=q._button,u=new l(t.getAttribute('ajaxify'));u.addQueryData('num_selected',s.files.length);h.bootstrap(u.toString(),t,true);this._asyncBootstrapped=true;}).bind(this));q.subscribe(i.SELECT_START,(function(){q.logStep(k.CLIENT_SELECT_BEGIN);}).bind(this));q.subscribe(i.SELECT_CANCELED,(function(){q.logStep(k.CLIENT_SELECT_CANCEL);if(!this._overlay){q.logStep(k.CLIENT_FLOW_CANCEL);this._beginLogged=false;}}).bind(this));q.subscribe(i.ALBUM_LIMIT_EXCEEDED,(function(){if(this._controller){this._controller.albumLimitExceeded();}else this._albumLimitWasExceeded=true;}).bind(this));q.subscribe(i.SESSION_LIMIT_EXCEEDED,(function(){if(this._controller){this._controller.sessionLimitExceeded();}else this._sessionLimitWasExceeded=true;}).bind(this));}};o.prototype.addController=function(q){'use strict';this._controller=q;this._asyncBootstrapped=true;var r=this._controller.getWaterfallID?this._controller.getWaterfallID():this._controller.getWaterfallConfig().waterfallID,s=this._controller.getUploaderApp?this._controller.getUploaderApp():this._controller.getWaterfallConfig().waterfallApp;if(!this._beginLogged){this._beginLogged=true;j.sendSignal({qn:r,step:j.BEGIN,uploader:s});}if(this._pendingFileLists.length){var t=[];this._pendingFileLists.forEach(function(u){t=t.concat(u.files);});this._controller.uploadFiles(t);}else j.sendSignal({qn:r,step:j.OVERLAY_FIRST,uploader:s});if(this._albumLimitWasExceeded)this._controller.albumLimitExceeded();if(this._sessionLimitWasExceeded)this._controller.sessionLimitExceeded();};o.prototype.addOverlay=function(q){'use strict';this._overlay=q;};o.prototype.addOverlayAndController=function(q,r){'use strict';this.addOverlay(q);this.addController(r);};o.addFilePickerToSession=function(q,r){'use strict';p(q).addFilePicker(r);};o.addControllerToSession=function(q,r){'use strict';p(q).addController(r);};o.addOverlayToSession=function(q,r){'use strict';p(q).addOverlay(r);};o.addOverlayAndControllerToSession=function(q,r,s){'use strict';p(q).addOverlayAndController(r,s);};function p(q){if(!n[q])n[q]=new o(q);return n[q];}f.exports=o;},null);
__d("StoryTopicMap",[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={},i={registerTopics:function(j,k){h[j]=k;},getTopicsForFTID:function(j){return h[j]||[];}};f.exports=i;},null);
__d("XEventRelatedEventsPivotController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/events\/async\/related_events_pivot\/",{event_id:{type:"Int",required:true},attachment_id:{type:"String",required:true}});},null,{});
__d("XSearchRelatedPostsPivotController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/search\/async\/related_posts_pivot\/",{origin:{type:"String",required:true},content_id:{type:"String",required:true}});},null,{});
__d("XPubcontentFeedChainingController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/pubcontent\/feed_chaining\/",{actor_id:{type:"String",required:true},content_id:{type:"String"},ft_id:{type:"String"},origin:{type:"String",required:true}});},null,{});
__d("XPubcontentRelatedShareChainingController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/pubcontent\/related_share\/",{attachment_div_id:{type:"String",required:true},global_share_id:{type:"Int",required:true},video_div_id:{type:"String"},link_url:{type:"String"},qid:{type:"String"},mf_story_key:{type:"String"},share_id:{type:"String"},is_auto_expand:{type:"Bool",defaultValue:false}});},null,{});
__d("XPubcontentRelatedVideoChainingController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/pubcontent\/related_video\/",{attachment_div_id:{type:"String",required:true},fbvideo_id:{type:"Int",required:true},qid:{type:"String"},mf_story_key:{type:"String"}});},null,{});
__d("XPubcontentTopicChainingController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/pubcontent\/topic_chaining\/",{pivotal_topic_ids:{type:"IntVector",defaultValue:[]}});},null,{});
__d("XPubcontentInlineStoryPivotChainingController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/pubcontent\/inline_story_pivot_chaining\/",{origin:{type:"String",required:true},storyid:{type:"String"},ftid:{type:"String"}});},null,{});
__d("XRelatedGamesChainingController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/games\/async\/related_games\/",{attachment_div_id:{type:"String",required:true},app_id:{type:"Int",required:true}});},null,{});
__d("XTopicConversationFeedPivotChainingController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/discussions\/creation_unit\/",{});},null,{});
__d('PubcontentFeedChainingController',['AggregatedLinkComposerConfig','Arbiter','AsyncRequest','AttachmentRelatedShareConstants','CreateTopicConversationChainingConfig','CSS','cx','DOM','DOMQuery','FeedAdsChainingConfig','NavigationMessage','PageLikeConstants','PubcontentFeedChainingConfig','PubcontentRelatedShareChainingConfig','PubcontentTopicChainingConfig','StoryInlinePivotChainingConfig','RelatedEventsPivotChainingConfig','Run','SearchRelatedPostsPivotChainingConfig','StoryTopicMap','SubscriptionsHandler','UFIFeedbackTargets','UFIUIEvents','XEventRelatedEventsPivotController','XSearchRelatedPostsPivotController','XFeedAdsChainingController','XPubcontentFeedChainingController','XPubcontentRelatedShareChainingController','XPubcontentRelatedVideoChainingController','XPubcontentTopicChainingController','XPubcontentInlineStoryPivotChainingController','XRelatedGamesChainingController','XTopicConversationFeedPivotChainingController'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na){if(c.__markCompiled)c.__markCompiled();var oa='ei',pa='ad_fan_page_action',qa='ad_like_page_post_action',ra='page_story_like_action',sa='related_share_article_click',ta='related_share_video_click',ua='page_share_like_action',va='topic_story_like_action',wa='story_click_for_pivot_action',xa='story_like_pivot_action',ya='event_join',za='comment_on_topic_conversation_target_action',ab='composer_publish_action';function bb(){'use strict';this.$PubcontentFeedChainingController1=t;this.$PubcontentFeedChainingController2=q;this.$PubcontentFeedChainingController3=u;this.$PubcontentFeedChainingController4=v;this.$PubcontentFeedChainingController5=w;this.$PubcontentFeedChainingController6=x;this.$PubcontentFeedChainingController7=z;this.$PubcontentFeedChainingController8=l;this.$PubcontentFeedChainingController9={};this.registerEvents();bb.instance=this;}bb.prototype.registerEvents=function(){'use strict';if(this.$PubcontentFeedChainingController10)return;this.$PubcontentFeedChainingController10=new ba();this.$PubcontentFeedChainingController10.addSubscriptions(i.subscribe(r.NAVIGATION_BEGIN,this.$PubcontentFeedChainingController11.bind(this)),i.subscribe(s.LIKED,this.$PubcontentFeedChainingController12.bind(this)),i.subscribe(da.UFIActionLinkLike,this.$PubcontentFeedChainingController13.bind(this)),i.subscribe(da.UFIActionAddComment,this.$PubcontentFeedChainingController14.bind(this)),i.subscribe('composer/publish',this.$PubcontentFeedChainingController15.bind(this)),i.subscribe('LitestandComposer/publish',this.$PubcontentFeedChainingController15.bind(this)),i.subscribe(k.ARTICLE_CLICK,this.$PubcontentFeedChainingController16.bind(this)),i.subscribe(k.VIDEO_CLICK,this.$PubcontentFeedChainingController17.bind(this)),i.subscribe(k.FBVIDEO_CLICK,this.$PubcontentFeedChainingController18.bind(this)),i.subscribe(k.GAME_CLICK,this.$PubcontentFeedChainingController19.bind(this)),i.subscribe(k.PHOTO_CLICK,this.$PubcontentFeedChainingController20.bind(this)),i.subscribe(k.EVENT_JOIN,this.$PubcontentFeedChainingController21.bind(this)));y.onLeave(this.$PubcontentFeedChainingController11.bind(this));};bb.prototype.$PubcontentFeedChainingController11=function(){'use strict';this.$PubcontentFeedChainingController10&&this.$PubcontentFeedChainingController10.release();this.$PubcontentFeedChainingController10=null;};bb.getAdClientTokenIndex=function(){'use strict';return oa;};bb.prototype.$PubcontentFeedChainingController12=function(cb,db){'use strict';var eb=this.findAdClientToken(db.target);if(eb){this.$PubcontentFeedChainingController22(db.target,{origin:pa,actor_id:db.profile_id,client_token:eb});}else this.$PubcontentFeedChainingController23(db.target,{origin:db.origin,actor_id:db.profile_id});};bb.prototype.$PubcontentFeedChainingController14=function(cb,db){'use strict';if(!db.feedback)return;var eb=this.$PubcontentFeedChainingController24(db.target,{origin:za,data:db});if(!eb)return false;var fb=na.getURIBuilder().getURI();new j(fb).setErrorHandler(this.$PubcontentFeedChainingController25.bind(this,eb.story.id)).setRelativeTo(eb.chainingWrapper).setMethod('POST').setData({story_id:db.feedback.entidentifier}).send();return true;};bb.prototype.$PubcontentFeedChainingController13=function(cb,db){'use strict';if(!db.ft_id)return;if(!this.$PubcontentFeedChainingController26(this.findStory(db.target)))return;ca.getFeedbackTarget(db.ft_id,(function(eb,fb){var gb=this.findAdClientToken(eb);if(gb&&fb.isshare){this.$PubcontentFeedChainingController22(eb,{actor_id:fb.actorid,origin:qa,ft_id:fb.entidentifier,client_token:gb});}else if(fb.isownerpage){this.$PubcontentFeedChainingController23(eb,{actor_id:fb.actorid,content_id:fb.entidentifier,origin:ra});}else if(fb.isshare){this.$PubcontentFeedChainingController23(eb,{actor_id:fb.actorid,content_id:fb.entidentifier,ft_id:fb.entidentifier,origin:ua});}else{var hb=aa.getTopicsForFTID(fb.entidentifier);if(hb&&hb.length>0){this.$PubcontentFeedChainingController27(eb,{ft_id:fb.entidentifier,origin:va,pivotal_topic_ids:hb});}else this.$PubcontentFeedChainingController28(eb,{origin:xa,ft_id:fb.entidentifier});}}).bind(this,db.target));};bb.prototype.$PubcontentFeedChainingController28=function(cb,db){'use strict';var eb=this.$PubcontentFeedChainingController24(cb,db);if(!eb)return false;var fb=la.getURIBuilder().setString('origin',db.origin);if(db.story_id)fb.setString('storyid',String(db.story_id));if(db.ft_id)fb.setString('ftid',String(db.ft_id));new j().setErrorHandler(this.$PubcontentFeedChainingController25.bind(this,eb.story.id)).setRelativeTo(eb.chainingWrapper).setURI(fb.getURI()).setAllowCrossPageTransition(true).send();return true;};bb.prototype.$PubcontentFeedChainingController20=function(cb,db){'use strict';var eb=this;eb.$PubcontentFeedChainingController28(db.attachment,{origin:wa,story_id:db.storyid});};bb.prototype.$PubcontentFeedChainingController16=function(cb,db){'use strict';if(h.no_chained_related_stories==='true')return;db.origin=sa;var eb=this,fb=this.findStory(db.attachment),gb=p.scry(p.getRootElement(),'#initial_browse_result').length>0;if(gb)return;var hb;if(db.is_right_click){hb=0;}else hb=k.EVENT_DELAY;setTimeout(function(){if(fb){var ib=eb.findAttachment(fb);if(ib)db.attachment=ib;}eb.$PubcontentFeedChainingController29(db.attachment,db);},hb);};bb.prototype.$PubcontentFeedChainingController17=function(cb,db){'use strict';db.origin=ta;var eb=this,fb=this.findStory(db.attachment);setTimeout(function(){if(fb){var gb=eb.findAttachment(fb);if(gb)db.attachment=gb;}eb.$PubcontentFeedChainingController29(db.attachment,db);},k.EVENT_DELAY);};bb.prototype.$PubcontentFeedChainingController18=function(cb,db){'use strict';db.origin=ta;var eb=this,fb=this.findStory(db.attachment);setTimeout(function(){if(fb){var gb=eb.findAttachment(fb);if(gb)db.attachment=gb;}eb.$PubcontentFeedChainingController29(db.attachment,db);},k.EVENT_DELAY);};bb.prototype.$PubcontentFeedChainingController19=function(cb,db){'use strict';var eb=this,fb=this.findStory(db.attachment);setTimeout(function(){if(fb)var gb=eb.findContainer(fb);eb.$PubcontentFeedChainingController30(fb,db.global_share_id,o.getID(gb));},k.EVENT_DELAY);};bb.prototype.$PubcontentFeedChainingController21=function(cb,db){'use strict';var eb=this.findStory(db.attachment);if(eb){var fb=this.findAttachment(eb);if(fb)db.attachment=fb;}this.$PubcontentFeedChainingController31(db.attachment,{origin:ya,event_id:db.event_id});};bb.prototype.$PubcontentFeedChainingController15=function(cb,db){'use strict';var eb=this;setTimeout(function(){eb.$PubcontentFeedChainingController32(db.markup.firstChild,{origin:ab,content_id:db.content_id});},this.$PubcontentFeedChainingController7.composer_publish_action);};bb.prototype.$PubcontentFeedChainingController33=function(cb){'use strict';return !!(cb&&cb.id&&!m.hasClass(cb,"_sf6")&&!(cb.id in this.$PubcontentFeedChainingController9));};bb.prototype.$PubcontentFeedChainingController34=function(cb){'use strict';if(!cb)return false;if(cb.origin in this.$PubcontentFeedChainingController1||cb.origin in this.$PubcontentFeedChainingController3||cb.origin in this.$PubcontentFeedChainingController2||cb.origin in this.$PubcontentFeedChainingController5||cb.origin in this.$PubcontentFeedChainingController6||cb.origin in this.$PubcontentFeedChainingController8||cb.origin in this.$PubcontentFeedChainingController7){return true;}else{var db=this.$PubcontentFeedChainingController4[cb.origin];if(!db||!db.rate)return false;var eb=Math.random();if(eb>db.rate)return false;return true;}};bb.prototype.$PubcontentFeedChainingController35=function(cb){'use strict';this.$PubcontentFeedChainingController9[cb]=true;};bb.prototype.$PubcontentFeedChainingController25=function(cb){'use strict';delete this.$PubcontentFeedChainingController9[cb];};bb.prototype.$PubcontentFeedChainingController26=function(cb){'use strict';if(!cb)return false;var db="_3lkn",eb=cb.nextSibling,fb=true;if(eb&&eb.firstChild){var gb=eb.firstChild;fb=!(gb.hasChildNodes()&&m.hasClass(gb,db));}if(!fb)return false;var hb=cb.children[0],ib=cb.children[1],jb="_4_ck";if(hb&&m.hasClass(hb,jb)||ib&&m.hasClass(ib,jb))return false;return true;};bb.prototype.$PubcontentFeedChainingController24=function(cb,db){'use strict';var eb=this.findStory(cb);if(!this.$PubcontentFeedChainingController33(eb))return null;if(!this.$PubcontentFeedChainingController34(db))return null;this.$PubcontentFeedChainingController35(eb.id);if(this.isSponsoredStory(eb))return null;var fb;if(!db.continued_chaining){fb=this.findContainer(eb);if(!fb)return null;var gb=o.create('div'),hb=o.appendContent(fb,gb);if(hb.length!==1)return null;}else{fb=eb;gb=o.create('div');hb=o.insertAfter(fb,gb);o.remove(fb);if(hb.length!==1)return null;}if(db.is_auto_expand){return {chainingWrapper:hb[0],story:eb,is_auto_expand:db.is_auto_expand};}else return {chainingWrapper:hb[0],story:eb};};bb.prototype.$PubcontentFeedChainingController22=function(cb,db){'use strict';var eb=this.$PubcontentFeedChainingController24(cb,db);if(!eb)return false;var fb=this.findStreamRoot(eb.story);if(!fb)return false;var gb=fb.getAttribute('id'),hb=ga.getURIBuilder().setString('actor_id',db.actor_id).setString('origin',db.origin).setString('ei',db.client_token).setString('data_ownerid',gb);if(db.ft_id)hb.setString('ft_id',db.ft_id);new j().setErrorHandler(this.$PubcontentFeedChainingController25.bind(this,eb.story.id)).setRelativeTo(eb.chainingWrapper).setURI(hb.getURI()).send();return true;};bb.prototype.$PubcontentFeedChainingController29=function(cb,db){'use strict';if(!this.$PubcontentFeedChainingController26(this.findStory(cb)))return false;var eb=this.$PubcontentFeedChainingController24(cb,db);if(!eb)return false;m.addClass(eb.chainingWrapper,"_3lkn");var fb=null;if(db.fbvideo_id){fb=ja.getURIBuilder();fb.setInt('fbvideo_id',db.fbvideo_id);}else{fb=ia.getURIBuilder();fb.setInt('global_share_id',db.global_share_id);}fb.setString('attachment_div_id',o.getID(db.attachment));if(db.link_url)fb.setString('link_url',db.link_url);if(db.video_div_id)fb.setString('video_div_id',db.video_div_id);if(db.share_id)fb.setString('share_id',db.share_id);var gb=JSON.parse(eb.story.getAttribute('data-ft'))||{};if('qid' in gb&&'mf_story_key' in gb){fb.setString('qid',gb.qid);fb.setString('mf_story_key',gb.mf_story_key);}if(db.is_auto_expand){this.$PubcontentFeedChainingController25(eb.story.id);fb.setBool('is_auto_expand',db.is_auto_expand);}var hb=new j().setErrorHandler(this.$PubcontentFeedChainingController25.bind(this,eb.story.id)).setRelativeTo(eb.chainingWrapper).setURI(fb.getURI());gb&&hb.setData(gb);hb.send();return true;};bb.prototype.$PubcontentFeedChainingController30=function(cb,db,eb){'use strict';if(!this.$PubcontentFeedChainingController33(cb))return;this.$PubcontentFeedChainingController35(cb.id);var fb=ma.getURIBuilder().setInt('app_id',db).setString('attachment_div_id',eb);new j().setErrorHandler(this.$PubcontentFeedChainingController25.bind(this,cb.id)).setURI(fb.getURI()).send();return true;};bb.prototype.$PubcontentFeedChainingController23=function(cb,db){'use strict';var eb=this.$PubcontentFeedChainingController24(cb,db);if(!eb)return false;var fb=ha.getURIBuilder().setString('actor_id',db.actor_id).setString('origin',db.origin);if(db.ft_id)fb.setString('ft_id',db.ft_id);if(db.content_id)fb.setString('content_id',db.content_id);new j().setErrorHandler(this.$PubcontentFeedChainingController25.bind(this,eb.story.id)).setRelativeTo(eb.chainingWrapper).setURI(fb.getURI()).send();return true;};bb.prototype.$PubcontentFeedChainingController27=function(cb,db){'use strict';var eb=this.$PubcontentFeedChainingController24(cb,db);if(!eb)return false;var fb=ka.getURIBuilder().setIntVector('pivotal_topic_ids',db.pivotal_topic_ids).getURI();new j().setErrorHandler(this.$PubcontentFeedChainingController25.bind(this,eb.story.id)).setRelativeTo(eb.chainingWrapper).setURI(fb).send();return true;};bb.prototype.$PubcontentFeedChainingController31=function(cb,db){'use strict';var eb=this.$PubcontentFeedChainingController24(cb,db);if(!eb)return false;var fb=ea.getURIBuilder().setInt('event_id',db.event_id).setString('attachment_id',o.getID(cb)).getURI();new j().setErrorHandler(this.$PubcontentFeedChainingController25.bind(this,eb.story.id)).setRelativeTo(eb.chainingWrapper).setURI(fb).send();return true;};bb.prototype.$PubcontentFeedChainingController32=function(cb,db){'use strict';var eb=this.$PubcontentFeedChainingController24(cb,db);if(!eb)return false;var fb=fa.getURIBuilder().setString('origin',db.origin).setString('content_id',String(db.content_id));new j().setErrorHandler(this.$PubcontentFeedChainingController25.bind(this,eb.story.id)).setRelativeTo(eb.chainingWrapper).setURI(fb.getURI()).setAllowCrossPageTransition(true).send();return true;};f.exports=bb;},null);
__d('PubcontentLitestandClassicChainingController',['ContextualThing','DOM','PubcontentFeedChainingController','csx'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l,m;l=j;m=l&&l.prototype;Object.assign(n,l);n.prototype=Object.create(l.prototype);n.prototype.constructor=n;n.__superConstructor__=l;n.prototype.findStory=function(o){'use strict';var p="^div._4-u2",q=i.scry(o,p);return q.length===1?q[0]:null;};n.prototype.isSponsoredStory=function(o){'use strict';var p="._5paw";return i.scry(o,p).length>0;};n.prototype.findAttachment=function(o){'use strict';var p="div._6m2",q="div.iframeEmbed",r=i.scry(o,p)[0]||i.scry(o,q)[0];return r;};n.prototype.findContainer=function(o){'use strict';var p=i.create('div'),q=i.insertAfter(o,p);h.register(p,o);return q.length>=1?q[0]:null;};n.prototype.findStreamRoot=function(o){'use strict';var p="^div._4ikz";return i.scry(o,p)[0];};n.prototype.findAdClientToken=function(o){'use strict';var p=this.findStory(o);if(!p)return null;var q=p.getAttribute('data-ft');if(!q)return null;var r=JSON.parse(q);return r[j.getAdClientTokenIndex()];};n.prototype.init=function(){'use strict';this.registerEvents();};function n(){'use strict';l.apply(this,arguments);}f.exports=new n();},null);
__d("XSearchAwarenessController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/search\/async\/awareness\/",{origin:{type:"String"},story_id:{type:"Int"},actor_id:{type:"Int"},global_share_id:{type:"Int"},query:{type:"String"},dismiss:{type:"Exists",defaultValue:false}});},null,{});
__d('SearchAwarenessDispatcher',['Arbiter','AsyncRequest','AttachmentRelatedShareConstants','DOM','NavigationMessage','PageLikeConstants','Run','CSS','SearchAwarenessWebConfig','SubscriptionsHandler','UFIFeedbackTargets','UFIUIEvents','XSearchAwarenessController','EventListener','csx','cx','setTimeoutAcrossTransitions'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){if(c.__markCompiled)c.__markCompiled();var y='ARTICLE_CLICK_ACTION',z='STORY_CLICK_ACTION',aa='STORY_LIKE_ACTION',ba='COMPOSER_PUBLISH_ACTION',ca='FAN_PAGE_ACTION',da='TRENDING_SERP_LOAD',ea='PHOTOS_SERP_LOAD',fa=false,ga,ha={init:function(){if(!p.master_gk)return;if(fa)return;ga=new q();ga.addSubscriptions(h.subscribe(l.NAVIGATION_BEGIN,ha._cleanup.bind(this)),h.subscribe(m.LIKED,ha._onFan.bind(this)),h.subscribe(s.UFIActionLinkLike,ha._onLike.bind(this)),h.subscribe('composer/publish',ha._onComposerPublish.bind(this)),h.subscribe('LitestandComposer/publish',ha._onComposerPublish.bind(this)),h.subscribe(j.ARTICLE_CLICK,ha._onArticleClick.bind(this)));n.onLeave(ha._cleanup.bind(this));fa=true;},_cleanup:function(){ga&&ga.release();ga=null;fa=false;},_onFan:function(ia,ja){if(!p.has_on_fan)return;ha._dispatch(ja.target,{origin:ca,actor_id:ja.profile_id});},_onLike:function(ia,ja){if(!p.has_on_like)return;if(!ja.ft_id)return;r.getFeedbackTarget(ja.ft_id,(function(ka,la){ha._dispatch(ja.target,{actor_id:la.actorid,story_id:la.entidentifier,origin:aa});}).bind(this,ja.target));},_onPhotoClick:function(ia,ja){if(!p.has_on_photo_click)return;ha._dispatch(ja.target,{story_id:ja.storyid,origin:z});},_onArticleClick:function(ia,ja){if(!p.has_on_article_click)return;ha._dispatch(ja.target,{global_share_id:ja.global_share_id,story_id:ja.share_id,origin:y});},_onComposerPublish:function(ia,ja){if(!p.has_on_composer_publish)return;ha._dispatch(ja.markup.firstChild,{story_id:ja.content_id,origin:ba});},onTrendingSERPLoad:function(ia){if(ia==null||!p.master_gk)return;ha._dispatch(null,{query:ia,origin:da});},onPhotosSERPLoad:function(ia){if(ia==null||!p.master_gk)return;ha._dispatch(null,{query:ia,origin:ea});},_dispatch:function(ia,ja){if(!ja.origin)return true;var ka=t.getURIBuilder().setString('origin',ja.origin);if(ja.story_id)ka.setInt('story_id',parseInt(ja.story_id,10));if(ja.actor_id)ka.setInt('actor_id',parseInt(ja.actor_id,10));if(ja.global_share_id)ka.setInt('global_share_id',parseInt(ja.global_share_id,10));if(ja.query)ka.setString('query',ja.query);var la=new i().setURI(ka.getURI()),ma=k.scry(document.body,"._585-")[0],na=k.scry(document.body,"._5ob9")[0],oa=ma!=null?ma:na;if(oa){la.setRelativeTo(oa);la.send();}return true;},showAwarenessExperienceNow:function(ia){if(!fa)ha.init();if(ia==null||!fa||ga==null)return;var ja=u.listen(document.body,'click',function(){if(ia!=null)ia.destroy();ja.remove();});ga.addSubscriptions(ja);ia.show();},findStory:function(ia){var ja="^div._4-u2",ka=k.scry(ia,ja);return ka.length===1?ka[0]:null;},onTrendingSERPLeave:function(ia,ja){if(!fa)ha.init();if(ia==null||!fa)return;n.onLeave(function(){x(function(){n.onAfterLoad(function(){ha._dispatch(null,{query:ia,origin:da});});},ja);});},openMegaNUX:function(){if(!fa)ha.init();var ia=k.scry(document.body,"._4y-a")[0];if(ia==null)return;o.addClass(document.body,"_4y-7");o.addClass(ia,"_4y-8");var ja=h.subscribe('SearchAwareness.dismissUnit',function(){o.removeClass(document.body,"_4y-7");});ga&&ga.addSubscriptions(ja);},openMegaNUXWithoutFilters:function(){if(!fa)ha.init();var ia=k.scry(document.body,"._4y-a")[0];if(ia==null)return;o.addClass(document.body,"_4y-9");o.addClass(ia,"_4y-8");var ja=h.subscribe('SearchAwareness.dismissUnit',function(){o.removeClass(document.body,"_4y-9");});ga&&ga.addSubscriptions(ja);}};f.exports=ha;},null);
__d('FeedAdsGapRuleViolationDetection',['Banzai','CSS','csx','cx','DOM','ge','isEmpty'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();var o=Object.assign||function(da){for(var ea=1;ea<arguments.length;ea++){var fa=arguments[ea];for(var ga in fa)if(Object.prototype.hasOwnProperty.call(fa,ga))da[ga]=fa[ga];}return da;},p='ei',q='qid',r='gap rule violation',s='non violating ads gap',t='first position violation',u='feed load',v='first position invalidation',w='spacing invalidation',x=[],y=[],z=[],aa={},ba={},ca={registerFeedStories:function(da,ea){if(da.containerID=='substream_0'){x=[];y=[];}var fa=m(da.containerID);if(!fa)return;aa=o({},da.demoAdChecks,aa);var ga=l.scry(fa,"div._5jmm").map(this._convertStoryNodeToObject).filter(function(ia){return ia!==null;});if(da.isLoggingEnabled&&ga.length!==0)this._logFeedLoad();if(da.isNewerStories){x=ga.concat(x);}else x=x.concat(ga);for(var ha in da.minGaps)if(da.minGaps.hasOwnProperty(ha))ba[ha]=da.minGaps[ha];if(n(aa)){if(da.isLoggingEnabled||da.isFirstPosInvalidationEnabled)this._checkFirstPosViolation(da,fa);if(da.isLoggingEnabled||da.isGapRuleInvalidationEnabled)this._checkGapRuleViolation(da);}},_convertStoryNodeToObject:function(da){if(i.hasClass(da,"_170y"))return null;var ea=da.getAttribute('data-dedupekey');if(aa[ea])return null;var fa=l.scry(da,"div._hye"),ga=l.scry(da,"li._170x"),ha=[];if(fa.length!==0){ha=fa.map(function(ka){return ka.getAttribute('data-ft');}).filter(function(ka){return ka!==null;});}else if(ga.length!==0){ha=ga.map(function(ka){return ka.getAttribute('data-ft');}).filter(function(ka){return ka!==null;});}else if(da.getAttribute('data-ft'))ha=[da.getAttribute('data-ft')];if(!ha.length)return null;var ia=JSON.parse(ha[0]),ja={dataFTArray:ha,dedupKey:ea,isSponsored:!!ia[p],height:da.offsetHeight,qid:parseInt(ia[q],10),nodeID:da.id};return ja;},_checkFirstPosViolation:function(da,ea){while(x.length>0&&x[0].isSponsored){var fa={ftArray:x[0].dataFTArray,qid:x[0].qid,nodeid:x[0].nodeID,firstStoryType:da.firstStoryType},ga=l.scry(ea,'.uiBoxRed')[0];if(ga){var ha=ga.textContent||ga.innerText;if(ha)fa.error_msg=ha;}if(da.isLoggingEnabled&&!(x[0].dedupKey in z)){this._logFirstPosViolation(fa);z[x[0].dedupKey]=fa;}if(da.isFirstPosInvalidationEnabled){this._invalidateFirstPosAd(fa);x.splice(0,1);}else break;}},_getMinGap:function(da,ea,fa){var ga=Math.min(da?da:Number.MAX_VALUE,ea?ea:Number.MAX_VALUE);return ga!==Number.MAX_VALUE?ga:fa;},_getStoryDedupKeysJSONString:function(da,ea){var fa=[];for(var ga=da;ga<=ea;ga++)fa.push(x[ga].dedupKey);return JSON.stringify(fa);},_getIdxOfStoryToSwap:function(da,ea){if(ea>=x.length-da)return -1;for(var fa=da+1;fa<x.length&&ea>0;fa++){if(!x[fa].isSponsored){ea--;}else return -1;if(ea===0)return fa;}return -1;},_checkGapRuleViolation:function(da){var ea=null,fa=null,ga=0;for(var ha=0;ha<x.length;ha++){var ia=x[ha];ga+=ia.height;if(ia.isSponsored){ga-=ia.height;var ja=false,ka=false;if(ea!==null){var la=ha-ea,ma=null,na=this._getMinGap(ba[fa.dedupKey],ba[ia.dedupKey],da.defaultMinGap);if(la<na){ma=r;}else ma=s;var oa={ftArray_A:fa.dataFTArray,ftArray_B:ia.dataFTArray,dist:la,pdist:ga,pos:ha+1,qid_A:fa.qid,qid_B:ia.qid,event_type:ma,nodeid:ia.nodeID,dedupKeys:this._getStoryDedupKeysJSONString(ea,ha)};if(da.isLoggingEnabled)if(!(ia.dedupKey in y)||y[ia.dedupKey].event_type!==ma){this._logAdsGapEvent(oa);y[ia.dedupKey]=oa;}if(da.isGapRuleInvalidationEnabled&&ma==r){var pa=-1;if(da.isSwapOnGapRuleViolationEnabled)pa=this._getIdxOfStoryToSwap(ha,na-la);if(pa>0){this._shiftAdBelowOrganicStory(ia.nodeID,x[pa].nodeID);var qa=x[ha];x.splice(ha,1);x.splice(pa,0,qa);if(da.isLoggingEnabled){var ra={ft:x[pa].dataFTArray[0],dist:pa-ha,qid:x[pa].qid,event_type:'ad_swap'};h.post('feed_ads_gap_rule_violation',ra);}ka=true;ia=x[ha];ga+=ia.height;}else if(da.isGapRuleInvalidationEnabled){this._invalidateGapRuleViolatedAd(oa);ja=true;x.splice(ha--,1);}}}if(!ja&&!ka){ea=ha;fa=ia;ga=0;}}}},_logFirstPosViolation:function(da){var ea={ft:da.ftArray[0],event_type:t,intValues:{qid:da.qid},first_story_type:da.firstStoryType};if(da.error_msg)ea.error_msg=da.error_msg;h.post('feed_ads_gap_rule_violation',ea);},_logAdsGapEvent:function(da){var ea={ft_A:da.ftArray_A[0],ft_B:da.ftArray_B[0],event_type:da.event_type,intValues:{dist:da.dist,pdist:da.pdist,pos:da.pos,qid_A:da.qid_A,qid_B:da.qid_B},dedup_keys:da.dedupKeys};h.post('feed_ads_gap_rule_violation',ea);},_logFeedLoad:function(){var da={event_type:u};h.post('feed_ads_gap_rule_violation',da);},_invalidateFirstPosAd:function(da){i.hide(m(da.nodeid));var ea={ft_array:da.ftArray,event_type:v};h.post('feed_ads_gap_rule_violation',ea);},_invalidateGapRuleViolatedAd:function(da){var ea=m(da.nodeid);ea&&i.hide(ea);var fa={ft_array_A:da.ftArray_A,ft_array_B:da.ftArray_B,event_type:w};h.post('feed_ads_gap_rule_violation',fa);},_shiftAdBelowOrganicStory:function(da,ea){var fa=m(da),ga=m(ea);fa&&ga&&l.insertAfter(ga,fa);}};f.exports=ca;},null);
__d('StoryPositionTracking',['DOM','LitestandStream','csx','ge'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=0;function m(p,q){var r=JSON.parse(p.getAttribute('data-ft'));if(r){r.insertion_position=q;p.setAttribute('data-ft',JSON.stringify(r));}}function n(p){return h.scry(p,"._5jmm");}var o={registerNewStories:function(p){if(p=='substream_0')l=0;var q=n(k(p)),r=q.length;for(var s=0;s<r;s++)m(q[s],l++);},updateAllStories:function(){var p=n(i.getStreamRoot()),q=p.length;l=0;for(var r=0;r<q;r++)m(p[r],l++);}};f.exports=o;},null);
__d('StreamViewportTracking',['DOM','DOMDimensions','ViewportTracking','ge','recordTNTreeData'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m,n,o=51;m=j;n=m&&m.prototype;Object.assign(p,m);p.prototype=Object.create(m.prototype);p.prototype.constructor=p;p.__superConstructor__=m;p.prototype.init=function(q,r){'use strict';if(r)this.$StreamViewportTracking1=r;n.init.call(this,q);this.initSubscriptions();};p.prototype.initSubscriptions=function(){'use strict';};p.prototype.getDataFromConfig=function(q){'use strict';this.isTimetrackingEnabled=1;this.timeout=q.record_delay;};p.prototype.getTimeout=function(){'use strict';return this.timeout;};p.prototype.getStorySelector=function(){'use strict';return '.uiStreamStory';};p.prototype.getAllStories=function(){'use strict';var q=h.scry(this.getStream(),this.getStorySelector());return q.filter(function(r){return r.getAttribute('data-ft');});};p.prototype.getStoryID=function(q){'use strict';var r=JSON.parse(q.getAttribute('data-ft'));return r.mf_story_key;};p.prototype.getQueryID=function(q){'use strict';var r=JSON.parse(q.getAttribute('data-ft'));return r.qid;};p.prototype.getFBFeedLocations=function(q){'use strict';var r=JSON.parse(q.getAttribute('data-ft'));return r.fbfeed_location;};p.prototype.getFBFeedInsertionPosition=function(q){'use strict';var r=JSON.parse(q.getAttribute('data-ft'));return r.insertion_position;};p.prototype.getDataToLog=function(q){'use strict';var r={},s=this.getStream();r=l(q,s);var t=q.getAttribute('data-insertion-position');if(t!==null)r.inspos=t;r.evt=o;r.vpv_time=Math.round(Date.now()/1000);var u=h.scry(q,".fbStoryAttachmentImage")[0];if(u){var v=i.getElementDimensions(u);r.story_image_height=v.height;r.story_image_width=v.width;}return {ft:r};};p.prototype.getStream=function(){'use strict';if(this.$StreamViewportTracking1)return this.$StreamViewportTracking1;return k('home_stream');};p.prototype.heartBeatIsEnabled=function(){'use strict';return true;};p.init=function(q,r){'use strict';p.instance=new p();p.instance.init(q,r);};p.getInstance=function(){'use strict';return p.instance;};function p(){'use strict';m.apply(this,arguments);}f.exports=p;},null);
__d('FbFeedAttachmentRelatedShare',['Arbiter','AttachmentRelatedShareConstants','DOMQuery','Event','tidyEvent','csx'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n={loadRelatedAttachment:function(o,p){l(k.listen(o,'click',function(){h.inform(i.ARTICLE_CLICK,{attachment:o,global_share_id:p});}));},loadRelatedGameAttachment:function(o,p){l(k.listen(o,'click',function(){h.inform(i.GAME_CLICK,{attachment:o,global_share_id:p});}));},loadRelatedAttachmentForStream:function(o){var p=function(event,q){var r=event.getTarget();if(r.getAttribute('target')!=='_blank')return;var s="^div._5pbx",t="^div._5pc9",u=j.scry(r,s)[0]||j.scry(r,t)[0];if(!u)return;h.inform(i.ARTICLE_CLICK,{attachment:u,global_share_id:0,link_url:r.getAttribute('href'),is_right_click:q});};l(k.listen(o,'click',function(event){p(event,false);}));l(k.listen(o,'mousedown',function(event){if(event.which==3||event.button==2)p(event,true);}));}};f.exports=n;},null);
__d('FbFeedViewportTracking',['Arbiter','LitestandMessages','LitestandStream','StreamViewportTracking','csx'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m,n;m=k;n=m&&m.prototype;Object.assign(o,m);o.prototype=Object.create(m.prototype);o.prototype.constructor=o;o.__superConstructor__=m;o.prototype.initSubscriptions=function(){'use strict';this.subscriptions.addSubscriptions(h.subscribe([i.STORIES_INSERTED],this.invalidateAllStoriesCache.bind(this)),h.subscribe(i.LEAVE_HOME,this.updateTimeTrackingData.bind(this,true)));};o.prototype.getStorySelector=function(){'use strict';return "._5jmm";};o.prototype.getStream=function(){'use strict';return j.getStreamRoot();};o.prototype.getSessionID=function(){'use strict';return j.getFeedStreamID();};o.init=function(p){'use strict';o.instance=new o();o.instance.init(p);};o.getInstance=function(){'use strict';return o.instance;};function o(){'use strict';m.apply(this,arguments);}f.exports=o;},null);