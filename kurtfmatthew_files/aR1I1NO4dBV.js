/*!CK:1659749707!*//*1439790638,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["EzoWu"]); }

__d('P2PConfirmationDialog.react',['CurrentEnvironment','LayerFadeOnHide','LeftRight.react','P2PButton.react','P2PDialog.react','P2PDialogBody.react','P2PDialogFooter.react','P2PText.react','P2PDialogTitle.react','React','cx','emptyFunction','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){if(c.__markCompiled)c.__markCompiled();'use strict';var u=Object.assign||function(x){for(var y=1;y<arguments.length;y++){var z=arguments[y];for(var aa in z)if(Object.prototype.hasOwnProperty.call(z,aa))x[aa]=z[aa];}return x;},v=q.PropTypes,w=q.createClass({displayName:'P2PConfirmationDialog',propTypes:{allowBack:v.bool,buttonLabel:v.node.isRequired,buttonUse:v.string.isRequired,centered:v.bool,image:v.object.isRequired,onBackClick:v.func,onOKClick:v.func,onSecondaryClick:v.func,showCloseButton:v.bool,showSecondaryButton:v.bool,secondaryButtonLabel:v.node,secondaryButtonUse:v.string,title:v.string.isRequired},getDefaultProps:function(){return {buttonLabel:t._("OK"),buttonUse:'default',centered:false,onBackClick:s,onSecondaryClick:s,showCloseButton:false,showSecondaryButton:false,onOKClick:s,width:h.messengerdotcom?350:300};},getBackButton:function(){if(!this.props.allowBack)return null;return (q.createElement(k,{label:t._("Back"),onClick:this.props.onBackClick,use:'default'}));},getSecondaryButton:function(){if(!this.props.showSecondaryButton)return null;return (q.createElement(k,{label:this.props.secondaryButtonLabel,onClick:this.props.onSecondaryClick,use:this.props.secondaryButtonUse}));},render:function(){var x=h.messengerdotcom,y=[q.createElement('div',{className:"_465t",key:'confirmation_icon'},this.props.image),q.createElement(o,{className:"_465u"+(this.props.centered?' '+"_465v":''),key:'confirmation_text',type:'primary'},this.props.children)];if(x)y=q.createElement(j,{direction:'left'},y);return (q.createElement(l,{behaviors:u({LayerFadeOnShow:false,LayerFadeOnHide:i},this.props.behaviors),className:"_465w"+(x?' '+"_465x":''),layerHideOnBlur:false,ref:'dialog',repositionOnUpdate:true,shown:true,width:this.props.width},q.createElement('div',{className:"_465y"},q.createElement(p,{className:"_465z",showCloseButton:this.props.showCloseButton},this.props.title),q.createElement(m,null,y),q.createElement(n,null,this.getBackButton(),this.getSecondaryButton(),q.createElement(k,{label:this.props.buttonLabel,onClick:this.props.onOKClick,use:this.props.buttonUse})))));}});f.exports=w;},null);
__d('P2PSuccessDialog.react',['CurrentEnvironment','Image.react','LayerSlowlyFadeOnShow','P2PConfirmationDialog.react','React','emptyFunction','fbt','ix'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();'use strict';var p=Object.assign||function(s){for(var t=1;t<arguments.length;t++){var u=arguments[t];for(var v in u)if(Object.prototype.hasOwnProperty.call(u,v))s[v]=u[v];}return s;},q=l.PropTypes,r=l.createClass({displayName:'P2PSuccessDialog',propTypes:{buttonLabel:q.node,buttonUse:q.string,onOKClick:q.func,onSecondaryClick:q.func,showCloseButton:q.bool,showSecondaryButton:q.bool,secondaryButtonLabel:q.node,secondaryButtonUse:q.string,title:q.string.isRequired},getDefaultProps:function(){return {allowBack:false,buttonLabel:n._("OK"),buttonUse:'default',onOKClick:m,showCloseButton:false,width:h.messengerdotcom?350:300};},getImage:function(){if(h.messengerdotcom){return (l.createElement(i,{height:62,width:62,src:o('/images/p2p/checkmark-messenger.png')}));}else return (l.createElement(i,{height:56,width:56,src:o('/images/p2p/check_mark-sm.png')}));},render:function(){var s=this.getImage();return (l.createElement(k,{behaviors:p({LayerSlowlyFadeOnShow:j},this.props.behaviors),allowBack:this.props.allowBack,buttonLabel:this.props.buttonLabel,buttonUse:this.props.buttonUse,centered:this.props.centered,image:s,onOKClick:this.props.onOKClick,onSecondaryClick:this.props.onSecondaryClick,showCloseButton:this.props.showCloseButton,showSecondaryButton:this.props.showSecondaryButton,secondaryButtonLabel:this.props.secondaryButtonLabel,secondaryButtonUse:this.props.secondaryButtonUse,title:this.props.title,width:this.props.width},this.props.children));}});f.exports=r;},null);
__d('P2PAddCardForIncentivesSuccessDialog.react',['React','P2PSuccessDialog.react','P2PText.react','XUIText.react','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();'use strict';var n=h.PropTypes,o=h.createClass({displayName:'P2PAddCardForIncentivesSuccessDialog',propTypes:{amount:n.string.isRequired,onClose:n.func.isRequired,onOKClick:n.func.isRequired},renderBoldAmountText:function(){return (h.createElement(k,{weight:'bold'},m._("We sent {Amount user will receive} to your bank account.",[m.param('Amount user will receive',this.props.amount)])));},render:function(){return (h.createElement(i,{buttonLabel:m._("Send to a Friend"),buttonUse:'confirm',onOKClick:this.props.onOKClick,onSecondaryClick:this.props.onClose,showCloseButton:true,showSecondaryButton:true,secondaryButtonLabel:m._("Keep It"),title:'Card Added'},h.createElement(j,{type:'primary'},m._("{Reminder we sent money to the user's bank account} Your bank might take 2-3 days to make it available.",[m.param('Reminder we sent money to the user\'s bank account',this.renderBoldAmountText())])),h.createElement(j,{className:"_j_9",type:'primary'},m._("What will you do with your {Amount user will receive}?",[m.param('Amount user will receive',this.props.amount)]))));}});f.exports=o;},null);
__d('P2PCreditCardExpDateFormField.react',['React','P2PCreditCardFormFieldMixin.react','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();'use strict';var l=h.createClass({displayName:'P2PCreditCardExpDateFormField',mixins:[i],getIcon:function(){return (h.createElement('div',{className:"_31_w _31_x"}));},getAutocompleteName:function(){return 'cc-exp';},isValAtLimit:function(){var m=this.state.value;return m.length===this.getLimit();},getLimit:function(){return 5;},getPlaceholder:function(){return k._("MM\/YY");},formatValue:function(m,n,o){var p=this.getLimit(),q=String.fromCharCode(o);m=m.replace(/[^0-9\/]+/g,'');var r=m.split('/'),s=r[0],t=r[1];if(t&&t.length===4){m=s+'/'+t.substr(-2);}else m=m.slice(0,p);if(!/^\d+$/.test(q)&&o!==191&&o!==111)return m;m=m.replace(/\D/g,'');if(/^\d$/.test(m)&&(m!=='0'&&m!=='1')){m='0'+m+'/';}else if(m.length>=2&&m.indexOf('/')===-1)m=m.substr(0,2)+'/'+m.substr(2,4);return m;},validate:function(m){var n=m.split('/'),o=new Date(),p=parseInt(o.getFullYear().toString().substring(2),10),q=parseInt(o.getMonth()+1,10),r=parseInt(n[0],10),s=parseInt(n[1],10);if(m.length!==5||!r||!s||isNaN(r)||isNaN(s)||r<1||r>12)return false;if(s<p||s===p&&r<q||r>12||r<1)return false;return true;}});f.exports=l;},null);
__d('P2PCreditCardNumberFormFieldHelper',['Keys'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();'use strict';var i={formatCardNumber:function(j,k,l,m,n){if(l===h.BACKSPACE||l===h.DELETE){var o=k.split(n).length-1,p=j.split(n).length-1;if(p!==o)return j;}j=j.replace(/\D/g,'');j=j.substr(0,m[m.length-1]);var q='';for(var r=1;r<m.length;r++){if(m[r]>j.length||r===m.length-1){q+=j.slice(m[r-1]);break;}q+=j.slice(m[r-1],m[r])+n;}return q;},getUpdatedCursorPosition:function(j,k,l,m){var n=0,o=0;while(n<l&&n<k.length&&o<j.length)if(k[n]===j[o]){n++;o++;}else if(!/^\d+$/.test(k[n])){n++;}else o++;if(j.substr(o,1)===m)o++;return o;}};f.exports=i;},null);
__d('P2PCreditCardNumberFormField.react',['MessengerPaymentProductType','P2PCreditCardFormFieldMixin.react','P2PCreditCardNumberFormFieldHelper','PaymentMethodUtils','React','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();'use strict';var o=l.createClass({displayName:'P2PCreditCardFormField',mixins:[i],getIcon:function(){return (l.createElement('div',{className:"_31_w _3_2h"}));},getAutocompleteName:function(){return 'cc-number';},isValAtLimit:function(){var p=this.state.value.replace(/ /g,'');return p.length===k.getCardType(p).digits;},formatValue:function(p,q,r){var s,t=[0,4,8,12,16];switch(k.getCardType(p).name){case 'visa':case 'mc':case 'disc':s=t;break;case 'amex':s=[0,4,10,15];break;case 'diners':s=[0,4,10,14];break;default:s=t;break;}return j.formatCardNumber(p,q,r,s,' ');},getUpdatedCursorPosition:function(p,q,r){return j.getUpdatedCursorPosition(p,q,r,' ');},getPlaceholder:function(){return n._("Card Number");},validate:function(p){var q=this.isValidCardType(p),r;if(this.props.productType===h.P2P){r=n._("Please enter a debit card. Credit cards can't be used.");}else r=n._("Please enter a valid debit or credit card number.");this.setState({errorMessage:!q?r:null});return !!(k.isValidCCNumber(p)&&q);},isValidCardType:function(p){var q=['mc','visa','unknown'];if(this.props.productType===h.MESSENGER_COMMERCE)q.push('diners','disc','jcb','amex');var r=k.getCardType(p),s=r?r.name:'',t=q.indexOf(s)>=0;return t;}});f.exports=o;},null);
__d('P2PErrorDialog.react',['CurrentEnvironment','Image.react','P2PConfirmationDialog.react','P2PText.react','React','emptyFunction','fbt','ix'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p=Object.assign||function(s){for(var t=1;t<arguments.length;t++){var u=arguments[t];for(var v in u)if(Object.prototype.hasOwnProperty.call(u,v))s[v]=u[v];}return s;},q=l.PropTypes,r=l.createClass({displayName:'P2PErrorDialog',propTypes:{allowBack:q.bool,onBackClick:q.func,onOKClick:q.func,error:q.object,title:q.string},getDefaultProps:function(){return {allowBack:false,onBackClick:m,onOKClick:m,error:null,title:n._("Problem")};},renderErrorContent:function(){var s=this.props.error;if(s.message.__html){return (l.createElement(k,{dangerouslySetInnerHTML:s.message,type:'primary'}));}else return l.createElement(k,{type:'primary'},s.message);},getImage:function(){if(h.messengerdotcom){return (l.createElement(i,{height:62,width:62,src:o('/images/p2p/confirmation-error-messengerdotcom.png')}));}else return (l.createElement(i,{height:55,width:55,src:o('/images/p2p/confirmation-error.png')}));},render:function(){var s=this.getImage();return (l.createElement(j,{allowBack:this.props.allowBack,behaviors:p({},this.props.behaviors),centered:this.props.centered,image:s,onBackClick:this.props.onBackClick,onOKClick:this.props.onOKClick,title:this.props.title,width:this.props.width},this.renderErrorContent()));}});f.exports=r;},null);
__d('P2PCreditCardForm.react',['CreditCardFormParam','KappaWrapper','MessengerPaymentProductType','P2PAPI','P2PAPIUtils','P2PCreditCardCVCFormField.react','P2PCreditCardExpDateFormField.react','P2PCreditCardNumberFormField.react','P2PCreditCardZipCodeFormField.react','P2PErrorDialog.react','P2PErrorNotice.react','React','ReactLayeredComponentMixin','cx','emptyFunction','fbt','getObjectValues'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){if(c.__markCompiled)c.__markCompiled();'use strict';var y=s.PropTypes,z=s.createClass({displayName:'P2PCreditCardForm',mixins:[t],propTypes:{asyncRequestState:y.object,cscMaxLength:y.number,editMode:y.bool,onErrorDialogOKClick:y.func,onValidation:y.func,prefilledFormData:y.object,productType:y.oneOf(x(j)),rendersErrorDialog:y.bool,saveErrors:y.object},getDefaultProps:function(){return {cscMaxLength:null,editMode:false,onErrorDialogOKClick:v,onValidation:v,prefilledFormData:{},productType:j.P2P,rendersErrorDialog:false,saveErrors:null};},getInitialState:function(){var aa={};aa[h.CARD_NUMBER]={};aa[h.CARD_NUMBER].valid=false;aa[h.CARD_NUMBER].value=this.props.prefilledFormData[h.CARD_NUMBER]||'';aa[h.CARD_EXPIRATION]={};aa[h.CARD_EXPIRATION].valid=false;aa[h.CARD_EXPIRATION].value=this.props.prefilledFormData[h.CARD_EXPIRATION]||'';aa[h.CSC]={};aa[h.CSC].valid=false;aa[h.CSC].value=this.props.prefilledFormData[h.CSC]||'';aa[h.ZIP]={};aa[h.ZIP].valid=false;aa[h.ZIP].value=this.props.prefilledFormData[h.ZIP]||'';return {binError:'',isValid:false,fields:aa,previousBINNumber:'',validateBINRequestID:''};},componentWillMount:function(){i.start(6,3,0);},componentWillReceiveProps:function(aa){var ba=aa.asyncRequestState,ca=ba?ba[this.state.validateBINRequestID]:null;if(ca){this.setState({validateBINRequestID:''});if(ca.error){this.handleValidateBINNumberError(ca.error);}else this.handleValidateBINNumberSuccess();}},handleValidateBINNumberSuccess:function(){this.setState({binError:''},this.validateForm);},handleValidateBINNumberError:function(aa){this.setState({binError:aa.message},this.validateForm);},handleCreditCardNumberChange:function(aa,ba,ca){if(this.props.productType===j.P2P)this.validateBIN(ba);this.handleFormValueChange(aa,ba,ca);},validateBIN:function(aa){var ba,ca;aa=aa.replace(/ /g,'');ba=aa.substr(0,6);if(ba!==this.state.previousBINNumber&&ba.length>=6){ca=l.genRequestID();this.setState({validateBINRequestID:ca});k.validateBINNumber({binNumber:ba,requestID:ca});}else if(ba.length<6)this.setState({binError:'',validateBINRequestID:''});this.setState({previousBINNumber:ba});},handleFormValueChange:function(aa,ba,ca){var da=this.state.fields;da[aa]={valid:ca,value:ba};this.validateForm();},validateForm:function(){var aa=true,ba=this.state.fields;aa=!x(ba).some(function(ca){return !ca.valid;})&&!this.state.binError;this.setState({isValid:aa});this.props.onValidation(aa,this.serializeFormFields(),this.getFormFieldLoggingData());},serializeFormFields:function(){var aa=this.state.fields,ba={};for(var ca in aa)if(aa.hasOwnProperty(ca))ba[ca]=aa[ca].value;return ba;},getFormFieldLoggingData:function(){var aa=this.state.fields,ba=aa[h.CARD_NUMBER],ca=aa[h.CARD_EXPIRATION],da=aa[h.CSC],ea=aa[h.ZIP],fa={card_number_digits:ba.value.replace(/ /g,'').length,is_card_number_valid:ba.valid,expiration_date_digits:ca.value.replace(/\//,'').length,is_expiration_date_valid:ca.valid,csc_digits:da.value.length,is_csc_valid:da.valid,billing_zip_digits:ea.value.length,is_billing_zip_valid:ea.valid};return {credit_card_validation_data:fa};},getSaveError:function(aa){var ba='',ca=this.props.saveErrors;if(ca&&ca.fields&&ca.fields[aa])ba=ca.fields[aa].message;return ba;},isCreditCardNumberMasked:function(){return this.props.editMode;},isCreditCardNumberFocused:function(){return !this.props.editMode;},isExpFocused:function(){return this.props.editMode;},renderBINError:function(){if(!this.state.binError)return;return (s.createElement(r,{error:{message:this.state.binError}}));},renderGeneralError:function(){var aa=this.getGeneralError();if(!aa)return;return (s.createElement(r,{error:aa}));},getGeneralError:function(){if(this.props.saveErrors&&this.props.saveErrors.general)return this.props.saveErrors.general;return null;},handleErrorOKClick:function(){this.props.onErrorDialogOKClick();},renderLayers:function(){var aa=this.getGeneralError();if(!this.props.rendersErrorDialog||!aa)return {};return {errorMessageDialog:s.createElement(q,{error:aa,onOKClick:this.handleErrorOKClick,title:w._("Problem Saving Card")})};},render:function(){return (s.createElement('form',{className:"_3bez"},!this.props.rendersErrorDialog?this.renderGeneralError():null,this.renderBINError(),s.createElement('div',{className:"_2xxs _2xxt"},s.createElement(o,{reference:h.CARD_NUMBER,onChange:this.handleCreditCardNumberChange,saveError:this.getSaveError(h.CARD_NUMBER)||this.state.binError,value:this.state.fields[h.CARD_NUMBER].value,isMasked:this.isCreditCardNumberMasked(),focused:this.isCreditCardNumberFocused(),productType:this.props.productType})),s.createElement('div',{className:"_2xxs _2xxu"},s.createElement(n,{reference:h.CARD_EXPIRATION,focused:this.isExpFocused(),onChange:this.handleFormValueChange,saveError:this.getSaveError(h.CARD_EXPIRATION),value:this.state.fields[h.CARD_EXPIRATION].value}),s.createElement(m,{reference:h.CSC,onChange:this.handleFormValueChange,saveError:this.getSaveError(h.CSC),cscMaxLength:this.props.cscMaxLength,creditCardNumber:this.state.fields[h.CARD_NUMBER].value,value:this.state.fields[h.CSC].value})),s.createElement('div',{className:"_2xxs _2xxv"},s.createElement(p,{reference:h.ZIP,onChange:this.handleFormValueChange,saveError:this.getSaveError(h.ZIP),value:this.state.fields[h.ZIP].value}))));}});f.exports=z;},null);
__d('P2PAddCreditCardDialog.react',['CurrentEnvironment','Link.react','MessengerPaymentProductType','P2PAPI','P2PAPIUtils','P2PCreditCardStore','P2PCreditCardForm.react','P2PLoadingMask.react','P2PLogger','P2PPaymentLoggerEvent','P2PLinkConstants','React','P2PButton.react','P2PDialog.react','P2PDialogTitle.react','P2PDialogBody.react','P2PDialogFooter.react','P2PText.react','cx','emptyFunction','fbt','getObjectValues'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca){if(c.__markCompiled)c.__markCompiled();'use strict';var da=Object.assign||function(ha){for(var ia=1;ia<arguments.length;ia++){var ja=arguments[ia];for(var ka in ja)if(Object.prototype.hasOwnProperty.call(ja,ka))ha[ka]=ja[ka];}return ha;},ea=s.PropTypes,fa='fbP2PAddCreditCardDialog_learnMoreSentenceID',ga=s.createClass({displayName:'P2PAddCreditCardDialog',propTypes:{cancelButtonText:ea.string,eventFlow:ea.string.isRequired,loggingData:ea.object,loggingObjectID:ea.string,onCancel:ea.func,onSuccess:ea.func,productType:ea.oneOf(ca(j)),saveButtonText:ea.string,showCancelButton:ea.bool,text:ea.string,title:ea.string},getDefaultProps:function(){return {cancelButtonText:ba._("Cancel"),loggingData:{},onCancel:aa,onSuccess:aa,productType:j.P2P,saveButtonText:ba._("Save"),showCancelButton:true,text:ba._("Please enter a debit card. Credit cards can't be used."),title:ba._("Add Debit Card"),width:h.messengerdotcom?350:288};},getInitialState:function(){return {isValid:false,formData:{},formFieldLoggingData:{},loading:false,requestID:'',saveErrors:null};},onCreditCardStoreChange:function(){var ha=m.getAsyncRequestState(),ia=ha[this.state.requestID];this.setState({asyncRequestState:ha});if(ia){this.setState({requestID:''});if(ia.error){this.handleOnSaveError(ia.error);}else this.handleOnSaveSuccess(ia);}},componentDidMount:function(){this.log(q.UI_ACTN_INITIATE_ADD_CARD);this.creditCardStoreSub=m.addListener('change',this.onCreditCardStoreChange);},componentWillUnmount:function(){if(this.creditCardStoreSub){this.creditCardStoreSub.remove();this.creditCardStoreSub=null;}},log:function(ha,ia){p.log(ha,da({www_event_flow:this.props.eventFlow,object_id:this.props.loggingObjectID},this.props.loggingData,ia));},onSaveClick:function(){var ha=l.genRequestID();this.setState({loading:true,requestID:ha,saveErrors:null});this.log(q.UI_ACTN_CONFIRM_CARD_DETAILS);k.addCreditCard(da({requestID:ha,product_type:this.props.productType},this.state.formData));},handleOnSaveSuccess:function(ha){this.props.onSuccess(ha);this.log(q.UI_ACTN_ADD_CARD_SUCCESS);},handleOnSaveError:function(ha){this.setState({loading:false,saveErrors:ha});this.log(q.UI_ACTN_ADD_CARD_FAIL,{message:ha&&ha.general?ha.general.message:''});},handleValidation:function(ha,ia,ja){this.setState({isValid:ha,formData:ia,formFieldLoggingData:ja});},isSaveButtonDisabled:function(){return this.state.loading||!this.state.isValid;},onToggle:function(ha){if(!ha){this.props.onCancel();this.log(q.UI_ACTN_CANCEL_ADD_CARD,this.state.formFieldLoggingData);}},onCancelClicked:function(){this.onToggle(false);},renderAddCardForm:function(){var ha,ia=this.props.title;if(this.props.showCancelButton)ha=s.createElement(t,{use:'default',size:'medium',label:this.props.cancelButtonText,disabled:this.state.loading,onClick:this.onCancelClicked});return (s.createElement('div',null,s.createElement(v,null,ia),s.createElement(w,null,s.createElement(y,{type:'primary',className:"_3-96"},this.props.text),s.createElement(n,{asyncRequestState:this.state.asyncRequestState,onValidation:this.handleValidation,saveErrors:this.state.saveErrors,productType:this.props.productType}),s.createElement(y,{className:"_3-8y",id:fa,type:'secondary'},ba._("Your payment info is stored securely."),s.createElement('div',null,s.createElement(i,{'aria-describedby':fa,href:r.addDebitCardHelpURI,target:'_blank'},ba._("Learn More"))))),s.createElement(x,{leftContent:this.props.leftContent},ha,s.createElement(t,{use:'confirm',size:'medium',label:this.props.saveButtonText,disabled:this.isSaveButtonDisabled(),onClick:this.onSaveClick}))));},render:function(){return (s.createElement(u,{behaviors:this.props.behaviors,layerHideOnBlur:false,ref:'dialog',onToggle:this.onToggle,repositionOnUpdate:true,shown:true,width:this.props.width},this.renderAddCardForm(),s.createElement(o,{visible:this.state.loading})));}});f.exports=ga;},null);
__d('P2PFriendsListStore',['P2PActionConstants','EventEmitter','P2PAPI','P2PDispatcher'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l,m;'use strict';var n=[],o,p,q=100;l=i;m=l&&l.prototype;Object.assign(r,l);r.prototype=Object.create(l.prototype);r.prototype.constructor=r;r.__superConstructor__=l;function r(){m.constructor.call(this);p=false;o=k.register(this.onEventDispatched.bind(this));}r.prototype.onEventDispatched=function(s){var t=s.data,u=s.type;switch(u){case h.FRIENDS_LIST_UPDATED:this.handleFriendsListUpdated(t);this.emit('change');break;}};r.prototype.handleFriendsListUpdated=function(s){n=s;};r.prototype.getAllFriends=function(){if(!p){p=true;this.fetchFriends();}return n;};r.prototype.searchFriends=function(s){this.fetchFriends(s);};r.prototype.fetchFriends=function(s){j.getFriendsList(q,s);};f.exports=new r();},null);
__d('P2PFriendPickerDialog.react',['debounce','Image.react','MercuryIDs','P2PActions','P2PDialog.react','P2PDialogBody.react','P2PDialogTitle.react','P2PFriendsListStore','P2PLoadingMask.react','P2PLogger','P2PPaymentLoggerEvent','P2PText.react','React','ScrollableArea.react','XUITextInput.react','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){if(c.__markCompiled)c.__markCompiled();'use strict';var y=Object.assign||function(ba){for(var ca=1;ca<arguments.length;ca++){var da=arguments[ca];for(var ea in da)if(Object.prototype.hasOwnProperty.call(da,ea))ba[ea]=da[ea];}return ba;},z=t.PropTypes,aa=t.createClass({displayName:'P2PFriendPickerDialog',propTypes:{amount:z.string,eventFlow:z.string.isRequired,onClose:z.func.isRequired,subTitle:z.node.isRequired,title:z.node.isRequired},getDefaultProps:function(){return {amount:'',title:x._("Select Friend"),subTitle:x._("These are your friends who are able to receive money.")};},getInitialState:function(){return {friends:o.getAllFriends(),showLoader:true};},log:function(ba,ca){q.log(ba,y({www_event_flow:this.props.eventFlow},ca));},loggedSearch:null,friendPickerStoreSub:null,componentDidMount:function(){this.friendPickerStoreSub=o.addListener('change',this.updateFriendsList);},componentWillUnmount:function(){if(this.friendPickerStoreSub){this.friendPickerStoreSub.remove();this.friendPickerStoreSub=null;}},updateFriendsList:function(){this.setState({friends:o.getAllFriends(),showLoader:false});},onFriendSelect:function(ba){this.log(r.UI_ACTN_FRIEND_PICKER_SELECT,{object_id:ba.id});k.chatSendViewOpened({amount:this.props.amount,threadID:j.getThreadIDFromUserID(ba.id)});this.props.onClose();},getQuery:function(){return (this.refs.input_ref&&this.refs.input_ref.refs.textInput.refs.textField.value);},handleToggle:function(ba){if(!ba)this.props.onClose();},onSearchInputChange:function(){if(!this.loggedSearch){this.log(r.UI_ACTN_FRIEND_PICKER_SEARCH);this.loggedSearch=true;}var ba=this.getQuery();if(!ba)this.setState({showLoader:true});o.searchFriends(ba);},renderTagLineRow:function(){if(this.state.showLoader)return null;return (t.createElement('li',{className:"_4ro"},t.createElement('div',{className:"_4ia_"},this.props.subTitle)));},renderfriendRow:function(ba){return (t.createElement('li',{className:"_4iat",key:ba.id,onClick:this.onFriendSelect.bind(this,ba)},t.createElement('div',{className:"_4iau"},t.createElement(i,{className:"_4iav",height:50,src:ba.image_src,width:50})),t.createElement('div',{className:"_4iaw"},t.createElement(s,{className:"_4iax",type:'primary'},ba.full_name))));},renderFriendList:function(){var ba=this.getQuery();if(!this.state.showLoader&&this.state.friends.length===0)if(ba&&ba.length){return (t.createElement('div',{className:"_4iay"},x._("No results.")));}else return (t.createElement('div',{className:"_4iay"},x._("You do not have any friends who are able to receive money.")));return (t.createElement('div',{className:"_4iaz"},t.createElement(p,{visible:this.state.showLoader}),t.createElement(u,{height:350},t.createElement('ul',null,this.state.friends.map(this.renderfriendRow),this.renderTagLineRow()))));},render:function(){return (t.createElement(l,{onToggle:this.handleToggle,width:445},t.createElement(n,null,t.createElement('div',{className:"_4ia-"},this.props.title)),t.createElement(m,{className:"_4ib0"},t.createElement('div',{className:"_3ybc"},t.createElement(v,{className:"_4ib1",onChange:h(this.onSearchInputChange,150),placeholder:'Search friends',ref:'input_ref'})),this.renderFriendList())));}});f.exports=aa;},null);
__d('P2PPasswordProtectionNUXDialog.react',['CurrentEnvironment','Link.react','P2PAPI','P2PErrorDialog.react','P2PLinkConstants','P2PLoadingMask.react','P2PLogger','P2PPaymentLoggerEvent','P2PPaymentLoggerEventFlow','P2PPasswordProtectionParam','P2PPasswordProtectionStatusTypes','React','P2PButton.react','P2PDialog.react','P2PDialogTitle.react','P2PDialogBody.react','P2PDialogFooter.react','P2PText.react','cx','emptyFunction','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba){if(c.__markCompiled)c.__markCompiled();'use strict';var ca=Object.assign||function(fa){for(var ga=1;ga<arguments.length;ga++){var ha=arguments[ga];for(var ia in ha)if(Object.prototype.hasOwnProperty.call(ha,ia))fa[ia]=ha[ia];}return fa;},da=s.PropTypes,ea=s.createClass({displayName:'P2PPasswordProtectionNUXDialog',propTypes:{onComplete:da.func},getDefaultProps:function(){return {onComplete:aa,width:h.messengerdotcom?320:300};},getInitialState:function(){return {saveErrorObject:null,loading:false};},componentWillMount:function(){this.log(o.UI_ACTN_INITIATE_PASSWORD_PROTECTION_NUX);},log:function(fa,ga){n.log(fa,ca({www_event_flow:p.UI_FLOW_P2P_SETTINGS},ga));},onSaveClick:function(){this.setState({loading:true,saveErrorObject:null});this.setPasswordProtection(r.ENABLED);this.log(o.UI_ACTN_OPT_IN_PASSWORD_PROTECTION_NUX);},setPasswordProtection:function(fa){var ga={};ga[q.STATUS]=fa;j.setPasswordProtectionSetting({formData:ga,success:this.handleOnSaveSuccess,error:this.handleOnSaveError});},handleOnSaveSuccess:function(){this.setState({loading:false});this.props.onComplete();},handleOnSaveError:function(fa){this.setState({loading:false,saveErrorObject:fa});},isSaveButtonDisabled:function(){return this.state.loading;},isCancelButtonDisabled:function(){return this.state.loading;},onCancelClick:function(){this.setState({loading:true,saveErrorObject:null});this.setPasswordProtection(r.DISABLED);this.log(o.UI_ACTN_OPT_OUT_PASSWORD_PROTECTION_NUX);},handleErrorBackClick:function(){this.setState({saveErrorObject:null});},handleErrorOKClick:function(){this.setState({saveErrorObject:null});this.props.onComplete();},render:function(){if(this.state.saveErrorObject)return (s.createElement(k,{allowBack:true,title:ba._("Problem Saving"),onBackClick:this.handleErrorBackClick,onOKClick:this.handleErrorOKClick,error:this.state.saveErrorObject}));return (s.createElement(u,{className:h.messengerdotcom?"_-el":'',behaviors:{LayerFadeOnShow:false},layerHideOnBlur:false,shown:true,width:this.props.width},s.createElement(v,{showCloseButton:false},ba._("Use Password?")),s.createElement(w,null,s.createElement(y,{className:"_5sor",type:'primary'},ba._("For additional security, you can enter your Facebook password to send money. You can always update this in {link}.",[ba.param('link',s.createElement(i,{href:l.settingsWWWURI,target:'_blank'},ba._("Settings")))]))),s.createElement(x,null,s.createElement(t,{className:"_5sov",disabled:this.isCancelButtonDisabled(),label:ba._("Not Now"),onClick:this.onCancelClick,size:'medium',use:'default'}),s.createElement(t,{className:"_5sox",disabled:this.isSaveButtonDisabled(),label:ba._("Use Password"),onClick:this.onSaveClick,size:'medium',use:'confirm'})),s.createElement(m,{visible:this.state.loading})));}});f.exports=ea;},null);
__d('P2PAddCardForIncentivesDialog.react',['P2PAddCardForIncentivesSuccessDialog.react','P2PAddCreditCardDialog.react','P2PAPI','P2PFriendPickerDialog.react','P2PLogger','P2PPasswordProtectionNUXDialog.react','P2PPasswordProtectionStatusTypes','P2PPaymentLoggerEvent','P2PPaymentLoggerEventFlow','React','emptyFunction','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){if(c.__markCompiled)c.__markCompiled();'use strict';var t=Object.assign||function(w){for(var x=1;x<arguments.length;x++){var y=arguments[x];for(var z in y)if(Object.prototype.hasOwnProperty.call(y,z))w[z]=y[z];}return w;},u=q.PropTypes,v=q.createClass({displayName:'P2PAddCardForIncentivesDialog',propTypes:{amount:u.string.isRequired,eventFlow:u.string,onClose:u.func.isRequired,onCancel:u.func.isRequired,onSuccess:u.func},getDefaultProps:function(){return {eventFlow:p.UI_FLOW_FINANCIAL_INCENTIVES,onCancel:r,onSuccess:r};},getInitialState:function(){return {passwordProtectionNUXDialogShown:false,showConfirmation:false,showFriendPicker:false};},log:function(w,x){l.log(w,t({www_event_flow:this.props.eventFlow},x));},handleAddCardSuccess:function(w){if(this.props.onSuccess)this.props.onSuccess();w.success=this.handleIncentivesTransferSuccess;w.error=this.handleIncentivesTransferFailure;j.createFinancialIncentivesTransfer(w);this.setState({showConfirmation:true,passwordProtectionNUXDialogShown:w.passwordProtection===n.NOT_SET});},handleIncentivesTransferSuccess:function(){this.log(o.UI_ACTN_INCENTIVE_TRANSFER_SUCCESS);},handleIncentivesTransferFailure:function(w){this.log(o.UI_ACTN_INCENTIVE_TRANSFER_FAILURE,w.message);},handleAddCardCancelled:function(){this.props.onCancel();},handleConfirmationClosed:function(){this.handleClose();this.log(o.UI_ACTN_FI_CANCEL);},handleConfirmationNext:function(){this.log(o.UI_ACTN_FI_SUCCESS_DIALOG_NEXT);this.setState({showConfirmation:false,showFriendPicker:true});},handleClose:function(){this.props.onClose();},handlePasswordProtectionNUXComplete:function(){this.setState({passwordProtectionNUXDialogShown:false,showConfirmation:true});},render:function(){if(this.state.passwordProtectionNUXDialogShown){return (q.createElement(m,{onComplete:this.handlePasswordProtectionNUXComplete}));}else if(this.state.showConfirmation){return (q.createElement(h,{amount:this.props.amount,onClose:this.handleConfirmationClosed,onOKClick:this.handleConfirmationNext}));}else if(this.state.showFriendPicker){return (q.createElement(k,{amount:this.props.amount,eventFlow:this.props.eventFlow,onClose:this.handleClose}));}else return (q.createElement(i,{eventFlow:this.props.eventFlow,onCancel:this.handleAddCardCancelled,onSuccess:this.handleAddCardSuccess,text:s._("We'll send {Amount you will receive} to your bank account when you add a debit card. Credit cards can't be used.",[s.param('Amount you will receive',this.props.amount)])}));}});f.exports=v;},null);
__d("XP2PFinancialIncentivesImpressionsController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/notifications\/client\/p2p_financial_incentives\/impressions\/",{});},null,{});
__d("XP2PFinancialIncentivesXOutController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/notifications\/client\/p2p_financial_incentives\/xout\/",{});},null,{});
__d('P2PFinancialIncentivesUpsell.react',['Arbiter','AsyncRequest','Image.react','P2PActions','P2PAddCardForIncentivesDialog.react','P2PLogger','P2PPaymentLoggerEvent','P2PPaymentLoggerEventFlow','React','XP2PFinancialIncentivesImpressionsController','XP2PFinancialIncentivesXOutController','XUIButton.react','XUICloseButton.react','cx','fbt','ix'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){if(c.__markCompiled)c.__markCompiled();var x=Object.assign||function(aa){for(var ba=1;ba<arguments.length;ba++){var ca=arguments[ba];for(var da in ca)if(Object.prototype.hasOwnProperty.call(ca,da))aa[da]=ca[da];}return aa;},y='$3',z=p.createClass({displayName:'P2PFinancialIncentivesUpsell',_arbiterToken:null,log:function(aa,ba){m.log(aa,x({www_event_flow:o.UI_FLOW_FINANCIAL_INCENTIVES},ba));},getInitialState:function(){return {hidden:false};},componentDidMount:function(){this._arbiterToken=h.subscribeOnce('mercury-jewel/opened',this.trackImpression);},componentWillUnmount:function(){if(this._arbiterToken){h.unsubscribe(this._arbiterToken);this._arbiterToken=null;}},doUpsell:function(){k.showDialog(l,{amount:y,onClose:this.handleOnDialogClose,onCancel:k.hideDialog,onSuccess:this.xOut});},handleOnDialogClose:function(){k.hideDialog();this.xOut();},handleBannerDismissed:function(){this.log(n.UI_ACTN_FI_BANNER_DISMISSED);this.xOut();},xOut:function(){var aa=r.getURIBuilder().getURI();new i().setURI(aa).setMethod('post').send();this.setState({hidden:true});},trackImpression:function(){this.log(n.UI_ACTN_FI_BANNER_IMPRESSION);var aa=q.getURIBuilder().getURI();new i().setURI(aa).setMethod('post').send();},render:function(){if(this.state.hidden)return null;return (p.createElement('div',{className:"_2-hh"},p.createElement('span',{className:"_2-hi"},p.createElement(j,{src:w('/images/p2p/enter-financial-incentives-www.png')})),p.createElement('span',{className:"_2-hk"},p.createElement('span',{className:"_2-hl"},v._("Send {Amount user will receive} to a friend on us!",[v.param('Amount user will receive',y)]),' '),p.createElement('span',{className:"_3imh"},v._("Just add a debit card to get started."))),p.createElement('span',{className:"_2-hm"},p.createElement(s,{label:v._("Add Card"),use:'confirm',onClick:this.doUpsell})),p.createElement(t,{className:"_2-hn",onClick:this.handleBannerDismissed})));}});f.exports=z;},null);