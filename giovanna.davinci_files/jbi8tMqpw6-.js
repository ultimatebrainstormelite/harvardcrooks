/*!CK:1609554847!*//*1439891472,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["TbbYJ"]); }

__d('NotificationSeenState',['NotificationConstants','NotificationUpdates','createObjectFrom'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=Object.assign||function(w){for(var x=1;x<arguments.length;x++){var y=arguments[x];for(var z in y)if(Object.prototype.hasOwnProperty.call(y,z))w[z]=y[z];}return w;},l={},m=1,n=2,o=0,p=m,q=m|n,r=h.PayloadSourceType.INITIAL_LOAD,s={UNSEEN_AND_UNREAD:o,SEEN_BUT_UNREAD:p,SEEN_AND_READ:q};function t(w){var x=[],y=[];Object.keys(w).forEach(function(z){var aa=w[z],ba=l[z];l[z]=aa;if(ba===undefined){x.push(z);y.push(z);return;}var ca=ba^aa;if(ca&m)x.push(z);if(ca&n)y.push(z);});x.length&&i.didUpdateSeenState(x);y.length&&i.didUpdateReadState(y);}i.subscribe('update-notifications',function(w,x){var y=x.nodes;if(!y||!y.length)return;var z=x.payloadsource,aa=h.PayloadSourceType,ba=z==aa.ENDPOINT,ca={};x.nodes.forEach(function(da){var ea=da.alert_id;if(!ba||l[ea]===undefined)ca[ea]=s[da.seen_state];});t(ca);});i.subscribe('update-seen',function(w,x){if(!x.seenState)return;var y=[],z={};Object.keys(x.seenState).forEach(function(ba){if(!x.seenState[ba]){y.push(ba);return;}var ca=l[ba];if(ca!==undefined)z[ba]=ca|m;});var aa=k({},j(y,o),z);t(aa);});i.subscribe('update-read',function(w,x){if(!x.readState)return;var y=[],z={};Object.keys(x.readState).forEach(function(ba){if(x.readState[ba]){y.push(ba);return;}var ca=l[ba];if(ca!==undefined){z[ba]=ca&~n;}else if(x.payloadsource==r)z[ba]=p;});var aa=k({},j(y,q),z);t(aa);});function u(w){var x=l[w];return x;}var v={isRead:function(w){return u(w)===q;},isSeen:function(w){return u(w)!==o;},getUnseenCount:function(){return v.getUnseenIDs().length;},getUnseenIDs:function(){return Object.keys(l).filter(function(w){return l[w]===o;});},getUnreadCount:function(){return v.getUnreadIDs().length;},getUnreadIDs:function(){return Object.keys(l).filter(function(w){return l[w]!==q;});}};f.exports=v;},null);
__d('NotificaionJewelControllerModuleLoader',['JSResource','NotificationSeenState','NotificationStore','NotificationUpdates'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();c('NotificationSeenState');c('NotificationStore');c('NotificationUpdates');f.exports=h('NotificationJewelController');},null);
__d('NotificationJewelHeaderController',['DOM','Event','NotificationSeenState','NotificationUserActions','NotificationUpdates'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();function m(n,o){'use strict';i.listen(n,'click',function(){var p=j.getUnreadIDs();if(p.length)k.markNotificationsAsRead(p);});l.subscribe('read-state-updated',function(){if(o)h.setContent(o,j.getUnreadCount());});}f.exports=m;},null);
__d('NotificationHiddenState',['NotificationUpdates','NotificationConstants','isEmpty'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k={};h.subscribe('update-notifications',function(m,n){var o=n.nodes,p=n.payloadsource;if(p===i.PayloadSourceType.LIVE_SEND&&o&&o.length){var q={};o.forEach(function(r){var s=r.alert_id;if(k[s])q[s]=false;});if(!j(q)){k=Object.assign(k,q);h.didUpdateHiddenState(Object.keys(q));}}});h.subscribe('update-hidden',function(m,n){if(n.hiddenState){k=Object.assign(k,n.hiddenState);h.didUpdateHiddenState(Object.keys(n.hiddenState));}});var l={isHidden:function(m){if(k[m])return k[m];return false;}};f.exports=l;},null);
__d('NotificationList.react',['NotificationConstants','NotificationHiddenState','NotificationSeenState','NotificationStore','NotificationUpdates','NotificationUserActions','React','getObjectValues','isEmpty'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){if(c.__markCompiled)c.__markCompiled();var q=Object.assign||function(u){for(var v=1;v<arguments.length;v++){var w=arguments[v];for(var x in w)if(Object.prototype.hasOwnProperty.call(w,x))u[x]=w[x];}return u;},r=n.PropTypes,s=h.PayloadSourceType.LIVE_SEND,t=n.createClass({displayName:'NotificationList',propTypes:{businessID:r.string,hasEverBeenOpened:r.bool,maxHeight:r.number,negativeTracking:r.object,paused:r.bool,tracking:r.string,useChevron:r.bool,numPerPage:r.number.isRequired,listRenderer:r.func.isRequired,upsell:r.object},getInitialState:function(){this._currentlyFetching=false;this._pendingNotifs={};this._shouldScroll=false;return {canFetchMore:true,notifs:{},hiddenState:{},readState:{},showingChevron:false};},componentWillMount:function(){k.setBusinessID(this.props.businessID);this._subscriptions=[l.subscribe('notifications-updated',(function(u,v){if(v.source==s&&!p(v.updates)){this._shouldScroll=true;if(this.props.paused!==false)this._pendingNotifs=q({},this._pendingNotifs,v.updates);return;}this._fetchAndUpdate(k.getCount());}).bind(this)),l.subscribe(['hidden-state-updated','read-state-updated'],(function(u,v){if(u=='hidden-state-updated'){if(v.source!==s||!this.props.paused){var w={};Object.keys(v.updates).forEach(function(y){w[y]=i.isHidden(y);});this.setState({hiddenState:q({},this.state.hiddenState,w)});}}else{var x={};Object.keys(v.updates).forEach(function(y){x[y]=j.isRead(y);});this.setState({readState:q({},this.state.readState,x)});}}).bind(this))];},componentWillUnmount:function(){if(this._subscriptions){while(this._subscriptions.length)this._subscriptions.pop().unsubscribe();this._subscriptions=null;}},_getNotifsWithCurrentOrder:function(u){var v=Object.keys(this.state.notifs),w=Object.keys(u).filter((function(y){return !this.state.notifs[y];}).bind(this));v=v.concat(w);var x={};v.forEach((function(y){if(this._pendingNotifs[y]){if(this.state.notifs[y])x[y]=this.state.notifs[y];}else x[y]=u[y];}).bind(this));return x;},_fetchAndUpdate:function(u){this._currentlyFetching=true;k.getNotifications(u,(function(v){var w=p(this._pendingNotifs)?v:this._getNotifsWithCurrentOrder(v),x={},y={};o(w).forEach(function(z){var aa=z.alert_id;if(!this.state||!this.state.readState[aa])x[aa]=j.isRead(aa);if(!this.state||!this.state.hiddenState[aa])y[aa]=i.isHidden(aa);});this._currentlyFetching=false;this.setState({notifs:w,canFetchMore:k.canFetchMore()||k.getCount()!=Object.keys(w).length,readState:q({},this.state.readState,x),hiddenState:q({},this.state.hiddenState,y)});}).bind(this));},_fetchAndUpdateAll:function(){var u={};Object.keys(this._pendingNotifs).forEach((function(v){var w=i.isHidden(v);if(w!=this.state.hiddenState[v])u[v]=i.isHidden(v);}).bind(this));if(!p(u))this.setState({hiddenState:q({},this.state.hiddenState,u)});this._pendingNotifs={};this._fetchAndUpdate(k.getCount());},_fetchNextSet:function(){if(!this._currentlyFetching){var u=Object.keys(this.state.notifs).length;this._fetchAndUpdate(u+this.props.numPerPage);}},_onScrollAndUpdate:function(u){if(this._currentlyFetching||!this.state.canFetchMore)return;if(u)this._fetchNextSet();},_onChevronShow:function(){this.setState({showingChevron:true});},_onChevronHide:function(){this.setState({showingChevron:false});},_updateNotifInContainer:function(u){if(u.length>this.props.numPerPage){this._fetchAndUpdate(u.length);}else this._fetchNextSet();return;},componentDidUpdate:function(u){var v=j.getUnseenIDs();if(!p(this._pendingNotifs))v=v.filter((function(w){return !this._pendingNotifs[w];}).bind(this));if(v.length&&this.props.paused)m.markNotificationsAsSeen(v);if(!u.hasEverBeenOpened&&this.props.hasEverBeenOpened)this._updateNotifInContainer(v);if(u.paused&&!this.props.paused){this._shouldScroll=false;setTimeout(this._fetchAndUpdateAll,0);return;}},render:function(){var u=this.props.listRenderer;return (n.createElement(u,{hasEverBeenOpened:this.props.hasEverBeenOpened,paused:this.props.paused,tracking:this.props.tracking,negativeTracking:this.props.negativeTracking,shortenTimestamp:this.props.shortenTimestamp,businessID:this.props.businessID,maxHeight:this.props.maxHeight,useChevron:this.props.useChevron,notifs:this.state.notifs,afterScroll:this._onScrollAndUpdate,onChevronShow:this._onChevronShow,onChevronHide:this._onChevronHide,canFetchMore:this.state.canFetchMore,hiddenState:this.state.hiddenState,readState:this.state.readState,showingChevron:this.state.showingChevron,shouldScroll:this._shouldScroll,upsell:this.props.upsell||null,isRHC:this.props.isRHC}));}});f.exports=t;},null);
__d('NotificationListPropTypes',['React'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();'use strict';var i=h.PropTypes,j={negativeTracking:i.object,tracking:i.string,useChevron:i.bool,notifs:i.object,afterScroll:i.func,onChevronShow:i.func,onChevronHide:i.func,canFetchMore:i.bool,hiddenState:i.object,readState:i.object,showingChevron:i.bool,paused:i.bool,maxHeight:i.number,shouldScroll:i.bool,upsell:i.object};f.exports=j;},null);
__d('ReadToggle.react',['React','cx','emptyFunction','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();'use strict';var l=h.PropTypes,m=h.createClass({displayName:'ReadToggle',propTypes:{isRead:l.bool.isRequired,onClick:l.func,readLabel:l.node,unreadLabel:l.node},getDefaultProps:function(){return {onClick:j};},render:function(){if(this.props.isRead){return (h.createElement('div',{'aria-label':this.props.readLabel,className:this._getClasses(),'data-hover':'tooltip','data-tooltip-alignh':'center',onClick:this.props.onClick}));}else return (h.createElement('div',{'aria-label':this.props.unreadLabel,className:this._getClasses(),'data-hover':'tooltip','data-tooltip-alignh':'center',onClick:this.props.onClick,role:'button',tabIndex:'0'}));},_getClasses:function(){return k(this.props.className,(!this.props.isRead?"_5c9q":'')+(this.props.isRead?' '+"_5c9_":''));}});f.exports=m;},null);
__d('NotificationListItem.react',['AsyncResponse','BizSiteIdentifier.brands','BanzaiLogger','CloseButton.react','Event','FlexibleBlock.react','ImageBlock.react','Keys','List.react','NotificationPhotoThumbnail','NotificationTokens','NotificationURI','NotificationUserActions','React','TextWithEntities.react','ReadToggle.react','Timestamp.react','VaultBoxURI','XUIButton.react','PopoverMenu.react','ReactXUIMenu','cx','invariant','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea){if(c.__markCompiled)c.__markCompiled();var fa=Object.assign||function(ka){for(var la=1;la<arguments.length;la++){var ma=arguments[la];for(var na in ma)if(Object.prototype.hasOwnProperty.call(ma,na))ka[na]=ma[na];}return ka;},ga=ba.Item;function ha(ka,la){return u.createElement('span',{className:'fwb'},ka);}function ia(ka){return !!(ka&&ka.id&&!ka.is_facebook_app);}var ja=u.createClass({displayName:'NotificationListItem',getInitialState:function(){return {showingOptions:false,negativeFeedbackConfirmation:null,canReportAsSpam:false,spamReportConfirmation:null,sendingFeedback:false,mayUndoHide:false,notifOptionConfirmation:null,isBizSite:i.isBizSite()};},_onKeyDownItem:function(ka){if(l.getKeyCode(ka.nativeEvent)==o.RETURN)this._markItemRead();},_markItemReadIfUnreadFromReadButton:function(){if(!this.props.isRead)t.setNextIsFromReadButton(true);this._markItemReadIfUnread();},_markItemReadIfUnread:function(){!this.props.isRead&&this._markItemRead();},_markItemRead:function(){t.markNotificationsAsRead([this.props.alert_id]);},_onFeedbackError:function(ka){h.defaultErrorHandler(ka);this.setState({sendingFeedback:false});},_onHideSuccess:function(ka){var la=ka.getPayload();!la.confirmation?da(0):undefined;this.setState({negativeFeedbackConfirmation:la.confirmation,canReportAsSpam:la.canReportAsSpam,sendingFeedback:false,showingOptions:true});},_onHideAppSuccess:function(ka){var la=ka.getPayload(),ma=la.confirmation,na=la.canReportAsSpam;!ma?da(0):undefined;this.setState({negativeFeedbackConfirmation:ma,canReportAsSpam:na,mayUndoHide:true,sendingFeedback:false,showingOptions:true});},_onSpamReportSuccess:function(ka){var la=ka.getPayload().spamReportConfirmation;this.setState({negativeFeedbackConfirmation:null,spamReportConfirmation:la,sendingFeedback:false});},_onHide:function(){t.markNotificationAsHidden(this.props.alert_id,this._onHideSuccess,this._onFeedbackError);this.setState({sendingFeedback:true,mayUndoHide:true});},_onShowSuccess:function(){this.setState({notifOptionConfirmation:null,negativeFeedbackConfirmation:null,sendingFeedback:false,showingOptions:false});},_onShow:function(){var ka=this.props.negative?this.props.negative.subscription_level:null;t.markNotificationAsVisible(this.props.alert_id,ka,this._onShowSuccess,this._onFeedbackError);this.setState({sendingFeedback:true});},_onReportSpam:function(){t.markNotificationAsSpam(this.props.alert_id,this._onSpamReportSuccess,this._onFeedbackError);this.setState({sendingFeedback:true});},_markAppAsHidden:function(){t.markAppAsHidden(this.props.alert_id,this.props.application.id,this._onHideAppSuccess,this._onFeedbackError);this.setState({sendingFeedback:true});},_markAppAsVisible:function(){t.markAppAsVisible(this.props.alert_id,this.props.application.id,(function(){this.setState({negativeFeedbackConfirmation:null,sendingFeedback:false,showingOptions:false,mayUndoHide:false});}).bind(this),this._onFeedbackError);this.setState({sendingFeedback:true});},_renderAttachedImage:function(ka){if(ka)return (u.createElement('img',{src:ka.uri,className:"_42td",'aria-hidden':true}));return u.createElement('span',null);},_getModifiedTrackingString:function(ka){return JSON.stringify(fa({},JSON.parse(this.props.tracking),ka));},_onClickCloseButton:function(){if(this.props.useChevron){this.showCloseOptionOnMenuClose=true;}else this.setState({showingOptions:true});},_onCancelNegativeFeedback:function(){this.setState({showingOptions:false});},shouldComponentUpdate:function(ka,la){return (this.props.visible!==ka.visible||this.props.isRead!==ka.isRead||this.props.timestamp!==ka.timestamp||this.props.paused!==ka.paused||this.state.showingOptions!==la.showingOptions||this.state.sendingFeedback!==la.sendingFeedback||this.state.canReportAsSpam!==la.canReportAsSpam||this.state.spamReportConfirmation!==la.spamReportConfirmation);},componentWillReceiveProps:function(ka){if(this.props.paused&&!ka.paused&&!this.props.visible&&this.state.mayUndoHide)this.setState({mayUndoHide:false});},_onChevronHide:function(){this.props.onChevronHide();this._logChevronEvent('close');if(this.showCloseOptionOnMenuClose){this.showCloseOptionOnMenuClose=false;this._turnOff();}},_turnOff:function(){var ka=ia(this.props.application)?this._markAppAsHidden:this._onHide;ka();},_onChevronShow:function(){this.props.onChevronShow();this._logChevronEvent('open');},_logChevronEvent:function(ka){var la={event:ka,notif_type:this.props.notif_type,notif_id:parseInt(r.untokenizeIDs([this.props.alert_id])[0],10)};j.log('NotifJewelMenuLoggerConfig',la);},_onNotifOptionSuccess:function(ka){this.setState({showingOptions:true,sendingFeedback:false,notifOptionConfirmation:ka});},_onClickNotifOption:function(ka){this.setState({sendingFeedback:true,mayUndoHide:true});t.sendNotifOption(this.props.alert_id,this._onNotifOptionSuccess,this._onFeedbackError,ka);},_undoNotifOption:function(ka){this.setState({sendingFeedback:true});t.undoNotifOption(this.props.alert_id,this._onShowSuccess,this._onFeedbackError,ka);},render:function(){if(!this.props.visible&&!this.state.mayUndoHide)return u.createElement('li',{className:"_4_62"});var ka=this.props.negative,la=this.props.negativeTracking,ma="_33c"+(!this.props.isRead?' '+"_4af":'')+(this.state.showingOptions?' '+"_4ag":'')+(this.state.sendingFeedback?' '+"_4m8s":'');if(this.state.negativeFeedbackConfirmation){var na=this.state.negativeFeedbackConfirmation,oa=null,pa=null;if(this.state.canReportAsSpam)if(!this.props.useChevron){oa=u.createElement('span',null,u.createElement('span',{className:'mhs'},'·'),u.createElement('a',{href:'#',onClick:this._onReportSpam},ea._("Report app for spam")));}else pa=u.createElement(p,{border:'none',spacing:'small',className:"_1v4c"},u.createElement('li',null,u.createElement('a',{href:'#',onClick:this._onReportSpam,className:'mls'},ea._("Report app for spam"))));var qa=ia(this.props.application)?this._markAppAsVisible:this._onShow,ra=!this.props.useChevron?u.createElement('a',{href:'#',onClick:qa,className:'mls'},ea._("Undo")):null;return (u.createElement('li',{className:ma,'data-gt':this.props.tracking},u.createElement('div',{className:"_4ai"},u.createElement(v,{interpolator:ha,ranges:na.ranges,aggregatedranges:na.aggregated_ranges,text:na.text}),ra,oa),pa));}var sa=this.state.spamReportConfirmation;if(sa)return (u.createElement('li',{className:ma,'data-gt':this.props.tracking},u.createElement('div',{className:"_4ai"},u.createElement(v,{interpolator:ha,ranges:sa.ranges,aggregatedranges:sa.aggregated_ranges,text:sa.text}))));if(this.state.notifOptionConfirmation){na=this.state.notifOptionConfirmation;return (u.createElement('li',{className:ma,'data-gt':this.props.tracking},u.createElement('div',{className:"_4ai"},u.createElement(v,{interpolator:ha,ranges:na.ranges,aggregatedranges:na.aggregated_ranges,text:na.text&&na.text.text?na.text.text:''}),u.createElement('a',{href:'#',onClick:(function(){this._undoNotifOption(na.undo_action);}).bind(this),className:'mls'},ea._("Undo"))),u.createElement(p,{border:'none',spacing:'small',className:"_1v4c"},na.follow_up_options.map?na.follow_up_options.map((function(sb){return (u.createElement('li',{key:sb.client_action+sb.server_action},u.createElement('a',{onClick:(function(){this._onClickNotifOption(sb.server_action);}).bind(this),href:'#',className:'mls'},sb.subtext)));}).bind(this)):null)));}if(this.state.showingOptions&&!this.props.useChevron){var ta=ia(this.props.application)?this._markAppAsHidden:this._onHide;return (u.createElement('li',{className:ma,'data-gt':this.props.tracking},u.createElement('div',{className:"_4ai"},u.createElement('div',null,u.createElement(v,{interpolator:ha,ranges:ka.confirm_question.ranges,aggregatedranges:ka.confirm_question.aggregated_ranges,text:ka.confirm_question.text})),u.createElement('div',{className:'mts'},u.createElement(z,{'data-gt':this._getModifiedTrackingString(la.confirm),href:{url:'#'},label:ka.turn_off,use:'confirm',onClick:ta,disabled:this.state.sendingFeedback}),u.createElement(z,{'data-gt':this._getModifiedTrackingString(la.cancel),href:{url:'#'},label:ea._("Keep On"),onClick:this._onCancelNegativeFeedback,disabled:this.state.sendingFeedback})))));}var ua=null;if(this.props.title)ua=u.createElement(v,{interpolator:ha,ranges:this.props.title.ranges,aggregatedranges:this.props.title.aggregated_ranges,text:this.props.title.text,renderEmoji:true,renderEmoticons:true});var va=null,wa=null;if(ka){var xa=this._onClickCloseButton,ya;ya=this._getModifiedTrackingString(la.click);var za="_4ah"+(' '+"_55m9");va=u.createElement(k,{className:za,'data-gt':ya,size:'medium',tooltip:ka.button_tooltip,onClick:xa,ref:'closeButton'});}var ab=s.localize(this.props.url),bb=null;if(!this.props.noPhotoPreviews)bb=q.getThumbnail(this.props.attachments,this.props.attached_story,this.props.feedback_context);var cb=bb&&s.snowliftable(ab),db=s.isVaultSetURI(ab),eb=s.isAlbumDraftRecoveryDialogURI(ab),fb=(this.props.useChevron?"_55ma":'')+(' '+"_55m9"),gb=u.createElement(w,{className:fb,isRead:!!this.props.isRead,onClick:this._markItemReadIfUnreadFromReadButton,readLabel:ea._("Read"),unreadLabel:ea._("Mark as Read")}),hb=null;if(this.props.useChevron){va=null;var ib="_1_0c"+(' '+"_55m9"),jb=u.createElement(ba,null,this.props.menu_options?this.props.menu_options.map((function(sb){return (u.createElement(ga,{onclick:(function(){this._onClickNotifOption(sb.server_action);}).bind(this),key:sb.client_action+sb.server_action},u.createElement('div',{className:"_3-y-"},sb.text),u.createElement('div',{className:"_3-y_"},sb.subtext)));}).bind(this)):null);hb=u.createElement(aa,{alignh:'right',menu:jb,className:ib,onShow:this._onChevronShow,onHide:this._onChevronHide},u.createElement('div',{className:"_1_0d"}));}var kb=cb||db||eb?ab:this.props.ajaxify_url,lb=null,mb=null,nb=db?y.getSyncedTabURI().toString():ab;if(cb){lb='theater';}else if(eb){lb='async-post';}else if(db||kb)lb='dialog';var ob=null,pb=this.props.actors[0];if(pb)ob={backgroundImage:'url('+pb.profile_picture.uri+')'};var qb=false;this.props.attachments.forEach(function(sb){if(qb)return;qb=sb.style_list.indexOf('notification_target')>=0||sb.style_list.indexOf('question')>=0;if(qb)return;});var rb=u.createElement('div',null,gb,va,hb);return (u.createElement('li',{className:ma,'data-gt':this.props.tracking,onMouseLeave:wa},u.createElement('div',{className:'anchorContainer'},u.createElement('a',{href:nb,ajaxify:kb,className:"_33e"+(this.props.useChevron?' '+"_1_0e":''),rel:lb,onClick:mb,onMouseDown:this._markItemRead,onKeyDown:this._onKeyDownItem},u.createElement(n,null,u.createElement('span',{style:ob,className:(!this.props.isNotifsPage?"_33h":'')+(this.props.isNotifsPage?' '+"_12u1":'')}),u.createElement(m,{flex:m.FLEX.left},u.createElement('div',{className:"_4l_v"},ua,u.createElement(n,{className:"_33f"+(this.state.isBizSite?' '+"_2g48":'')},u.createElement('img',{className:"_10cu",src:this.props.icon.uri}),u.createElement('span',null,u.createElement(x,{shorten:this.props.shortenTimestamp,time:this.props.timestamp.time,text:this.props.timestamp.text,verbose:this.props.timestamp.verbose,className:"_33g"})))),this._renderAttachedImage(bb)))),rb)));}});f.exports=ja;},null);
__d('NotificationJewelList.react',['Animation','Event','LoadingIndicator.react','NotificationListPropTypes','NotificationListItem.react','React','ScrollableArea.react','Vector','cx','debounce','fbt','getObjectValues','isEmpty'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){if(c.__markCompiled)c.__markCompiled();var u=Object.assign||function(ba){for(var ca=1;ca<arguments.length;ca++){var da=arguments[ca];for(var ea in da)if(Object.prototype.hasOwnProperty.call(da,ea))ba[ea]=da[ea];}return ba;},v=160,w=530,x=40,y=64,z=430,aa=m.createClass({displayName:'NotificationJewelList',propTypes:k,_isLoadingIndicatorVisible:function(){var ba=this.refs.loading;if(!ba)return false;var ca=m.findDOMNode(this.refs.scrollable),da=o.getElementDimensions(ca).y;if(da===0)return false;var ea=o.getElementPosition(ca).y+da,fa=o.getElementPosition(m.findDOMNode(ba)).y;fa-=x;return fa<ea;},_calculateHeight:function(){var ba=o.getViewportDimensions().y,ca=Math.min(this.props.maxHeight||w,ba-v);if(this.props.upsell)return Math.max(ca-y,0);return ca;},_keepOnLoading:function(){if(this.isMounted())this.props.afterScroll(this._isLoadingIndicatorVisible());},_renderItems:function(){return s(this.props.notifs).map((function(ba){var ca=ba.alert_id;return (m.createElement(l,u({key:ca,visible:!this.props.hiddenState[ca],isRead:this.props.readState[ca],negativeTracking:this.props.negativeTracking,shortenTimestamp:this.props.shortenTimestamp,useChevron:this.props.useChevron,onChevronShow:this.props.onChevronShow,onChevronHide:this.props.onChevronHide,paused:this.props.paused,parent:this},ba)));}).bind(this));},componentDidMount:function(){var ba=m.findDOMNode(this.refs.scrollable);i.listen(window,'resize',q((function(){if(!t(this.props.notifs))new h(ba).to('height',this._calculateHeight()+'px').duration(100).go();}).bind(this)));},componentDidUpdate:function(ba){if(this.props.paused&&!ba.paused)if(this.props.shouldScroll&&this.refs.scrollable)this.refs.scrollable.getArea().scrollToTop(false);setTimeout(this._keepOnLoading,0);},render:function(){var ba=this.props.notifs,ca=null,da=null,ea=z,fa=null;if(!t(ba)){ca=m.createElement('ul',{'data-gt':this.props.tracking},this._renderItems());da=this._calculateHeight();}else if(!this.props.canFetchMore)ca=m.createElement('div',{className:"_572e"},r._("No new notifications"));if(this.props.canFetchMore)fa=m.createElement(j,{color:'white',size:'small',ref:'loading',className:"_33i"});var ga=null;if(this.props.upsell){var ha=this.props.upsell.module;ga=m.createElement(ha,this.props.upsell.props);}var ia="_50-t"+(this.props.showingChevron?' '+"_2iy1":'');return (m.createElement('div',{className:ia},m.createElement(n,{ref:'scrollable',width:ea,height:da,fade:true,persistent:true,onScroll:q(this._keepOnLoading)},ca,fa),ga));}});f.exports=aa;},null);
__d('NotificationJewelListController',['NotificationList.react','NotificationJewelList.react','React'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();function k(l,m){'use strict';this.$NotificationJewelListController1=l;this.$NotificationJewelListController2=m;this.$NotificationJewelListController3=false;this.$NotificationJewelListController4=false;this.$NotificationJewelListController5();}k.prototype.open=function(){'use strict';this.$NotificationJewelListController3=true;this.$NotificationJewelListController5();};k.prototype.pause=function(){'use strict';this.$NotificationJewelListController4=true;this.$NotificationJewelListController5();};k.prototype.unpause=function(){'use strict';this.$NotificationJewelListController4=false;this.$NotificationJewelListController5();};k.prototype.$NotificationJewelListController5=function(){'use strict';j.render(j.createElement(h,{hasEverBeenOpened:this.$NotificationJewelListController3,paused:this.$NotificationJewelListController4,tracking:this.$NotificationJewelListController2.tracking,negativeTracking:this.$NotificationJewelListController2.negativeTracking,shortenTimestamp:this.$NotificationJewelListController2.shortenTimestamp,businessID:this.$NotificationJewelListController2.businessID,maxHeight:this.$NotificationJewelListController2.maxHeight,useChevron:this.$NotificationJewelListController2.useChevron,numPerPage:5,listRenderer:i,upsell:this.$NotificationJewelListController2.upsell||null}),this.$NotificationJewelListController1);};f.exports=k;},null);
__d('HashtagParser',['URLMatcher','getHashtagRegex'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=100,k=30,l=/@\[([0-9]+):([0-9]+):((?:[^\\\]]*(?:\\.)*)*)\]/g;function m(ea){var fa=z(ea),ga=0,ha=0;return o(ea).map(function(ia){while(ga<fa.length){var ja=fa[ga],ka=ja.offset-ha;if(ka<ia.offset){ha+=ja.token.length-ja.name.length;ga++;}else break;}return {marker:ia.marker,tag:ia.hashtag,rawOffset:ia.offset+ha,offset:ia.offset};});}function n(ea){return p(ea,u(ea));}function o(ea){var fa=ba(ea);return p(fa,q(ea,fa));}function p(ea,fa){return s(ea).slice(0,k).filter(function(ga){var ha=w(ga.offset,ga.hashtag.length,fa);return !ha&&ga.hashtag.length<=j;});}function q(ea,fa){return v(t(ea),u(fa));}var r=i();function s(ea){var fa=[];ea.replace(r,function(ga,ha,ia,ja,ka){fa.push({marker:ia,hashtag:ja,offset:ka+ha.length});});return fa;}function t(ea){return ca(ea).map(function(fa){return [fa.offset,fa.name.length];});}function u(ea){var fa=[],ga,ha=0;while(ga=h.permissiveMatch(ea)){var ia=ea.indexOf(ga);fa.push([ha+ia,ga.length]);ea=ea.substring(ia+ga.length);ha+=ia+ga.length;}return fa;}function v(ea,fa){var ga=[],ha=0,ia=0,ja=0;while(ha<ea.length&&ia<fa.length)if(ea[ha][0]>fa[ia][0]){ga[ja++]=fa[ia++];}else ga[ja++]=ea[ha++];return ga.concat(ea.slice(ha),fa.slice(ia));}function w(ea,fa,ga){if(!ga)return false;var ha=y(ga,ea);return x(ea,fa,ga,ha)||x(ea,fa,ga,ha+1);}function x(ea,fa,ga,ha){if(!ga[ha])return false;var ia=ga[ha][0],ja=ga[ha][1];return !(ea+fa-1<ia||ea>ia+ja-1);}function y(ea,fa){var ga=0,ha=ea.length-1;while(ga<=ha){var ia=Math.floor((ga+ha)/2),ja=ea[ia][0];if(ja==fa){return ia;}else if(ja<fa){ga=ia+1;}else ha=ia-1;}return ha;}function z(ea){var fa=[];ea.replace(l,function(ga,ha,ia,ja,ka){fa.push({token:ga,id:ha,type:ia,name:ja,offset:ka});});return fa;}function aa(ea){return ea?ea.replace(/\\([^\\])/g,'$1').replace(/\\\\/g,'\\'):null;}function ba(ea){return ea.replace(l,function(fa,ga,ha,ia,ja){return aa(ia);});}function ca(ea){var fa=0,ga=0;return z(ea).map(function(ha){var ia=ea.indexOf(ha.token,ga);ga=ia+1;ia-=fa;var ja=aa(ha.name);fa+=ha.token.length-ja.length;if(ia>=0)return {id:ha.id,name:ja,type:ha.type,offset:ia};});}var da={};da.parse=m;da.parseWithoutMentions=n;f.exports=da;},null);
__d("XQuickPromotionSimpleLoggingController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/qp\/action\/log\/",{qp_id:{type:"Int",required:true},qp_action:{type:"Enum",enumType:1},qp_instance_log_data:{type:"StringToStringMap",defaultValue:{}},qp_event:{type:"String"}});},null,{});
__d('QPRenderer',['$','CSS','XQuickPromotionSimpleLoggingController','AsyncSignal'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=function(q,event,r){var s=j.getURIBuilder().setInt('qp_id',q).setString('qp_event',event).setStringToStringMap('qp_instance_log_data',r).getURI();new k(s,{}).send();},m=function(q,r,s){var t=j.getURIBuilder().setInt('qp_id',q).setEnum('qp_action',r).setStringToStringMap('qp_instance_log_data',s).getURI();new k(t,{}).send();},n=function(q,r,s,t,u,v){p(q,s,h(t),v,function(){if(u)i.hide(r);});},o=function(q,r,s){r.show();l(q,'view',{});r.subscribe('cancel',function(){l(q,'dialog_cancel',{});});for(var t=0;t<s.length;t++){var u=s[t],v=h(u.element_id);p(q,u.action,v,u.instance_log_data,function(){if(u.should_close)r.hide();});if(u.action=='primary')v.focus();}},p=function(q,r,s,t,u){s.addEventListener('click',function(){var v=j.getURIBuilder().setInt('qp_id',q).setEnum('qp_action',r).setStringToStringMap('qp_instance_log_data',t).getURI();new k(v,{}).send();u();});};g.setAction=n;g.setDialogActionsAndShow=o;g.logAction=m;g.logEvent=l;},null);
__d('FacebarResultStoreUtils',['FacebarGlobalOptions','FacebarJSConstants'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j={getQueryFeatures:function(k){var l={};if(h.enableBootstrapRanking){if(k.raw_text)l.FEATURE_QUERY_LENGTH=k.raw_text.length;if(k.tokens){l.FEATURE_QUERY_TOKENS=k.tokens.length;l.FEATURE_QUERY_TOKEN_LENGTH_SUM=0;for(var m=0;m<k.tokens.length;m++)l.FEATURE_QUERY_TOKEN_LENGTH_SUM+=k.tokens[m].length;}}return l;},addFeatures:function(k,l,m,n,o,p){if(!k.features)return;k.features={FEATURE_QUERY_LENGTH:n.FEATURE_QUERY_LENGTH,FEATURE_QUERY_TOKENS:n.FEATURE_QUERY_TOKENS,FEATURE_QUERY_TOKEN_LENGTH_SUM:n.FEATURE_QUERY_TOKEN_LENGTH_SUM};k.features.FEATURE_IS_EXACT_NAME_MATCH=o;k.features.FEATURE_IS_STOP_WORD_MATCH=p;if(l&&l.length>0){var q=l.split(' ').length,r=0;for(var s=0;s<k.termMatches.length;++s)if(l.search(k.termMatches[s])>=0)r++;k.features.FEATURE_TITLE_TOKEN_MATCH_FRACTION=r/q;}if(m.tokens&&m.tokens.length>0){var t=l.search(m.tokens[0]);k.features.FEATURE_FIRST_TERM_MATCH_POSITION=t;k.features.FEATURE_FIRST_TERM_MATCH_TOKEN=l.substring(0,t+m.tokens[0].length).split(' ').length;k.termMatches.some(function(u){if(u.search(m.tokens[0])===0){k.features.FEATURE_FIRST_TERM_MATCH_TOKEN_FRACTION=m.tokens[0].length/u.length;return true;}return false;});k.features.FEATURE_IN_ORDER_MATCH=1;if(m.tokens.length>1){t=l.search(m.tokens[1]);k.features.FEATURE_SECOND_TERM_MATCH_POSITION=t;k.features.FEATURE_SECOND_TERM_MATCH_TOKEN=l.substring(0,t+m.tokens[1].length).split(' ').length;k.termMatches.some(function(u){if(u.search(m.tokens[1])===0){k.features.FEATURE_FIRST_TERM_MATCH_TOKEN_FRACTION=m.tokens[0].length/u.length;return true;}return false;});if(k.features.FEATURE_SECOND_TERM_MATCH_TOKEN<k.features.FEATURE_FIRST_TERM_MATCH_POSITION)k.features.FEATURE_IN_ORDER_MATCH=0;}}return k;},processEntityResult:function(k,l,m,n,o,p,q,r,s){var t={semantic:l.toString(),structure:[{type:k===i.keywordType?k:'ent:'+k,text:m,uid:l}],type:k,cost:n,cache_id_length:0,features:[]};t.tuid=JSON.stringify({semantic:t.semantic,structure:t.structure});if(h.enableBootstrapRanking){t.termMatches=q[l.toString()];t=this.addFeatures(t,m.toLowerCase(),o,p,r,s);}return t;},getRawTextFromStructured:function(k){var l=k.map(function(m){return m.getText();});return l.join('');},getTextFromResult:function(k){var l=k.structure,m='';l.forEach(function(n){m+=n.text;});return m;}};f.exports=j;},null);
__d('HashtagSearchResultUtils',['FacebarResultStoreUtils','HashtagParser','HashtagSearchResultConfig','URI','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m={getHashtagFromQuery:function(n){var o=i.parse(n);if(o&&o.length===1&&o[0].offset===0)return o[0].tag;return false;},makeTypeaheadResult:function(n){var o=l._("Hashtag");return {category:o,path:new k('/hashtag/'+n).toString(),photo:j.image_url,rankType:null,replace_results:j.boost_result?true:false,scaled_score:1,score:0,text:'#'+n,type:'hashtag_exact',uid:'hashtag:'+n};},makeFacebarEntry:function(n){var o=l._("Hashtag");return {category:o,path:new k('/hashtag/'+n).toString(),photo:j.image_url,replace_results:j.boost_result?true:false,text:'#'+n,type:'hashtag_exact',uid:'hashtag:'+n};},makeFacebarResult:function(n){var o=h.processEntityResult('hashtag_exact','hashtag:'+n,'#'+n,j.hashtag_cost);o.parse={display:[{type:'ent:hashtag_exact',uid:'hashtag:'+n}],remTokens:[],suffix:''};o.tags={hashtag:'hashtag'};return o;}};f.exports=m;},null);
__d('ContextualHelpSearchController',['Event','AsyncRequest','DOM','CSS','Focus','Input'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n=400;function o(){this._token=null;this._timerID=0;this._lastQuery=null;this.typing_listener=null;this.clear_listener=null;this.async_request=null;}Object.assign(o.prototype,{init:function(p,q,r,s,t,u){this.loader=p;this.search_box=q;this.topics_area=r;this.results_area=s;this.clear_button=t;this.typing_listener=h.listen(this.search_box,'keyup',this.setTimer.bind(this));this.clear_listener=h.listen(this.clear_button,'click',this.clearResults.bind(this));if(u==null||u.focusSearchBox==null||u.focusSearchBox)l.set(this.search_box);},source:'contextual_help',clearResults:function(){this.show(this.topics_area);this._lastQuery='';m.reset(this.search_box);l.set(this.search_box);if(this.async_request!==null){this.async_request.abort();this.async_request=null;}k.addClass(this.clear_button,'hidden_elem');},update:function(){var p=m.getValue(this.search_box);if(p===this._lastQuery)return;this._lastQuery=p;if(p===''){this.clearResults();return;}this.show(this.loader);var q={query:p,width:this._width||n,source:this.source};this.async_request=new i('/help/ajax/search/').setData(q).setHandler((function(r){this._update(r);}).bind(this));this.async_request.send();},_update:function(p){this.async_request=null;var q=p.getPayload().results;j.setContent(this.results_area,q);this.show(this.results_area);if(m.getValue(this.search_box)===''){this.clearResults();}else k.removeClass(this.clear_button,'hidden_elem');},setTimer:function(){if(this._timerID!==0)clearTimeout(this._timerID);this._timerID=setTimeout(this.update.bind(this),300);if(this.async_request!=null){this.async_request.abort();this.async_request=null;}},show:function(p){var q=[this.loader,this.topics_area,this.results_area];for(var r=0;r<q.length;r++)k.addClass(q[r],'hidden_elem');k.removeClass(p,'hidden_elem');}});f.exports=o;},null);
__d('JewelQPLogging',['QPRenderer'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=false,j=null,k=false;function l(){if(k)return;if(i&&j){h.logEvent(j.promotion_id,'view',j.instance_log_data?j.instance_log_data:{});k=true;}}var m={onJewelOpened:function(){i=true;l();},updateQPLogData:function(n){j=n;l();}};f.exports=m;},null);
__d('RequestsJewel',['Animation','AccessibilityLogger','Arbiter','AsyncRequest','AsyncSignal','ChannelConstants','CSS','DOM','Event','LinkController','Parent','ScrollableArea','Vector','$','debounce','ge','shield','fbt','JewelQPLogging','requireWeak'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa){if(c.__markCompiled)c.__markCompiled();var ba=null;aa('FriendBrowserCheckboxController',function(ga){return ba=ga;});var ca=530,da=30,ea=160;Object.assign(fa,{instance:null,getInstance:function(){return fa.instance;},replaceJewelTitle:function(ga,ha){o.setContent(u(ga),ha);},updateFromDOM:function(){if(fa.instance)fa.instance.fromDom();},setInitialHeight:function(){if(fa.instance)fa.instance.setHeight();},maybeLoadJewel:function(){if(fa.instance)fa.instance.maybeLoadJewel();}});function fa(ga,ha,ia){'use strict';fa.instance=this;this.countNew=0;this.jewel=ga;this.jewelFlyoutCase=ga.getRoot();this.jewelFlyout=w('fbRequestsFlyout');this.newCountSpan=w('newRequestCount');this.folder=ha;this.doNewMarkRead=ia;this.openTimestamp=0;this.$RequestsJewel1={};this.$RequestsJewel2=0;this.shouldClearPredictionAssocOnClick=false;var ja=w('requestsMarkReadButton');if(ja)p.listen(ja,'click',x(this.$RequestsJewel3,this));this.jewel.subscribe('marked-seen',x(this.$RequestsJewel4,this));this.jewel.subscribe('closed',x(this.$RequestsJewel5,this));this.jewel.subscribe('updated',this.$RequestsJewel6.bind(this));this.jewel.subscribe('opened',this.$RequestsJewel7.bind(this));q.registerHandler(this.$RequestsJewel8.bind(this));j.subscribe(m.getArbiterType('jewel_requests_add'),this.$RequestsJewel9.bind(this));j.subscribe(m.getArbiterType('jewel_friending_notifs'),this.$RequestsJewel10.bind(this));j.subscribe(m.getArbiterType('jewel_requests_remove_old'),this.$RequestsJewel11.bind(this));j.subscribe(m.getArbiterType('friend_requests_seen'),this.$RequestsJewel12.bind(this));p.listen(this.jewelFlyout,'submit',(function(la){var ma=r.byClass(la.getTarget(),'objectListItem');if(ma){n.removeClass(ma,'jewelItemNew');n.addClass(ma,'jewelItemResponded');}}).bind(this));var ka=o.find(w('fbRequestsJewel'),'a[rel="toggle"]');p.listen(ka,'focus',(function(la){i.logFocusIn();}).bind(this));this.setupScroll();p.listen(window,'resize',v((function(){this.$RequestsJewel13();}).bind(this)));}fa.prototype.setupScroll=function(){'use strict';var ga=o.scry(this.jewelFlyout,'.uiScrollableAreaWrap')[0];if(ga){this.$RequestsJewel14=ga;this.$RequestsJewel15=0;this.$RequestsJewel16=p.listen(ga,'scroll',this.$RequestsJewel17.bind(this),p.Priority.$RequestsJewel18);}};fa.prototype.fromDom=function(){'use strict';o.scry(this.jewelFlyout,'.jewelItemList li.objectListItem').forEach((function(ga){var ha=ga.getAttribute('id');if(ha){var ia=w(ha+'_status'),ja=this.$RequestsJewel19(ha);if(ja.requester)this.$RequestsJewel1[ja.requester]=ha;++this.$RequestsJewel2;}}).bind(this));this.$RequestsJewel20();};fa.prototype.$RequestsJewel21=function(ga){'use strict';var ha=ga.match(/^(\d+)_(\d+)/);return ha?{requester:ha[1],type:ha[2]}:undefined;};fa.prototype.$RequestsJewel19=function(ga){'use strict';var ha=ga?this.$RequestsJewel21(ga):undefined,ia;if(ha&&ha.requester){ia=parseInt(ha.requester,10);if(isNaN(ia))ia=undefined;}var ja;if(ha&&ha.type){ja=parseInt(ha.type,10);if(isNaN(ja))ja=undefined;}return {requester:ia,type:ja};};fa.prototype.$RequestsJewel22=function(){'use strict';if(this.countNew>0)this.countNew-=1;};fa.prototype.$RequestsJewel8=function(ga,event){'use strict';var ha=r.byClass(ga,'jewelItemNew');if(ha&&r.byClass(ha,'fbRequestList')&&r.byClass(ha,'beeperEnabled')){var ia=this.$RequestsJewel21(ha.id);ia&&this.$RequestsJewel4(ia.requester,ia.type);this.$RequestsJewel22();j.inform('jewel/count-updated',{jewel:'requests',count:this.countNew});n.removeClass(ha,'jewelItemNew');}return true;};fa.prototype.$RequestsJewel23=function(){'use strict';return o.scry(this.jewelFlyout,'.uiScrollableArea')[0];};fa.prototype.$RequestsJewel17=function(){'use strict';var ga=o.scry(this.$RequestsJewel14,'.uiMorePager');if(!ga)return;var ha=ga.pop();if(ha){var ia=t.getElementPosition(ha,'viewport').y;if(ia>0)n.addClass(r.byClass(this.$RequestsJewel14,'uiScrollableArea'),'contentAfter');var ja=o.find(ha,'a');if(!ja)return;var ka=t.getElementPosition(ja,'viewport').y;if(ka==this.$RequestsJewel15)return;var la=t.getElementPosition(this.$RequestsJewel14,'viewport').y+t.getElementDimensions(this.$RequestsJewel14).y;if(ka-300<la&&ka>0){this.$RequestsJewel15=ka;var ma=ja.getAttribute('ajaxify');if(ma){new k(ma).setRelativeTo(ja).setStatusElement(r.byClass(ja,'stat_elem')).send();}else ba&&ba.getInstance('jewel').showMore();}}};fa.prototype.$RequestsJewel10=function(ga,ha){'use strict';if(!ha||this.jewel.isOpen())return;if(ha.obj.notif_type!=='friend_confirmed')return;if(w('fbRequestsJewelLoading')){new k().setURI('/ajax/requests/loader/').send();return;}var ia={};ia.reloadcontent=true;new k().setURI('/ajax/requests/loader/').setData(ia).send();};fa.prototype.$RequestsJewel9=function(ga,ha){'use strict';if(!ha)return;var ia=ha.obj.from,ja=ha.obj.suggester,ka=this.$RequestsJewel19(this.$RequestsJewel1[ia]).type,la=ka===19&&!ja;if(!la&&(ka||this.jewel.isOpen()))return;if(w('fbRequestsJewelLoading')){new k().setURI('/ajax/requests/loader/').send();}else{var ma={};ma.reloadcontent=true;new k().setURI('/ajax/requests/loader/').setData(ma).send();}};fa.prototype.$RequestsJewel11=function(ga,ha){'use strict';if(!ha||this.jewel.isOpen()||w('fbRequestsJewelLoading')!==null)return;var ia=this.$RequestsJewel1[ha.obj.from],ja=ia&&w(ia);if(ja){if(n.hasClass(ja,'jewelItemNew')){this.$RequestsJewel22();j.inform('jewel/count-updated',{jewel:'requests',count:this.countNew});}if(!n.hasClass(ja,'jewelItemResponded')){o.remove(ja);delete this.$RequestsJewel1[ha.obj.from];--this.$RequestsJewel2;this.$RequestsJewel20();}}};fa.prototype.$RequestsJewel3=function(){'use strict';this.jewel.markSeen();this.$RequestsJewel24();};fa.prototype.$RequestsJewel4=function(ga,ha){'use strict';var ia=o.scry(this.jewelFlyout,'li');new l('/ajax/gigaboxx/endpoint/UpdateLastSeenTime.php',{folder:this.folder,first_item:ia[0].id}).send();var ja=typeof ga!='undefined'&&typeof ha!='undefined'?{requester:ga,type:ha}:{};this.doNewMarkRead&&new l('/ajax/requests/mark_read/',ja).send();};fa.prototype.$RequestsJewel12=function(ga,ha){'use strict';j.inform('jewel/count-updated',{jewel:'requests',count:0});};fa.prototype.$RequestsJewel24=function(ga,ha){'use strict';o.scry(this.jewel.root,'li.jewelItemNew').forEach(function(ia){n.removeClass(ia,'jewelItemNew');});};fa.prototype.$RequestsJewel6=function(ga,ha){'use strict';this.countNew=ha.count;n.conditionClass(this.jewelFlyout,'beeperUnread',this.countNew>0);n.conditionClass(this.jewelFlyoutCase,'showRequests',this.countNew>0);if(this.newCountSpan){var ia=this.countNew==1?y._("{num} NEW REQUEST",[y.param('num',this.countNew)]):y._({"*":"{num} NEW REQUESTS"},[y.param('num',this.countNew,[0])]);o.setContent(this.newCountSpan,ia);}};fa.prototype.$RequestsJewel20=function(){'use strict';o.scry(this.jewelFlyout,'li.empty').forEach((function(ga){n.conditionShow(ga,this.$RequestsJewel2<=0);}).bind(this));};fa.prototype.$RequestsJewel7=function(){'use strict';j.inform('requestsJewel/opened');var ga=w('fbRequestsJewelLoading'),ha=this.$RequestsJewel23();if(!ga&&!ha){this.unhandledRequest=true;}else if(ga){var ia=Date.now();if(this.openTimestamp+5000<ia){this.openTimestamp=ia;new k().setURI('/ajax/requests/loader/').setData({log_impressions:true}).send();}}else{var ja=Object.keys(this.$RequestsJewel1);if(ja.length>0)new k().setURI('/friends/requests/log_impressions').setData({ids:ja.join(','),ref:'jewel'}).send();}ha&&s.poke(ha);z.onJewelOpened();};fa.prototype.$RequestsJewel5=function(){'use strict';j.inform('requestsJewel/closed');this.$RequestsJewel24();};fa.prototype.$RequestsJewel25=function(){'use strict';return Math.min(Math.max(t.getViewportDimensions().y-ea,da),ca);};fa.prototype.$RequestsJewel13=function(){'use strict';if(this.$RequestsJewel23())new h(this.$RequestsJewel23()).to('height',this.$RequestsJewel25()+'px').duration(100).go();};fa.prototype.setHeight=function(){'use strict';this.$RequestsJewel23().style.height=this.$RequestsJewel25()+'px';};fa.prototype.maybeLoadJewel=function(){'use strict';if(this.unhandledRequest){this.unhandledRequest=false;this.$RequestsJewel7();}};f.exports=fa;},null);
__d('JewelX',['Event','Arbiter','ArbiterMixin','CSS','DOM','HTML','Keys','Promise','TabIsolation','Toggler','Run','csx','emptyFunction','reportData'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){if(c.__markCompiled)c.__markCompiled();var v=function(w,x){w&&x&&this.init(w,x);};Object.assign(v,{_instancesByName:{}});Object.assign(v.prototype,j,{init:function(w,x){this.name=x.name;this.root=w;this.badge=x.badge;this.countNew=0;this.initialCount=0;this.escHandler=null;this.bootload_module=x.bootload_module;this.bootload_args=x.bootload_args;this.bootloading=null;this.togglerInstance=q.getInstance(w).setSticky(false);r.onAfterLoad((function(){return this._setupBootload();}).bind(this));if(x.keepOpenForSnowlift)this.togglerInstance.setPrePageTransitionCallback(this._onPrePageTransition.bind(this));v._instancesByName[this.name]=this;var y=this.getFlyout(),z=new p(y);q.createInstance(y).setSticky(false);q.listen('show',this.root,(function(aa){this._logFirstClick();this.hasNew()&&this.markSeen();this.reset();i.inform('layer_shown',{type:'Jewel'});z.enable();this.setupEvents();return this._setupBootload().then((function(){this.inform('opened');}).bind(this));}).bind(this));q.listen('hide',this.root,(function(aa,ba){this.hasNew()&&this.markSeen();this.reset();this.inform('closed');i.inform('layer_hidden',{type:'Jewel'});z.disable();this.removeEvents();}).bind(this));i.subscribe('jewel/count-updated',(function(aa,ba){ba.jewel==this.name&&this.update(ba);}).bind(this));i.subscribe('jewel/focus',(function(aa,ba){if(this.isOpen())q.hide(this.root);}).bind(this));},getRoot:function(){return this.root;},getFlyout:function(){if(typeof this._flyout==='undefined')this._flyout=l.find(this.root,".__tw");return this._flyout;},hasNew:function(){return k.hasClass(this.root,'hasNew');},isOpen:function(){return k.hasClass(this.root,'openToggler');},reset:function(){k.removeClass(this.root,'hasNew');},setContent:function(w){var x=l.find(this.root,'ul.jewelItemList');l.setContent(x,m(w));},update:function(w){this.countNew=w.count;if(typeof this.countNew==='number'&&this.countNew<0)this.countNew=0;this.badge.setLegacyContent(this.countNew);var x=isNaN(this.countNew)||this.countNew>0;k.conditionClass(this.root,'hasNew',x);this.inform('updated',w);},setupEvents:function(){this.escHandler=h.listen(document.documentElement,'keydown',(function(w){if(w.keyCode===n.ESC&&this.isOpen())q.hide(this.root);}).bind(this));},removeEvents:function(){if(this.escHandler){this.escHandler.remove();this.escHandler=null;}},markSeen:function(){i.inform('jewel/count-updated',{jewel:this.name,count:0},i.BEHAVIOR_STATE);this.inform('marked-seen');},_onPrePageTransition:function(w,x){if(!this._isSnowliftURI(x.from)&&!this._isSnowliftURI(x.to))this.togglerInstance&&this.togglerInstance.hide();},_isSnowliftURI:function(w){return w&&w.getQueryData().hasOwnProperty('theater');},_logFirstClick:function(){this._logFirstClick=t;u('jewel_click',{gt:{count:this.countNew,initial:this.initialCount,jewel:this.name}});},_setupBootload:function(){if(!this.bootload_module)return o.resolve();if(!this.bootloading)this.bootloading=new o((function(w,x){this.bootload_module.load().then((function(y){new y(this,this.bootload_args);w();}).bind(this))['catch'](x);}).bind(this));return this.bootloading;}});f.exports=v;},null);
__d('LitestandNewsfeedCountUpdater',['Arbiter','AsyncRequest','LitestandMessages','NavigationMessage','WildWildWestJSGating','emptyFunction'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n,o,p=0;function q(){o&&clearTimeout(o);if(n)return;var u=l.badge_update_time;o=setTimeout(r,u);}function r(){if(n)return;new i().setURI('/ajax/litestand/newsfeed_count').setHandler(function(u){if(n)return;s(u.getPayload());q();}).setAllowCrossPageTransition(true).send();}function s(u){h.inform(j.UPDATE_HOME_COUNT,{count:u,onHome:n},h.BEHAVIOR_STATE);if(l.show_badge_bk){h.inform(k.NAVIGATION_COUNT_UPDATE,{key:'nf',count:n?0:u-p});p=u;}}var t={init:function(){t.init=m;h.subscribe(j.NEWSFEED_LOAD,function(){n=true;s(0);});h.subscribe(j.LEAVE_HOME,function(){n=false;q();});q();}};f.exports=t;},null);
__d('LitestandChromeHomeCount',['Arbiter','CSS','DOM','Event','LitestandMessages','LitestandNewsfeedCountUpdater','Parent','UserAgent_DEPRECATED','csx','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();var r=20,s,t,u,v,w,x={init:function(y){w=y;t=j.find(document,"div._uaw ._5ahz");s=t.parentNode;u=n.byClass(s,"_1ayn");v=false;h.subscribe(l.UPDATE_HOME_COUNT,function(z,aa){x.updateBadge(aa.onHome?0:aa.count);});k.listen(u,'click',function(event){var z=event.getModifiers();if(z.shift||o.osx()&&z.meta||o.windows()&&z.control)x.updateBadge(0);});m.init();x.updateBadge(w);},updateBadge:function(y){w=y;var z=y>0;x.toggleBadge(z);if(z){var aa=y>r?r+'+':y;j.setContent(t,aa);}},toggleBadge:function(y){if(v===y)return;v=y;i.conditionClass(s,"_5ahy",!y);}};f.exports=x;},null);
__d('MercuryJewelModuleLoader',['JSResource'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();f.exports=h('MercuryJewel');},null);
__d("RenderManager",[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){"use strict";this._isDirty=false;this._obj=i;}h.prototype.dirty=function(){"use strict";if(!this._isDirty){this._isDirty=true;setTimeout(this._doPaint.bind(this),0);}};h.prototype._doPaint=function(){"use strict";this._isDirty=false;this._obj.paint();};f.exports=h;},null);
__d('CounterDisplay',['Arbiter','CSS','DOM','RenderManager','Run','$','removeFromArray'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();function o(p,q,r,s,t,u){Object.assign(this,{_name:p,_valueNode:m(q),_wrapperNode:m(r)||null,_statusClass:t,_rm:new k(this),_arbiterSubscription:null,_count:0});var v=this._valueNode.firstChild;if(v){var w=parseInt(v.nodeValue,10);if(!isNaN(w))this._count=w;}this._statusNode=s?m(s):null;this._subscribeAll();o.instances.push(this);if(!u)l.onLeave(this._destroy.bind(this),true);}Object.assign(o,{EVENT_TYPE_ADJUST:'CounterDisplay/adjust',EVENT_TYPE_UPDATE:'CounterDisplay/update',instances:[],adjustCount:function(p,q){h.inform(o.EVENT_TYPE_ADJUST+'/'+p,q);},setCount:function(p,q){h.inform(o.EVENT_TYPE_UPDATE+'/'+p,q);}});Object.assign(o.prototype,{_destroy:function(){delete this._valueNode;delete this._wrapperNode;if(this._arbiterSubscription){this._arbiterSubscription.unsubscribe();delete this._arbiterSubscription;}n(o.instances,this);},adjustCount:function(p){this._count=Math.max(0,this._count+p);this._rm.dirty();return this;},setCount:function(p){this._count=Math.max(0,p);this._rm.dirty();return this;},paint:function(){j.setContent(this._valueNode,this._count);this._toggleNodes();},_toggleNodes:function(){if(this._wrapperNode)i.conditionClass(this._wrapperNode,'hidden_elem',this._count<=0);if(this._statusClass&&this._statusNode)i.conditionClass(this._statusNode,this._statusClass,this._count>0);},_subscribeAll:function(){var p=[o.EVENT_TYPE_ADJUST+'/'+this._name,o.EVENT_TYPE_UPDATE+'/'+this._name];this._arbiterSubscription=h.subscribe(p,this._onInform.bind(this),h.SUBSCRIBE_NEW);},_onInform:function(p,q){q=parseInt(q);if(isNaN(q))return;if(p.indexOf(o.EVENT_TYPE_ADJUST)!=-1){this.adjustCount(q);}else if(p.indexOf(o.EVENT_TYPE_UPDATE)!=-1){this.setCount(q);}else return;return;}});f.exports=o;},null);
__d('MessagingEvents',['Arbiter','ChannelConstants','arrayContains','isEmpty'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=Object.assign||function(p){for(var q=1;q<arguments.length;q++){var r=arguments[q];for(var s in r)if(Object.prototype.hasOwnProperty.call(r,s))p[s]=r[s];}return p;},m={},n=new h();function o(p){if(!k(m))return;for(var q in p)n.inform('count/'+q,p[q]);}n.subscribe('mark-as-read',function(p,q){(q.tids||q.chat_ids||[]).forEach(function(r){r=''+r;if(!(r in m)){m[r]=true;var s=function(){n.unsubscribe(t);clearTimeout(u);delete m[r];},t=n.subscribe('read',function(v,w){if(j(w.tids||[],r)||j(w.chat_ids||[],r))s();}),u=setTimeout(s,60000);}});});h.subscribe(i.getArbiterType('messaging'),function(p,q){var r=l({},q.obj),event=r.event||'';delete r.type;delete r.event;n.inform(event,r);if('unread_counts' in r){var s=r.unread_counts;o({unread:s.inbox,other_unseen:s.other});}});h.subscribe(i.getArbiterType('inbox'),function(p,q){var r=l({},q.obj);delete r.type;o(r);});b.MessagingEvents=f.exports=n;},3);
__d('TitanLeftNav',['CounterDisplay','MessagingEvents'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j={initialize:function(){i.subscribe('count/other_unseen',function(k,l){h.setCount('other_unseen',l);});}};f.exports=j;},null);
__d('AccessibilityShortcut',['AccessibilityLogger','Event','Focus','ge','onEnclosingPageletDestroy','warning'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n={init:function(o,p){var q=i.listen(o,'click',function(r){r.preventDefault();var s=k(p);if(s){j.set(s);h.logSRKey();}else m(s,'Failed to set focus on element with ID: %s',p);});l(o,function(){return q.remove();});}};f.exports=n;},null);
__d("isEmail",[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=/^[\w!#\$%&'\*\+\/\=\?\^`\{\|\}~\-]+(:?\.[\w!#\$%&'\*\+\/\=\?\^`\{\|\}~\-]+)*@(?:[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?$/i;function i(j){return h.test(j);}f.exports=i;},null);
__d('NotificationJewelReminderLoader',['JSResource'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();f.exports={init:function(i){h('NotificationJewelReminder').load().done(function(j){new j(i);});}};},null);
__d('PagesVoiceBar',['$','Arbiter','AsyncRequest','BlueBar','ChannelConstants','DOM','URI','ViewportBounds'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p='PagesVoiceBar/initialized',q='PagesVoiceBar/switchVoice',r='page_transition',s='pages_voice_bar_sync',t=null,u=null,v=false,w=false,x=o.addTop(0);function y(ea,fa){new j('/ajax/pages/switch_voice.php').setData(fa).setHandler(function(ga){ca();}).send();}function z(){t=null;}function aa(ea,fa){if(fa.obj.profile_id&&fa.obj.profile_id===t)ca();}function ba(ea){i.subscribe(p,ea);}function ca(){n.getNextURI().go();}var da={initVoiceBar:function(){if(w)return;u=h('pagesVoiceBarContent');i.subscribe(q,y);i.subscribe(r,z);i.subscribe(l.getArbiterType(s),aa);w=true;v=m.contains(k.getBar(),u);i.inform(p,null,i.BEHAVIOR_STATE);},update:function(ea,fa){ba(function(){t=fa;m.setContent(u,ea);var ga=u.offsetHeight;if(!v&&x.getSize()!==ga){x.remove();x=o.addTop(o.getTop()+ga);}});}};f.exports=da;},null);
__d('PrivacyLiteFlyout',['Animation','Arbiter','ArbiterMixin','AsyncDialog','AsyncRequest','Banzai','CSS','DOM','Ease','Event','PrivacyConst','Style','SubscriptionsHandler','Toggler','XPrivacyCheckupSpawnDialogController','XPrivacyRemindersDismissController','csx','cx','ge'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){if(c.__markCompiled)c.__markCompiled();var aa=Object.assign||function(ka){for(var la=1;la<arguments.length;la++){var ma=arguments[la];for(var na in ma)if(Object.prototype.hasOwnProperty.call(ma,na))ka[na]=ma[na];}return ka;},ba='PrivacyLiteFlyout/expandingSection',ca={},da={};function ea(ka,la,ma){var na=la?0:ka.offsetHeight;s.set(ka,'height',na+'px');s.set(ka,'overflow','hidden');n.show(ka);var oa=la?ka.scrollHeight:0,pa=o.getID(ka);ca[pa]&&ca[pa].stop();ca[pa]=new h(ka).to('height',oa).ondone(function(){ca[pa]=null;s.set(ka,'height','');s.set(ka,'overflow','');oa||n.hide(ka);ma();}).duration(Math.abs(oa-na)*1.5).ease(p.sineOut).go();}function fa(ka){var event='other_section';switch(ka){case 'who_can_see':case 'who_can_contact':case 'how_to_stop':event=ka;break;}return event;}var ga=null,ha=false,ia=false,ja=aa({loadBody:function(){this._loadBody(false);},loadBodyFromMegaphone:function(){this._loadBody(true);},_loadBody:function(ka){if(!ha&&z('fbPrivacyLiteFlyoutLoading')){ha=true;new l('/ajax/privacy/privacy_lite/loader').setData({from_megaphone:ka}).send();}},_addListener:function(ka,event,la){return q.listen(ka,'click',function(){m.post('privacy_lite',{event:event,exit_point:la});});},addLoggingElem:function(ka,event,la){var ma=this._loggingElements.length,na={elem:ka,event:event,exit:la};this._loggingElements[ma]=na;},registerSettingsAndBasicsLinkLogging:function(ka,event,la,ma){var na=o.scry(ka,"._5cw0")[0],oa=o.scry(ka,"._3djx")[0];if(na){this._settingsLinkListener&&this._settingsLinkListener.release();this._settingsLinkListener=this._addListener(na,event,la);}if(oa){this._privacyBasicsLinkListener&&this._privacyBasicsLinkListener.release();this._privacyBasicsLinkListener=this._addListener(oa,event,ma);}},_subscribeListeners:function(){this._loggingElements&&this._loggingElements.forEach(function(ka){this._subscriptions&&this._subscriptions.addSubscriptions(this._addListener(ka.elem,ka.event,ka.exit));},this);},renderBody:function(ka,la){var ma=z('fbPrivacyLiteFlyoutLoading');if(ma){o.replace(ma,ka);ja.registerCallback(function(){ja.inform('load',null,i.BEHAVIOR_STATE);},la);}},hideCleanup:function(ka){i.inform(ba);var la=o.scry(ka,"._2va0").forEach(function(ma){n.removeClass(ma,"_2va0");});},registerFlyoutToggler:function(ka,la,ma){this._loggingElements=[];ga=la;var na=u.createInstance(ka);na.setSticky(false);u.listen(['show','hide'],la,(function(oa){ja.inform(oa);ia=oa==='show';if(!ia){ja.hideCleanup(ka);na.hide();this._subscriptions&&this._subscriptions.release();this._subscriptions=null;i.inform('layer_hidden',{type:'PrivacyShortcutsFlyout'});}else{i.inform('layer_shown',{type:'PrivacyShortcutsFlyout'});if(ma){ma.start(this);ma=null;}i.subscribeOnce(ba,(function(){this._subscriptions&&this._subscriptions.release();this._subscriptions=new t();this._subscribeListeners();}).bind(this));m.post('privacy_lite',{event:'show_flyout',exit_point:null});}}).bind(this));},isFlyoutVisible:function(){return ga&&u.getActive()===ga;},exists:function(){return !!o.scry(document.body,"._59fc")[0];},setFlyoutVisible:function(ka){ka?u.show(ga):u.hide(ga);},showSection:function(ka){var la=da[ka];if(!la)return;if(!la.sublist_container){ja.inform('expanded',ka,i.BEHAVIOR_STATE);return;}var ma=la.chevron,na=la.sublist_container;i.inform(ba,ma);if(ja.inform('expand',ka)!==false){n.removeClass(ma,"_9or");n.addClass(ma,"_9os");ea(na,true,function(){ja.inform('expanded',ka);});}},hideSection:function(ka,la,ma){var na=da[ka],oa=na.chevron,pa=na.sublist_container;if(ma===oa)return;if(ja.inform('collapse',ka)!==false){n.addClass(oa,"_9or");n.removeClass(oa,"_9os");ea(pa,false,function(){ja.inform('collapsed',ka);});}},toggleSection:function(ka){var la=da[ka].chevron;u.getInstance(la).hide();if(n.hasClass(la,"_9or")){ja.showSection(ka);m.post('privacy_lite',{event:fa(ka)+'_expand',exit_point:null});new l('/ajax/privacy/privacy_lite/log_section_expand').setData({section:ka}).send();}else{ja.hideSection(ka);m.post('privacy_lite',{event:fa(ka)+'_collapse',exit_point:null});}},registerSection:function(ka,la){da[ka]=la;if(la.sublist_container){i.subscribe(ba,ja.hideSection.bind(null,ka));q.listen(la.section_block,'click',ja.toggleSection.bind(null,ka));}ja.inform(ka);},registerInlineHelpOnAudienceChangeNewSelector:function(ka,la,ma,na){ka=ka.getInstance();ka.subscribe('changed',(function(oa){this._registerInlineHelpOnAudienceChange(la,ma,na,ka.getSelectedBaseValue());}).bind(this));},registerSelectorLogging:function(ka,la,ma,na){ka=ka.getInstance();ka.subscribe('open',function(){m.post('privacy_lite',{event:la,exit_point:null});});ka.subscribe('close',function(){m.post('privacy_lite',{event:ma,exit_point:null});});ka.subscribe('changed',function(){m.post('privacy_lite',{event:na,exit_point:null});});},_registerInlineHelpOnAudienceChange:function(ka,la,ma,na){var oa=o.find(ka,"._9o_"),pa=o.find(ka,"._2v9_");if(ma){var qa=o.find(ka,"._5n9w"),ra=na==r.BaseValue.EVERYONE;n.conditionShow(qa,ra);n.conditionShow(oa,!ra);if(qa&&ra){var sa=w.getURIBuilder().setString('type','delta_everyone').setBool('log_plite',true).getURI();new l(sa).send();}}else n.show(oa);n.hide(pa);if(la)new l('/ajax/privacy/privacy_lite/kill_intro').send();},registerInlineHelpXOutOnClick:function(ka,la,ma){q.listen(ka,'click',function(){n.addClass(la,"_9p0");});},registerBlockUnhideOnFocus:function(ka,la){q.listen(ka,'focus',(function(ma){n.show(ma);m.post('privacy_lite',{event:'block_user_input_click',exit_point:null});}).bind(this,la));},registerMessageFilterSettingOnClick:function(ka,la){var ma=o.find(ka,"._fv0");q.listen(ka,'click',function(){if(ma.checked){new l('/ajax/mercury/change_filtering_type.php').setData({filtering_type:la,source:'privacy_lite'}).send();}else{var event='basic_filtering';if(la==='strict')event='strict_filtering';m.post('privacy_lite',{event:event,exit_point:null});}});},registerPrivacyCheckupListener:function(ka){q.listen(ka,'click',(function(){this.setFlyoutVisible(false);k.send(new l(v.getURIBuilder().setEnum('source','plite').getURI()));m.post('privacy_lite',{event:'exit_flyout',exit_point:'privacy_checkup'});}).bind(this));},displayPrivacyCheckup:function(ka){ka.show();}},j);f.exports=ja;},null);
__d('PrivacyLiteFlyoutHelp',['Event','Arbiter','AsyncRequest','Banzai','ContextualHelpSearchController','CSS','DOM','Parent','csx','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();var r,s;function t(u,v,w,x,y){this._width=315;s=n.find(v,'input');var z=n.create('div');this.init(u,s,z,w,x,{focusSearchBox:false});r=o.byClass(v,"_8-a");h.listen(y,'click',(function(){this._hideSearch(this);k.post('privacy_lite',{event:'plite_search_collapse',exit_point:null});}).bind(this));i.subscribe('PrivacyLiteFlyout/expandingSection',this._hideSearch.bind(this));var aa=n.scry(r,"._d1r")[0];aa&&h.listen(aa,'click',(function(){m.addClass(r,"_aw6");s.focus();k.post('privacy_lite',{event:'plite_search_expand',exit_point:null});if(!this.suggestedResults)new j('/ajax/privacy/privacy_lite/help_suggestions').setHandler((function(ba){var ca=ba.getPayload().searchSuggestions,da=n.find(r,"._4_8m");n.setContent(da,ca);m.addClass(r,"_4_8l");}).bind(this)).send();}).bind(this));}Object.assign(t.prototype,new l(),l.prototype,{source:'privacy_shortcuts',_hideSearch:function(){this.clearResults();m.removeClass(r,"_aw6");},show:function(u){if(u===this.topics_area){m.removeClass(r,"_aw7");return;}else if(u===this.loader){m.addClass(r,"_aw7");m.hide(this.results_area);}else m.hide(this.loader);m.show(u);}});f.exports=t;},null);
__d('ViewasChromeBar',['Event','Arbiter','AsyncRequest','CSS','DOM','Focus','ModalMask','PageTransitionsRegistrar','Parent','cx','csx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){if(c.__markCompiled)c.__markCompiled();var s='ViewasChromeBar/initialized',t=null,u=false;function v(y){i.subscribe(s,y);}function w(y){k.addClass(y,"_7g7");var z=l.find(y,"._7g0");m.set(l.find(z,'.textInput'));}var x={initChromeBar:function(y){if(u)return;t=y;u=true;i.inform(s,null,i.BEHAVIOR_STATE);},update:function(y,z){v(function(){l.setContent(t,y);if(z)new j('/ajax/privacy/glasgow/viewas_bar_flyout_open').send();});},registerSpecificModeOnClick:function(y){h.listen(y,'click',w.bind(null,p.byClass(y,"_7f-")));},registerFlyoutModalMask:function(){n.show();o.registerHandler(n.hide,10);}};f.exports=x;},null);
__d('SearchSingleState',['fbt'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(k,l,m,n){return {classNames:'grammar',groupIndex:0,indexInGroup:k,path:l,text:m,type:'grammar',uid:n};}var j={getSuggestions:function(k,l,m){if(m==='ent:user'){return this.getSuggestionsForUser(k,l);}else if(m==='ent:page'){return this.getSuggestionsForPage(k,l);}else if(m==='ent:app'){return this.getSuggestionsForApp(k,l);}else if(m==='ent:group')return this.getSuggestionsForGroup(k,l);},getSuggestionsForUser:function(k,l){return [i(0,'/search/'+k+'/photos-of',h._("photos of {full name}",[h.param('full name',l)]),'photos_of_user'),i(1,'/search/'+k+'/friends',h._("friends of {full name}",[h.param('full name',l)]),'friends_of_user'),i(2,'/search/'+k+'/pages-liked',h._("favorite pages of {full name}",[h.param('full name',l)]),'pages_liked_user'),i(3,'/search/str/'+l+'/users-named',h._("find all people named \"{full name}\"",[h.param('full name',l)]),'people_named_text')];},getSuggestionsForPage:function(k,l){return [i(0,'/search/'+k+'/photos-of',h._("photos of {name of page}",[h.param('name of page',l)]),'photos_of_page'),i(1,'/search/'+k+'/likers',h._("people who like {name of page}",[h.param('name of page',l)]),'page_likers'),i(2,'/search/str/'+l+'/pages-named',h._("find all pages named \"{name of page}\"",[h.param('name of page',l)]),'pages_named_text')];},getSuggestionsForGroup:function(k,l){return [i(0,'/search/'+k+'/members',h._("{name of group} members",[h.param('name of group',l)]),'members_of_group'),i(1,'/search/'+k+'/photos-in',h._("photos in {name of groups}",[h.param('name of groups',l)]),'photos_in_group'),i(2,'/search/'+k+'/creators',h._("{name of group} creators",[h.param('name of group',l)]),'creators_of_group'),i(3,'/search/'+k+'/admins',h._("{name of group} administrators",[h.param('name of group',l)]),'admins_of_group')];},getSuggestionsForApp:function(k,l){return [i(0,'/search/'+k+'/apps-similar-to',h._("apps similar to {name of app}",[h.param('name of app',l)]),'similar_apps'),i(1,'/search/'+k+'/app-users',h._("people who use {name of app}",[h.param('name of app',l)]),'app_users'),i(2,'/search/str/'+l+'/pages-named',h._("find all apps named \"{name of page}\"",[h.param('name of page',l)]),'apps_named_text')];}};f.exports=j;},null);
__d('SearchDataSource',['Event','Arbiter','AsyncResponse','DataSource','HashtagSearchResultUtils','createArrayFromMixed','PageTransitionsRegistrar','SearchSingleState','UnicodeCJK','FacebarJSConstants','debounce','errorCode'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){if(c.__markCompiled)c.__markCompiled();var t=Object.assign||function(z){for(var aa=1;aa<arguments.length;aa++){var ba=arguments[aa];for(var ca in ba)if(Object.prototype.hasOwnProperty.call(ba,ca))z[ca]=ba[ca];}return z;},u,v,w=100,x='/typeahead/search/facebar/nullstate/';u=k;v=u&&u.prototype;Object.assign(y,u);y.prototype=Object.create(u.prototype);y.prototype.constructor=y;y.__superConstructor__=u;function y(z){'use strict';v.constructor.call(this,z);this._token=z.token||'';this._lazyonload=z.lazyonload===false?false:true;this._extraTypes=z.extraTypes;this._buckets=z.buckets;this._noMultiFetch=z.noMultiFetch||false;this._nullStateConfig=z.nullStateConfig||{};var aa=z.maxResults||8;this._numResults={min:3,max:aa};this.recordingRoute='non_banzai';this._enabledHashtag=z.enabledHashtag||false;this.logBackendQueriesWindow=z.logBackendQueriesWindow||25;this._genTime=z.genTime;this._bootstrapError=false;this._hasKeywordBootstrap=z.hasKeywordBootstrap||false;this.cacheUnicodeMatch.setConfigs({prefix_hangul_conjoining_jamo:true,prefix_kana_drop_trailing_latin:z.cjkDropLatinInCjTokens,prefix_kana_hiragana_to_katakana:z.cjkUiCacheHiraganaToKatakana});this.backendUnicodeMatch.setConfigs({prefix_kana_drop_trailing_latin:z.cjkDropLatinInCjTokens});}y.prototype.init=function(){'use strict';v.init.call(this);this._leanPayload=null;this._bootstrapRequestsPending=0;this._criticalOnly=true;this._updateMaxResults();var z=r(this._updateMaxResults,w,this,true);h.listen(window,'resize',z);if(this._nullStateConfig.prefetchNullState)this.fetchNullState('');if(this._nullStateConfig.singleState)i.subscribe('page_transition',this.handlePageTransition.bind(this));if(this._nullStateConfig.prefetchNullState||this._nullStateConfig.singleState)i.subscribe('search/updateNullState',this.updateNullState.bind(this));if(this._nullStateConfig.recent)i.subscribe('search/refreshRecentSearchesNullstate',this.refreshRecentSearches.bind(this));};y.prototype.refreshRecentSearches=function(){'use strict';this.nullStateData=null;};y.prototype.handlePageTransition=function(){'use strict';this.nullStateParams={};};y.prototype.updateNullState=function(event,z){'use strict';this.nullStateParams=z;this.fetchNullState();};y.prototype.markResultsAsNullState=function(z){'use strict';if(z)for(var aa=z,ba=Array.isArray(aa),ca=0,aa=ba?aa:aa[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var da;if(ba){if(ca>=aa.length)break;da=aa[ca++];}else{ca=aa.next();if(ca.done)break;da=ca.value;}var ea=da;ea.isNullState=true;}};y.prototype.markResultsAsSingleState=function(z){'use strict';if(z)for(var aa=z,ba=Array.isArray(aa),ca=0,aa=ba?aa:aa[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var da;if(ba){if(ca>=aa.length)break;da=aa[ca++];}else{ca=aa.next();if(ca.done)break;da=ca.value;}var ea=da;ea.isSingleState=true;}};y.prototype.fetchNullState=function(z){'use strict';this.lastNullOrSingleStateFetchStartTime=Date.now();if(!this._nullStateConfig.hasNullState)return;var aa=null;if(this.nullStateParams&&this.nullStateParams.uid){this.nullStateParams.query=z||'';aa=this._fetchDataForSingleState();this.markResultsAsNullState(aa);}else{aa=this._fetchDataForNullState();this.markResultsAsSingleState(aa);}if(aa)this.inform('respond',{value:this.nullStateParams?this.nullStateParams.query:'',results:aa,isAsync:false,nullState:true});};y.prototype._fetchDataForSingleState=function(){'use strict';if(this.nullStateDataWithProfile&&this.nullStateParams.uid===this.nullStateDataWithProfile.profileID)return this.nullStateDataWithProfile.data;if(this.nullStateParams.type==='ent:app'||this.nullStateParams.type==='ent:group'||this.nullStateParams.type==='ent:page'){this.fetch(x,{profile_id:this.nullStateParams.uid,ent_type:this.nullStateParams.type},{singleState:true});this.nullStateDataWithProfile={profileID:this.nullStateParams.uid};return;}var z=o.getSuggestions(this.nullStateParams.uid,this.nullStateParams.text,this.nullStateParams.type);if(!z)return this._fetchDataForNullState();this.nullStateDataWithProfile={data:z,profileID:this.nullStateParams.uid};return z;};y.prototype._shouldRefreshNullState=function(){'use strict';if(!this._nullStateConfig.recent)return false;var z=window.location.href;if(!z)return false;if(z.contains('allactivity')&&z.contains('log_filter=search'))return true;return false;};y.prototype._fetchDataForNullState=function(){'use strict';if(this.nullStateData&&!this._shouldRefreshNullState()){this.markResultsAsNullState(this.nullStateData);setTimeout((function(){this.inform('respond',{value:'',results:this.nullStateData,isAsync:true,nullState:true});}).bind(this),0);return;}if(!this.fetchingNullState){this.fetchingNullState=true;this.fetch(x,{value:""},{nullState:true,value:''});}return null;};y.prototype.dirty=function(){'use strict';v.dirty.call(this);this._bootstrapError=false;this._fetchOnUseRequests=[];};y.prototype.asyncErrorHandler=function(z,aa){'use strict';if(aa.nullState)this.fetchingNullState=false;if(aa.bootstrap)this._bootstrapError=true;this.inform('fetchError',{response:z,fetch_context:aa});if(window.Dialog&&window.Dialog.getCurrent()==null&&z.getError()==1400003)j.verboseErrorHandler(z);};y.prototype.fetch=function(z,aa,ba){'use strict';ba=ba||{};ba.fetch_start=Date.now();var ca=n.getMostRecentURI().path;aa=t({},aa,{path:ca});v.fetch.call(this,z,aa,ba);};y.prototype.fetchHandler=function(z,aa){'use strict';if(aa.nullState){this.fetchingNullState=false;this.nullStateData=z.getPayload().entries;this.markResultsAsNullState(this.nullStateData);this.inform('respond',{value:'',results:this.nullStateData,isAsync:true,nullState:true});return;}if(aa.singleState){this.nullStateDataWithProfile.data=z.getPayload().entries;this.markResultsAsSingleState(this.nullStateDataWithProfile.data);this.inform('respond',{results:this.nullStateDataWithProfile.data,isAsync:true,value:this.nullStateParams?this.nullStateParams.query:'',nullState:true});return;}var ba=z.getPayload(),ca=t({fetch_end:Date.now()},aa),da=ca.value?i.BEHAVIOR_EVENT:i.BEHAVIOR_PERSISTENT;this.inform('beginFetchHandler',{response:z});if(aa.bootstrap)this._bootstrapError=false;if(aa.type=='lean'){this._leanPayload=ba;this._processLean();}else{if(ba.coeff2_ts)ca.coeff2_ts=ba.coeff2_ts;v.fetchHandler.call(this,z,aa);if(aa.bootstrap&&!z.getRequest().getData().no_cache)ca.browserCacheHit=ba.timestamp<this._genTime;if(aa.bootstrap&&!ba.no_data&&this._bootstrapRequestsPending>0){aa.bootstrap=false;--this._bootstrapRequestsPending;!this._bootstrapRequestsPending&&this._bootstrapPostProcess();}if(ba.no_data||ba.stale||ba.token!==this._token){var ea=t({},z.getRequest().getData());if(ea.lazy){delete ea.lazy;ea.token=this._token;this._fetchOnUse(ea,aa);}}}this.inform('endpointStats',{info:ca,response:z},da);if(aa&&!!aa.value)this.inform('completeFetch',{response:z,stats:ca});};y.prototype.respond=function(z,aa,ba){'use strict';this.inform('respondValidUids',aa);this.inform('reorderResults',aa);var ca=this.buildData(aa,z);ca.forEach(function(da,ea){da.origIndex=ea;da.fromCache=!ba;});this.inform('respond',{value:z,results:ca,isAsync:!!ba});return ca;};y.prototype.buildData=function(z,aa){'use strict';if(!z||z.length===0)return [];var ba=z.map(this.getEntry,this);ba.length=Math.min(ba.length,this._maxResults);return ba;};y.prototype.fetchLean=function(){'use strict';this._fetchLean();};y.prototype._isQueryTooShort=function(z){'use strict';return z.length<this._minQueryLength&&!p.hasIdeoOrSyll(z);};y.prototype.shouldFetchMoreResults=function(z){'use strict';return z.length<this._maxResults;};y.prototype._bootstrapPostProcess=function(){'use strict';var z={time:Date.now()};this.inform('bootstrapped',z,i.BEHAVIOR_PERSISTENT);this._processLean();};y.prototype._processLean=function(){'use strict';if(this._leanPayload){var z,aa=this._leanPayload.entries;for(var ba in aa){z=this.getEntry(ba);z&&(z.index=aa[ba]);}this.setExclusions(this._leanPayload.blocked);this._leanPayload=null;}};y.prototype._updateMaxResults=function(){'use strict';var z=window.innerHeight||document.documentElement.clientHeight;this.setMaxResults(Math.max(this._numResults.min,Math.min(this._numResults.max,Math.ceil(2+(z-370)/56))));};y.prototype._bootstrapFetch=function(z,aa){'use strict';var ba=t({},aa,this.bootstrapData);if(this._criticalOnly&&this._lazyonload)ba.lazy=1;this.fetch(this.bootstrapEndpoint,ba,{bootstrap:true,type:z});++this._bootstrapRequestsPending;};y.prototype._fetchOnUse=function(z,aa){'use strict';for(var ba in this.bootstrapData)!z.hasOwnProperty(ba)&&(z[ba]=this.bootstrapData[ba]);if(this._criticalOnly){this._fetchOnUseRequests.push({args:z,ctx:aa});}else this.fetch(this.bootstrapEndpoint,z,aa);};y.prototype._fetchLean=function(){'use strict';var z={no_cache:1};z.options=m(z.options);z.options.push('lean');this._fetchOnUse(z,{type:'lean'});};y.prototype.bootstrap=function(z){'use strict';if(!z){this._criticalOnly=false;this._flushFetchOnUseRequests();}if(this._bootstrapped)return;var aa={filter:['event'],no_cache:1};this._fetchOnUse(aa,{type:'event'});var ba=['app','page','group','friendlist'];ba=ba.concat(this._extraTypes||[]);var ca=[];if(this._hasKeywordBootstrap)ca.push(q.keywordType);if(this._noMultiFetch){ba.push('user');ba.concat(ca);this._bootstrapFetch('user',{filter:ba});}else{this._bootstrapFetch('other',{filter:ba});if(this._buckets){for(var da=0;da<this._buckets.length;++da){var ea={filter:['user'],buckets:this._buckets[da]};this._bootstrapFetch('user',ea);}}else this._bootstrapFetch('user',{filter:['user']});if(ca.length>0)this._bootstrapFetch('keyword',{filter:ca});}this._fetchLean();this._bootstrapped=true;};y.prototype.getBootstrapError=function(){'use strict';return this._bootstrapError;};y.prototype._flushFetchOnUseRequests=function(){'use strict';var z=this._fetchOnUseRequests.length;for(var aa=0;aa<z;++aa){var ba=this._fetchOnUseRequests[aa];this.fetch(this.bootstrapEndpoint,ba.args,ba.ctx);}if(z>0)this.inform('extra_bootstrap',{time:Date.now()},i.BEHAVIOR_PERSISTENT);this._fetchOnUseRequests=[];};y.prototype.onLoad=function(z,aa){'use strict';this.inform('onload',{time:Date.now()},i.BEHAVIOR_PERSISTENT);if(z)setTimeout(this.bootstrap.bind(this,aa),0);};y.prototype.mergeUids=function(z,aa,ba,ca){'use strict';var da=this.getDynamicHashtagResult(ca);if(ca&&da&&aa.indexOf(da)<=0)aa.unshift(da);var ea=ba[0]?this.getEntry(ba[0]):null,fa=aa[0]?this.getEntry(aa[0]):null,ga=ea&&ea.replace_results?ea:null;ga=!ga&&fa&&fa.replace_results?fa:ga;var ha=v.mergeUids.call(this,z,aa,ba,ca);if(ga){this.inform('backend_topreplace',{});return this.deduplicateByKey([ga.uid].concat(ha));}return ha;};y.prototype.getTextToIndexFromFields=function(z,aa){'use strict';var ba=[],ca=z.tokenVersion==="v2";for(var da=0;da<aa.length;++da){if(ca&&(aa[da]==="text"||aa[da]==="alias"))continue;var ea=z[aa[da]];if(ea)ba.push(ea.join?ea.join(' '):ea);}return ba.join(' ');};y.prototype.getDynamicHashtagResult=function(z){'use strict';if(!z||!this._enabledHashtag)return;var aa=l.getHashtagFromQuery(z);if(!aa)return;var ba='hashtag:'+aa,ca=this.getEntry(ba);if(!ca)this.processEntries([l.makeTypeaheadResult(aa)],z);return ba;};f.exports=y;},null);
__d('legacy:SearchDataSource',['SearchDataSource'],function a(b,c,d,e){if(c.__markCompiled)c.__markCompiled();b.SearchDataSource=c('SearchDataSource');},3);
__d('SearchTypeaheadCore',['Arbiter','DOM','Event','Input','Keys','Parent','ScriptPath','TypeaheadCore'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p,q;p=o;q=p&&p.prototype;Object.assign(r,p);r.prototype=Object.create(p.prototype);r.prototype.constructor=r;r.__superConstructor__=p;function r(s){'use strict';q.constructor.call(this,s);}r.prototype.init=function(s,t,u){'use strict';q.init.call(this,s,t,u);var v=m.byTag(u,'form'),w=this.reset.bind(this);h.subscribe('pre_page_transition',function(event,y){var z=/^\/search/,aa=z.test(y.from.path),ba=z.test(y.to.path);if(aa&&!ba)setTimeout(w,0);});if(v){var x=i.find(v,'input.search_sid_input');j.listen(v,'submit',(function(){if(this.data&&this.data.queryData)x.value=this.data.queryData.sid;setTimeout(w,0);}).bind(this),j.Priority.URGENT);}};r.prototype.select=function(){'use strict';this.reset();this.element.focus();setTimeout((function(){this.element.blur();}).bind(this),0);n.setClickPointInfo({click:'Search'});};r.prototype.handleTab=function(event){'use strict';var s=this.view.getQuerySuggestion(this.value);if(s){k.setValue(this.element,s);this.checkValue();event.kill();}else q.handleTab.call(this,event);};r.prototype.getSearchType=function(){'use strict';return 'regular';};r.prototype.focus=function(){'use strict';q.focus.call(this);if(this.getValue().length===0||this.element.getAttribute('singlestate')==='true')this.data.fetchNullState(this.getValue());};r.prototype.keyup=function(event){'use strict';if(this.getValue().length===0&&j.getKeyCode(event)===l.ESC)return;if(this.getValue().length===0)this.data.fetchNullState(this.getValue());this.element.setAttribute('singlestate',false);};f.exports=r;},null);
__d('legacy:SearchTypeaheadCore',['SearchTypeaheadCore'],function a(b,c,d,e){if(c.__markCompiled)c.__markCompiled();b.SearchTypeaheadCore=c('SearchTypeaheadCore');},3);
__d('SearchPeopleFriendsOf',['TokenizeUtil','URI','fbt'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();function k(l,m){'use strict';this.friendsOfUri=l;this.placementStrategy=m.placement_strategy;this.placementParams=m.placement_params;this.triggerStrategy=m.trigger_strategy;this.triggerParams=m.trigger_params;}k.prototype.injectInto=function(l,m){'use strict';if(!l||l.length===0||!this.$SearchPeopleFriendsOf1(l,m))return;if(l[0].type!=="user")return;var n=this.createFindAllFriendsOf(l[0].text,l[0].uid);this.$SearchPeopleFriendsOf2(n,l);};k.prototype.$SearchPeopleFriendsOf2=function(l,m){'use strict';var n=this.$SearchPeopleFriendsOf3(m);if(n==='last'){var o=m.filter(function(p){return p.type==='user';}).length;n=o;}m.splice(n,0,l);};k.prototype.$SearchPeopleFriendsOf1=function(l,m){'use strict';var n=this.$SearchPeopleFriendsOf4(this.triggerStrategy);return n(l,this.triggerParams,m);};k.prototype.$SearchPeopleFriendsOf3=function(l){'use strict';var m=this.$SearchPeopleFriendsOf4(this.placementStrategy);return m(l,this.placementParams);};k.prototype.$SearchPeopleFriendsOf4=function(l){'use strict';return this["$SearchPeopleFriendsOf_"+l];};k.prototype.$SearchPeopleFriendsOf5=function(l,m,n){'use strict';return false;};k.prototype.$SearchPeopleFriendsOf6=function(l,m,n){'use strict';return true;};k.prototype.$SearchPeopleFriendsOf7=function(l,m,n){'use strict';var o=parseInt(m,10),p=0;for(var q=0;q<l.length;q++){var r=l[q];if(r.type==='user'&&r.index_rank==-1)p++;if(p>o)return false;}return true;};k.prototype.$SearchPeopleFriendsOf8=function(l,m,n){'use strict';var o=parseInt(m,10),p=h.tokenize(n);p=p.map(function(x){return x.toLowerCase();});var q=0;for(var r=0;r<l.length;r++){var s=l[r];if(s.type!=='user'||s.index_rank!=-1)continue;var t=h.tokenize(s.text);t=t.map(function(x){return x.toLowerCase();});if(t.length<p.length)continue;var u=true;for(var v=0;v<p.length-1;v++)if(p[v]!==t[v]){u=false;break;}var w=p.length-1;if(u&&t[w].startsWith(p[w])){q++;if(q>=o)return false;}}return true;};k.prototype.$SearchPeopleFriendsOf9=function(l,m){'use strict';return "last";};k.prototype.$SearchPeopleFriendsOf10=function(l,m){'use strict';return 1;};k.prototype.createFindAllFriendsOf=function(l,m){'use strict';var n=j._("{name}'s Friends",[j.param('name',l)]),o=new i(this.friendsOfUri).addQueryData({q:"",init:'psm',fofid:m}).toString();return {uid:'people_search',type:'user',text:n,classNames:'seeAllUser',photo:'/images/search_typeahead/people_see_more.png',logType:'grammar',path:o};};f.exports=k;},null);
__d('SearchTypeaheadView',['Arbiter','ContextualLayerUpdateOnScroll','ContextualTypeaheadView','DOM','goURI','MusicConstants','MusicEvents','SearchPeopleSeeMore','SearchPeopleSeeMoreOptions','SearchPeopleFriendsOf','SearchPeopleFriendsOfOptions','URI','fbt','isEmail'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){if(c.__markCompiled)c.__markCompiled();var v=Object.assign||function(aa){for(var ba=1;ba<arguments.length;ba++){var ca=arguments[ba];for(var da in ca)if(Object.prototype.hasOwnProperty.call(ca,da))aa[da]=ca[da];}return aa;},w,x;w=j;x=w&&w.prototype;Object.assign(y,w);y.prototype=Object.create(w.prototype);y.prototype.constructor=y;y.__superConstructor__=w;function y(aa,ba){'use strict';x.constructor.call(this,aa,ba);this._peopleSeeMore=new o(this.getSeeMoreEndpoint('',true),p);this._peopleFriendsOf=new q(this.getSeeMoreEndpoint('',true),r);}y.prototype.initializeLayer=function(){'use strict';x.initializeLayer.call(this);this.layer.setOffsetY(-1);this.layer.enableBehavior(i);};y.prototype.ignoreClick=function(event){'use strict';event.prevent();};y.prototype.render=function(aa,ba,ca){'use strict';if(!ba)return;if(this._bucketize)ba=z(ba);if(this.showPeopleSeeMore&&aa)this._peopleSeeMore.injectInto(ba,aa);if(this.showPeopleFriendsOf&&aa)this._peopleFriendsOf.injectInto(ba,aa);var da={results:ba,value:aa};this.inform('finalResultsReordering',da);return x.render.call(this,aa,da.results,ca);};y.prototype.disableBucketization=function(){'use strict';this._bucketize=false;};y.prototype.buildBuckets=function(aa,ba){'use strict';var ca=ba.length,da=0,ea;for(ea=0;ea<ca;++ea)if(ba[ea].type=='user')da++;this._redirectToUsersResultsPage=this.showFilterResults&&da===ca;this.setWebSuggLoggingParams(aa,ba);if(!aa&&this.showFindPeople)ba.unshift(this.buildFindPeople());if(this._bucketize)ba=x.buildBuckets.call(this,aa,ba);if(aa&&this._shouldShowSeeMore){ba.push(this.buildSeeMore(aa,ca));if(u(aa)&&da<1)ba.push(this.buildInvite(aa));}return ba;};y.prototype.buildFindPeople=function(){'use strict';var aa=t._("Find people");return {classNames:'seeAllUser seeAllUserNullState',logType:'grammar',path:this.getSeeMoreEndpoint(null,true),photo:'/images/search_typeahead/people_see_more.png',text:aa,type:'no_header'};};y.prototype.buildSeeMore=function(aa,ba){'use strict';var ca=this.getSeeMoreText(aa,ba),da=this.getSeeMoreSubtext(ba),ea,fa,ga,ha='',ia='',ja='',ka='';if(this.showseemorev2){fa='seeMoreV2';ga='calltoactionV2';ja=k.create('span',{className:'simpleSearchSeeMoreRowRedesignIcon'});ka=k.create('span',{className:'seeMoreV2Query'},[' '+aa]);}else{fa='seeMore';ga='calltoaction';ha=k.create('span',{className:'arrow'});ia=k.create('span',{className:'subtext'},[da]);}ea=k.create('li',{className:ga},[ja,k.create('a',{href:this.getSeeMoreEndpoint(aa),rel:'ignore'},[k.create('span',{className:'text'},[k.create('span',{className:fa},[ca,ka,ha]),ia])])]);ea.setAttribute('aria-label',ca);return {uid:'search',node:ea,search:true};};y.prototype.getSeeMoreText=function(aa,ba){'use strict';if(this.showKeywordResultsPage)return t._("Search for {query}",[t.param('query',aa)]);if(ba<=0)return t._("See results for {query}",[t.param('query',aa)]);if(this._redirectToUsersResultsPage)return t._("Filter results for {query}",[t.param('query',aa)]);if(this.showseemorev2){return t._("Find more results for");}else return t._(["See more results for {query}","44e6d113d67af68d7209174cf9420c3d"],[t.param('query',aa)]);};y.prototype.getSeeMoreSubtext=function(aa){'use strict';if(aa===0)return t._("No results to display");if(aa===1)return t._("Displaying top result");return t._({"*":"Displaying top {number} results"},[t.param('number',aa,[0])]);};y.prototype.buildInvite=function(aa){'use strict';var ba=t._("Invite {query} to Facebook",[t.param('query',aa)]),ca=k.create('li',{className:'calltoaction'},[k.create('a',{href:this.getInviteEndpoint(aa),rel:'ignore'},[k.create('span',{className:'text'},[k.create('span',{className:'invite'},[ba])])])]);ca.setAttribute('aria-label',ba);return {uid:'invite',node:ca,search:true};};y.prototype.searchPageQueryData=function(aa){'use strict';return v({q:aa},this.queryData||{});};y.prototype.searchPageTypeData=function(aa){'use strict';return this._redirectToUsersResultsPage||aa?{type:"users"}:{};};y.prototype.select=function(aa){'use strict';var ba=this.index,ca=this.results[ba];if(!ca||ca.type=='header')return;var da=this.items[ba],ea=k.scry(da,'a')[0];if(ca.song){if(ea)n.inform(m.MUSIC_BUTTON.ACTIVATE,ea);aa&&this.inform('highlight',{index:ba,selected:ca});}else{x.select.call(this,aa);if(ea&&ea.href)if(ea.target=='_blank'){window.open(ea.href);}else l(ea.href);}};y.prototype.setSid=function(aa){'use strict';this.queryData.tas=aa;};y.prototype.getSeeMoreEndpoint=function(aa,ba){'use strict';return new s(this.seeMoreEndpoint).addQueryData(this.searchPageQueryData(aa)).addQueryData(this.searchPageTypeData(ba)).toString();};y.prototype.getInviteEndpoint=function(aa){'use strict';return new s('/invite.php').addQueryData({email_list:aa});};y.prototype.show=function(){'use strict';if(!this.isVisible()){h.inform('layer_shown',{type:'SearchTypeahead'});x.show.call(this);}};y.prototype.hide=function(){'use strict';if(this.isVisible()){h.inform('layer_hidden',{type:'SearchTypeahead'});x.hide.call(this);}};y.prototype.getQuerySuggestion=function(aa){'use strict';var ba=this.results[this.index],ca=ba&&ba.type!='header'?ba.text.toLowerCase():'';return ca==aa.toLowerCase()?'':ca;};y.prototype.setWebSuggLoggingParams=function(aa,ba){'use strict';var ca=0,da=0;for(var ea=0;ea<ba.length;ea++)if(ba[ea].type==='websuggestion'){if(da===0)da=ea+1;var fa='FR'+(ea-ca)+'AS'+ca,ga=ea+1;ba[ea].path+='&wssk='+fa+'&wssp='+ga+'&wspq='+encodeURIComponent(aa);ba[ea].path+='&wssrc='+ba[ea].websuggestion_source;ca++;}var ha='&wssc='+ba.length+'-'+aa.length+'&wsbp='+ca+'-'+da;for(ea=0;ea<ba.length;ea++)if(ba[ea].type==='websuggestion')ba[ea].path+=ha;};function z(aa){var ba,ca,da,ea,fa=[],ga={};ca=aa.length;for(ba=0;ba<ca;ba++){da=aa[ba];ea=da.render_type||da.type;if(!ga.hasOwnProperty(ea)){ga[ea]=fa.length;fa.push([]);}fa[ga[ea]].push(da);}var ha=[];ca=fa.length;for(ba=0;ba<ca;++ba){da=fa[ba][0];ea=da.render_type||da.type;ha=ha.concat(fa[ba]);}return ha;}Object.assign(y.prototype,{_shouldShowSeeMore:true,_bucketize:true,queryData:{init:'quick'}});f.exports=y;},null);
__d('legacy:SearchTypeaheadView',['SearchTypeaheadView'],function a(b,c,d,e){if(c.__markCompiled)c.__markCompiled();b.SearchTypeaheadView=c('SearchTypeaheadView');},3);
__d('legacy:Typeahead',['Typeahead'],function a(b,c,d,e){if(c.__markCompiled)c.__markCompiled();b.Typeahead=c('Typeahead');},3);
__d('SearchTypeaheadRecorder',['AsyncRequest','Banzai','BanzaiNectar','BanzaiScuba','CurrentUser','Event','FacebarGlobalOptions','Keys','TokenizeUtil','Vector','clickRefAction','mapObject','ge','throttle','whitelistObjectKeys'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){if(c.__markCompiled)c.__markCompiled();var w=Object.assign||function(aa){for(var ba=1;ba<arguments.length;ba++){var ca=arguments[ba];for(var da in ca)if(Object.prototype.hasOwnProperty.call(ca,da))aa[da]=ca[da];}return aa;},x={WAITING:'WAITING',SUCCESS:'SUCCESS',NO_RESULTS:'NO_RESULTS',ERROR:'ERROR'};function y(aa){'use strict';this.init(aa);this.initEvents(aa);}y.prototype.init=function(aa){'use strict';this.core=aa.getCore();this.data=aa.getData();this.view=aa.getView();this.element=this.core.getElement();this.initTime=Date.now();this._onloadTime=0;this._extraRecorder=[];this.performanceTimings={};this.allFromSingleState=false;this.allFromNullState=false;var ba=t('search_first_focus');this.initStartTime=ba&&ba.value;this.bootstrapStats={bootstrapped:0};this.type="legacy_search";this._reset();};y.prototype._reset=function(){'use strict';this.stats={};this.avgStats={};this.appendStats={};this._backspacing=false;this.backendQueries=[];this.backendQueriesStatus={};this._topreplace=false;this._inflightRequests={};var aa=Math.random().toString();this.data.setQueryData({sid:aa});this.view.setSid(aa);this.recordStat('sid',aa);this.recordStat('keypressed',0);};y.prototype.initEvents=function(){'use strict';this.core.subscribe('focus',(function(event){if(!this.stats.session_start_time){this.recordStat('session_start_time',Date.now());var aa=new Date(),ba=aa.getTimezoneOffset(),ca=Date.now()-ba*60*1000;this.recordStat('session_start_time_user_timezone',ca);}}).bind(this));this.core.subscribe('blur',(function(event){var aa=Date.now();for(var ba in this._inflightRequests){var ca=this._inflightRequests[ba],da=aa-ca;this.recordAvgStat('search_endpoint_ms_from_js',da);}this.recordStat('session_end_time',aa);this.submit();}).bind(this));this.view.subscribe('select',(function(aa,ba){this.recordSelectInfo(ba);}).bind(this));this.view.subscribe('render',(function(aa,ba){this.recordRender(ba);}).bind(this));this.data.subscribe('logPerformanceTiming',(function(aa,ba){this.performanceTimings[ba.field]=ba.value;}).bind(this));this.data.subscribe('activity',(function(aa,ba){this.recordStat('pending_request',ba.activity);}).bind(this));this.data.subscribe('respondValidUids',(function(aa,ba){this.validUids=ba.slice(0);}).bind(this));this.data.subscribe('beforeQuery',(function(aa,ba){if(!ba.value){this.query='';this.results=[];this.data.lastNullOrSingleStateFetchStartTime=Date.now();return;}if(!this.stats.first_query_time)this.recordStat('first_query_time',Date.now());this.query=ba.value;if(!this.queryStartTime)this.queryStartTime=[];this.queryStartTime[this.query]=Date.now();this.recordCountStat('num_queries');}).bind(this));this.data.subscribe('queryEndpoint',(function(aa,ba){this.recordCountStat('num_search_ajax_requests');this.recordAvgStat('endpoint_query_length',ba.value.length);this._inflightRequests[ba.value]=Date.now();}).bind(this));this.data.subscribe('onload',(function(aa,ba){this._onloadTime=ba.time;}).bind(this));this.data.subscribe('bootstrapped',(function(aa,ba){this.bootstrapStats.endTime=ba.time;this.bootstrapStats.bootstrapped=1;}).bind(this));this.core.subscribe('recordFunction',(function(aa,ba){this._extraRecorder.push(ba);}).bind(this));this.data.subscribe('endpointStats',(function(aa,ba){var ca=ba.info,da=ca.fetch_end-ca.fetch_start;if(ca.value){this.recordAvgStat('search_endpoint_ms_from_js',da);}else this.bootstrapStats[ca.type]=da;if(ca.coeff2_ts)this.bootstrapStats.coeff2_ts=ca.coeff2_ts;if(typeof ca.browserCacheHit!='undefined')this.recordCountStat(ca.browserCacheHit?'bootstrap_cachehits':'bootstrap_cachemisses');if(this._inflightRequests[ca.value])delete this._inflightRequests[ca.value];}).bind(this));this.data.subscribe('fetchComplete',(function(aa,ba){var ca=ba.entries,da=ba.value;if(da&&this.backendQueriesStatus[da]){this._addDurationForBackendQuery(this.backendQueriesStatus[da]);this.backendQueriesStatus[da].status=ca&&ca.length>0?x.SUCCESS:x.NO_RESULTS;}}).bind(this));this.data.subscribe('fetchError',(function(aa,ba){var ca=ba.fetch_context,da=ca.value;if(ca.bootstrap||!da)return;if(this.backendQueriesStatus[da]){this.backendQueriesStatus[da].status=x.ERROR;this._addDurationForBackendQuery(this.backendQueriesStatus[da]);}}).bind(this));this.data.subscribe('query',(function(aa,ba){this.recordAvgStat('num_results_from_cache',ba.results.length);}).bind(this));this.data.subscribe('backend_topreplace',(function(aa,ba){if(false===this._topreplace){this.recordStat("backend_topreplace",1);this._topreplace=true;}}).bind(this));this.data.subscribe('completeFetch',(function(aa,ba){if(this.core.scubaInfo){var ca=ba.response,da={recv:ba.stats.fetch_end-ba.stats.fetch_start,render:Date.now()-ba.stats.fetch_start,payload_size:JSON.stringify(ca).length};if(!ca.payload.entities)ca.payload.entities=this.buildResults();this.logToScuba(ca,da,this.core.scubaInfo,this.query,this.type);}}).bind(this));this.data.subscribe('completeCacheFetch',u((function(aa,ba){if(this.core.scubaInfo)this.logToScuba({},{},this.core.scubaInfo,this.query,this.type);}).bind(this),500));m.listen(this.element,'keydown',(function(event){this.recordStat('keypressed',1);this.recordCountStat('count_keys_pressed');if(m.getKeyCode(event)==o.BACKSPACE){if(!this._backspacing&&this.query){this._backspacing=true;this.recordAppendStat('before_backspace_queries',this.query);}}else this._backspacing=false;}).bind(this));this.data.subscribe('beforeFetch',(function(aa,ba){var ca=ba.request.data.value;if(!ca)return;this.backendQueries.push(ca);this.backendQueriesStatus[ca]={status:x.WAITING,start_time:Date.now()};}).bind(this));};y.prototype.recordStat=function(aa,ba){'use strict';this.stats[aa]=ba;};y.prototype.recordCountStat=function(aa){'use strict';var ba=this.stats[aa];this.stats[aa]=ba?ba+1:1;};y.prototype.recordAvgStat=function(aa,ba){'use strict';if(this.avgStats[aa]){this.avgStats[aa][0]+=ba;++this.avgStats[aa][1];}else this.avgStats[aa]=[ba,1];};y.prototype.recordAppendStat=function(aa,ba){'use strict';if(!this.appendStats.hasOwnProperty(aa))this.appendStats[aa]=[];this.appendStats[aa].push(ba);};y.prototype.recordRender=function(aa){'use strict';this.results=aa.filter(function(ka){return ka.uid!='search'&&ka.type!='disabled_result'&&ka.type!='header';}).map(function(ka){return w({},ka);});var ba=null;if(this.queryStartTime)ba=this.queryStartTime[this.query];var ca=this.results.every(function(ka){return ka.fromCache;}),da=this.results.every(function(ka){return ka.isFromGSEF||ka.fromCache;}),ea=this.results.every(function(ka){return ka.isNullState;}),fa=this.results.every(function(ka){return ka.isSingleState;}),ga=this.results.every(function(ka){return ka.exactMatchKeyword;});this.allFromSingleState=fa;this.allFromNullState=ea;if(this.results.length&&this.data.lastNullOrSingleStateFetchStartTime&&ea){this.recordStat('time_render_null_state',Date.now()-this.data.lastNullOrSingleStateFetchStartTime);this.data.lastNullOrSingleStateFetchStartTime=null;}else if(this.data.lastNullOrSingleStateFetchStartTime&&this.results.length&&fa){this.recordStat('time_render_single_state',Date.now()-this.data.lastNullOrSingleStateFetchStartTime);}else if(ba){var ha=Date.now()-ba;if(ga){this.recordAppendStat('times_render_gs_echo',ha);}else this.recordAppendStat(ca?'times_render_local':'times_render_remote',ha);if(!ca&&da)this.recordAppendStat('time_render_gs_early_fetch',ha);}this.data.lastNullOrSingleStateFetchStartTime=null;var ia=q.getViewportDimensions();this.recordStat('window_size_width',ia.x);this.recordStat('window_size_height',ia.y);if(this.results.length>0&&!this.stats.first_result_time)this.recordStat('first_result_time',Date.now());var ja='typed';if(this.allFromNullState){ja='nullstate';}else if(this.allFromSingleState)ja='singlestate';this.recordStat('last_state',ja);};y.prototype.recordSelectInfo=function(aa){'use strict';var ba=aa.selected,ca=aa.index;if(ba.groupIndex!==undefined)ca=aa.index-ba.groupIndex-1;var da={href:ba.path},ea=ba.dataGT?{gt:JSON.parse(ba.dataGT)}:{};r('click',da,null,null,ea);if(ba.uid=='search'||ba.uid=='people_search'){this.recordStat('selected_search',1);}else if(ba.uid=='invite'){this.recordStat('selected_invite',1);}else{var fa=ba.log_type||ba.rankType||ba.render_type||ba.type,ga=fa=='friend'?'user':fa;this.recordStat('selected_'+ga,1);this.recordStat('selected_position',ca);this.recordStat('selected_type',fa);this.recordStat('selected_name_length',ba.text.length);this.recordStat('selected_id',ba.uid);this.recordStat('selected_degree',ba.bootstrapped?1:2);this.recordStat('selected_recent_search',ba.recent_search);var ha=p.parse(this.data.getTextToIndex(ba)).tokens,ia=z(ha,this.query);if(ia)this.recordStat('matched_terms',ia);}var ja={};this._extraRecorder.forEach((function(ka){ka(aa,this.results,ja);}).bind(this));this.recordStat('extra_select_info',JSON.stringify(ja));if(ba.type==='websuggestion'){this.recordStat('selected_memcached_websuggestion',ba.fromMemcache);this.recordStat('selected_websuggestion_source',ba.websuggestion_source);}this.recordStat('selected_with_mouse',aa.clicked?1:0);};y.prototype._addDurationForBackendQuery=function(aa){'use strict';if(aa.start_time){aa.duration=Date.now()-aa.start_time;delete aa.start_time;}};y.prototype._dataToSubmit=function(){'use strict';this.recordStat('candidate_results',this.buildResults());this.recordStat('query',this.query);this.recordStat('init_time',this.initTime);if(this.initStartTime){this.recordStat('init_start_time',this.initStartTime);this.recordStat('onload_time',this._onloadTime);this.initStartTime=0;}this.recordStat('bootstrapped',this.bootstrapStats.bootstrapped);if(this.bootstrapStats.endTime){this.recordStat('bootstrapped_time',this.bootstrapStats.endTime);this.recordStat('user_bootstrap_ms',this.bootstrapStats.user);this.recordStat('other_bootstrap_ms',this.bootstrapStats.other);this.bootstrapStats.endTime=0;}var aa=this.data.getBootstrapError();if(aa)this.recordStat('bootstrap_error',1);this.recordStat('coeff2_ts',this.bootstrapStats.coeff2_ts);this.recordStat('max_results',this.data._maxResults);if(this.backendQueries.length>0){if(this.backendQueries.length>this.data.logBackendQueriesWindow)this.backendQueries=this.backendQueries.slice(this.backendQueries.length-this.data.logBackendQueriesWindow);this.recordStat('backend_queries',this.backendQueries);var ba=v(this.backendQueriesStatus,this.backendQueries);s(ba,this._addDurationForBackendQuery,this);this.recordStat('backend_queries_status',ba);}if(n.taSessionLoggingSample){var ca=[];this.results.forEach(function(ha){ca.push([ha.text||'',ha.category||'',ha.subtext||'']);});this.recordStat('raw_suggestions_text',ca);}var da=this.stats;for(var ea in this.avgStats){var fa=this.avgStats[ea];da[ea]=fa[0]/fa[1];}for(var ga in this.appendStats)da[ga]=JSON.stringify(this.appendStats[ga]);return da;};y.prototype.buildResults=function(){'use strict';var aa=(this.results||[]).map((function(ba,ca){var da=p.parse(this.data.getTextToIndex(ba)).tokens,ea=ba.rankType||ba.render_type||ba.type,fa=ba.bootstrapped?1:0,ga=ba.s_token||'',ha=typeof ba.index=='undefined'?100:ba.index,ia=z(da,this.query)||this.query,ja=ba.index_rank,ka=ba.match_type,la=ba.l_type,ma=ba.vertical_type,na=ba.prefix_match,oa=ba.prefix_length,pa=ba.text,qa=ba.category,ra=ba.subtext,sa=ba.fromCache,ta=ba.isNullState,ua=ba.isSingleState;if(typeof ba.groupIndex=='number')return [ba.groupIndex,ba.indexInGroup,ba.uid,ea,fa,ga,ia,ja,ka,na,oa,ba.origIndex,la,ma,pa,qa,ra,ha,sa,ta,ua];return [0,ca,ba.uid,ea,fa,ga,ia,ja,ka,na,oa,ba.origIndex,la,ma,pa,qa,ra,ha,sa,ta,ua];}).bind(this));return JSON.stringify(aa);};y.prototype.submit=function(){'use strict';var aa=this._dataToSubmit();switch(this.data.recordingRoute){case 'banzai_vital':i.post(this._banzaiRoute,aa,{delay:0,retry:true});break;default:this.submitThroughAsyncRequest(aa);}this._reset();};y.prototype.addLatencyToSample=function(aa,ba,ca,da){'use strict';aa.addInteger(da+'query_start',ca.queryStart);aa.addInteger(da+'query_end',ca.queryEnd);aa.addInteger(da+'keypress_query_end',ca.keyPressToQueryEnd);aa.addInteger(da+'render',ca.render);aa.addInteger(da+'keypress_render',ca.keyPressToRender);ba[da+'query_start']=ca.queryStart;ba[da+'query_end']=ca.queryEnd;ba[da+'keypress_query_end']=ca.keyPressToQueryEnd;ba[da+'render']=ca.render;ba[da+'keypress_render']=ca.keyPressToRender;};y.prototype.logToScuba=function(aa,ba,ca,da,ea){'use strict';var fa={},ga=new k('search_facebar_js',null,{addBrowserFields:true,addPredictedGeographyFields:true,addUser:true,addSearchVersion:true,addGatekeepers:{facebarGKs:true}});ga.addInteger('sample_rate',ca.sample_rate);fa.sample_rate=ca.sample_rate;ga.addNormal('site',ca.site);fa.site=ca.site;ga.addDenorm('query',da);fa.query=da;var ha=aa.payload||{};if(ha.entities){ga.addInteger('num_entities',ha.entities.length);fa.num_entities=ha.entities.length;}Object.keys(this.performanceTimings).forEach((function(ja){ga.addInteger(ja,this.performanceTimings[ja]);fa[ja]=this.performanceTimings[ja];}).bind(this),this);if(ha.results||ha.entries){var ia=(ha.results||ha.entries).length;ga.addInteger('num_results',ia);fa.num_results=ia;}if(ha.gzipped_payload_size!==undefined){ga.addInteger('gzipped_payload_size',ha.gzipped_payload_size);fa.gzipped_payload_size=ha.gzipped_payload_size;}if(ba.recv&&ba.render>ba.recv){ga.addInteger('time_render',ba.render-ba.recv);fa.time_render=ba.render-ba.recv;ga.addInteger('time_js_async',ba.recv);fa.time_js_async=ba.recv;}if(ba.payload_size){ga.addInteger('payload_size',ba.payload_size);fa.payload_size=ba.payload_size;}if(this.stats.time_render_null_state&&(!da||da.length===0)){ga.addInteger('time_render_null_state',this.stats.time_render_null_state);fa.time_render_null_state=this.stats.time_render_null_state;}ga.addInteger('query_id',aa.queryId);fa.query_id=aa.queryId;ga.addDenorm('user_id',l.getID());fa.user_id=l.getID();ga.addDenorm('session_id',this.stats.sid);fa.session_id=this.stats.sid;ga.addNormal('typeahead_type',ea);fa.typeahead_type=ea;if(ba.remoteQueryLatencies){this.addLatencyToSample(ga,fa,ba.remoteQueryLatencies,'remote_');ga.addInteger('remote_keypress_query_dispatch',ba.remoteQueryLatencies.keyPressToQueryDispatch);fa.remote_keypress_query_dispatch=ba.remoteQueryLatencies.keyPressToQueryDispatch;ga.addInteger('remote_keypress_query_start',ba.remoteQueryLatencies.keyPressToQueryStart);fa.remote_keypress_query_start=ba.remoteQueryLatencies.keyPressToQueryStart;ga.addNormal('inflight_requests',ba.remoteQueryLatencies.inflightRequests);ga.addInteger('inflight_requests',ba.remoteQueryLatencies.inflightRequests);fa.inflight_requests=ba.remoteQueryLatencies.inflightRequests;ga.addNormal('waiting_queries',ba.remoteQueryLatencies.waitingQueries);ga.addInteger('waiting_queries',ba.remoteQueryLatencies.waitingQueries);fa.waiting_queries=ba.remoteQueryLatencies.waitingQueries;}if(ba.cacheQueryLatencies)this.addLatencyToSample(ga,fa,ba.cacheQueryLatencies,'cache_');ga.post();j.log('search_facebar_js','typeahead',fa);};y.prototype.submitThroughAsyncRequest=function(aa){'use strict';if(Object.keys(aa).length>0)new h().setURI(this._endPoint).setMethod('POST').setData({stats:aa}).setOption('handleErrorAfterUnload',true).setErrorHandler((function(ba){aa.retry=true;new h().setURI(this._endPoint).setMethod('POST').setData({stats:aa}).setOption('asynchronous',false).send();}).bind(this)).send();};var z=function(aa,ba){if(!aa||!ba)return;var ca=p.parse(ba);if(ca.flatValue[ca.flatValue.length-1]===' ')return ca.flatValue;var da=ca.tokens[ca.tokens.length-1],ea={};aa.forEach(function(ja){ea[ja]=(ea[ja]||0)+1;});var fa={},ga=ca.tokens.slice(0,ca.tokens.length-1);ga.forEach(function(ja){fa[ja]=(fa[ja]||0)+1;});for(var ha=0;ha<aa.length;++ha){var ia=aa[ha];if(ia.indexOf(da)===0&&ea[ia]-(fa[ia]||0)>0){ga.push(ia);return ga.join(' ');}}return undefined;};Object.assign(y.prototype,{_endPoint:'/ajax/typeahead/record_metrics.php',_banzaiRoute:'search'});f.exports=y;},null);
__d('TypeaheadSearchRecorderBasic',['SearchTypeaheadRecorder','emptyFunction'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();function j(k){'use strict';this._typeahead=k;}j.prototype.enable=function(){'use strict';new h(this._typeahead);};Object.assign(j.prototype,{disable:i});f.exports=j;},null);
__d('legacy:SearchRecorderBasicTypeaheadBehavior',['TypeaheadSearchRecorderBasic'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();if(!b.TypeaheadBehaviors)b.TypeaheadBehaviors={};b.TypeaheadBehaviors.searchRecorderBasic=function(i){i.enableBehavior(h);};},3);
__d('legacy:SearchTypeaheadRenderer',['SearchTypeaheadRenderer'],function a(b,c,d,e){if(c.__markCompiled)c.__markCompiled();if(!b.TypeaheadRenderers)b.TypeaheadRenderers={};b.TypeaheadRenderers.search=c('SearchTypeaheadRenderer');},3);
void 0;
__d("XSearchFacebarSurveyController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/search\/facebar_survey\/",{id:{type:"String",required:true},query:{type:"String"},session_id:{type:"String",required:true}});},null,{});
__d('AbandonedSessionSurvey',['AsyncRequest','SubscriptionsHandler','XSearchFacebarSurveyController','getOrCreateDOMID'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();function l(m){'use strict';this.core=m.getCore();this.data=m.getData();this.view=m.getView();this.subscriptionsHandler=new i();}l.prototype.enable=function(){'use strict';this.subscriptionsHandler.addSubscriptions(this.core.subscribe('focus',(function(){this.searchBoxFocused=true;this.resultSelected=false;}).bind(this)),this.data.subscribe('beforeQuery',(function(m,n){this.query=n.value||'';}).bind(this)),this.view.subscribe('select',(function(){this.resultSelected=true;}).bind(this)),this.core.subscribe('blur',(function(){if(this.searchBoxFocused&&!this.resultSelected){this.resultSelected=false;this.searchBoxFocused=false;this.openSurvey();}}).bind(this)));};l.prototype.disable=function(){'use strict';this.subscriptionsHandler.release();this.request&&this.request.abort();};l.prototype.openSurvey=function(){'use strict';if(this.openedSurvey)return;this.openedSurvey=true;var m=j.getURIBuilder().setString('id',k(this.core.element)).setString('query',this.query||'').setString('session_id',this.data.queryData.sid);this.request=new h().setMethod('post').setURI(m.getURI());this.request.send();};f.exports=l;},null);
__d('TypeaheadSearchFilter',['Arbiter'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(j){'use strict';this._typeahead=j;}i.prototype.enable=function(){'use strict';var j=this._typeahead,k=j.getView().seeMoreEndpoint;this._subscriptions=[h.subscribe('search/typeahead/updateFilter',function(l,m){if(m.filter_type=='web')j.getView().queryData.form='FBKBFR';j.getView().queryData.type=m.filter_type;}),h.subscribe('search/typeahead/updateSeeMoreEndpoint',function(l,m){j.getView().seeMoreEndpoint=m;}),h.subscribe('page_transition',function(l,m){if(j.getView().queryData.form)delete j.getView().queryData.form;delete j.getView().queryData.type;j.getView().seeMoreEndpoint=k;},h.SUBSCRIBE_NEW)];};i.prototype.disable=function(){'use strict';this._subscriptions.forEach(function(j){j.unsubscribe();});this._subscriptions=null;};Object.assign(i.prototype,{_subscription:null});f.exports=i;},null);
__d('legacy:SearchFilterTypeaheadBehavior',['TypeaheadSearchFilter'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();if(!b.TypeaheadBehaviors)b.TypeaheadBehaviors={};b.TypeaheadBehaviors.initFilters=function(i){i.enableBehavior(h);};},3);
__d('TypeaheadDetectQueryLocale',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){'use strict';this._typeahead=i;this._data=i.getData();this._queryCache={'':this._data.queryCache,ja_JP:{},zh_TW:{}};}h.prototype.enable=function(){'use strict';this._previousLocale='';this._reset=this._typeahead.subscribe('reset',this._swapQueryCache.bind(this,''));this._beforeQuery=this._data.subscribe('beforeQuery',(function(i,j){var k=j.value;if(k===''){this._swapQueryCache('');return;}var l=null,m=k.charCodeAt(k.length-1);if(12352<=m&&m<=12543){l='ja_JP';}else if(12544<=m&&m<=12735)l='zh_TW';this._swapQueryCache(l);}).bind(this));};h.prototype.disable=function(){'use strict';this._swapQueryCache('');this._data.unsubscribe(this._beforeQuery);this._typeahead.ubsubscribe(this._reset);};h.prototype._swapQueryCache=function(i){'use strict';if(i===null||i===this._previousLocale)return;this._data.queryCache=this._queryCache[i];this._data.setQueryData({query_locale:i});this._previousLocale=i;};f.exports=h;},null);
__d('TypeaheadExcludeBootstrapFromQueryCache',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){'use strict';this._data=i.getData();}h.prototype.enable=function(){'use strict';this._buildingQueryCache=false;this._buildQueryCache=this._data.subscribe('buildQueryCache',(function(){this._buildingQueryCache=true;}).bind(this));this._mergeUids=this._data.subscribe('mergeUids',(function(i,j){if(this._buildingQueryCache)j.local_uids.splice(0,j.local_uids.length);}).bind(this));this._fetchComplete=this._data.subscribe('fetchComplete',(function(){this._buildingQueryCache=false;}).bind(this));};h.prototype.disable=function(){'use strict';this._data.unsubscribe(this._buildQueryCache);this._data.unsubscribe(this._mergeUids);this._data.unsubscribe(this._fetchComplete);};f.exports=h;},null);
__d('TypeaheadRecentSearchUpdater',['Arbiter'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(j){'use strict';this.view=j.getView();}i.prototype.enable=function(){'use strict';this.updaterSubscription=this.view.subscribe('select',function(){h.inform('search/refreshRecentSearchesNullstate',{},h.BEHAVIOR_STATE);});};i.prototype.disable=function(){'use strict';this.view.unsubscribe(this.updaterSubscription);};f.exports=i;},null);