/*!CK:1343407230!*//*1439978008,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["7CZto"]); }

__d("TimelineFilterOptions",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={ALL:"all",REVIEW:"review",TAG_REVIEW:"tagreview",FACE_ALERTS:"facealertsreview",POSTSANDAPPS:"postsandapps",LOCATION:"location",PHOTOS:"photos",TAGGED_PHOTOS:"taggedphotos",OWN_PHOTOS:"ownphotos",LIKES:"likes",LIKED_INTERESTS:"likedinterests",LIKED_POSTS:"likedposts",GROUPS:"groups",GROUP_MEMBERSHIP:"groupmembership",GROUP_POSTS:"groupposts",HIDDEN:"hidden",SPAM:"spam",ALL_APPS:"apps",SEARCH:"search",ADS:"ads",CLUSTER:"cluster",APP:"app",STORIES:"stories",COLLECTION_ITEM:"citem",FITNESS:"fitness",OG_VIDEO:"ogvideo",SAVED_FOR_LATER:"saved",PRIVATE_NOTES:"private_notes",NOW:"now"};},null,{});
__d('BrowseFacebarHighlighter',['CSS','csx','NodeHighlighter'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k={};Object.assign(k,j,{getHighlightCandidates:function(){return ["._53ad"];},isDiscardNode:function(l){return h.hasClass(l,'DefaultText');},createSegmentedRegex:function(l){l=this.escapeAndAddBidirectionalCharsToTokens(l);return '(^|\\s|\\b)('+l.join('|')+')';}});f.exports=k;},null);
__d('getElementChildren',['toArray','isElementNode'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();function j(k){return h(k.children||k.childNodes).filter(i);}f.exports=j;},null);
__d('FacebarSemanticQuery',['CurrentUser','URI'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j='str',k=/\*[\w\-]+\(/g;function l(v){var w={me:h.getID()};return Object.assign(w,Array.isArray(v.semantic_map)?{}:v.semantic_map);}function m(v,w){var x=l(v);if(typeof x[w]!=='undefined')return String(x[w]);return w;}function n(v){return new i("/profile.php").addQueryData({id:v});}function o(v,w){var x=[w],y=[],z=v.browse_functions,aa=v.search_path;while(x.length>0){var ba=x.pop();if(!r(ba)){y.push(ba);continue;}var ca=ba.substring(0,ba.indexOf('(')),da=ca,ea=s(ba);if(!z[ca]){y=[];break;}var fa=z[ca].minNumParams,ga=z[ca].maxNumParams;if(x.length>0)if(z[ca].numParamsUnbounded){if(y.length>0)ca+='-'+ea.length;}else if(ea.length!=1&&ea.length>fa||ea.length===0&&fa!=ga)ca+='-'+ea.length;x.push(ca);for(var ha=0;ha<ea.length;ha++){if(ea[ha].length===0)continue;if(z[da].allowsFreeText){x.push(j+'/'+encodeURIComponent(encodeURIComponent(ea[ha])));}else x.push(ea[ha]);}}return new i(aa+y.join('/'));}function p(v){return v.replace(/['"\[\]]/g,'');}function q(v,w){var x=JSON.parse(w),y=[];if(x.length>0)y=[x[0]];var z=[],aa=v.browse_functions,ba=v.search_path;while(y.length>0){var ca=y.pop();if(typeof ca!=='object'){z.push(p(ca));continue;}var da=Object.keys(ca)[0],ea=da,fa=ca[da];if(!aa[da]){z=[];break;}var ga=aa[da].minNumParams,ha=aa[da].maxNumParams;if(y.length>0)if(aa[da].numParamsUnbounded){if(z.length>0)da+='-'+fa.length;}else if(fa.length!=1&&fa.length>ga||fa.length===0&&ga!=ha)da+='-'+fa.length;y.push(da);for(var ia=0;ia<fa.length;ia++){if(fa[ia].length===0)continue;if(aa[ea].allowsFreeText){y.push(j+'/'+encodeURIComponent(fa[ia]));}else y.push(fa[ia]);}}return new i(ba+z.join('/'));}function r(v){return (/^[a-z\-]+\(.*\)$/.test(v));}function s(v){if(!r(v)&&v.indexOf('param_')!==0)return [v];var w=v.substring(v.indexOf('(')+1,v.length-1);if(w.length===0)return [];return t(w);}function t(v){var w=[],x=0,y=0;for(var z=0;z<v.length;++z)if(v[z]==','&&y===0){w.push(v.substring(x,z));x=z+1;}else if(v[z]=='('){y++;}else if(v[z]==')')y--;w.push(v.substring(x,v.length));return w;}function u(v,w,x){'use strict';this.facebarConfig=v;this.unmapped=(w||"").trim();this.mapped=m(v,this.unmapped);this.position=null;this.$FacebarSemanticQuery1=typeof x!=='undefined'?x:false;}u.prototype.isEntity=function(){'use strict';return (/^\d+$/.test(this.mapped));};u.prototype.isShortcut=function(){'use strict';return this.mapped.indexOf('shortcut(')===0;};u.prototype.isImplemented=function(){'use strict';return this.mapped&&!this.mapped.match(k);};u.prototype.isSemanticForest=function(){'use strict';return this.$FacebarSemanticQuery1;};u.prototype.getUnimplemented=function(){'use strict';return (this.mapped.match(k)||[]).map(function(v){return v.substr(1,v.length-2);});};u.prototype.getURI=function(){'use strict';if(this.isEntity()){return n(this.mapped);}else if(this.isShortcut()){return new i(this.mapped.substr(9,this.mapped.length-10));}else if(this.isSemanticForest()){return q(this.facebarConfig,this.unmapped);}else return o(this.facebarConfig,this.unmapped);};f.exports=u;},null);
__d('FacebarURI',['FacebarJSConstants','FacebarSemanticQuery','URI','WWWBase'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l={event:{ref:h.eventLinkRef},user:{fref:'ts'},page:{fref:'ts'}},m={getSearchRawPrefix:function(){return 'search';},getSearchPath:function(){return '/'+this.getSearchRawPrefix()+'/';},getURI:function(n,o){var p=null,q=!o.song&&!o.isExtendedResult&&o.path;if(q){p=new j(q);if(o.type in l)p.addQueryData(l[o.type]);}else{var r=new i(n,o.semantic);if(r&&r.isImplemented())p=r.getURI();}return p&&m.getQualifiedURI(p);},getQualifiedURI:function(n){var o=new j(n);if(!o.getDomain()){var p=new j(k.uri);o.setProtocol(p.getProtocol()).setDomain(p.getDomain()).setPort(p.getPort());}return o;}};f.exports=m;},null);
__d('FacebarFindPeopleAndPages',['FacebarGlobalOptions','FacebarJSConstants','FacebarStructuredText','FacebarURI','URI','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();var o={insertInto:function(p,q,r){p=this._cleanQuery(p);var s=this._getInsertionIndex(p,q);if(s>-1){var t=this._createFindPeopleAndPagesResult(p,r);q.splice(s,0,t);}},_getInsertionIndex:function(p,q){if(!p||!h.findPeopleAndPages)return -1;var r=q.some(this._isUserOrPageSuggestion);if(!r)return -1;var s=-1;for(var t=0;t<q.length;t++)if(this._isEntitySuggestion(q[t]))s=t+1;return s;},_isUserOrPageSuggestion:function(p){return p.type==='user'||p.type==='page';},_isEntitySuggestion:function(p){return p.type!==i.keywordType&&p.type!==i.grammarType;},_cleanQuery:function(p){return String(p).trim().replace(/\s+/g,' ').replace(/[\u200E|\u200F|\u202a|\u202b|\u202c]/g,'');},_createFindPeopleAndPagesResult:function(p,q){var r='str/'+p+'/keywords_entities',s=n._("Find all people and pages named \"{query}\"",[n.param('query',p)]);return {type:'grammar',results_set_type:'browse_type_blended',text:p,id:p,uid:p,query_string:p,icon_class:"_207",isSeeMore:true,isPeopleAndPagesSuggestion:true,structure:j.fromString(s),semantic:r,uri:k.getQualifiedURI(new l('/search/'+r)),fromCache:q,tags:{displayedSeeMore:true}};}};f.exports=o;},null);
__d('FacebarKeywordSearchUtils',['FacebarURI','FacebarStructuredText','KeywordsSearchResultConfig','URI'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=function(n){var o=0;while(o<n.length)if(n[o].exactMatchKeyword){n.splice(o,1);}else ++o;},m={addExactMatch:function(n,o,p){if(!o.length)return;var q,r;for(var s=0,t=o.length;s<t;s++){r=o[s];if(r.type==='grammar')continue;q=true;break;}if(!q)return;var u=this.getExactMatchKeywordResult(n);if(!u)return;var v=Math.min(o.length,p),w=v;for(s=0;s<v;s++){r=o[s];if(r.exactMatchKeyword)return;if(r.cost>j.default_cost)--w;if(r.type!==j.result_type)continue;u.backendCost=r.cost+j.exact_match_cost_delta_from_best;u.cost=r.backendCost;l(o);o.splice(s,0,u);return;}l(o);o.splice(Math.min(Math.min(v,p-1),w),0,u);},getExactMatchKeywordResult:function(n){if(!n||n.is_empty||!n.raw_text)return;var o=n.raw_text.toLowerCase().replace(/\s{2,}/g,' ').trim(),p=j.query_prefix_blacklist;for(var q=0;q<p.length;q++)if(o.startsWith(p[q]))return;var r=this.makeFacebarEntry(o);return this._makeFacebarResult(r,n.cache_id.length);},makeFacebarEntry:function(n){var o=null,p=null;if(j.gsv2_results_page){p='str/'+encodeURIComponent(n)+'/'+j.gsv2_browse_edge;o=h.getQualifiedURI(new k('/search/'+p));}else{o=h.getQualifiedURI(new k(j.results_page_url).addQueryData('q',n));p=j.shortcut+'('+o.toString()+')';}return {semantic:p,text:n,type:j.result_type,resultsSetType:j.result_set_type,uid:j.uid_prefix+n,iconClass:j.icon_class,uri:o,structure:i.fromString(n)};},_makeFacebarResult:function(n,o){var p={semantic:n.semantic,structure:[{type:'grammar',text:n.text,uid:n.semantic}],type:n.type,resultsSetType:n.resultsSetType,cost:j.default_cost,cache_id_length:o,parse:{display:[{type:'grammar',uid:j.uid_prefix+n.text}],remTokens:[],suffix:''},iconClass:n.iconClass,exactMatchKeyword:true};p.tuid=JSON.stringify({semantic:p.semantic,structure:p.structure});return p;}};f.exports=m;},null);
__d('FacebarGSv2Echo',['FacebarGlobalOptions','FacebarJSConstants','FacebarKeywordSearchUtils','FacebarStructuredText','FacebarURI','URI','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p={insertInto:function(q,r,s,t){if(this._shouldInsert(q,r)){var u=r.findIndex(this._isKeywordSuggestion,this);if(u<0)u=r.length;var v=this._removeExactMatchAndReturnSubtext(q,r),w=r.findIndex((function(y){return (y.isCelebrity||y.isTrending)&&q===this._normalizeValue(y.text);}).bind(this),this),x=h.showEcho&&(!h.renderKeywordSnippets||w<0);if(x)r.splice(u,0,this._createEchoResult(q,s,v,t));if(h.findPostsSemantic)r.splice(u,0,this._createFindPostsResult(q,s,t));}},_shouldInsert:function(q,r){q=this._normalizeValue(q);if(!q||!h.graphSearchV2)return false;for(var s=0;s<r.length;s++){var t=r[s];if(t.isRecentSearchSuggestion&&q===this._normalizeValue(t.text))return false;}return true;},_isKeywordSuggestion:function(q){return q.type===i.keywordType||q.type===i.grammarType;},_removeExactMatchAndReturnSubtext:function(q,r){var s="";q=this._normalizeValue(q);for(var t=0;t<r.length;t++){var u=r[t];if(this._isKeywordSuggestion(u)&&q===this._normalizeValue(u.text)){if(u.subtext)s=u.subtext;r.splice(t,1);return s;}}return s;},_normalizeValue:function(q){return String(q).trim().replace(/\s+/g,' ').replace(/[\u200E|\u200F|\u202a|\u202b|\u202c]/g,'').toLowerCase();},_createEchoResult:function(q,r,s,t){q=this._normalizeValue(q);var u=j.makeFacebarEntry(q);if(h.renderKeywordSnippets)s=s||o._("Search Facebook");return {type:i.keywordType,results_set_type:i.browseTypes.keyword,text:q,id:q,uid:q,query_string:q,icon_class:"_5b1w",isSingleState:t,exactMatchKeyword:true,structure:k.fromString(q),semantic:u.semantic,uri:u.uri,fromCache:r,subtext:s};},_createFindPostsResult:function(q,r,s){q=this._normalizeValue(q);var t=h.findPostsSemantic.replace('{QUERY}',q),u=h.findPostsSemantic.replace('{QUERY}',encodeURIComponent(q)),v=o._("Find all posts for \"{query}\"",[o.param('query',q)]);return {type:i.keywordType,results_set_type:i.browseTypes.keyword,text:q,id:q,uid:q,query_string:q,icon_class:"_4-vy",isSeeMore:true,isSingleState:s,structure:k.fromString(v),semantic:t,uri:l.getQualifiedURI(new m('/search/'+u)),fromCache:r,tags:{displayedSeeMore:true}};}};f.exports=p;},null);
__d('FacebarSemanticUtils',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={_semanticForestConversionSub:function(i){var j=[],k=arguments.callee;i.forEach(function(l){if(typeof l==='string'){j.push(l);return;}var m=null;for(var n in l)m=n;if(!m)return;var o=m+'('+k(l[m])+')';j.push(o);});return j.join(',');},semanticForestConversion:function(i){if(!i)return '';var j=JSON.parse(i);return this._semanticForestConversionSub(j);},isEntity:function(i){if(!i)return false;return (/^\d+$/.test(i));}};f.exports=h;},null);
__d('FacebarResultStore',['FacebarGlobalOptions','FacebarJSConstants','FacebarKeywordSearchUtils','FacebarResultStoreUtils','FacebarSemanticUtils','FacebarStructuredText','KeywordsSearchResultConfig','TokenizeUtil','UnicodeMatch','concatMap','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){if(c.__markCompiled)c.__markCompiled();var s=Object.assign||function(u){for(var v=1;v<arguments.length;v++){var w=arguments[v];for(var x in w)if(Object.prototype.hasOwnProperty.call(w,x))u[x]=w[x];}return u;};function t(u,v,w,x){'use strict';this.facebarConfig=u;this.facebarConfig.grammar_stop_words_penalty=this.facebarConfig.grammar_stop_words_penalty||2;this.facebarConfig.grammar_stop_words=this.facebarConfig.grammar_stop_words||{};this.facebarConfig.options=x;this.tokenize=v;this.getEntry=w;this.typeaheadTypeMap=this.facebarConfig.mapped_types;this.facebarConfig.typeahead_types.forEach(function(y){this.typeaheadTypeMap[y]=y;},this);this.unicodeMatch=new p({prefix_hangul_conjoining_jamo:true});this.resetCaches();}t.prototype.transformStructured=function(u){'use strict';var v=[],w=[],x='',y='';u.forEach(function(ba,ca){if(ba.isType('text')){x+=ba.getText();y=y==null?null:y+ba.getText();}else{var da=x.match(/\"/g);if(da&&da.length%2)x=x.replace(/\s+$/,'')+'"';if(x.length){Array.prototype.push.apply(v,this.tokenize(x));w.push(x);x='';}v.push(ba.toStruct());w.push({uid:String(ba.getUID()),type:this._getFBObjectType(ba.getTypePart(1)),text:ba.getText()});y=null;}},this);if(x.length){if(x[x.length-1]=='\'')x=x.substr(0,x.length-1);Array.prototype.push.apply(v,this.tokenize(x));w.push(x);if(x[x.length-1]==' ')v.push('');}var z=JSON.stringify(w),aa=z.replace(/\]$/,'').replace(/\"$/,'');aa=aa.replace(/\s{2,}/g,' ');return {tokens:v,text_form:z,is_empty:!!z.match(/^\[(\"\s*\")?\]$/),raw_text:y,cache_id:aa};};t.prototype.resetCaches=function(){'use strict';this.resetBootstrapCache();this.resetQueryCache();};t.prototype.resetBootstrapCache=function(){'use strict';this.bootstrapCache={};};t.prototype.resetQueryCache=function(){'use strict';this.queryCache={'':{tokens:[],results:[]}};};t.prototype.setNullState=function(u){'use strict';this.facebarConfig.null_state=u.map(this._extractStructure,this);};t.prototype.addEntryToNullState=function(u){'use strict';if(this.facebarConfig.null_state){var v=this.facebarConfig.entity_cost+u.grammar_costs['{'+u.type+'}'],w=k.processEntityResult(u.type,u.uid,u.text,v);this.facebarConfig.null_state.unshift(w);}};t.prototype.addRecentEntryToNullState=function(u){'use strict';if(!this.facebarConfig.null_state)return;var v=decodeURIComponent(u.semantic);for(var w=0;w<this.facebarConfig.null_state.length;w++){var x=this.facebarConfig.null_state[w];if(x.semantic===v){this.facebarConfig.null_state.splice(w,1);break;}}var y=s({},u,{isRecent:true,isNullState:true,type:i.keywordType,structure:m.fromString(u.text),tuid:JSON.stringify({semantic:u.semantic,structure:u.structure})});if(u.icon_class)y.iconClass=u.icon_class;if(u.isRecentSearchSuggestion){y.iconClass="_5b1w";delete y.isRecentSearchSuggestion;}if(u.results_set_type)y.resultsSetType=u.results_set_type;this.facebarConfig.null_state.unshift(y);};t.prototype.clearRecentSearches=function(){'use strict';if(!this.facebarConfig.null_state)return;this.facebarConfig.null_state=this.facebarConfig.null_state.filter(function(u){return !u.isRecent;});};t.prototype.setSortFunction=function(u){'use strict';this._sortFunction=u;};t.prototype.addBootstrap=function(u){'use strict';var v=this.bootstrapCache;u.forEach(function(w){var x=this.getEntry(w);x.bootstrapped=true;var y=this.tokenize(x.textToIndex,true);if(x.tokens)Array.prototype.push.apply(y,x.tokens.split(' '));Array.prototype.push.apply(y,this.getExtraTokensToIndex(x));y.forEach(function(z){if(!v.hasOwnProperty(z))v[z]={};v[z][w]=true;});},this);};t.prototype.getExtraTokensToIndex=function(u){'use strict';var v=[];if(u.alias!=null)v.push(u.alias.toLowerCase());return v;};t.prototype.addNullStateToQueryCache=function(u,v){'use strict';this.saveResults(this.facebarConfig.null_state,u,true);if(h.includeInitialTypeNamedX)this.saveResults(v,u,true);};t.prototype.extendResult=function(u,v){'use strict';var w=u.cache_id.substr(v.cache_id_length);if((w.indexOf("\"")>=0||v.tokens.length===0)&&!v.isTypeNamedXBootstrap)return null;var x;if(!!v.isTypeNamedXBootstrap){if(u.raw_text!==null){x=v.ext_text+w;}else if(u.tokens.length!==0&&u.tokens[0].text){x=u.tokens[0].text;}else return null;}else if(v.tokens[v.tokens.length-1].length!==0){x=v.ext_text+w;}else x=v.ext_text+" "+w;if(x.length===0)return null;v.ext_node.text=x;v.parse.entTokens=[x];v.parse.suffix="";this._extractStructure(v);if(!this._punctRegexp)this._punctRegexp=new RegExp(o.getPunctuation(),'g');v.semantic=v.ext_semantic.replace('(ext_string)','('+x.replace(this._punctRegexp,"")+')');v.isExtendedResult=true;return v;};t.prototype.getResults=function(u,v){'use strict';if(u.tokens.length===0||u.tokens.length==1&&u.tokens[0]==='')return {results:this.facebarConfig.null_state||[],null_state:true};var w=this._getBestQueryCache(u.cache_id),x=w.results.filter(function(ia){return !ia.isRecent;}),y={},z=this._getBootstrapMatchByType(u.tokens,y),aa=this._addMatchingBootstrapResults(u,z[0]||{},y);if(h.limitBootstrapResult)aa=aa.slice(0,h.limitBootstrapResultNum);var ba=[],ca=[];if(h.hasKeywordBootstrap){ba=aa.filter(function(ia){return ia.type===i.keywordType;});ca=aa.filter(function(ia){return ia.type!==i.keywordType;});ba.sort(this._sortFunction);ca.sort(this._sortFunction);if(aa.length>v){var da=Math.min(h.maxKeywordsToShow,ba.length);if(ca.length<v-da)da=v-ca.length;ba=ba.slice(0,da);ca=ca.slice(0,v-ba.length);}aa=ca.concat(ba);}Array.prototype.push.apply(aa,q(this._getResultsFromCache.bind(this,z,u),x));if(!h.hasKeywordBootstrap){aa.sort(this._sortFunction);if(!h.graphSearchV2&&h.keywordSearchEnabled)j.addExactMatch(u,aa,v);}var ea={},fa=[],ga=false,ha=0;aa.forEach(function(ia){var ja=m.fromStruct(ia.structure);if(ja.hasType('blank')){fa.push(ia);return;}ia.semantic=ia.semantic.toLowerCase();if(!ia.termMatches)ia.termMatches=y[ia.semantic];var ka=t.getUniqueSemantic(ia.semantic),la=t.getUniqueSemantic(ia.alternateSemantic);if(!ka)return;var ma=ea[ka]||la&&ea[la];if(ma){if(ia.isJSBootstrapMatch){ma.isJSBootstrapMatch=true;ma.bootstrapCost=ia.bootstrapCost;}else if(ma.isJSBootstrapMatch&&ia.backendCost!==undefined&&ma.backendCost===undefined)ma.backendCost=ia.backendCost;if(!!ia.tags)Object.assign(ma.tags||{},ia.tags);return;}if(ga&&ia.blankFilled)return;if(ia.type.indexOf('browse_type')>=0){ha+=1;if(this.facebarConfig.maxGrammarResults!==undefined&&ha>this.facebarConfig.maxGrammarResults)return;}ga=ga||!!ia.blankFilled;ea[ka]=ia;if(la)ea[la]=ia;fa.push(ia);},this);return {results:fa};};t.prototype.saveResults=function(u,v,w,x,y){'use strict';u=u.map(this._processBackendResult,this);var z=[],aa={},ba={};u.forEach(function(da){ba[da.semantic]=true;da.parse&&da.parse.disambiguation&&da.parse.disambiguation.forEach(function(ea){var fa=l.semanticForestConversion(ea);aa[fa]=true;});});var ca=this._getBestQueryCache(v.cache_id);ca.results.forEach(function(da){if(da.type==='websuggestion')return;if(da.exactMatchKeyword)return;if(da.isExtendedResult)return;if(da.semantic in aa)return;var ea=this._getDifferenceArrayTokens(da.tokens,v.tokens),fa=this._getNumTokensMatching(ea,da);fa=this._tryMatchingFinalInsertedEntity(ea,fa,da);if(fa>0&&fa==ea.length||(da.type==="shortcut"&&da.termMatches.indexOf(v.tokens[v.tokens.length-1]))>=0){da.cacheOnlyResult=!ba[da.semantic];z.push(da);}},this);if(h.limitCacheResult)z=z.slice(0,h.limitCacheResultNum);u.forEach(function(da){da.tokens=v.tokens;da.cache_id_length=v.cache_id.length;if(!!da.isTypeNamedXBootstrap)++da.cache_id_length;z.push(da);},this);if(y)Array.prototype.push.apply(z,y);if(this.queryCache[v.cache_id]===undefined)this.queryCache[v.cache_id]={};Object.assign(this.queryCache[v.cache_id],{tokens:v.tokens,results:z,incomplete:w},x);};t.prototype.alreadyKnown=function(u){'use strict';return !!this.queryCache[u]&&!this.queryCache[u].incomplete;};t.prototype.stripBrackets=function(u){'use strict';return u.replace(/^[\[\{]/,'').replace(/[\]\}]$/,'');};t.prototype._extractStructure=function(u){'use strict';function v(y,z,aa){return {type:y==='ent:extend_string'?'text':y,text:z,uid:aa||null};}function w(y,z){y.split(' ').forEach(function(aa){if(aa!==''){if(z)u.chunks.push(u.structure.length);u.structure.push(v('text',aa));}u.structure.push(v('text',' '));});u.structure.pop();}function x(y){if(u.structure.length!==0||i.nonGrammarTypes[u.type])return y;return y.charAt(0).toUpperCase()+y.substr(1);}u.structure=[];u.chunks=[];u.parse.display.forEach(function(y){if(typeof y==='string'){w(x(y),true);}else if(y.type==='ent:extend_string'){w(y.text,true);}else if(y.uid){var z=this.getEntry(y.uid,y.fetchType);u.chunks.push(u.structure.length);if(z==null)throw new Error('No entry found for uid \"'+y.uid+'\", type \"'+y.fetchType+'\" and piece text \"'+y.text+'\"');if(z.grammar_like){w(x(z.text),false);}else{var aa=y.type;if(y.fetchType)aa+=':'+y.fetchType;u.structure.push(v(aa,z.text,y.uid));}}else if(y.type=='blank'){u.chunks.push(u.structure.length);u.structure.push(v(y.type,'...'));}},this);return u;};t.prototype._getDifferenceArrayTokens=function(u,v){'use strict';if(!u.length)return [''].concat(v);var w=u.length-1,x=u[w];if(x==='')x=u[--w];var y='';if(typeof x=='string'&&w<v.length)y=v[w].substr(x.length);if(y===''&&w+1<v.length&&v[w+1]==='')return [''];return [y].concat(v.slice(w+1));};t.prototype._processBackendResult=function(u){'use strict';if(u.isTypeNamedXBootstrap&&u.cache_id_length)return u;u.semantic=u.semantic.toString();u.backendCost=u.cost;this._extractStructure(u);if(u.type.match(/^\{.*\}$/))u.useExtendedIndex=true;if(u.alternateSemantic)u.alternateSemantic=u.alternateSemantic.toLowerCase().replace(/\[(\d*)\]/g,'$1');if(u.parse.extendable){var v=null;u.parse.display.forEach(function(ba){if(ba.type!=="ent:extend_string")return;v=ba;},this);if(!v||u.semantic.match(/\[.*\]/).length!==1){u.parse.extendable=false;}else{u.ext_node=v;u.ext_semantic=u.semantic.replace(/\[(.*)\]/g,'ext_string');u.ext_text=v.text;}}if(u.semantic.match(/\[\d*\]/)){var w=u.parse,x=w.pos;if(x===undefined){u.semantic=u.semantic.replace(/\[(\d*)\]/g,'$1');}else{var y=w.remTokens[w.remTokens.length-1];if(w.remTokens.length&&u.structure[u.chunks[y]]&&u.structure[u.chunks[y]].uid){x=w.remTokens[w.remTokens.length-1];u.completed=true;}var z=u.structure[u.chunks[x]].uid;if(z===null){u.semantic=u.semantic.replace(/\[(\d*)\]/g,'$1');}else{var aa=new RegExp('\\['+z+'\\]','g');u.unsubstituted_semantic=u.semantic;u.semantic=u.semantic.replace(aa,z);if(w&&w.disambiguation&&w.disambiguation.length>0){w.disambiguation=w.disambiguation.filter(function(ba){return ba.indexOf('['+z+']')!==-1;});w.unsubstituted_disambiguation=w.disambiguation.splice(0);w.disambiguation=w.disambiguation.map(function(ba){return ba.replace(aa,z);});}}}}u.semantic=u.semantic.replace(/\[(.*)\]/g,'$1');u.tuid=JSON.stringify({semantic:u.semantic,structure:u.structure});return u;};t.prototype._sortFunction=function(u,v){'use strict';return (u.cost||0)-(v.cost||0);};t.prototype._getResultsFromCache=function(u,v,w){'use strict';var x=v.tokens,y=this._getDifferenceArrayTokens(w.tokens,x),z=[],aa=this._getNumTokensMatching(y,w),ba=this._tryMatchingFinalInsertedEntity(y,aa,w);if(w.parse.extendable||w.isExtendedResult){var ca=this.extendResult(v,w);if(ca)z.push(ca);if(w.isExtendedResult)return z;}if(ba>0&&ba==y.length&&!(w.type===n.result_type&&y.length===1&&y[0]==='"'))z.push(w);if(w.type==="shortcut"&&w.termMatches.indexOf(v.tokens[x-1])>=0)z.push(w);return z;};t.prototype._addMatchingBootstrapResults=function(u,v,w){'use strict';var x=u.tokens;return q((function(y){var z=v[y];if(z===undefined)return [];var aa=[],ba=k.getQueryFeatures(u);z.forEach(function(ca){var da=this.getEntry(ca,y);if(!this._isTitleTermMatch(x,da)&&!this._isAliasMatch(u.raw_text,da))return;var ea=this._isExactNameMatch(x,da)||this._isAliasMatch(u.raw_text,da),fa=ea?0:this.facebarConfig.non_title_term_match_penalty,ga=this._isNonGrammarTermMatch(x,da),ha=da.grammar_costs?da.grammar_costs['{'+y+'}']:0,ia=ha+fa+this.facebarConfig.entity_cost+this.facebarConfig.grammar_stop_words_penalty*!ga,ja=k.processEntityResult(y,ca,da.text,ia,u,ba,w,ea,!ga);ja.bootstrapCost=ia;ja.isJSBootstrapMatch=true;if(y===i.keywordType){ja.iconClass=da.iconClass;ja.isRecentSearchSuggestion=da.isRecentSearchSuggestion;ja.parse=da.parse;ja.subtext=da.subtext;ja.semantic=da.semantic;ja.cost+=.001*da.text.length;}aa.push(ja);},this);return aa;}).bind(this),this.facebarConfig.bootstrap_types);};t.prototype._isTitleTermMatch=function(u,v){'use strict';var w=u[0]||{};if(typeof w=='object')return false;var x=v.titleToIndex;return u.length===1?this._isTokenizePrefixMatch(w,x):o.isExactMatch(w,x);};t.prototype._isExactNameMatch=function(u,v){'use strict';var w=u[0]||{};if(typeof w=='object')return false;var x=v.text;for(var y=0;y<u.length-1;++y)if(u[y]!==''&&!o.isExactMatch(u[y],x))return false;return u.length>0&&this._isTokenizePrefixMatch(u[u.length-1],x);};t.prototype._isAliasMatch=function(u,v){'use strict';return v.alias!=null&&u!=null&&o.isExactMatch(v.alias,u);};t.prototype._isNonGrammarTermMatch=function(u,v){'use strict';var w=o.parse(v.titleToIndex.toLowerCase()),x=w.tokens.filter(function(aa){return aa!==''&&!this.facebarConfig.grammar_stop_words[aa];},this);x=x.join(' ');for(var y=0;y<u.length;++y){if(typeof u[y]=='object')return true;var z=y===u.length-1?this._isTokenizePrefixMatch(u[y],x):o.isQueryMatch(u[y],x);if(z)return true;}return false;};t.prototype._getBootstrapMatchByType=function(u,v){'use strict';if(u.length===0)return [];var w=u.map(function(){return {};}),x=u[u.length-1]==='',y={},z,aa=x?u.length-1:u.length,ba=u[aa-1];if(aa&&ba.uid){this._pushBootstrapEntryAtPosition(w,aa-1,ba.uid);return w;}for(var ca in this.bootstrapCache)if(aa&&this.unicodeMatch.prefixMatch(ca,ba)&&(!x||ca===ba))for(z in this.bootstrapCache[ca])if(!y[z]){y[z]=1;this._addMatchedTerm(z,ca,v);this._pushBootstrapEntryAtPosition(w,aa-1,z);}for(var da=aa-2;da>=0;da--){if(typeof u[da]=='object')break;if(u[da].length&&u[da][0]=='"')break;for(z in this.bootstrapCache[u[da]]){if(!y[z])y[z]=0;if(y[z]+da==aa-1){++y[z];this._addMatchedTerm(z,u[da],v);this._pushBootstrapEntryAtPosition(w,da,z);}}}return w;};t.prototype._addMatchedTerm=function(u,v,w){'use strict';(w[u]=w[u]||[]).push(v);return w;};t.prototype._pushBootstrapEntryAtPosition=function(u,v,w){'use strict';var x=this.getEntry(w);if(!x)return;var y=[];if(x.grammar_costs){y=Object.keys(x.grammar_costs).map(function(ba){return this.stripBrackets(ba);},this);}else y=[x.type];for(var z=0;z<y.length;z++){var aa=y[z];if(u[v][aa]===undefined)u[v][aa]=[];u[v][aa].push(w);}};t.prototype._getNumTokensMatching=function(u,v){'use strict';var w=0,x=v.parse,y=u.length,z=null,aa=null;if(x.pos!==undefined){var ba=v.structure[v.chunks[x.pos]];if(ba){z=ba.uid;aa=ba.type.split(':')[2];}}v.outputTokensUsed=[];v.termMatches=[];if(z){w=this._prefixMatchEntity(u,x,z,v.outputTokensUsed,aa,!!v.useExtendedIndex,v.termMatches);if(w===0||w===y)return w;}else if(x.suffix&&y==1&&x.suffix.indexOf(u[0])===0){return y;}else if(x.suffix==u[0]){++w;}else return 0;var ca=[];x.remTokens=x.remTokens||[];for(var da=0;da<x.remTokens.length;da++){if(typeof u[w]!='string'||v.chunks.length<=x.remTokens[da]||v.structure.length<=v.chunks[x.remTokens[da]]||v.structure[v.chunks[x.remTokens[da]]].uid)break;var ea=v.structure[v.chunks[x.remTokens[da]]].text;ca.push(ea.toLowerCase());}w=this._greedyMatchText(ca,u,w,x.remTokens,v.outputTokensUsed,v.isNullState);if(w==y-1&&u[w]==='')return y;return w;};t.prototype._prefixMatchEntity=function(u,v,w,x,y,z,aa){'use strict';v.entTokens=v.entTokens||[];if(v.entTokens.length===0){if(u[0]!=='')return 0;if(v.possessive&&u.length>1&&u[1]=='\'s'){x.push([v.pos+1]);return 2;}else return 1;}var ba=false,ca=this.getEntry(w,y);if(typeof y!=='undefined'&&y!==ca.fetchType)return 0;var da=this.tokenize(z?ca.textToIndex:ca.text,true),ea=[];for(var fa=0;fa<u.length+v.entTokens.length-1;fa++)if(fa<v.entTokens.length-1){ea.push(v.entTokens[fa]);}else if(fa==v.entTokens.length-1){ea.push(v.entTokens[fa]+u[0]);}else ea.push(u[fa-v.entTokens.length+1]);var ga=-v.entTokens.length+1;for(var ha=0;ha<ea.length;++ha){var ia=ea[ha];if(typeof ia!='string')break;if(ia===''){ga++;continue;}var ja=false;for(var ka=0;ka<da.length;ka++)if(da[ka]==ia||ha===ea.length-1&&da[ka].indexOf(ia)===0){if(aa)aa.push(da[ka]);da[ka]='';ja=true;++ga;break;}if(ja)continue;if(!v.possessive||ia.length<=2||ia.substr(ia.length-2)!='\'s')break;var la=ia.substr(0,ia.length-2);for(ka=0;ka<da.length;ka++)if(da[ka]==la){++ga;if(x)ba=true;break;}break;}if(ga>0){if(ba)x.push([v.pos+1]);return ga;}if(x===undefined)return 0;var ma=u[0],na=ma;if(v.possessive&&ma.length>=2&&ma.substr(ma.length-2)=='\'s')na=ma.substr(0,ma.length-2);v.suffix=v.suffix||'';if(u.length==1&&v.suffix.indexOf(ma)===0||v.suffix==na||v.suffix==ma){if(na!=ma&&v.suffix==na)x.push([v.pos+1]);return 1;}return 0;};t.prototype._tryMatchingFinalInsertedEntity=function(u,v,w){'use strict';if(!w.completed||v<0)return v;var x=w.parse,y=x.remTokens[x.remTokens.length-1],z=w.structure[w.chunks[y]],aa=this.getEntry(z.uid,z.type),ba=this.tokenize(aa.text,true);v=this._greedyMatchText(ba,u,v);if(v==u.length-1&&u[v]==='')return u.length;return v;};t.prototype._greedyMatchText=function(u,v,w,x,y,z){'use strict';for(var aa=0;aa<u.length;aa++){var ba=u[aa];if(ba==v[w]){if(y!==undefined)y.push(x[aa]);++w;continue;}if(w===v.length-1&&ba.indexOf(v[w])===0){if(y!==undefined)if(ba==v[w]){y.push([x[aa]]);}else y.push([x[aa],v[w].length]);return v.length;}if(z)break;}return w;};t.prototype._getBestQueryCache=function(u){'use strict';for(var v=u.length;v>=0;v--){var w=this.queryCache[u.slice(0,v)];if(w)return w;}};t.prototype._getFBObjectType=function(u){'use strict';if(this.typeaheadTypeMap[u]){return this.typeaheadTypeMap[u];}else return 'page';};t.prototype._isTokenizePrefixMatch=function(u,v){'use strict';return o.isPrefixMatch(this.unicodeMatch.prefixMatchPrepare(u),this.unicodeMatch.prefixMatchPrepare(v));};t.EPSILON=1e-05;t.getUniqueSemantic=function(u){if(!u)return;var v=[],w=[],x=[];u='('+u+')';var y=u,z=false;u.replace(/[\(\),]/g,function(aa,ba){var ca;switch(aa){case ',':var da=x.length-1;ca=y.substr(x[da],ba-x[da]);v[da].push(ca);x[da]=ba+1;break;case '(':x.push(ba+1);v.push([]);w.push(ba+1);break;case ')':if(x.length===0)throw u+' is not a valid semantic string';var ea=x.pop();ca=y.substr(ea,ba-ea);ca=decodeURI(ca.replace(/%/g,'%25').replace(/\s/g,'+').trim());var fa=v.pop();fa.push(ca);var ga=fa.sort();for(var ha=1;ha<ga.length;ha++)if(ga[ha]==ga[ha-1])z=true;var ia=ga.join(',');y=y.substr(0,w.pop())+ia+y.substr(ba);break;}return aa;});if(z)return '';return y.replace(/\((.*)\)/,'$1');};f.exports=t;},null);
__d("FacebarTokenizer",["TokenizeUtil"],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i="[^\"]",j=["\\s's","'s","\""+i+"*\"?"],k=[[/\s+$/,''],[/\"\s+/,'"'],[/\s+\"/,'"'],[/\"\"/,''],[/^\"$/,''],[/\s+/,' ']],l={tokenize:function(m,n){var o=[],p=0;m=m.replace(/\s/g,' ').toLowerCase();m.replace(new RegExp(j.join('|'),'g'),function(r,s){if(s>p){var t=m.substr(p,s-p);Array.prototype.push.apply(o,h.parse(t).tokens.slice(0));}var u=r;for(var v=0;v<k.length;v++){var w=k[v];u=u.replace(w[0],w[1]);}if(o.length&&u=='\'s'){o[o.length-1]+=u;}else if(u!=='')o.push(u);if(n)Array.prototype.push.apply(o,h.parse(r).tokens);p=s+r.length;});if(p<m.length){var q=m.substr(p,m.length-p);Array.prototype.push.apply(o,h.parse(q).tokens.slice(0));}return o;}};f.exports=l;},null);
__d('FacebarTypeaheadTypeNamedX',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={browse_type_user:'user',browse_type_page:'page',browse_type_place:'place',browse_type_group:'group',browse_type_application:'app'},i=1,j=2;k.addTypeNamedX=function(l,m,n,o){'use strict';var p=new k(),q=[],r=[];l.forEach(function(w){delete w.tags.hiddenSeeMore;if(w.isSeeMore){q.push(w);}else r.push(w);});if(!o.showTypeNamedX){q.forEach(function(w){w.tags.hiddenSeeMore=true;});return r;}var s=p.buildTypeNamedXBuckets(r,q,n,o),t=s[0],u=s[1];t.forEach(function(w){w.tags.displayedSeeMore=true;});var v=p.replaceResults(r,m,t);Array.prototype.push.apply(v,u);v.forEach(function(w){w.tags.hiddenSeeMore=true;});return r;};k.prototype.buildTypeNamedXBuckets=function(l,m,n,o){'use strict';var p={};o=o||{};l.forEach(function(t,u){var v=t.render_type||t.type;if(p[v]===undefined)p[v]={index:u,matchCount:0};if(!o.alwaysDisplayTypeNamedX&&t.text.toLowerCase().indexOf(n.toLowerCase())<0)return;p[v].matchCount++;});var q=[],r=[];m.forEach(function(t){var u=h[t.results_set_type];if(p[u]!==undefined&&p[u].matchCount>=i){q.push([t,p[u].index]);}else r.push(t);});q.sort(function(t,u){return t[1]-u[1];});var s=q.map(function(t){return t[0];});Array.prototype.push.apply(r,s.slice(j));s.length=Math.min(s.length,j);return [s,r];};k.prototype.replaceResults=function(l,m,n){'use strict';var o=[],p=Math.min(0,l.length-m)+n.length;for(var q=0;q<p;++q){var r=-1;for(var s=0;s<Math.min(m-q,l.length);++s){var t=l[s];if(!t.exactMatchKeyword&&t.type!=='websuggestion')r=s;}if(r>=0){o.push(l[r]);l.splice(r,1);}}Array.prototype.unshift.apply(l,n);return o;};function k(){'use strict';}f.exports=k;},null);
__d('FacebarTypeaheadL2Terms',['FacebarJSConstants'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=3,j={addL2Terms:function(k,l,m,n){if(!n.suggestBackendL2Terms)return k;var o=[],p=[];k.forEach(function(r){if(r.exactMatchKeyword){r.tags.l2_suggestion=true;o.push(r);}else if(r.isKeywordL2){r.tags.l2_suggestion=true;r.type='l2suggestion';o.push(r);}else if(r.type!=='keywords')p.push(r);});var q=0;return p.map(function(r){if(h.entityTypes[r.type])if(q<i){q++;}else if(o.length)return o.pop();return r;});}};f.exports=j;},null);
__d('ResultsBucketizer',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i,j){'use strict';this.$ResultsBucketizer1=i;this.$ResultsBucketizer2=j;}h.trimResults=function(i,j,k){'use strict';var l=[];i.forEach(function(m,n){if(m.indexBeforeBuckets>j)l.push({index:n,originalIndex:m.indexBeforeBuckets});});l.sort(function(m,n){return m.originalIndex-n.originalIndex;}).slice(k).sort(function(m,n){return n.index-m.index;}).forEach(function(m){i.splice(m.index,1);});};h.mergeBuckets=function(i,j){'use strict';var k=[];for(var l in j)if(!j[l].rule.hidden&&(!j[l].rule.xor||!j[j[l].rule.xor]))k.push(j[l]);k.sort(function(m,n){var o=(m.rule.position||0)-(n.rule.position||0);if(o!==0)return o;return m.results[0].indexBeforeBuckets-n.results[0].indexBeforeBuckets;});i.length=0;k.forEach((function(m,n){if(m.rule.maxPromotions!=null&&n<k.length-1)h.trimResults(m.results,k[n+1].results[0].indexBeforeBuckets,m.rule.maxPromotions);Array.prototype.push.apply(i,m.results);}).bind(this));};h.prototype.$ResultsBucketizer3=function(i,j){'use strict';if(j.propertyName==null)return j.bucketName||'default';var k=this.$ResultsBucketizer2(i,j.propertyName);if(k==null||j.propertyValue!=null&&''+k!==j.propertyValue)return false;return j.bucketName||j.propertyName+'.'+k;};h.prototype.$ResultsBucketizer4=function(i,j){'use strict';var k={};i.forEach((function(l,m){j.some((function(n){var o=this.$ResultsBucketizer3(l,n);if(o===false)return false;if(k[o]==null)k[o]={results:[],rule:n};if(!!n.maxResults&&k[o].results.length>=n.maxResults)return true;l.bucketLineage.push({bucketName:o,bucketIndex:k[o].results.length});k[o].results.push(l);return true;}).bind(this));}).bind(this));return k;};h.prototype.$ResultsBucketizer5=function(i,j){'use strict';var k=this.$ResultsBucketizer1[j];if(!k)return {};var l=this.$ResultsBucketizer4(i,k);for(var m in l){var n=l[m].rule.subBucketRules;if(!!n)this.$ResultsBucketizer5(l[m].results,n);}h.mergeBuckets(i,l);return l;};h.prototype.$ResultsBucketizer6=function(i,j,k){'use strict';if(j.length<=k)return j.slice();var l=j.map(function(n){return n.indexBeforeBuckets;}),m=l.sort(function(n,o){return n-o;})[k];return j.filter(function(n){return n.indexBeforeBuckets<m;});};h.prototype.bucketize=function(i,j,k){'use strict';i.forEach(function(l,m){l.bucketLineage=[];l.indexBeforeBuckets=m;});k=k||{};Object.assign(k,this.$ResultsBucketizer5(i,'main'));return this.$ResultsBucketizer6(k,i,j);};f.exports=h;},null);
__d('FacebarDataSource',['Arbiter','AsyncRequest','FacebarFindPeopleAndPages','FacebarGlobalOptions','FacebarGSv2Echo','FacebarJSConstants','FacebarResultStore','FacebarResultStoreUtils','FacebarStructuredText','FacebarTimerUtils','FacebarSemanticUtils','FacebarTokenizer','FacebarTypeaheadTypeNamedX','FacebarTypeNamedXBootstrap','FacebarTypeaheadL2Terms','FacebarTypeNamedXTokenOptions','FacebarURI','ResultsBucketizer','ResultsBucketizerConfig','SearchDataSource','Vector','ViewportBounds','throttle','invariant','queryThenMutateDOM','setTimeoutAcrossTransitions'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga){if(c.__markCompiled)c.__markCompiled();var ha=Object.assign||function(la){for(var ma=1;ma<arguments.length;ma++){var na=arguments[ma];for(var oa in na)if(Object.prototype.hasOwnProperty.call(na,oa))la[oa]=na[oa];}return la;},ia,ja;ia=aa;ja=ia&&ia.prototype;Object.assign(ka,ia);ka.prototype=Object.create(ia.prototype);ka.prototype.constructor=ka;ka.__superConstructor__=ia;function ka(la){'use strict';ja.constructor.call(this,la);this._fetched_null_state=null;this._initialQueryData=null;this._curQueryId=-1;this._maxRemoteQueryId=-1;this._single_state=true;this._waitingQueries=0;this.mixGrammarAndEntity=la.mixGrammarAndEntity!==undefined?la.mixGrammarAndEntity:true;this.grammarVersion=la.grammarVersion||'';if(!la.grammarOptions)la.grammarOptions={};this.recordingRoute='banzai_vital';this._maxGrammarResults=la.grammarOptions.maxGrammarResults;this.nullStateEndpoint=la.nullStateEndpoint||'/ajax/browse/null_state.php';this.setNullStateData(la.nullStateData||{},true);this._minQueryLength=la.minQueryLength||-1;this._fixProcessLean=la.grammarOptions.fixProcessLean||false;this.hasGSPreload=k.hasGSPreload;this.gsPreloadOptions=k.gsPreloadParams;this.throttleExecuteQuery();this.throttleSendRemoteQuery();this.throttleRenderResults();this.resultStoreOptions=la.grammarOptions||{};this.resultStoreOptions.useNewExactNameMatch=la.grammarOptions.useNewExactNameMatch==="true";this.defaultQuery=null;this._bypassBucketizer=false;this._resultsBucketizer=new y(z.rules,function(ma,na){switch(na){case 'isSeeMore':return ma.isSeeMore;case 'objectType':return ma.type;case 'resultSetType':return ma.results_set_type;case 'renderType':return ma.render_type||ma.type;case 'cacheOnlyResult':return ma.cacheOnlyResult;case 'closeEntity':return ma.bootstrapped||(!!ma.tags?ma.tags[na]:undefined);default:return !!ma.tags?ma.tags[na]:undefined;}});this.fetchNullState();this.initWithConfig(k.grammarConfig);}ka.prototype.initWithConfig=function(la){'use strict';this.facebarConfig=la;this.createResultStore();this.blockees={};if(this._fetched_null_state){this.setNullState(this._fetched_null_state);this._fetched_null_state=null;}};ka.prototype.throttleExecuteQuery=function(){'use strict';var la=k.executeQueryThrottleTime;this.executeQueryThrottled=da.withBlocking(this.executeQuery,la,this);};ka.prototype.throttleSendRemoteQuery=function(){'use strict';var la=k.sendRemoteQueryThrottleTime;if(la===0){this.sendRemoteQueryThrottled=this.sendRemoteQuery;}else if(k.lazyThrottleRemoteQuery){var ma=Date.now(),na=k.enableSendRemoteQueryDelay,oa=k.sendRemoteQueryDelayTime;this.sendRemoteQueryThrottled=(function(){for(var pa=arguments.length,qa=Array(pa),ra=0;ra<pa;ra++)qa[ra]=arguments[ra];var sa=Date.now();if(ma+la<sa){ma=sa;if(na){ga((function(){this.sendRemoteQuery.apply(this,qa);}).bind(this),oa);}else this.sendRemoteQuery.apply(this,qa);}}).bind(this);}else this.sendRemoteQueryThrottled=da.withBlocking(this.sendRemoteQuery,la,this);};ka.prototype.throttleRenderResults=function(){'use strict';var la=k.renderThrottleTime;if(la===0){this.renderResultsThrottled=this.renderResults;return;}var ma=Date.now();this.renderResultsThrottled=(function(na,oa,pa,qa){var ra=Date.now();if(pa||ma+la<ra){ma=ra;this.renderResults(na,oa,pa,qa);}}).bind(this);};ka.prototype.createResultStore=function(){'use strict';this.facebarConfig.maxGrammarResults=this._maxGrammarResults;this.resultStore=new n(this.facebarConfig,s.tokenize,this.getEntry.bind(this),this.resultStoreOptions);if(this._fixProcessLean)this._processLean();this.subscribe('setSortFunction',(function(la,ma){this.resultStore.setSortFunction(ma);}).bind(this));};ka.prototype.dirty=function(){'use strict';this._nullStateFetched=false;this.resultStore.resetCaches();ja.dirty.call(this);};ka.prototype.addEntries=function(la){'use strict';this.resultStore.addBootstrap(this.processEntries(la));};ka.prototype._processLean=function(){'use strict';if(this._fixProcessLean){if(this._leanPayload&&this.resultStore){var la,ma=this._leanPayload.entries;for(var na in ma){la=this.getEntry(na);if(!la)continue;for(var oa in ma[na]){if(!la.grammar_costs)la.grammar_costs={};la.grammar_costs['{'+oa+'}']=ma[na][oa];}}this.setExclusions(this._leanPayload.blocked);this._leanPayload=null;}}else ja._processLean.call(this);};ka.prototype.setNullStateData=function(la,ma){'use strict';if(ma)this.nullStateData={grammar_version:this.grammarVersion};Object.assign(this.nullStateData,la);return this;};ka.prototype.setNullState=function(la){'use strict';this._null_state=la;this.processEntries(this._null_state.entities);this.resultStore.setNullState(this._null_state.queries);var ma=u.typeNamedX;ma.forEach(function(na){na.parse.extendable=true;na.qid=this._curQueryId;na.isTypeNamedXBootstrap=true;},this);this.resultStore.addNullStateToQueryCache(this.getRawStructure(p.fromString('')),ma);this._typeNamedXResults={};ma.forEach(function(na){this._typeNamedXResults[m.grammarToEntityTypes[na.resultsSetType]]=na;},this);};ka.prototype.getNullStateTrending=function(){'use strict';return this._null_state.trending;};ka.prototype.setSingleState=function(la){'use strict';this._single_state=la;};ka.prototype.overrideNullState=function(la){'use strict';!(this._null_state!=null)?ea(0):undefined;this._original_null_state=this._original_null_state||this._null_state;this.setNullState(la);};ka.prototype.restoreNullState=function(){'use strict';if(this._original_null_state)this.setNullState(this._original_null_state);};ka.prototype.fetchNullState=function(){'use strict';if(this._nullStateFetched){this.activityStart();setTimeout(this.activityEnd.bind(this),0);return;}var la=new i().setURI(this.nullStateEndpoint).setData(this.nullStateData).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true).setHandler((function(ma){if(this.resultStore){this.setNullState(ma.payload);this.inform('nullstateReady',true);}else this._fetched_null_state=ma.payload;this._nullStateFetched=true;}).bind(this)).setFinallyHandler(this.activityEnd.bind(this));this.activityStart();la.send();};ka.prototype.fetchNUXResults=function(la){'use strict';if(!k.allowGrammar)return;la=la||{};var ma=new i().setURI(la.URI).setData(this.nullStateData).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true).setHandler((function(na){if(this.resultStore){this.overrideNullState(na.payload);la.success&&la.success();}}).bind(this)).setFinallyHandler(this.activityEnd.bind(this));this.activityStart();ma.send();};ka.prototype.toTypeaheadEntryUid=function(la){'use strict';var ma,na=p.fromStruct(la.structure),oa=na.getFragment(0);if(na.getCount()==1&&oa.isType('ent')){var pa=oa.getType().split(':')[2];ma=this.getEntry(oa.getUID(),pa);ma.type=this.resultStore.stripBrackets(la.type);}else{ma=this.getEntry(la.tuid);if(!ma){ma={dynamic_cost:la.dynamic_cost,extra_uri_params:la.extra_uri_params,memcache:la.fromMemcache,photo:la.photo,results_set_type:la.resultsSetType,tuid:la.tuid,type:la.type,uid:la.tuid,tags:la.tags,is_redirect:la.isRedirect};this.processEntries([ma]);ma=this.getEntry(la.tuid);}ma.icon_class=la.isSingleState&&la.singleStateIconClass?la.singleStateIconClass:la.iconClass;if(k.renderKeywordSnippets){ma.category=la.category;ma.subtext=la.subtext;ma.boldedSubtext=la.boldedSubtext;}}if(ma.is_redirect)ma.path=la.path;ma.error_info=la.errorInfo;ma.logInfo=la.logInfo;ma.structure=na;ma.text=ma.structure.toString();ma.queryTypeText=la.queryTypeText;ma.semantic=!!la.isSingleState&&la.singleStateSemantic?la.singleStateSemantic:la.semantic;ma.alternateSemantic=la.alternateSemantic;ma.tree=la.tree;ma.cost=la.cost;ma.isSeeMore=!!la.isSeeMore;ma.isNullState=!!la.isNullState;ma.isSingleState=!!la.isSingleState;ma.isTrending=!!la.isTrending||la.keyword_type==m.keywordTypes.trending;ma.isCelebrity=la.keyword_type==m.keywordTypes.celebrity;ma.isRecent=!!la.isRecent;ma.isAdminedPage=!!la.isAdminedPage;ma.isPrefetched=!!la.isPrefetched;ma.isSuggestion=!!la.isSuggestion;ma.isFromGSEF=!!la.isFromGSEF;ma.isRecentSearchSuggestion=!!la.isRecentSearchSuggestion;ma.entityInfo=la.entityInfo;ma.cacheOnlyResult=la.cacheOnlyResult||false;ma.isExtendedResult=la.isExtendedResult||false;if(la.isExtendedResult){ma.uri=x.getURI(this.facebarConfig,ma);}else ma.uri=ma.uri||x.getURI(this.facebarConfig,ma);ma.semanticForest=la.semanticForest;ma.parse=la.parse;ma.tags=la.tags||{};ma.isKeywordL2=la.isKeywordL2||false;ma.exactMatchKeyword=la.exactMatchKeyword||false;ma.qid=la.qid;ma.templateID=la.templateID;if(la.isJSBootstrapMatch){ma.isJSBootstrapMatch=la.isJSBootstrapMatch;ma.backendCost=la.backendCost;ma.bootstrapCost=la.bootstrapCost;}this._replaceCategoryWithTermMatches(ma,la);return ma.tuid;};ka.prototype._replaceCategoryWithTermMatches=function(la,ma){'use strict';if(la.type!=="user"||!la.term_to_subtitle||!ma.termMatches)return;var na=[];ma.termMatches.forEach(function(pa){if(la.term_to_subtitle[pa])na.push(la.term_to_subtitle[pa]);},this);if(la.category===undefined)la.category="";var oa=la.category.split(" \xB7 ");oa.unshift.apply(oa,na);oa=oa.filter(function(pa,qa,ra){return qa==ra.indexOf(pa);});la.category=oa.splice(0,2).join(" \xB7 ");};ka.prototype.getRawStructure=function(la){'use strict';if(typeof la=='string')la=p.fromString(la);if(this.resultStore)return this.resultStore.transformStructured(la.toArray());};ka.prototype.saveResult=function(la){'use strict';this._initialQueryData=this.getUID(la.uid,la.fetchType);};ka.prototype.isDefaultKeywordQuery=function(la){'use strict';return la.type===m.keywordType&&o.getTextFromResult(la).toLowerCase()===this.value.getHash().trim().toLowerCase();};ka.prototype.buildUids=function(la){'use strict';if(!la||!this.resultStore)return [];if(typeof la==='string')la=p.fromString(la);var ma=this.getRawStructure(la),na=this.resultStore.getResults(ma,this.getMaxResults()),oa=na.results;if(typeof oa==='undefined')return [];var pa=na.null_state===true,qa=0;oa=oa.filter(function(ua,va){if(!k.allowGrammar&&ua.type=='grammar')return false;return ua.semantic!='<blank>'&&(ua.type!='unimplemented'||(qa++)===0);},this);var ra=[],sa=[],ta=[];oa.forEach(function(ua){if(ua.forcedPosition>0){ta.push(ua);}else if(ua.isSeeMore){ra.push(ua);}else sa.push(ua);});if(pa){oa=this.orderNullState(oa,this.getMaxResults());}else oa=sa;if(ta.length>0){ta.sort(function(ua,va){return ua.forcedPosition-va.forcedPosition;});ta.forEach(function(ua){oa.splice(ua.forcedPosition,0,ua);});}if(ra.length>0)oa.push.apply(oa,ra);return oa.map(this.toTypeaheadEntryUid,this);};ka.prototype.orderNullState=function(la,ma){'use strict';var na={top:[],bottom:[],middle:[]},oa=function(ra){var sa=ra.null_state_position;return na.hasOwnProperty(sa)?sa:'middle';},pa=function(ra,sa){return ra.original_cost-sa.original_cost;};la&&la.forEach(function(ra){na[oa(ra)].push(ra);},this);for(var qa in na){na[qa]=na[qa].sort(pa).slice(0,ma);ma-=na[qa].length;}return [].concat(na.top,na.middle,na.bottom);};ka.prototype.handleResponse=function(la,ma){'use strict';if(!(la.payload.errors)){this.processEntries(la.payload.entities);if(la.payload.blockees)la.payload.blockees.forEach((function(na){if(!this.blockees.hasOwnProperty(na))this.blockees[na.toLocaleLowerCase()]=na;}).bind(this));la.payload.results.forEach((function(na){na.qid=la.queryId;if(!na.parse)na.parse={};na.parse.entTokens=na.parse.entTokens||[];na.parse.remTokens=na.parse.remTokens||[];na.parse.suffix=na.parse.suffix||'';if(r.isEntity(na.semantic))na=this._buildCommonEntityFields(na,ma.tokens);}).bind(this));this.saveResults(la,ma);}};ka.prototype.saveResults=function(la,ma){'use strict';var na=[];if(la.payload.seemore&&this._typeNamedXResults)la.payload.seemore.forEach(function(oa){na.push(this._typeNamedXResults[oa]);},this);if(la.payload.prefetched)this.processPrefetched(la.payload.prefetched);this.resultStore.saveResults(la.payload.results,ma,la.payload.incomplete,{},na);};ka.prototype.processPrefetched=function(la){'use strict';for(var ma in la){var na=p.fromString(ma),oa=this.getRawStructure(na),pa=la[ma];this.processEntries(pa.entities);pa.results.forEach((function(qa){if(r.isEntity(qa.semantic))qa=this._buildCommonEntityFields(qa,oa.tokens);}).bind(this));this.resultStore.saveResults(pa.results,oa,pa.incomplete);}};ka.prototype.processEntries=function(la){'use strict';return la.map(function(ma,na){var oa=ma.uid=ma.uid+'';ma.textToIndex=this.getTitleTerms(ma);ma.titleToIndex=this.getTitleTerms(ma);oa=this.getUID(oa,ma.fetchType);var pa=this.getEntry(oa);if(!pa){this.setEntry(oa,{});pa=this.getEntry(oa);}else{delete ma.photo;if(!k.facebarUpdateSnippets){delete ma.category;delete ma.subtext;}}Object.assign(pa,ma);pa.tuid=oa;pa.index===undefined&&(pa.index=na);return oa;},this);};ka.prototype.getUID=function(la,ma){'use strict';la=la+'';if(ma!==undefined){ma=/([^:]+:)?([^:]+)(:.*)?/.exec(ma)[2];return JSON.stringify([la,ma]);}return la;};ka.prototype.getEntry=function(la,ma){'use strict';var na;la=''+la;na=ma!=null?ja.getEntry.call(this,this.getUID(la,ma))||ja.getEntry.call(this,la):ja.getEntry.call(this,la);return na;};ka.prototype.getEntryForFragment=function(la){'use strict';return this.getEntry(la.getUID(),la.getTypePart(2));};ka.prototype.getMaxResults=function(){'use strict';return this._numResults.max;};ka.prototype.query=function(la,ma,na){'use strict';this.executeQueryThrottled(la,this._initialQueryData,{keyPress:q.getTimestamp()});this._initialQueryData=null;};ka.prototype.executeQuery=function(la,ma,na){'use strict';this._curQueryId++;na.queryId=this._curQueryId;na.startCacheQuery=q.getTimestamp();var oa=this.getMaxResults()+w.additionalResultsToFetch;this.setQueryData({qid:this._curQueryId,max_results:oa});this.inform('beforeQuery',{value:la,queryId:this._curQueryId});this.value=la;var pa=this.buildUids(la,[]);na.endCacheQuery=q.getTimestamp();if(ma&&pa.length===0)pa.push(ma);if(k.sendExistingIDs){var qa=[];pa.forEach(function(ra){var sa=this.getEntry(ra);if(sa&&sa.type in m.entityTypes)qa.push(sa.uid);},this);if(qa.length>0)this.setQueryData({qid:this._curQueryID,existing_ids:JSON.stringify(qa),max_results:oa});}this.inform('query',{value:la,results:pa,queryId:this._curQueryId});if(this.resultStore)this.respond(la,pa,false,false,na);};ka.prototype.shouldFetchMore=function(la,ma){'use strict';if(la.is_empty)return false;if(this.resultStore.alreadyKnown(la.cache_id))return false;if(la.raw_text&&this._isQueryTooShort(la.raw_text))return false;if(k.alwaysFetchMore)return true;if(ma.length<this.getMaxResults())return true;return this.countValidResults(ma)<this.getMaxResults();};ka.prototype.countValidResults=function(la){'use strict';var ma=0;la.forEach(function(na){if(na&&!na.isNullState&&!na.isSeeMore)ma++;},this);return ma;};ka.prototype.sendRemoteQuery=function(la,ma,na,oa,pa){'use strict';var qa=this._single_state,ra=this.getQueryData(la.text_form);ra.gs_prefetch_mode=oa;if(pa)ra.max_results=pa;var sa=new i().setURI(this.queryEndpoint).setData(ra).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true).setHandler((function(ta,ua){if(oa&&ua.payload.is_user)return;ua.queryId=ta;ua.inputQuery=la.text_form;if(ua.payload.results!=null)ua.payload.results.forEach(function(wa){wa.isSingleState=qa;wa.isFromGSEF=oa;});na.endRemoteQuery=q.getTimestamp();this.inform('response_received',ua);this.handleResponse(ua,la);var va=[];if(ua.payload.abandon_cache)va=ua.payload.results.map(this.toTypeaheadEntryUid,this);this.respond(ma,va,true,ua.payload&&(!ua.payload.results||ua.payload.results.length===0),na);this.inform('backend_response',ua);if(k.disable_snowballing){this.resultStore.resetQueryCache();this.saveResults(ua,la);}}).bind(this,na.queryId)).setFinallyHandler(this.activityEnd.bind(this));this.inform('sending_request',sa);this._maxRemoteQueryId=na.queryId;na.waitingQueries=this._waitingQueries;na.inflightRequests=i.getInflightCount();na.startRemoteQuery=q.getTimestamp();sa.send();this.activityStart();};ka.prototype.activityStart=function(){'use strict';if(!this._waitingQueries)this.inform('activity',{activity:true},h.BEHAVIOR_STATE);this._waitingQueries++;};ka.prototype.activityEnd=function(){'use strict';this._waitingQueries--;if(!this._waitingQueries)this.inform('activity',{activity:false},h.BEHAVIOR_STATE);};ka.prototype._bucketizeResults=function(la,ma){'use strict';ma=this._tagKeywordsSuggestions(ma);ma=v.addL2Terms(ma,this.getMaxResults(),la.toString(),k);ma=t.addTypeNamedX(ma,this.getMaxResults(),la.toString(),k);var na=Math.min(ma.length,this.getMaxResults());return this._resultsBucketizer.bucketize(ma,na);};ka.prototype._tagKeywordsSuggestions=function(la){'use strict';if(!la||la.length===0)return la;var ma=la[0];if(ma.bootstrapped)return la;if(ma.type==='grammar'||ma.cost<k.closeEntityThreshold&&ma.type==='user')return la;return la.map(function(na){if(na.type!==m.keywordType)return na;na=ha({},na);na.tags.topBucket=true;return na;});};ka.prototype._buildCommonEntityFields=function(la,ma){'use strict';if(la.queryTypeText)return la;if(k.unbreakParseDisplay){la.parse.display=[{type:'ent:'+la.type,uid:la.semantic}];}else la.parse.display=[{type:'ent:'+la.type,uid:parseInt(la.semantic,10)}];if(la.parse.fetchType)la.parse.display[0].fetchType=la.parse.fetchType;la.parse.entTokens=ma;la.parse.pos=0;la.resultsSetType='{'+la.type+'}';la.queryTypeText=m.defaultQueryTypeText;return la;};ka.prototype.setBypassBucketizer=function(la){'use strict';this._bypassBucketizer=la;};ka.prototype.respond=function(la,ma,na,oa,pa){'use strict';if(na&&this.value){if(typeof this.value==='string')this.value=p.fromString(this.value);this.inform('remote_query_match',{isMatch:this.value.matches(la),queryId:pa?pa.queryId:0});la=this.value;if(!ma||ma.length===0)ma=this.buildUids(la);}this.inform('reorderResults',ma);this.inform('respondValidUids',ma);var qa=ma.map(this.getEntry,this);qa.forEach(function(sa,ta){sa.fromCache=!na;sa.isSingleState=this._single_state;},this);if(!na){var ra=this.getRawStructure(la);if(this.shouldFetchMore(ra,qa)){if(pa!=null)pa.dispatchRemoteQuery=q.getTimestamp();if(this.hasGSPreload){this.sendRemoteQueryThrottled(ra,la,pa,true,this.gsPreloadOptions.max_entities_to_fetch);this.sendRemoteQueryThrottled(ra,la,pa);}else this.sendRemoteQueryThrottled(ra,la,pa);}}if(!na||!pa||pa.queryId===this._maxRemoteQueryId)this.renderResultsThrottled(la,qa,na,oa);if(pa!=null)this.logLatencies(na,pa);};ka.prototype.renderResults=function(la,ma,na,oa){'use strict';if(!!la&&(la instanceof p&&!la.isEmptyOrWhitespace())&&!this._bypassBucketizer)ma=this._bucketizeResults(la,ma);ma.length=Math.min(ma.length,this.getMaxResults());this.injectExtraResults(la,ma);oa=na&&ma.length===0;this.inform('respond',{value:la,results:ma,isAsync:!!na,isEmptyResults:oa});};ka.prototype.injectExtraResults=function(la,ma,na){'use strict';l.insertInto(la,ma,!na,this._single_state);j.insertInto(la,ma,!na,this._single_state);};ka.prototype.logLatencies=function(la,ma){'use strict';var na=q.getTimestamp();if(la){this.inform('remote_query_latency',{queryId:ma.queryId,latencies:{queryStart:Math.max(ma.startRemoteQuery-ma.dispatchRemoteQuery,0),queryEnd:Math.max(ma.endRemoteQuery-ma.startRemoteQuery,0),keyPressToQueryDispatch:Math.max(ma.dispatchRemoteQuery-ma.keyPress,0),keyPressToQueryStart:Math.max(ma.startRemoteQuery-ma.keyPress,0),keyPressToQueryEnd:Math.max(ma.endRemoteQuery-ma.keyPress,0),render:Math.max(na-ma.endRemoteQuery,0),inflightRequests:ma.inflightRequests,waitingQueries:ma.waitingQueries,keyPressToRender:Math.max(na-ma.keyPress,0)}});}else this.inform('cache_query_latency',{queryId:ma.queryId,latencies:{queryStart:Math.max(ma.startCacheQuery-ma.keyPress,0),queryEnd:Math.max(ma.endCacheQuery-ma.startCacheQuery,0),keyPressToQueryEnd:Math.max(ma.endCacheQuery-ma.keyPress,0),render:Math.max(na-ma.endCacheQuery,0),keyPressToRender:Math.max(na-ma.keyPress,0)}});};ka.prototype._updateMaxResults=function(){'use strict';fa((function(){var la=ba.getViewportDimensions().y,ma=ca.getTop()||42,na=56,oa=48,pa=la-ma-oa-25;this._maxResults=Math.max(this._numResults.min,Math.min(this._numResults.max,Math.floor(pa/na)-1));this.value&&this.query(this.value);}).bind(this));};ka.prototype.getCurQueryId=function(){'use strict';return this._curQueryId;};ka.prototype.setTypenamedXOption=function(la){'use strict';k.showTypeNamedX=la;};ka.prototype.setMinQueryLength=function(la){'use strict';this._minQueryLength=la;};ka.prototype.setGrammarOption=function(la){'use strict';k.allowGrammar=la;};Object.assign(ka.prototype,{events:['query','respond','bootstrapped','activity','ready']});f.exports=ka;},null);
__d('FacebarTypeaheadDebugPane.react',['Banzai','LeftRight.react','React','Image.react'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=j.PropTypes,m=j.createClass({displayName:'FacebarTypeaheadDebugPane',propTypes:{result:l.object.isRequired},getInitialState:function(){return {feedbackSent:false};},componentWillReceiveProps:function(n){if(n.result!==this.props.result)this.setState({feedbackSent:false});},sendFeedback:function(n){var o=this.props.result;if(o.decoration.entity===o)o.decoration.entity='';var p=JSON.stringify(o),q=JSON.stringify(o.debug.allResults),r={result:p,query:o.debug.query,position:o.debug.position,sid:o.debug.sid,allResults:q,isOK:n};h.post('facebar_feedback',r,{delay:0});this.setState({feedbackSent:true});this.setState({feedbackOK:n});return false;},renderDebugText:function(n){return j.createElement('div',null,n);},render:function(){var n=this.sendFeedback.bind(this,true),o=this.sendFeedback.bind(this,false),p=this.state.feedbackSent,q=p&&this.state.feedbackOK,r=p&&!this.state.feedbackOK;return (j.createElement('div',{className:'fsm pam'},j.createElement(i,null,j.createElement('div',null,this.props.result.debug.map(this.renderDebugText)),j.createElement('div',null,j.createElement('div',{className:q?'':'hidden_elem'},j.createElement('strong',null,'Feedback sent'),j.createElement(k,{className:'mls',src:'/images/green_up.gif'})),j.createElement('div',{className:r?'':'hidden_elem'},j.createElement('strong',null,'Feedback sent'),j.createElement(k,{className:'mls',src:'/images/red_down.gif'})),j.createElement('div',{className:p?'hidden_elem':''},j.createElement('a',{href:'#',onClick:n},j.createElement(k,{src:'/images/green_up.gif'})),j.createElement('a',{href:'#',onClick:o},j.createElement(k,{className:'mls',src:'/images/red_down.gif'})))))));}});f.exports=m;},null);
__d('FacebarTypeaheadDiffText.react',['React','cx'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=h.PropTypes,k=h.createClass({displayName:'FacebarTypeaheadDiffText',propTypes:{prefix:j.string,text:j.string},renderDiff:function(l,m){return (h.createElement('span',{className:"diffNode _5td3",key:m},l));},renderParts:function(){var l=this.props.prefix,m=this.props.text;if(l==null)return this.renderDiff(m,0);var n=m.toLowerCase().indexOf(l.toLowerCase());l=l.trim();if(n===0)m=m.slice(l.length);var o=m.split(/\b/).map(this.renderDiff);if(n===0)o.unshift(l);return o;},render:function(){return (h.createElement('span',this.props,this.renderParts()));}});k.generatePrefixes=function(l,m){var n=[],o,p;for(var q=0,r=m.length;q<r;q++){p=m[q].getText();o=l.slice(0,Math.min(l.length,p.length));if(o==='')return n;if(p.toLowerCase().indexOf(o.toLowerCase())===0){n.push(o);l=l.slice(o.length);}else return n;}return n;};f.exports=k;},null);
__d('FacebarTypeaheadHighlightedText.react',['BrowseFacebarHighlighter','React'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=i.PropTypes,k=i.createClass({displayName:'FacebarTypeaheadHighlightedText',propTypes:{text:j.string,tokens:j.array},renderHighlight:function(l,m){if((m+1)%3===0){return i.createElement('span',{className:'highlightNode',key:m},l);}else if(l)return l;},renderParts:function(){var l=this.props.text,m=this.props.tokens;if(m&&l){var n=h.createRegex(m),o=l.split(n);return o.map(this.renderHighlight);}else return l;},render:function(){return (i.createElement('span',this.props,this.renderParts()));}});f.exports=k;},null);
__d('FacebarTypeaheadItem.react',['Badge.react','React','FacebarGlobalOptions','FacebarTypeaheadDebugPane.react','FacebarTypeaheadDiffText.react','FacebarTypeaheadHighlightedText.react','TimelineFilterOptions','URI','XUICloseButton.react','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){if(c.__markCompiled)c.__markCompiled();var s=i.PropTypes;function t(v){var w=v.getTypePart(0);return w?"fragment"+w.charAt(0).toUpperCase()+w.substr(1):"fragment";}var u=i.createClass({displayName:'FacebarTypeaheadItem',propTypes:{result:s.object.isRequired,className:s.string,icon:s.object,token:s.object,highlight:s.array,prefix:s.string,message:s.object,valign:s.bool},getDefaultProps:function(){return {valign:true};},renderHighlightedFragment:function(v,w){return (i.createElement(m,{className:t(v),key:w,text:v.getText(),tokens:this.props.highlight}));},renderDiffedFragment:function(v,w,x){return (i.createElement(l,{className:t(v),key:x,prefix:w,text:v.getText()}));},renderText:function(){var v=this.props.result,w=v.structure.toArray(),x=this.props.prefix;if(j.graphSearchV2&&!v.isSeeMore&&x!=null&&x.trim()!==''){var y=l.generatePrefixes(x,w);return w.map((function(z,aa){if(!y[aa])y[aa]='';return this.renderDiffedFragment(z,y[aa],aa);}).bind(this));}else return w.map(this.renderHighlightedFragment);},renderBadge:function(){if(this.props.result.is_verified){return (i.createElement(h,{type:'verified',size:'medium'}));}else if(this.props.result.is_work_user){return (i.createElement(h,{type:'work',size:'medium'}));}else if(this.props.result.pages_verified_badge===1){return (i.createElement(h,{type:'page_blue_seal',size:'medium'}));}else if(this.props.result.pages_verified_badge===2)return (i.createElement(h,{type:'page_gray_seal',size:'medium'}));},renderIcon:function(){var v=this.props.result,w=v.icon_class;if(w){return (i.createElement('span',{className:"_k83"},i.createElement('span',{className:w})));}else if(v.photo)return (i.createElement('img',{className:"_20h",alt:'',src:v.photo}));},renderLabel:function(){var v=' \u00B7 ',w=this.props.result,x="_53ad"+(this.props.valign&&this.props.token&&this.props.token.props&&this.props.token.props.text.length>0?' '+"_55y-":'')+(!w.category&&!w.subtext?' '+"_2vzo":'')+(!w.category&&!!w.subtext||w.category&&w.category.indexOf(v)<0&&!w.subtext?' '+"_2vzp":'')+(w.category&&!!w.subtext||w.category&&w.category.indexOf(v)>0?' '+"_2vzq":''),y=i.createElement('span',{className:x},this.renderText(),this.renderBadge(),this.props.token),z="_7gk"+(this.props.message?' '+"_5byz":'');return (i.createElement('span',{className:z},y,this.props.message));},renderMain:function(){return (i.createElement('span',{className:"_205",rel:'ignore'},this.renderActivityLogXButton(),i.createElement('a',{className:"_6i1",href:this.props.result.uri},i.createElement('span',null,this.props.icon||this.renderIcon(),this.renderLabel()))));},renderActivityLogXButton:function(){if(!this.props.result.isRecentSearchSuggestion)return null;var v=new o('/me/allactivity');v.setQueryData({privacy_source:'activity_log',log_filter:n.SEARCH});return (i.createElement(p,{size:'medium',className:"_2d9t",href:v}));},renderDebug:function(){return this.props.result.debug?i.createElement(k,{result:this.props.result}):null;},render:function(){var v="_202"+(' '+"_5bl2")+(' '+"_6_k")+(j.graphSearchV2?' '+"_1et7":'')+(j.renderKeywordSnippets?' '+"_28vg":'')+(this.props.result.isCelebrity?' '+"_5g-n":'')+(this.props.result.isTrending?' '+"_5g-o":'')+(j.typeaheadkeywordStyle==='relaxed'?' '+"_3bzk":'')+(j.typeaheadkeywordStyle==='baggy'?' '+"_3bzl":'');return (i.createElement('li',{className:r(v,this.props.className),onClick:this.props.onClick,onMouseEnter:this.props.onMouseEnter,'aria-label':this.props.result.structure.toString(),role:'option'},this.renderMain(),this.renderDebug()));}});f.exports=u;},null);
__d('FacebarTypeaheadToken.react',['FacebarTypeaheadHighlightedText.react','React','cx'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=i.PropTypes,l=' \u00B7 ',m=i.createClass({displayName:'FacebarTypeaheadToken',propTypes:{text:k.array.isRequired,highlight:k.array,limit:k.number,mainClass:k.string,innerClass:k.string,leadingMiddot:k.bool,savedContext:k.string},render:function(){var n=null;if(this.props.savedContext)n=i.createElement('span',{className:"_10j2"},this.props.savedContext);var o=this.props.text;if(this.props.limit)o.splice(this.props.limit);o.forEach((function(s,t){if(t!==0||this.props.leadingMiddot||n)o[t]=l+s;}).bind(this));var p=i.createElement(h,{className:this.props.mainClass,tokens:this.props.highlight,text:o.shift()}),q=o.length?i.createElement(h,{tokens:this.props.highlight,className:"_53ab",text:o.join('')}):null,r=this.props.innerClass||"_53aa";return (i.createElement('span',{className:"_53a9"},i.createElement('span',{className:r},n,p,q)));}});f.exports=m;},null);
__d('FacebarTypeaheadTokenText',['HTML','getElementText'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j='\u00B7';function k(o){if(typeof o==='object'){return i(h(o).getRootNode());}else return o||'';}function l(o){return k(o).split(j).map(function(p){return p.trim();});}function m(o){var p={};return o.filter(function(q){var r=!p[q];p[q]=true;return r&&q;});}var n={textForEntity:function(o,p){var q=o.category||p[o.type]||'',r=o.subtext||'',s=o.boldedSubtext||'',t=l(q).concat(l(s)).concat(l(r));return m(t);},text:function(o){return m(l(o));}};f.exports=n;},null);
__d('FacebarTypeaheadEntityItem.react',['FacebarGlobalOptions','FacebarTypeaheadItem.react','FacebarTypeaheadToken.react','FacebarTypeaheadTokenText','React','TypeaheadFacepileX.react','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p=Object.assign||function(r){for(var s=1;s<arguments.length;s++){var t=arguments[s];for(var u in t)if(Object.prototype.hasOwnProperty.call(t,u))r[u]=t[u];}return r;},q=l.createClass({displayName:'FacebarTypeaheadEntityItem',renderToken:function(){return (l.createElement(j,{highlight:this.getHighlightTokens(),text:k.textForEntity(this.props.result,{}),savedContext:this.props.result.saved_context}));},renderIcon:function(){if(this.props.result.isNullState){var r=this.props.result.icon_class?l.createElement('span',{className:this.props.result.icon_class}):l.createElement('img',{className:"_20h",src:this.props.result.photo});return (l.createElement('span',{className:!h.renderKeywordSnippets?"_k83":''},r));}if(this.props.result.size>1&&this.props.result.photos){return (l.createElement(m,{className:"_51l_",photos:this.props.result.photos,size:this.props.result.size}));}else if(this.props.result.photo)return (l.createElement('img',{className:"_20h",alt:'',src:this.props.result.photo}));},getHighlightTokens:function(){if(this.props.result.original_query){var r=this.props.result.original_query.toString().trim(),s=r.split(' '),t=s.length>1?[r].concat(s):[r];return t.filter(function(u){return u!=='';});}},render:function(){var r=this.props.className;if(this.props.result.isNullState)r=o(this.props.className,!h.renderKeywordSnippets?"_207":'');return (l.createElement(i,p({},this.props,{className:r,icon:this.renderIcon(),token:this.renderToken(),highlight:this.getHighlightTokens(),valign:true})));}});f.exports=q;},null);
__d('FacebarDisambiguationDialog',['Event','BrowseLogger','CSS','cx','Dialog','DOM','FacebarStructuredText','FacebarTypeaheadEntityItem.react','React','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();var r=650;function s(t,u,v,w,x){'use strict';this._sets=t;this._path=u;this._ondone=v;this._oncancel=w;this._selection=[];this._typeaheadSID=x;}s.prototype.show=function(){'use strict';new l().setTitle(q._("Which of these did you mean?")).setBody(this._createBody()).setContentWidth(r).setModal(true).setButtons([l.CONFIRM,l.CANCEL]).setHandler(this._handleDone.bind(this)).setCancelHandler(this._handleCancel.bind(this)).show();this._sets.forEach((function(t){var u=[];t.forEach(function(w){u.push(w.uid);});var v=t[0];i.logDisambiguationImpression(v.text,v.type,this._path,u.join(','),this._typeaheadSID);}).bind(this));};s.prototype._createBody=function(){'use strict';var t=[];this._sets.forEach((function(u,v){t.length&&t.push(m.create('li',{className:"_200"}));u.forEach((function(w){var x=this._createItem(w,v);this._selection[v]||this._selectItem(x);t.push(x.root);}).bind(this));}).bind(this));return m.create('ul',{className:'viewList disambiguationList'},t);};s.prototype._createItem=function(t,u){'use strict';var v={uri:null,subtext:t.subtext,category:t.category,photo:t.photo,type:t.type,structure:n.fromStruct([{text:t.text,type:'ent:'+t.type,uid:t.uid}])},w=m.create('div',{className:"_201"}),x=p.createElement(o,{result:v}),y=m.create('div');p.render(x,y);var z=y.firstChild;j.addClass(z,"_6i3");m.appendContent(z,j.hide(w));var aa={setId:u,result:t,root:z,check:w};h.listen(z,'mouseover',this._toggleHover.bind(this,aa,true));h.listen(z,'mouseout',this._toggleHover.bind(this,aa,false));h.listen(z,'click',(function(event){this._selectItem(aa);return event.kill();}).bind(this));return aa;};s.prototype._toggleHover=function(t,u){'use strict';j.conditionClass(t.root,'selected',u);};s.prototype._toggleCheck=function(t,u){'use strict';j.conditionShow(t.check,u);};s.prototype._selectItem=function(t){'use strict';var u=this._selection[t.setId];this._selection[t.setId]=t;u&&this._toggleCheck(u,false);this._toggleCheck(t,true);};s.prototype._handleDone=function(t){'use strict';this._ondone(t==l.CONFIRM?this._selection.map((function(u){var v=u.result;i.logDisambiguationClick(v.text,v.type,this._path,v.index,v.uid,this._typeaheadSID);return v;}).bind(this)):null);};s.prototype._handleCancel=function(){'use strict';this._oncancel();};f.exports=s;},null);
__d('StructuredInputDOM',['createArrayFromMixed','CSS','cx','DOM','FacebarGlobalOptions','getElementText'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n=function(){return l.graphSearchV2?"_4v1s":"_586o";},o={ENTITY_CLASS:n(),encodeText:function(p){return p.replace(/ /g,'\u00a0');},decodeText:function(p){return p.replace(/\u00a0/g,' ');},createIconNode:function(p){if(p&&typeof p=='object'){var q=k.create('i',{className:p.className,style:p.uri&&{backgroundImage:'url("'+p.uri+'")'}});q.setAttribute('data-select','ignore');return q;}},createTextNode:function(p){return k.create('span',{'data-si':true},o.encodeText(p||""));},createEntityNode:function(p,q){var r=o.encodeText(p.text),s=o.createIconNode(q.icon),t=k.create('span',{},s?[s,r]:r),u=(q.className||'').split(/\s+/);u.push(o.ENTITY_CLASS);u.forEach(i.addClass.bind(i,t));var v={si:true,uid:p.uid,type:p.type,text:r,fulltext:r,group:q.group,select:q.select,icon:JSON.stringify(q.icon||null)};for(var w in v)if(v[w]!=null)t.setAttribute('data-'+w,v[w]);return t;},convertToTextNode:function(p){p.className='';p.setAttribute('data-type','text');p.removeAttribute('data-group');p.removeAttribute('data-select');p.removeAttribute('data-icon');p.removeAttribute('data-uid');for(var q=p.firstChild;q;q=q.nextSibling)if(!k.isTextNode(q))k.remove(q);},isEntityNode:function(p){return k.isElementNode(p)&&i.hasClass(p,o.ENTITY_CLASS);},containsOnlyText:function(p,q){q=h(q);for(var r=p.firstChild;r;r=r.nextSibling)if(!(k.isTextNode(r)||p.nodeName in q))return false;return true;},getText:function(p){return m(p).replace(/ /g,'\u00a0');},getDecodedText:function(p){return o.decodeText(m(p));},getLength:function(p){return m(p).length;},getMarker:function(p,q,r){var s=p.firstChild;while(s){var t=o.getLength(s);if(t>q||!s.nextSibling){if(k.isTextNode(s)||!r){return {node:s,offset:Math.min(q,t)};}else return o.getMarker(s,q);}else q-=t;s=s.nextSibling;}}};f.exports=o;},null);
__d('StructuredInputUtil',['StructuredInputDOM'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(o,p,q){var r=o.substr(0,p).lastIndexOf(q);return r!==-1?r+1:0;}function j(o,p,q){var r=o.indexOf(q,p);return r!==-1?r:o.length;}function k(o,p,q){return (p===0||p===o.length||o.substr(p,q.length)==q);}function l(o,p,q,r){switch(p){case 'none':return q;case 'all':return r?o.length:0;case 'word':if(k(o,q,'\u00a0')){return q;}else if(r){return j(o,q,'\u00a0');}else return i(o,q,'\u00a0');}}function m(o,p){return p&&h.isEntityNode(o)&&!h.isEntityNode(p);}var n={getMarkerAtOffset:function(o,p){var q=o.firstChild,r=0,s=0;while(q){r+=s;s=h.getLength(q);if(r+s>p){break;}else q=q.nextSibling;}return {node:q||o.lastChild,offset:p-r};},validateEntityText:function(o){var p=h.getText(o),q=o.getAttribute('data-fulltext'),r=o.getAttribute('data-group');if(r=='hashtag'){var s=p.match(/#[^\s]+/);q=s&&s[0];}var t=p.indexOf(q),u={prefix:null,entity:null,suffix:null};switch(r){case 'none':u.entity=p;break;case 'hashtag':case 'all':if(t!=-1){u.prefix=p.substr(0,t);u.entity=p.substr(t,q.length);u.suffix=p.substr(t+q.length);}else u.suffix=p;break;case 'word':if(t!=-1){u.prefix=p.substr(0,t);p=p.substr(t);}var v=0,w=0;while(v<q.length){w=j(q,v+1,'\u00a0');if(p.substr(0,w)!=q.substr(0,w)){break;}else v=w;}u.entity=p.substr(0,v)||null;u.suffix=p.substr(v)||null;}return u;},getGrouping:function(o,p){var q=o.getAttribute('data-group'),r=o.getAttribute('data-select');if(p=='select'){return r=='group'?q:'none';}else return q;},snapMarkerToText:function(o,p){var q=o.node;if(h.isEntityNode(q)){var r=o.offset,s=n.getGrouping(q,p);if(s!='none')if(r===0){var t=q.previousSibling;if(m(q,t))return {node:t,offset:h.getLength(t)};}else if(r==h.getLength(q)){var u=q.nextSibling;if(m(q,u))return {node:u,offset:0};}}return o;},nextMarkerBoundary:function(o,p,q){var r=o.node;if(h.isEntityNode(r)&&(!p||o.offset!==0)){var s=n.getGrouping(r,q);if(s!='none')return {node:o.node,offset:l(h.getText(r),s,o.offset,p)};}return o;}};f.exports=n;},null);
__d('StructuredInputCleaner',['DOM','createArrayFromMixed','StructuredInputUtil','StructuredInputDOM','UserAgent_DEPRECATED','getElementText'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();function n(o,p,q){'use strict';this._node=o;this._selection=p;this._wrapText=q;}n.prototype._cleanEntityNode=function(o){'use strict';var p=o.getAttribute('data-text'),q=k.getText(o);o.style.cssText='';if(p==q&&k.containsOnlyText(o,{I:true}))return null;var r=[],s=j.validateEntityText(o),t=k.createIconNode(JSON.parse(o.getAttribute('data-icon')));if(!s.entity&&(s.suffix&&!s.prefix||s.prefix&&!s.suffix)){k.convertToTextNode(o);o.setAttribute('data-text',q);return null;}if(s.prefix)r.push(this._createTextNode(s.prefix));if(s.entity){if(this._selection&&m(o)!==s.entity)this._selection.markDirty(o);h.setContent(o,t?[t,s.entity]:s.entity);o.setAttribute('data-text',s.entity);r.push(o);}if(s.suffix)r.push(this._createTextNode(s.suffix));return r;};n.prototype._removeSpecialNodes=function(){'use strict';var o=i(this._node.getElementsByTagName('script')),p=i(this._node.getElementsByTagName('style'));o.forEach(h.remove);p.forEach(h.remove);};n.prototype._collapseNodes=function(){'use strict';for(var o,p=this._node.firstChild;p;p=o){o=p.nextSibling;if(!h.isTextNode(p)&&!k.isEntityNode(p)&&!k.containsOnlyText(p))for(var q=p.lastChild;q;q=p.lastChild){this._node.insertBefore(q,o);o=q;}}};n.prototype._createTextNode=function(o){'use strict';if(this._wrapText){return k.createTextNode(o);}else return document.createTextNode(o);};n.prototype.replaceNodes=function(o,p){'use strict';if(p==null)return;var q=o.length?o[o.length-1].nextSibling:null;o.forEach(function(r){if(p.indexOf(r)===-1)h.remove(r);},this);p.reverse().forEach(function(r){if(o.indexOf(r)===-1)this._node.insertBefore(r,q);q=r;},this);};n.prototype.clean=function(){'use strict';this._removeSpecialNodes();this._collapseNodes();var o=[],p=(function(){if(o.length){this.replaceNodes(o,this._cleanTextNodes(o));o.length=0;}}).bind(this);i(this._node.childNodes).forEach((function(q){if(k.isEntityNode(q)){this.replaceNodes([q],this._cleanEntityNode(q));p(o);}else o.push(q);}).bind(this));p();if(!this._node.firstChild&&l.firefox())this._node.appendChild(this._createTextNode());};n.prototype.endOnText=function(){'use strict';var o=(function(p,q){if(k.isEntityNode(p))this._node.insertBefore(this._createTextNode(),q?p:null);}).bind(this);o(this._node.firstChild,true);o(this._node.lastChild,false);};Object.assign(n.prototype,{_cleanTextNodes:(function(){var o=function(q){return (q.nodeName==='BR'||q.nodeName==='SPAN'&&p(q));},p=function(q){return q.getAttribute('data-si')&&k.containsOnlyText(q)&&k.getLength(q)>0;};return function(q){if(q.length!=1||!o(q[0])){var r=q.map(k.getText).join('').replace(/\s+/g,' ');return r?[this._createTextNode(r)]:[];}else{q[0].style.cssText='';return;}};})()});f.exports=n;},null);
__d("DOMSelection",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();(function(){var h=this,i={isPreceding:function(o,p){return p.compareDocumentPosition(o)&2;},contains:function(o,p){if(o.compareDocumentPosition!=null){return o.compareDocumentPosition(p)&16;}else return o.contains(p);},isCursorPreceding:function(o,p,q,r){if(o===q)return p<=r;if(i.isText(o)&&i.isText(q))return i.isPreceding(o,q);if(i.isText(o)&&!i.isText(q))return !i.isCursorPreceding(q,r,o,p);if(!i.contains(o,q))return i.isPreceding(o,q);if(o.childNodes.length<=p)return false;if(o.childNodes[p]===q)return 0<=r;return i.isPreceding(o.childNodes[p],q);},isText:function(o){return (o!=null?o.nodeType==3:false);},getChildIndex:function(o){var p=0;while(o=o.previousSibling)p++;return p;}},j=h.Selection=(function(){function o(p){this.win=p;}o.prototype.hasSelection=function(){return o.hasSelection(this.win);};o.prototype.isBidirectional=function(){return o.isBidirectional(this.win);};o.prototype.getOrigin=function(){return o.getOrigin(this.win);};o.prototype.getFocus=function(){return o.getFocus(this.win);};o.prototype.getStart=function(){return o.getStart(this.win);};o.prototype.getEnd=function(){return o.getEnd(this.win);};o.prototype.trySelection=function(p,q,r,s){return o.trySelection(this.win,p,q,r,s);};o.prototype.setSelection=function(p,q,r,s){return o.setSelection(this.win,p,q,r,s);};o.prototype.clearSelection=function(){return o.clearSelection(this.win);};return o;})();function k(){if(h.document.selection&&/MSIE 9\./.test(navigator.userAgent)){return false;}else return !!h.getSelection;}if(k()){j.supported=true;j.hasSelection=function(o){var p;return (p=o.getSelection())&&(p.focusNode!=null)&&(p.anchorNode!=null);};j.isBidirectional=function(o){return true;};j.getOrigin=function(o){var p;if(!((p=o.getSelection())&&(p.anchorNode!=null)))return null;return [p.anchorNode,p.anchorOffset];};j.getFocus=function(o){var p;if(!((p=o.getSelection())&&(p.focusNode!=null)))return null;return [p.focusNode,p.focusOffset];};j.getStart=function(o){var p,q,r,s,t,u;if(!j.hasSelection(o))return null;t=j.getOrigin(o),p=t[0],r=t[1];u=j.getFocus(o),q=u[0],s=u[1];if(i.isCursorPreceding(p,r,q,s))return [p,r];return [q,s];};j.getEnd=function(o){var p,q,r,s,t,u;if(!j.hasSelection(o))return null;t=j.getOrigin(o),p=t[0],r=t[1];u=j.getFocus(o),q=u[0],s=u[1];if(i.isCursorPreceding(p,r,q,s))return [q,s];return [p,r];};var l=function(o,p,q,s,t,u){var v=p.getSelection();if(!v)return;if(t==null)t=q;if(u==null)u=s;if(v.collapse&&v.extend){v.collapse(q,s);v.extend(t,u);}else{r=p.document.createRange();r.setStart(q,s);r.setEnd(t,u);if(o||!j.hasSelection(p)||(r.endContainer===t&&r.endOffset===u&&r.startContainer===q&&r.startOffset===s)){try{v.removeAllRanges();}catch(w){}v.addRange(r);}}};j.setSelection=l.bind(j,true);j.trySelection=l.bind(j,false);j.clearSelection=function(o){try{var q=o.getSelection();if(!q)return;q.removeAllRanges();}catch(p){}};j.getText=function(o){var p=o.getSelection();if(!p)return;return p.toString();};}else if(h.document.selection){var m=function(o,p,q){var r,s,t,u,v;s=o.createElement('a');r=p.duplicate();r.collapse(q);v=r.parentElement();while(true){v.insertBefore(s,s.previousSibling);r.moveToElementText(s);if(!(r.compareEndPoints((q?'StartToStart':'StartToEnd'),p)>0&&(s.previousSibling!=null)))break;}if(r.compareEndPoints((q?'StartToStart':'StartToEnd'),p)===-1&&s.nextSibling){r.setEndPoint((q?'EndToStart':'EndToEnd'),p);t=s.nextSibling;u=r.text.length;}else{t=s.parentNode;u=i.getChildIndex(s);}s.parentNode.removeChild(s);return [t,u];},n=function(o,p,q,r,s){var t,u,v,w,x;x=0;t=i.isText(r)?r:r.childNodes[s];u=i.isText(r)?r.parentNode:r;if(i.isText(r))x=s;w=o.createElement('a');u.insertBefore(w,t||null);v=o.body.createTextRange();v.moveToElementText(w);w.parentNode.removeChild(w);p.setEndPoint((q?'StartToStart':'EndToEnd'),v);return p[q?'moveStart':'moveEnd']('character',x);};j.supported=true;j.hasSelection=function(o){var p;if(!o.document.selection)return false;p=o.document.selection.createRange();return p&&p.parentElement().document===o.document;};j.getStart=function(o){var p;if(!j.hasSelection(o))return null;p=o.document.selection.createRange();return m(o.document,p,true);};j.getEnd=function(o){var p;if(!j.hasSelection(o))return null;p=o.document.selection.createRange();return m(o.document,p,false);};j.isBidirectional=function(o){return false;};j.getOrigin=function(o){return j.getStart(o);};j.getFocus=function(o){return j.getEnd(o);};var l=function(o,p,q,r,s,t){if(s==null)s=q;if(t==null)t=r;var u=p.document.body.createTextRange();n(p.document,u,false,s,t);n(p.document,u,true,q,r);return u.select();};j.setSelection=l.bind(j,true);j.trySelection=l.bind(j,false);j.clearSelection=function(o){return o.document.selection.empty();};j.getText=function(o){if(!j.hasSelection(o))return null;var p=o.document.selection.createRange();return p&&p.text;};}else j.supported=false;}).call(this);f.exports=Selection;},null,{});
__d('StructuredInputSelection',['DOM','DOMSelection','Scroll','Vector','StructuredInputUtil','StructuredInputDOM'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();function n(p){'use strict';var q=p.ownerDocument;this.window=q.defaultView||q.parentWindow;this.root=p;this.selection=false;this.start=new o(this,[]);this.end=new o(this,[]);this.update();}n.prototype.isSupported=function(){'use strict';return !!(i&&i.hasSelection);};n.prototype.update=function(){'use strict';this.selection=false;if(this.isSupported()&&this.root==document.activeElement)if(i.hasSelection(this.window)){var p=i.getStart(this.window),q=i.getEnd(this.window),r=i.getFocus(this.window);this.start=this.makeMarker(p);this.end=this.makeMarker(q);this.backward=p[0]==r[0]&&p[1]==r[1];this.selection=this.start.node&&this.end.node;}};n.prototype.makeMarker=function(p){'use strict';if(p[0]===this.root){return new o(this,[this.root.childNodes[p[1]],0]);}else return new o(this,p);};n.prototype.getFocus=function(){'use strict';return this.backward?this.start:this.end;};n.prototype.getOrigin=function(){'use strict';return this.backward?this.end:this.start;};n.prototype.move=function(p){'use strict';if(this.selection){this.start.move(p);this.start.snap();this.end.setPosition(this.start);return this.apply();}};n.prototype.expand=function(p){'use strict';if(this.selection){if(i.isBidirectional()){this.start.move(!p);this.start.snap();this.end.move(p);this.end.snap();}return this.apply();}};n.prototype.getText=function(){'use strict';if(this.selection&&this.isSupported()){var p=i.getText(this.window);return p;}};n.prototype.getOffset=function(){'use strict';if(this.selection)return this.start.rootOffset;};n.prototype.getLength=function(){'use strict';return (this.getText()||"").length;};n.prototype.setPosition=function(p,q){'use strict';this.backward=false;this.selection=true;this.start.setPosition(l.getMarkerAtOffset(this.root,p));this.start.snap();if(q>0){this.end.setPosition(l.getMarkerAtOffset(this.root,p+q));this.end.snap();}else this.end.setPosition(this.start);return this.apply();};n.prototype.hasRange=function(){'use strict';return this.selection&&(this.start.node!=this.end.node||this.start.offset!=this.end.offset);};n.prototype.scrollToFocus=function(){'use strict';var p=5,q=this.getFocus();if(q.node){var r=k.getElementDimensions(this.root).x,s=j.getLeft(this.root),t=q.node.offsetLeft+q.node.offsetWidth;if(t-s<p){j.setLeft(this.root,t-p);}else if(t-s>r-p)j.setLeft(this.root,t-r+p);}};n.prototype.apply=function(){'use strict';if(this.start.hasChanged()||this.end.hasChanged()){var p=this.getOrigin().getMarker(true),q=this.getFocus().getMarker(true);this.selection=this.selection&&p&&p.node&&q&&q.node;if(this.selection&&this.isSupported()){this.start.changed=false;this.end.changed=false;i.trySelection(this.window,p.node,p.offset,q.node,q.offset);return true;}}};n.prototype.markDirty=function(p){'use strict';if(h.contains(p,this.start.node,p))this.start.changed=true;if(h.contains(p,this.end.node,p))this.end.changed=true;};function o(p,q){'use strict';this.selection=p;this.node=q[0];this.offset=q[1];this.rootOffset=this.getRootOffset(q[0],q[1]);this.sibling=this.node&&this.node.previousSibling;this.changed=false;}o.prototype.hasChanged=function(){'use strict';return this.changed||!this.isNodeValid();};o.prototype.isNodeValid=function(){'use strict';if(m.getLength(this.node)>this.offset){var p=this.node;while(p=p.parentNode)if(p==this.selection.root)return true;}};o.prototype.getMarker=function(p){'use strict';if(this.isNodeValid()&&(p&&!this.node.firstChild||!p&&this.node.parentNode==this.selection.root)){return this;}else return m.getMarker(this.selection.root,this.rootOffset,p);};o.prototype.move=function(p){'use strict';this.node&&this.setPosition(l.nextMarkerBoundary(this.getMarker(false),p,'select'));};o.prototype.snap=function(){'use strict';this.node&&this.setPosition(l.snapMarkerToText(this.getMarker(false),'select'));};o.prototype.setPosition=function(p){'use strict';if(p.offset!=this.offset||p.node!=this.node){this.changed=true;this.node=p.node;this.offset=p.offset;this.rootOffset=this.getRootOffset(this.node,this.offset);}};o.prototype.getRootOffset=function(p,q){'use strict';var r=0,s=5;while(p&&(r++)<s)if(p===this.selection.root){return q;}else{var t=p;while(t=t.previousSibling)q+=m.getLength(t);p=p.parentNode;}};f.exports=n;},null);
__d('StructuredInput',['Arbiter','ArbiterMixin','CSS','DOM','DataStore','Event','Input','InputSelection','JSLogger','Keys','Locale','Parent','Scroll','StructuredInputCleaner','StructuredInputDOM','StructuredInputSelection','StructuredInputUtil','Style','UserAgent_DEPRECATED','createArrayFromMixed','createObjectFrom','cx','csx','emptyFunction','getActiveElement','setTimeoutAcrossTransitions','mixin'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha){if(c.__markCompiled)c.__markCompiled();var ia,ja,ka=229,la=ba([q.UP,q.DOWN,q.LEFT,q.RIGHT,q.HOME,q.END]),ma=ba([q.BACKSPACE,q.DELETE]),na=ba([q.SPACE,q.RETURN]),oa=ba('IUB'.split('').map(function(ta){return ta.charCodeAt(0);})),pa=z.firefox(),qa=z.ie(),ra=z.webkit();ia=ha(i);ja=ia&&ia.prototype;Object.assign(sa,ia);sa.prototype=Object.create(ia.prototype);sa.prototype.constructor=sa;sa.__superConstructor__=ia;function sa(ta){'use strict';ja.constructor.call(this);l.set(ta,'StructuredInput',this);this._root=ta;this._richInput=k.find(ta,"._586i");this._textInput=k.find(ta,"._586f");this._placeholderText=k.scry(ta,"._586j")[0];this._hintText=k.find(ta,"._586k");this._contentWidth=null;this._richWidth=null;this._hintNodes=[];h.subscribe(p.DUMP_EVENT,(function(ua,va){va.structuredInputState={initInputsFinished:!!this._initInputsFinished,initEventsFinished:!!this._initEventsFinished,cleanInputPreTogglesFinished:!!this._cleanInputPreTogglesFinished,cleanInputFinished:!!this._cleanInputFinished,elements:{richInput:!!this._richInput,textInput:!!this._textInput,placeholderText:!!this._placeholderText,hintText:!!this._hintText}};}).bind(this));this.init();}sa.prototype.init=function(){'use strict';this.init=ea;this._initSelection();this._initCleaner();this._initInputs();this._initInputsFinished=true;this._initEvents();this._initEventsFinished=true;this._scheduledCleanInput=false;this._richChanged=false;this._textChanged=false;this._selectionChanged=false;this._selectionIgnore=false;this._imeMode=false;this.cleanInput();this.inform('init',null,h.BEHAVIOR_PERSISTENT);};sa.prototype._initInputs=function(){'use strict';this._richInput.contentEditable=true;this._richInput.spellcheck=false;this._richInput.tabIndex=1;this._textInput.tabIndex=-1;this._multiline=this._textInput.nodeName=='TEXTAREA';if(!j.shown(this._richInput)){var ta=o.get(this._textInput),ua=fa()===this._textInput;k.setContent(this._richInput,v.encodeText(n.getValue(this._textInput)));j.hide(this._textInput);j.show(this._richInput);this.cleanInput();if(ua){this._richInput.focus();this.setSelection({offset:ta.start,length:ta.end-ta.start});}}this.togglePlaceholder();this._toggleHint();};sa.prototype._initEvents=function(){'use strict';var ta=null,ua=false,va=(function(){this._richChanged=true;ua||this.scheduleCleanInput(true);}).bind(this),wa=(function(){this._textChanged=true;ua||this.scheduleCleanInput(false);}).bind(this),xa=(function(){this._selectionChanged=true;this.scheduleCleanInput(false);}).bind(this),ya=(function(){this._imeMode=true;this._placeholderText&&j.hide(this._placeholderText);j.hide(this._hintText);}).bind(this),za=(function(){this._imeMode=false;this._richChanged=true;this.cleanInput();}).bind(this);m.listen(this._richInput,'keydown',(function(ab){ta=ab.keyCode;if(ab.ctrlKey&&ab.keyCode in oa){return ab.kill();}else if(ab.keyCode in la){xa();}else if(ab.keyCode===q.BACKSPACE&&this._deleteTrailingChunk()){this._richChanged=true;this.cleanInput();return ab.kill();}else if(ab.keyCode in ma){va();}else if(ab.keyCode==ka)ya();}).bind(this));m.listen(this._richInput,'keypress',(function(ab){if(ab.keyCode==q.RETURN){this._multiline&&this._insertText("\n");return ab.kill();}else if(!this._selectionChanged&&this._selectionIsText()){wa();}else va();}).bind(this));if(!ua){m.listen(this._richInput,'keyup',(function(ab){if((this._imeMode||ab.keyCode!=ta)&&ab.keyCode in na){za();return ab.kill();}else if(this._imeMode){this._textChanged=true;this.cleanInput();}}).bind(this));if(pa)m.listen(this._richInput,'input',(function(){this._textChanged=true;this.cleanInput();}).bind(this));}else{m.listen(this._richInput,'compositionstart',ya);m.listen(this._richInput,'compositionend',function(){setTimeout(za,0);});m.listen(this._richInput,'input',(function(){this._textChanged=true;if(!this._imeMode)if(!this._richChanged){this.cleanInput();}else this.scheduleCleanInput();}).bind(this));}m.listen(document,'selectionchange',(function(){if(this._selectionIgnore){this._selectionIgnore=false;}else this._selectionChanged=true;}).bind(this));m.listen(this._richInput,'mousedown',(function(){this._selectionChanged=true;this._selectionLength=0;this._selectionOffset=0;}).bind(this));m.listen(this._richInput,'mouseup',(function(){this._selectionChanged=true;this.scheduleCleanInput();}).bind(this));m.listen(this._richInput,'cut',(function(){this._richChanged=true;this.scheduleCleanInput(false);}).bind(this));m.listen(this._richInput,'paste',(function(ab){this._richChanged=true;this.scheduleCleanInput(true);}).bind(this));m.listen(this._richInput,'drop',(function(ab){this.focus();this.selectAll();this._insertClipboard(ab&&ab.dataTransfer);return ab.kill();}).bind(this));m.listen(this._richInput,'dragover',function(ab){ab.dataTransfer.dropEffect='move';ab.dataTransfer.effectAllowed='move';return ab.kill();});m.listen(this._richInput,'focus',(function(ab){this._toggleHint();this.inform('focus');}).bind(this));m.listen(this._richInput,'blur',(function(ab){j.hide(this._hintText);this._imeMode=false;this._richChanged=true;this.scheduleCleanInput(false);this.inform('blur');}).bind(this));};sa.prototype._initCleaner=function(){'use strict';this._cleaner=new u(this._richInput,this._selection,true);};sa.prototype._initSelection=function(){'use strict';this._selection=new w(this._richInput);this._selectionLength=0;this._selectionOffset=0;};sa.prototype._insertClipboard=function(ta){'use strict';if(ta&&typeof ta.getData==='function'){var ua=ta.getData('Text');this._insertText(ua);}};sa.prototype._deleteTrailingChunk=function(ta){'use strict';var ua=this.getSelection();if(ua.length>0||ua.offset===0)return false;var va=this.getSelection().offset-1,wa=x.getMarkerAtOffset(this._richInput,va);if(wa&&v.isEntityNode(wa.node)&&x.getGrouping(wa.node,'select')!=='none'){k.remove(wa.node);return true;}return false;};sa.prototype._selectionIsText=function(){'use strict';var ta=this._selection.start.node,ua=this._selection.end.node;return ta&&ta===ua&&!v.isEntityNode(ta)&&!v.isEntityNode(ta.parentNode);};sa.prototype._insertText=function(ta){'use strict';if(ta){var ua=k.create('div',{},ta);return this._insertNodes(ua);}};sa.prototype._insertHTML=function(ta){'use strict';if(ta){var ua=k.create('div'),va=new u(ua,null,false);ua.innerHTML=ta;va.clean();return this._insertNodes(ua);}};sa.prototype._insertNodes=function(ta){'use strict';if(document.selection){document.selection.createRange().pasteHTML(ta.innerHTML);}else document.execCommand('insertHTML',false,ta.innerHTML);this._richChanged=true;this.cleanInput();};sa.prototype.togglePlaceholder=function(ta){'use strict';if(!this._placeholderText)return;var ua=v.getLength(this._richInput)===0;if(ta&&ua){j.show(this._placeholderText);}else j.conditionShow(this._placeholderText,ua&&!this._imeMode);};sa.prototype._toggleHint=function(){'use strict';var ta=aa(this._hintNodes),ua=null,va='',wa=v.getText(this._richInput).toLowerCase();if(!this.hasFocus())return;if(this._contentOverflows()){j.hide(this._hintText);return;}while(ta.length&&va.length<wa.length){ua=ta.shift();va+=v.getText(ua);}if(wa.length&&va.substr(0,wa.length).toLowerCase()==wa.toLowerCase()){k.setContent(this._hintText,aa(this._richInput.cloneNode(true).childNodes).filter(function(ya){return ya.tagName!=='BR';}));var xa=v.createTextNode(va.substr(wa.length));ta.unshift(xa);k.appendContent(this._hintText,k.create('span',{className:"_586h"},ta));j.show(this._hintText);j.hide(this._placeholderText);}else j.hide(this._hintText);};sa.prototype._contentOverflows=function(){'use strict';if(this._richWidth===null)this._richWidth=this._richInput.clientWidth;if(this._contentWidth===null){var ta=this._richInput.lastChild;this._contentWidth=k.isElementNode(ta)?ta.offsetLeft+ta.offsetWidth:0;}return this._contentWidth>this._richWidth;};sa.prototype._forceTop=function(){'use strict';if(!this._multiline)t.setTop(this._richInput,0);t.setTop(this._root,0);};sa.prototype._createStructureNodes=function(ta){'use strict';return ta.map((function(ua){return ua.uid||ua.type&&ua.type!='text'?v.createEntityNode(ua,ua.display||{}):v.createTextNode(ua.text);}).bind(this));};sa.prototype._suppressInput=function(){'use strict';if(pa||qa){if(this._richClean)return;this._richClean=this._richInput.cloneNode(true);this._richClean.contentEditable=false;this._root.insertBefore(this._richClean,this._richInput.nextSibling);t.setLeft(this._richClean,t.getLeft(this._richInput));y.set(this._richInput,'padding',0);y.set(this._richInput,'height',0);}};sa.prototype._revealInput=function(){'use strict';if(!this._richClean)return;y.set(this._richInput,'height','');y.set(this._richInput,'padding','');this._root.removeChild(this._richClean);this.focus();this._richClean=null;};sa.prototype._cleanInput=function(){'use strict';var ta;if(this._textChanged&&!this._richChanged){this._selection.update();ta='change';}else if(this._richChanged||this._selectionChanged){this._selection.update();if(this._richChanged){this._contentWidth=null;this._cleaner.clean();this._cleaner.endOnText();this._selection.apply();ta='change';}if(this._selectionChanged){this._cleanSelection();if(this._selectionLength||!this._richChanged)ta='select';}}this._revealInput();this._forceTop();this._cleanInputPreTogglesFinished=true;if(this._richChanged||this._textChanged){this.togglePlaceholder();this._toggleHint();}this._selectionIgnore=true;this._selectionChanged=false;this._richChanged=false;this._textChanged=false;this._cleanInputFinished=true;ta&&this.inform(ta);};sa.prototype._cleanSelection=function(){'use strict';var ta=this._selection.getLength(),ua=this._selection.getOffset();if(ta){this._selection.expand(ta>=this._selectionLength);ta=this._selection.getLength();ua=this._selection.getOffset();}this._selectionLength=ta;this._selectionOffset=ua;};sa.prototype.cleanInput=function(){'use strict';this._scheduledCleanInput||this._cleanInput();};sa.prototype.scheduleCleanInput=function(ta){'use strict';ta&&this._suppressInput();if(!this._scheduledCleanInput){this._scheduledCleanInput=true;ga((function(){this._cleanInput();this._scheduledCleanInput=false;}).bind(this),0);}};sa.prototype.setEnabled=function(ta){'use strict';this._textInput.disabled=!ta;this._richInput.contentEditable=ta;};sa.prototype.getRoot=function(){'use strict';return this._root;};sa.prototype.getRichInput=function(){'use strict';return this._richInput;};sa.prototype.getEnabled=function(){'use strict';return !this._textInput.disabled;};sa.prototype.getText=function(){'use strict';return v.getDecodedText(this._richInput);};sa.prototype.setText=function(ta){'use strict';k.setContent(this._richInput,v.createTextNode(ta));this._richChanged=false;this._selectionChanged=false;this.inform('change');};sa.prototype.setHint=function(ta){'use strict';this._hintNodes=this._createStructureNodes(ta);this._toggleHint();};sa.prototype.getStructure=function(){'use strict';var ta=[];aa(this._richInput.childNodes).forEach((function(ua){var va=!k.isTextNode(ua),wa=v.getDecodedText(ua);wa.length&&ta.push({text:wa,uid:va?ua.getAttribute('data-uid'):null,type:va&&ua.getAttribute('data-type')||'text'});}).bind(this));return ta;};sa.prototype.setStructure=function(ta){'use strict';k.setContent(this._richInput,this._createStructureNodes(ta));this._cleaner.clean();this._cleaner.endOnText();this.togglePlaceholder();this._toggleHint();this._richChanged=false;this._selectionChanged=false;this.inform('change');};sa.prototype.getContentDimensions=function(){'use strict';var ta=this._richInput.lastChild;return {width:ta?ta.offsetLeft+ta.offsetWidth:0,height:ta?ta.offsetTop+ta.offsetHeight:0};};sa.prototype.getSelection=function(){'use strict';if(this._selection)return {offset:this._selection.getOffset(),length:this._selection.getLength()};};sa.prototype.setSelection=function(ta){'use strict';if(this.hasFocus()&&this._selection){this._selection.update();this._selection.setPosition(ta.offset,ta.length);this._selection.scrollToFocus();this._selectionChanged=false;this.inform('select');}};sa.prototype.moveSelectionToEnd=function(){'use strict';this.setSelection({length:0,offset:v.getLength(this._richInput)});};sa.prototype.isSelectionAtEnd=function(){'use strict';var ta=this.getSelection().offset,ua=v.getLength(this._richInput);return ta>=ua;};sa.prototype.selectAll=function(){'use strict';this.setSelection({offset:0,length:v.getLength(this._richInput)});};sa.prototype.hasFocus=function(){'use strict';return k.contains(this._root,document.activeElement);};sa.prototype.focus=function(){'use strict';this._richInput.focus();};sa.prototype.blur=function(){'use strict';var ta={position:'absolute',top:0,width:'1px',height:'1px'};if(r.isRTL()){ta.right='-100px';}else ta.left='-100px';var ua=k.create('input',{type:'text',tabIndex:-1,style:ta});k.appendContent(this._root,ua);var va=function(){if(this.hasFocus()||ra&&document.activeElement===document.body){ua.focus();ua.blur();}};this.blur=va;this.blur();};sa.getInstance=function(ta){var ua=s.byClass(ta,"_586g");if(!ua)throw new Error('No DOMElement structured input found using '+ta);return l.get(ua,'StructuredInput')||new sa(ua);};f.exports=sa;},null);
__d('FacebarTypeaheadInput',['ArbiterMixin','csx','DOM','FacebarStructuredText','StructuredInput','Vector','Locale','mixin'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p,q,r={text:{className:"text",group:"all",select:"none"},ent:{className:"entity",group:"all",select:"group"},'ent:hashtag_exact':{className:"entity",group:"hashtag",select:"none"}};function s(u){return Object.assign(u.toStruct(),{display:r[u.getType()]||r[u.getTypePart(0)]});}p=o(h);q=p&&p.prototype;Object.assign(t,p);t.prototype=Object.create(p.prototype);t.prototype.constructor=t;t.__superConstructor__=p;function t(u){'use strict';q.constructor.call(this);this.root=u;this.input=l.getInstance(u);this.value=null;this.selection={offset:0,length:0};this.resetOnChange=true;this.initEvents();}t.prototype.initEvents=function(){'use strict';var u=(function(v,w){this.inform(v,w);}).bind(this);this.input.subscribe('blur',u);this.input.subscribe('focus',u);this.input.subscribe('change',(function(v,w){if(this.resetOnChange)this.value=null;this.inform('change',w);}).bind(this));};t.prototype.togglePlaceholder=function(u){'use strict';return this.input.togglePlaceholder(u);};t.prototype.focus=function(){'use strict';this.input.focus();};t.prototype.blur=function(){'use strict';this.input.blur();};t.prototype.getElement=function(){'use strict';return this.root;};t.prototype.getRawPlaceholderElement=function(){'use strict';return j.find(this.root,"._586j");};t.prototype.getRawInputElement=function(){'use strict';return j.scry(this.root,"._586i")[0];};t.prototype.getValue=function(){'use strict';if(this.value===null)this.value=k.fromStruct(this.input.getStructure());return this.value;};t.prototype.getLength=function(){'use strict';return this.getValue().getLength();};t.prototype.resetPlaceholder=function(){'use strict';this.input.resetPlaceholder();};t.prototype.setValue=function(u,v){'use strict';this.value=u;this.resetOnChange=!!v;var w=u.toArray().map(s);this.input.setStructure(w);this.input.setSelection({offset:u.getLength(),length:0});this.resetOnChange=true;};t.prototype.storeSelection=function(){'use strict';this.selection=this.input.getSelection();};t.prototype.restoreSelection=function(){'use strict';if(this.selection)this.input.setSelection(this.selection);};t.prototype.clearSelection=function(){'use strict';this.input.setSelection({offset:this.getLength(),length:0});};t.prototype.setHint=function(u){'use strict';var v=u&&!u.hasRTL()&&!n.isRTL()?u.toArray().map(s):[];this.input.setHint(v);};t.prototype.isSelectionAtEnd=function(){'use strict';return this.input.isSelectionAtEnd();};t.prototype.selectInput=function(u){'use strict';this.input.setSelection({offset:u||0,length:this.getLength()});};t.prototype.getEndOffset=function(){'use strict';var u=m.getElementDimensions(this.root),v=this.input.getContentDimensions();return Math.min(u.x,v.width);};Object.assign(t.prototype,{events:['change','focus','blur']});f.exports=t;},null);
__d('FacebarTypeaheadWebSearch',['FacebarStructuredFragment','FacebarStructuredText'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=new h({type:'ent:websuggestion',text:'Web Search: ',uid:null}),k=j.getText().toLowerCase().trim();function l(o,p){if(!o||o.type!=='websuggestion')return;var q=p.getValue().toArray();q.forEach(function(r){if(r.isType('ent')&&!r.isType('ent','user')&&r.getUID())if(o.extra_uri_params){o.extra_uri_params.qh=r.getUID();return;}});}function m(o){return o.getType()===j.getType();}function n(o){'use strict';this._core=o.getCore();this._view=o.getView();this._input=this._core.input;this._isEnabled=false;}n.prototype.enable=function(){'use strict';this._isEnabled=true;this.changeListener=this._input.subscribe('change',this._changeWebSearch.bind(this));this.lockListener=this._input.subscribe('shortcut',this._lockWebSearch.bind(this));this.beforeSelectListener=this._view.subscribe('beforeSelect',this._beforeSelect.bind(this));this.beforeRenderListener=this._view.subscribe('beforeRender',this._beforeRender.bind(this));};n.prototype._changeWebSearch=function(){'use strict';var o=this._input.getValue(),p=o.toArray(),q=p[0];if(q&&q.getType()==='text')if(q.getText().toLowerCase().startsWith(k)){p.splice(0,1,j,new h({text:q.getText().substr(k.length).replace(/^ /,'')}));this._replaceFragments(p);}else if(p.length>1&&p.some(m)){var r='';p.forEach(function(s){if(m(s))return;r+=s.getText();});this._input.storeSelection();this._input.setValue(i.fromString(r));this._input.restoreSelection();}};n.prototype._replaceFragments=function(o){'use strict';this._input.storeSelection();this._input.setValue(new i(o));this._input.restoreSelection();};n.prototype._beforeSelect=function(o,p){'use strict';l(p.selected,this._input);return true;};n.prototype._beforeRender=function(o,p){'use strict';var q=this._input.getValue().toArray()[0],r=q&&m(q);p.results.forEach(function(s){if(s.type==='websuggestion')s.isLockedWebSearchMode=r;});return true;};n.prototype._lockWebSearch=function(o,p){'use strict';if(p.shift){var q=this._input.getValue().toArray()[0];if(!q||!m(q))this._input.setValue(new i([j]));}};n.prototype.disable=function(){'use strict';this.beforeSelectListener.unsubscribe();this.changeListener.unsubscribe();this.lockListener.unsubscribe();this.beforeRenderListener.unsubscribe();this._isEnabled=false;};n.addPrefix=function(o){'use strict';var p=m(o.getFragment(0))||o.getFragment(0).getText().toLowerCase().startsWith(k);if(!p){var q=[j].concat(o.toArray());return new i(q);}else return o;};f.exports=n;},null);
__d('FacebarTypeaheadCore',['Animation','Arbiter','ArbiterMixin','Base64','DOM','Event','FacebarGlobalOptions','FacebarJSConstants','FacebarKeywordSearchUtils','FacebarResultStoreUtils','FacebarStructuredText','FacebarTypeaheadInput','FacebarTypeaheadWebSearch','Keys','KeywordsSearchResultConfig','Parent','Style','URI','arrayContains','cx','csx','getActiveElement','invariant','mixin','setTimeout'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa){if(c.__markCompiled)c.__markCompiled();var ga=Object.assign||function(ka){for(var la=1;la<arguments.length;la++){var ma=arguments[la];for(var na in ma)if(Object.prototype.hasOwnProperty.call(ma,na))ka[na]=ma[na];}return ka;},ha,ia;ha=ea(j);ia=ha&&ha.prototype;Object.assign(ja,ha);ja.prototype=Object.create(ha.prototype);ja.prototype.constructor=ja;ja.__superConstructor__=ha;function ja(ka){'use strict';ia.constructor.call(this);Object.assign(this,ka);}ja.prototype.init=function(ka,la,ma){'use strict';if(window.getSelection===null)throw new Error('Facebar: window.getSelection is null!');this.init=function(){};this.data=ka;this.view=la;this.root=ma;this.facebarRoot=w.byClass(ma,"_585-");this.windowFocused=true;this.isFocused=false;this.hoverAnimation=null;this.stickyQuery=null;this.settedQuery=null;this.selectedQuery=null;this.currentQuery=null;this.initSubcomponents();this.initEvents();this.checkValue();};ja.prototype.initSubcomponents=function(){'use strict';var ka=l.find(this.root,"._5861");this.input=new s(ka);this.view.setInputElement(this.input.getRawInputElement());};ja.prototype.initEvents=function(){'use strict';m.listen(this.root,'keydown',this.keydown.bind(this));m.listen(this.root,'keyup',this.keyup.bind(this));m.listen(this.root.parentNode,'mousedown',this.mousedown.bind(this));m.listen(this.view.getElement(),'mousedown',this.mousedown.bind(this));m.listen(window,'focus',this.focusWindow.bind(this));m.listen(window,'blur',this.blurWindow.bind(this));this.view.subscribe('select',this.selectView.bind(this));this.view.subscribe('highlight',this.highlightView.bind(this));this.view.subscribe('render',this.highlightView.bind(this));this.view.subscribe('hideHelp',this.performQuery.bind(this));this.input.subscribe('focus',this.focusInput.bind(this));this.input.subscribe('blur',this.blurInput.bind(this));this.input.subscribe('change',this.changeInput.bind(this));this.data.subscribe('activity',this.typeaheadActivity.bind(this));this.data.subscribe('respond',this.completeData.bind(this));this.data.subscribe('nullstateReady',this.performQueryIfVisible.bind(this));i.subscribe('FacebarTypeahead.clearRecentSearches',(function(){return this.clearRecentSearches();}).bind(this));i.subscribe('FacebarTypeahead.focus',(function(){this.input.focus();fa((function(){this.input.clearSelection();}).bind(this),0);}).bind(this));fa(this.initFocus.bind(this),0);};ja.prototype.initFocus=function(){'use strict';if(!this.lazyFocused&&l.contains(this.input.root,ca())){this.lazyFocused=true;this.isFocused=true;this._newSession();this.inform('focus',{catchup:true});this.open(true);}};ja.prototype.setStartTime=function(ka){'use strict';this.inform('focusStartTime',{time:ka});};ja.prototype.cleanQuery=function(ka){'use strict';ka=ga({},ka)||{};if(!ka.structure)ka.structure=new r();if(!n.allowGrammar||o.nonGrammarTypes[ka.type])ka.structure=r.fromString(ka.structure.toString());!(ka.structure instanceof r)?da(0):undefined;if(ka.type=='websuggestion'&&n.allowGrammar&&n.webSearchLockedInMode)ka.structure=t.addPrefix(ka.structure);return ka;};ja.prototype._unlockQuery=function(){'use strict';var ka=this.input.getValue();if(ka.hasType('ent')&&ka.trim().getCount()===1){this.input.storeSelection();this.input.setValue(r.fromString(ka.toString()));this.input.restoreSelection();}};ja.prototype.setPageQuery=function(ka){'use strict';ka=this.cleanQuery(ka);var la=this.input.getValue(),ma=ka.structure,na=!ma.isEmptyOrWhitespace()&&(la.isEmptyOrWhitespace()||la.toString().trim()!==ma.toString().trim());return this.selectQuery(ka,na);};ja.prototype.selectQuery=function(ka,la){'use strict';la=la!==false;ka=this.cleanQuery(ka);if(la||!this.selectedQuery){if(la||this.getValue().isEmptyOrWhitespace())this.setQuery(ka);this.selectedQuery=ka;}return ka;};ja.prototype.completeSelection=function(){'use strict';var ka=this.view.getSelection();if(ka&&!ka.search){this.data.saveResult(ka);ka.structure=ka.structure.pad();this.setQuery(ka);return true;}};ja.prototype.setQuery=function(ka,la){'use strict';ka=this.cleanQuery(ka);if(ka.structure.hasType('blank'))ka.structure=new r(ka.structure.toArray().filter(function(ma){return ma.getType()!='blank';}));this.input.setValue(ka.structure);this.settedQuery=ka;this.stickyQuery=la===false?this.stickyQuery:ka;this.checkValue();};ja.prototype.checkValue=function(){'use strict';if(this.value&&this.value.getHash()==this.input.getValue().getHash())return;this.checkBlockedSearch();this.performQueryIfVisible();};ja.prototype.checkBlockedSearch=function(){'use strict';var ka=this.input.getValue().toString().toLocaleLowerCase();if(!this.data.blockees||!this.data.blockees.hasOwnProperty(ka)){this.view.hideBlockNotification();}else this.view.showBlockNotification(this.data.blockees[ka]);};ja.prototype.isNullState=function(){'use strict';return this.input.getValue().getHash()==='';};ja.prototype.performQueryIfVisible=function(){'use strict';if(!this.view.visible)return;this.value=this.nextQuery=this.getValue();this.performQuery();};ja.prototype.performQuery=function(){'use strict';if(n.graphSearchV2)this.view.resetIndex();this.data.query(this.nextQuery);this.currentQuery=this.nextQuery;};ja.prototype.requery=function(){'use strict';if(this.currentQuery)this.data.query(this.currentQuery);};ja.prototype.executeQuery=function(ka){'use strict';ka=this.cleanQuery(ka);var la=this.inform('execute',ka),ma=this.getSessionID();this.close();if(n.allowGrammar){this.selectQuery(ka);}else this.selectQuery();if(n.hasRecentSearchNullState&&ka.type!=='shortcut')this.data.resultStore.addRecentEntryToNullState(ka);if(!la)this._navigateToQuery(ka,ma);};ja.prototype.getSearchType=function(){'use strict';return 'facebar';};ja.prototype._newSession=function(){'use strict';if(this._sessionID!=null)return;this._sessionID=Math.random().toString();this.inform('session',this._sessionID,i.BEHAVIOR_STATE);};ja.prototype._closeSession=function(){'use strict';this._sessionID=null;this.inform('session',null,i.BEHAVIOR_STATE);};ja.prototype.getSessionID=function(){'use strict';return this._sessionID;};ja.prototype._navigateToQuery=function(ka,la){'use strict';var ma=this.data.facebarConfig;if(ka.uri){ka.uri.addQueryData(ka.extra_uri_params);ka.uri.addQueryData({ref:'br_tf'});if(ka.structure&&(ka.type=='websuggestion'||ka.type==v.result_type||ka.type=='grammar'&&(!ma||String(ka.uri.getPath()).startsWith(ma.search_path)))){var na=this.data.getRawStructure(ka.structure).text_form,oa=k.encode(encodeURIComponent(na)).replace(/\=+$/,''),pa={sid:la,qs:oa,gv:this.data.getQueryData().grammar_version},qa=k.encode(JSON.stringify(pa)).replace(/\=+$/,'');ka.uri.addQueryData({ref:qa,bs:ka.alternateSemantic});}ka.uri.go();return;}};ja.prototype.reset=function(){'use strict';this.selectQuery();this.inform('reset');};ja.prototype.animateInputValue=function(ka,la,ma){'use strict';this.hoverAnimation&&this.hoverAnimation.stop();var na=new h(la).from('opacity',1).to('opacity',0).duration(150).ondone((function(){this.input.setValue(ma);this.hoverAnimation=oa.go();}).bind(this)),oa=new h(ka).from('opacity',0).to('opacity',1).duration(150).ondone((function(){this.hoverAnimation=null;x.set(la,'opacity','');x.set(ka,'opacity','');}).bind(this));x.set(ka,'opacity',0);this.hoverAnimation=na.go();};ja.prototype.open=function(ka){'use strict';this.inform('open');this.view.show(this.facebarRoot.offsetWidth);this.input.focus({catchup:ka});this.checkValue();if(!this.isFocused){this.isFocused=true;this._newSession();this.inform('focus');}};ja.prototype.close=function(){'use strict';this._closeSession();if(this.inform('close')===false)return;if((!this.value||this.value.isEmptyOrWhitespace())&&this.selectedQuery){this.input.setValue(this.selectedQuery.structure);}else if(this.stickyQuery)this.input.setValue(this.stickyQuery.structure);this.input.blur();this.view.hide();this.view.setAutoSelect(false);this.inform('session',null,i.BEHAVIOR_STATE);if(this.isFocused){this.isFocused=false;fa(this.inform.bind(this,'blur'),0);}};ja.prototype.getElement=function(){'use strict';return this.root;};ja.prototype.getValue=function(){'use strict';return this.input.getValue();};ja.prototype.getText=function(){'use strict';return this.getValue().toString();};ja.prototype.submitQuery=function(ka){'use strict';if(n.graphSearchV2&&this.view.index<0){var la=this.input.getValue(),ma=this.data.getRawStructure(la);if(ma&&!ma.is_empty){var na=!ma.raw_text?q.getRawTextFromStructured(la.toArray()):ma.raw_text,oa=p.makeFacebarEntry(na);oa.position=ka;this.inform('magSearch',oa);this.executeQuery(oa);}}else this.view.select();};ja.prototype.keydown=function(event){'use strict';var ka=true,la=m.getKeyCode(event);switch(la){case u.ESC:this.close();break;case u.RIGHT:if(!n.disableLockingEntitiesOnRightArrow){ka=this.input.isSelectionAtEnd()&&this.completeSelection();}else ka=false;break;case u.TAB:var ma=this.cleanQuery(this.view.getSelection()),na=ma.structure.hasType('blank');if(event.getModifiers().shift||!this.completeSelection()&&!this.loading){this.view.setAutoSelect(false);this.view.hide();ka=false;}else if(!na&&!n.graphSearchV2)this.tabQueued=true;break;case u.UP:this.view.prev();break;case u.DOWN:this.view.next();break;case u.RETURN:var oa=-2;this.submitQuery(oa);break;case u.PAGE_UP:this.view.first();break;case 222:var pa=this.input.value.trim();if(!event.getModifiers().shift&&pa.endsOnType('ent'))this.input.setValue(pa);ka=false;break;default:var qa=la<=46&&la!==8&&la!==32,ra=la>=112&&la<=126,sa=la===144||la===145;if(!qa&&!ra&&!sa&&!event.metaKey){this.data.setSingleState(false);if(n.autohighlight)this.view.setAutoSelect(true);}this.stickyQuery=null;ka=false;break;}this.input.storeSelection();if(ka)return event.kill();};ja.prototype.keyup=function(event){'use strict';var ka=m.getKeyCode(event),la=ka<=46&&ka!==8&&ka!==32,ma=ka>=112&&ka<=126,na=ka===144||ka===145;if(!la&&!ma&&!na&&!event.metaKey)if(n.unlockTextOnKeypress)this._unlockQuery();};ja.prototype.mousedown=function(event){'use strict';if(n.autohighlight)this.view.setAutoSelect(true);this.input.storeSelection();if(w.byClass(event.target,"_50c9"))event.preventDefault();};ja.prototype.focusWindow=function(){'use strict';this.windowFocused=true;};ja.prototype.blurWindow=function(){'use strict';this.windowFocused=false;};ja.prototype.selectView=function(ka,la){'use strict';if(!la||!la.selected)return;this.data.setSingleState(true);this.inform('select',la);var ma=this.cleanQuery(la.selected);this.executeQuery(ma);};ja.prototype.highlightView=function(){'use strict';var ka=this.view.getSelection();if(n.graphSearchV2){this.input.setHint(ka?ka.structure:null);}else ka&&this.input.setHint(ka.structure);};ja.prototype.blurInput=function(){'use strict';fa((function(){if(this.windowFocused||y.getRequestURI().getSubdomain()==='apps'){this.input.togglePlaceholder();this.close();}}).bind(this),0);};ja.prototype.changeInput=function(){'use strict';this.inform('change');this.checkValue();this.inform('change_end');};ja.prototype.focusInput=function(){'use strict';this.open();this.input.togglePlaceholder(false);};ja.prototype.updateData=function(){'use strict';this.view.setLoading(this.loading);};ja.prototype.completeData=function(ka,la){'use strict';this.checkBlockedSearch();if(la.forceDisplay||this.value&&this.value.matches(la.value)){var ma=n.graphSearchV2?!la.results.length:!la.results.length&&!this.loading&&la.isEmptyResults;this.view.render(la.value,la.results,la.isAsync,ma);if(this.tabQueued&&this.completeSelection())delete this.tabQueued;}};ja.prototype.typeaheadActivity=function(ka,la){'use strict';this.fetching=la.activity;if(this.loading!==this.fetching){this.loading=this.fetching;this.updateData();}};ja.prototype.getNameTextFromSelected=function(){'use strict';var ka=this.settedQuery&&this.settedQuery.semantic,la=this.data.facebarConfig&&this.data.facebarConfig.name_functions,ma=ka&&la&&ka.match(/[a-z-]+\([^()]+\)/g);if(ma)for(var na=0;na<ma.length;na++){var oa=ma[na].match(/([a-z-]+)\(([^()]+)\)/);if(oa&&z(la,oa[1]))return oa[2];}return this.value.toString();};ja.prototype.clearRecentSearches=function(){'use strict';this.data.resultStore.clearRecentSearches();};ja.clearRecentSearches=function(){'use strict';i.inform('FacebarTypeahead.clearRecentSearches');};Object.assign(ja.prototype,{events:['session','focus','select','change','execute','blur','focusStartTime','open']});f.exports=ja;},null);
__d('FacebarTypeaheadRecorder',['clickRefAction','Event','Keys','SearchTypeaheadRecorder','URI','Arbiter','FacebarTimerUtils','FacebarGlobalOptions','FacebarJSConstants'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){if(c.__markCompiled)c.__markCompiled();var q,r;q=k;r=q&&q.prototype;Object.assign(s,q);s.prototype=Object.create(q.prototype);s.prototype.constructor=s;s.__superConstructor__=q;function s(t){'use strict';r.constructor.call(this,t);this.userText="";this.nullStateCandidates=null;this.singleStateCandidates=null;this.queryTimes={};this._sessionDisabled=false;this.type="facebar";this._maxQueryID=0;this._isQueryMatch=true;}s.prototype.initEvents=function(t){'use strict';t.getCore().subscribe('session',(function(u,v){if(v===null){this.sessionEnd();}else this.sessionStart(v);}).bind(this));t.getCore().subscribe('select',(function(u,v){this.recordSelectInfo(v);}).bind(this));t.getCore().subscribe('magSearch',(function(u,v){this.recordMagSearch(v);}).bind(this));t.getCore().input.subscribe('shortcut',(function(u,v){this.recordShortcut(v);}).bind(this));t.getCore().subscribe('quickSelectRedirect',(function(u,v){this.recordQuickSelectInfo(v);}).bind(this));t.getView().subscribe('render',(function(u,v){this.recordRender(v);if(this.allFromNullState){this.nullStateCandidates=this.buildListTypeaheadRecords();}else if(this.allFromSingleState)this.singleStateCandidates=this.buildListTypeaheadRecords();}).bind(this));t.getView().subscribe('show',(function(u,v){if(!this.data.lastNullOrSingleStateFetchStartTime)return;this.recordStat('time_render_null_state',Date.now()-this.data.lastNullOrSingleStateFetchStartTime);this.data.lastNullOrSingleStateFetchStartTime=null;}).bind(this));t.getView().subscribe('logPerformanceTiming',(function(u,v){this.performanceTimings[v.field]=v.value;}).bind(this));t.data.subscribe('query',(function(u,v){if(!v.value.isEmpty())this.recordCountStat('num_queries');this.recordAvgStat('num_results_from_cache',v.results.length);this.queryTimes[v.queryId]={send:n.getTimestamp()};}).bind(this));t.data.subscribe('sending_request',(function(u,v){var w=v.data.value;if(!w)return;this.backendQueries.push(w);}).bind(this));t.subscribe('navigation',(function(u,v){if(v&&v.structure){this.recordStat('navigation_input',JSON.stringify(v.structure.toStruct()));this.recordStat('navigation_text',v.structure.toString());}}).bind(this));t.data.subscribe('response_received',(function(u,v,w){if(this.queryTimes[v.queryId]){var x=this.queryTimes[v.queryId];x.recv=n.getTimestamp()-x.send;if(v&&v.payload)x.payload_size=JSON.stringify(v.payload).length;}}).bind(this));t.data.subscribe('remote_query_latency',(function(u,v){if(this.queryTimes[v.queryId]){var w=this.queryTimes[v.queryId];w.remoteQueryLatencies=v.latencies;}}).bind(this));t.data.subscribe('cache_query_latency',(function(u,v){if(this.queryTimes[v.queryId]){var w=this.queryTimes[v.queryId];w.cacheQueryLatencies=v.latencies;}}).bind(this));t.data.subscribe('backend_response',(function(u,v){if(this.queryTimes[v.queryId]){var w=this.queryTimes[v.queryId];w.render=n.getTimestamp()-w.send;if(v.payload.incomplete)w.incomplete=true;w.backendInfo=v.payload.info;if(this.core.scubaInfo)this.logToScuba(v,w,this.core.scubaInfo,v.inputQuery,this.type);}}).bind(this));t.getCore().subscribe('change',(function(u,v){this.userInput(this.core.getText());}).bind(this));t.data.subscribe('remote_query_match',(function(u,v){if(this._maxQueryID<v.queryId){this._maxQueryID=v.queryId;this._isQueryMatch=v.isMatch;}}).bind(this));m.subscribe('BrowseNUX/typing',this.disableThisSession.bind(this));m.subscribe('TestConsole/typing',this.disableThisSession.bind(this));t.subscribe('clear',(function(){this.recordAppendStat('before_clear_queries',this.userText);}).bind(this));i.listen(this.element,'keydown',(function(event){this.recordStat('keypressed',1);this.recordCountStat('count_keys_pressed');if(i.getKeyCode(event)==j.BACKSPACE){if(!this._backspacing){this._backspacing=true;this.recordAppendStat('before_backspace_queries',this.core.getText());}}else this._backspacing=false;}).bind(this));this.core.subscribe('open',(function(u,v){if(v&&v.catchup)return;this.data.lastNullOrSingleStateFetchStartTime=Date.now();}).bind(this));this.core.subscribe('focusStartTime',(function(u,v){this.data.lastNullOrSingleStateFetchStartTime=v.time;}).bind(this));this.data.subscribe('beforeQuery',(function(u,v){if(!this.queryStartTime)this.queryStartTime=[];if(!this.query&&!this.data.lastNullOrSingleStateFetchStartTime)this.data.lastNullOrSingleStateFetchStartTime=Date.now();this.queryStartTime[this.query]=Date.now();}).bind(this));t.subscribe('filter',(function(u,v){this._unsupportedGrammarInfo=this.buildUnsupportedGrammarInfo(v);}).bind(this));t.getCore().subscribe('recordFunction',(function(u,v){this._extraRecorder.push(v);}).bind(this));};s.prototype._reset=function(t){'use strict';this.stats={};this.avgStats={};this.appendStats={};this._backspacing=false;this.backendQueries=[];this._topreplace=false;this._inflightRequests={};};s.prototype.sessionStart=function(t){'use strict';this._sessionEnded=false;this.data.setQueryData({sid:t});this.recordStat('sid',t);if(!this.stats.session_start_time){this.recordStat('session_start_time',n.getTimestamp());var u=new Date(),v=u.getTimezoneOffset(),w=Date.now()-v*60*1000;this.recordStat('session_start_time_user_timezone',w);}this.recordStat('keypressed',0);this.queryTimes={};};s.prototype.sessionEnd=function(){'use strict';if(this._sessionEnded||this._sessionDisabled){if(this._sessionDisabled){this.reset();this._sessionDisabled=false;this._sessionEnded=true;}return;}this._sessionEnded=true;var t='typed';if(this.allFromNullState){t='nullstate';}else if(this.allFromSingleState)t='singlestate';this.recordStat('last_state',t);this.recordStat('session_end_time',n.getTimestamp());this.recordStat('grammar_version',this.data.getQueryData().grammar_version);this.submit();};s.prototype.disableThisSession=function(){'use strict';this._sessionDisabled=true;};s.prototype.userInput=function(t){'use strict';this.userText=t;};s.prototype.buildUnsupportedGrammarInfo=function(t){'use strict';var u=t.results?t.results[0]:null;if(!u||u.results_set_type!=='unimplemented')return null;return {unsupported_grammar:{category:u.error_info.category||'unknown',edge:u.error_info.blamed_edge}};};s.prototype.buildTypeaheadRecord=function(t,u){'use strict';var v=t.rankType||t.render_type||t.type,w=0,x=u;if(typeof t.groupIndex=='number'){w=t.groupIndex;x=t.indexInGroup;}var y={group_index:w,index_in_group:x,cost:t.cost,s_value:t.s_value||0,semantic:t.semantic,text:t.structure.toString(),cache_only:t.cacheOnlyResult?1:0,prefetched:t.isPrefetched?1:0,parse:t.parse,semantic_forest:t.semanticForest,category:t.category,type:v,source:t.bootstrapped,grammar_results_type:(t.results_set_type||'').replace(/[\[\{](.*)[\]\}]/,'$1'),result_from_memcache:t.memcache,websuggestion_source:t.websuggestion_source,dynamic_cost:t.dynamic_cost,is_js_bootstrap_match:t.isJSBootstrapMatch,backend_cost:t.backendCost,bootstrap_cost:t.bootstrapCost,match_type:t.match_type,l_type:t.l_type,vertical_type:t.vertical_type,prefix_match:t.prefix_match,prefix_length:t.prefix_length,index_before_buckets:t.indexBeforeBuckets,bucket_lineage:t.bucketLineage,nullstate:t.isNullState,singlestate:t.isSingleState,query_id:t.qid,template_id:t.templateID,coeff_cost:typeof t.grammar_costs=='undefined'?-1:t.grammar_costs["{"+t.type+"}"],suggestion:t.isSuggestion,recent_search_suggestion:t.isRecentSearchSuggestion,keyword_bootstrap:t.isJSBootstrapMatch&&t.type===p.keywordType};if(t.logInfo)y.backend_log_info=t.logInfo;if(t.s_token)y.s_token=t.s_token;if(t.s_categories)y.s_categories=t.s_categories;return y;};s.prototype.buildListTypeaheadRecords=function(){'use strict';var t=[];this.results&&this.results.forEach((function(u,v){if(u.uid!=='search')t.push(this.buildTypeaheadRecord(u,v));}).bind(this));return t;};s.prototype.recordShortcut=function(t){'use strict';this.recordStat('shortcut',1);this.recordStat('shortcut_with_shift',t.shift);};s.prototype.recordStats=function(t,u){'use strict';for(var v in u)this.recordStat(t+'_'+v,u[v]);};s.prototype.getTypeaheadIndex=function(t,u){'use strict';var v=typeof t.groupIndex=='number'?t.groupIndex+1:0;return u-v;};s.prototype.recordQuickSelectInfo=function(t){'use strict';var u={input_query:t.input_query,semantic:t.semantic,type:t.type,position:t.position,with_mouse:t.with_mouse,text:t.text,quick_select:1};this.recordStats('selected',u);this.recordStat('quick_select',1);};s.prototype.recordMagSearch=function(t){'use strict';var u={};u.text=t.text;u.semantic=t.semantic;u.type=t.type;u.input_query=t.text;u.position=t.position;this.recordStats('selected',u);};s.prototype.recordSelectInfo=function(t){'use strict';var u=t.selected,v=this.getTypeaheadIndex(u,t.index),w={};if(u.uid=='search'){w.selected_search=1;}else{w=this.buildTypeaheadRecord(u);var x=w.type=='friend'?'user':w.type;w.position=v;w[x]=1;}w.with_mouse=t.clicked?1:0;w.quick_select=0;w.input_query=this.userText;w.input_fragments=JSON.stringify(this.core.currentQuery.toStruct());var y=u.dataGT?{gt:JSON.parse(u.dataGT)}:{},z={href:u.path};h('click',z,null,null,y);this.recordStats('selected',w);this.recordAppendStat('selection_history',{selected:w,candidate_results:this.buildListTypeaheadRecords(),timestamp:n.getTimestamp()});var aa={};this._extraRecorder.forEach((function(ba){ba(t,this.results,aa);}).bind(this));this.recordStat('extra_select_info',JSON.stringify(aa));this.recordStat('selected_with_mouse',t.clicked?1:0);};s.prototype._dataToSubmit=function(){'use strict';this.recordStat('max_results',this.data._maxResults);if(this.stats&&this.stats.selected_input_query){this.recordStat('input_query',this.stats.selected_input_query);}else this.recordStat('input_query',this.userText);this.recordStat('uri',new l(window.location.href).toString());if(!this.stats.shortcut){this.recordStat('shortcut',0);this.recordStat('shortcut_with_shift',false);}var t=this.stats;for(var u in this.avgStats){var v=this.avgStats[u];t[u]=v[0]/v[1];}var w={candidate_results:this.buildListTypeaheadRecords(),timestamp:n.getTimestamp(),input_query:this.userText,remote_query_match:this._isQueryMatch};if(this._unsupportedGrammarInfo)Object.assign(w,this._unsupportedGrammarInfo);this.recordAppendStat('suggestions_at_end_of_session',w);if(this.nullStateCandidates)this.recordAppendStat('suggestions_at_nullstate_session',{candidate_results:this.nullStateCandidates});if(this.singleStateCandidates)this.recordAppendStat('suggestions_at_singlestate_session',{candidate_results:this.singleStateCandidates});this.recordAppendStat('query_times',this.queryTimes);if(this.backendQueries.length>0){if(this.backendQueries.length>this.data.logBackendQueriesWindow)this.backendQueries=this.backendQueries.slice(this.backendQueries.length-this.data.logBackendQueriesWindow);this.recordStat('backend_queries',this.backendQueries);}if(o.taSessionLoggingSample){var x=[];this.results.forEach(function(z){x.push([z.text||'',z.category||'',z.subtext||'']);});this.recordStat('raw_suggestions_text',x);}if(o.graphSearchV2){this.recordStat('experience_type','gsv2');}else this.recordStat('experience_type','facebar');for(var y in this.appendStats)t[y]=JSON.stringify(this.appendStats[y]);return t;};s.prototype.getDataToSubmit=function(){'use strict';return this._dataToSubmit();};s.prototype.reset=function(){'use strict';return this._reset();};s.prototype.submit=function(){'use strict';if(!this._sessionDisabled)r.submit.call(this);this.view.inform('feedback');this._reset();};Object.assign(s.prototype,{_sessionEnded:true,_extraRecorder:[],_banzaiRoute:'facebar'});f.exports=s;},null);
__d('FacebarTypeaheadV2',['CSS','csx','cx','DOM','Event','Parent'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n={init:function(o){this._view=o.getView();this._root=m.byClass(o.getElement(),"_585-");this._button=k.find(this._root,"._4w98");this._core=o.getCore();l.listen(this._button,'click',this.buttonDownAndClick.bind(this));l.listen(this._button,'mousedown',this.buttonDownAndClick.bind(this));l.listen(this._button,'mouseup',this.buttonUp.bind(this));this._core.subscribe('open',this.showButton.bind(this));this._core.subscribe('close',this.hideButton.bind(this));},showButton:function(){h.addClass(this._button,"_4w97");},hideButton:function(){if(h.hasClass(this._button,"_4w97"))h.removeClass(this._button,"_4w97");},buttonDownAndClick:function(event){event.preventDefault();},buttonUp:function(){if(!this._core.isFocused){this._core.focusInput();}else{var o=-1;this._core.submitQuery(o);}}};f.exports=n;},null);
__d('FacebarTypeaheadGrammarItem.react',['React','FacebarTypeaheadItem.react','FacebarTypeaheadToken.react','FacebarTypeaheadTokenText','cx','fbt','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();var o=Object.assign||function(r){for(var s=1;s<arguments.length;s++){var t=arguments[s];for(var u in t)if(Object.prototype.hasOwnProperty.call(t,u))r[u]=t[u];}return r;},p={user:m._("Person")},q=h.createClass({displayName:'FacebarTypeaheadGrammarItem',renderToken:function(){var r=this.props.result.decoration,s=this.props.result.ambiguity,t=s&&s.text,u=r&&r.entity||s&&s.entity;if(this.props.result.isRecent){var v=m._("Recent search");return (h.createElement(j,{text:[v],innerClass:"_53ab"}));}else if(t){return (h.createElement(j,{text:k.text(t)}));}else if(u)return (h.createElement(j,{text:k.textForEntity(u,p),limit:2,leadingMiddot:true}));},getClassName:function(){var r=this.props.result;if(r.isPeopleAndPagesSuggestion)return "_2enu";if(r.tags&&r.tags.displayedSeeMore)return "_10gs";return "_207";},render:function(){var r=this.renderToken(),s=r&&!r.props.leadingMiddot;return (h.createElement(i,o({},this.props,{className:n(this.props.className,this.getClassName()),valign:s,token:r})));}});f.exports=q;},null);
__d('FacebarTypeaheadKeywordItem.react',['FacebarGlobalOptions','FacebarTypeaheadItem.react','FacebarTypeaheadToken.react','FacebarTypeaheadTokenText','React','cx','fbt','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p=Object.assign||function(r){for(var s=1;s<arguments.length;s++){var t=arguments[s];for(var u in t)if(Object.prototype.hasOwnProperty.call(t,u))r[u]=t[u];}return r;},q=l.createClass({displayName:'FacebarTypeaheadKeywordItem',render:function(){var r=[n._("Search")];if(this.props.result.isTrending){r.push(n._("Trending"));}else if(this.props.result.type=='related')r=[n._("Related search")];if(h.renderKeywordSnippets){var s=k.textForEntity(this.props.result,{});if(s&&s.length)r=s;}var t=l.createElement(j,{text:r,mainClass:(h.renderKeywordSnippets&&s&&s.length>1?"_4jt7":'')+(h.renderKeywordSnippets&&s&&s.length>1&&(this.props.result.isTrending||this.props.result.isCelebrity)?' '+"_4pi4":''),innerClass:"_53ab"});return (l.createElement(i,p({},this.props,{className:o(this.props.className,!h.renderKeywordSnippets?"_207":''),token:t,prefix:this.props.result.query_string.toLowerCase()})));}});f.exports=q;},null);
__d('FacebarTypeaheadNodeItem.react',['React','DOM'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=h.createClass({displayName:'FacebarTypeaheadNodeItem',render:function(){var k=this.props.result.node;return (h.createElement('li',this.props,!i.isElementNode(k)?k:null));},attachNode:function(k){var l=this.props.result.node;if(i.isElementNode(l))i.setContent(k,l);},componentDidMount:function(){this.attachNode(h.findDOMNode(this));},componentDidUpdate:function(k,l,m){this.attachNode(h.findDOMNode(this));},shouldComponentUpdate:function(k){return this.props.result.node!==k.result.node;}});f.exports=j;},null);
__d('FacebarTypeaheadRecentItem.react',['FacebarGlobalOptions','FacebarTypeaheadItem.react','React','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m=Object.assign||function(o){for(var p=1;p<arguments.length;p++){var q=arguments[p];for(var r in q)if(Object.prototype.hasOwnProperty.call(q,r))o[r]=q[r];}return o;},n=j.createClass({displayName:'FacebarTypeaheadRecentItem',render:function(){return (j.createElement(i,m({},this.props,{className:l(this.props.className,!h.renderKeywordSnippets?"_207":''),icon:this.renderIcon()})));},renderIcon:function(){var o=this.props.result;if(!h.allowGrammar)return (j.createElement('img',{className:"_20h",src:o.photo}));var p=o.icon_class?j.createElement('span',{className:o.icon_class}):j.createElement('img',{className:"_20h",src:o.photo});return (j.createElement('span',{className:!h.renderKeywordSnippets||o.icon_class&&h.renderKeywordSnippets?"_k83":''},p));}});f.exports=n;},null);
__d('FacebarTypeaheadTrendingItem.react',['FacebarTypeaheadItem.react','FacebarTypeaheadToken.react','React','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m=Object.assign||function(o){for(var p=1;p<arguments.length;p++){var q=arguments[p];for(var r in q)if(Object.prototype.hasOwnProperty.call(q,r))o[r]=q[r];}return o;},n=j.createClass({displayName:'FacebarTypeaheadTrendingItem',render:function(){var o=this.props.result.articleTitle||'',p=j.createElement(i,{text:[o],innerClass:"_53ab",leadingMiddot:true});return (j.createElement(h,m({},this.props,{className:l(this.props.className,"_207"),token:p,valign:false})));}});f.exports=n;},null);
__d('FacebarTypeaheadList.react',['ARIA','React','StaticContainer.react','FacebarTypeaheadEntityItem.react','FacebarTypeaheadGrammarItem.react','FacebarTypeaheadKeywordItem.react','FacebarTypeaheadNodeItem.react','FacebarTypeaheadRecentItem.react','FacebarTypeaheadTrendingItem.react','LoadingIndicator.react','FacebarJSConstants','FacebarGlobalOptions','CSS','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){if(c.__markCompiled)c.__markCompiled();var w=i.PropTypes,x={grammar:l,trending:p,related:m};x[r.browseTypes.keyword]=m;x[r.keywordType]=m;var y=i.createClass({displayName:'FacebarTypeaheadList',propTypes:{results:w.array,onRender:w.func,onSelect:w.func.isRequired,onHighlight:w.func.isRequired,isKeywordList:w.bool},getItemComponentConstructor:function(z,aa){if(z.node)return n;if(z.isRecent)return o;if(z.results_set_type===r.browseTypes.keyword)return m;if(z.type&&x[z.type])return x[z.type];return k;},renderItem:function(z,aa){var ba=this.getItemComponentConstructor(z),ca;if(z.type===r.keywordType){ca=z.query_string+z.semantic+z.isRecentSearchSuggestion;}else{ca=z.semantic||z.uid||z.tuid;ca=ca+z.isNullState;if(s.facebarUpdateSnippets)ca=ca+z.category+z.subtext;}return (i.createElement(j,{key:ca},i.createElement(ba,{result:z,onClick:this.handleClick.bind(null,z),onMouseEnter:this.handleMouseEnter.bind(null,z)})));},renderFooter:function(){var z="_3su"+(!this.props.loading?' '+"hidden_elem":'');return (i.createElement('li',{className:z},i.createElement('div',{className:"_21f"},v._("Finding results"),i.createElement(q,{size:'medium',color:'white'}))));},componentDidMount:function(){var z=i.findDOMNode(this);h.owns(this.props.accessibilityElement,z);},hasValidRecentSearches:function(){if(!s.hasRecentSearchNullState||!this.props.results)return false;return this.props.results.some(function(z){return z.isRecent;});},render:function(){var z=this.props.results,aa=[],ba=[],ca=false;if(z)z.forEach(function(ha){if(ha.isTrending)ca=true;if(ha.isSuggestion){ba.push(this.renderItem(ha));}else aa.push(this.renderItem(ha));},this);var da=null,ea=null,fa=ca?v._("In the News"):v._("Search Suggestions");if(ba.length>0){var ga=null;if(this.hasValidRecentSearches()||s.hasGrammarNullState)ga=i.createElement('div',{className:"_3zsi"+(s.renderKeywordSnippets?' '+"_1ejo":'')},fa);da=i.createElement('div',null,ga,i.createElement('ul',{id:'facebar_typeahead_view_list',className:"_21c",role:'listbox'},ba,this.renderFooter()));}else ea=this.renderFooter();return (i.createElement('div',null,i.createElement('ul',{id:'facebar_typeahead_view_list',className:"_21c"+(this.props.isKeywordList?' '+"_2yob":''),'data-click':'Search',role:'listbox'},aa,ea),da));},handleClick:function(z,aa){if(t.hasClass(aa.target,"_2d9t"))return;if(!aa.nativeEvent.isMiddleClick()&&!aa.nativeEvent.getModifiers().any){this.props.onSelect(z);aa.preventDefault();}},handleMouseEnter:function(z){this.props.onHighlight(z);},componentDidUpdate:function(z,aa,ba){this.props.onRender();},shouldComponentUpdate:function(z){return this.props.loading!==z.loading||this.props.results!==z.results;}});f.exports=y;},null);
__d('FacebarTypeaheadView',['Arbiter','CSS','ContextualLayer','DOM','FacebarGlobalOptions','FacebarJSConstants','FacebarStructuredText','FacebarTypeaheadList.react','Parent','React','ScriptPath','Style','TypeaheadView','performanceNow','csx','cx','fbt','URI','Link.react'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){if(c.__markCompiled)c.__markCompiled();var aa=Object.assign||function(fa){for(var ga=1;ga<arguments.length;ga++){var ha=arguments[ga];for(var ia in ha)if(Object.prototype.hasOwnProperty.call(ha,ia))fa[ia]=ha[ia];}return fa;},ba,ca,da='unimplemented';ba=t;ca=ba&&ba.prototype;Object.assign(ea,ba);ea.prototype=Object.create(ba.prototype);ea.prototype.constructor=ea;ea.__superConstructor__=ba;function ea(fa,ga){'use strict';ca.constructor.call(this,fa,ga);this.element=fa;this.sid='';this.index=-1;this.warningShown=false;this.autoSelect=false;this.loading=false;this.handleRender=this.handleRender.bind(this);this.handleHighlight=this.handleHighlight.bind(this);this.handleSelect=this.handleSelect.bind(this);this.events=['highlight','render','filter','show'];}ea.prototype.init=function(){'use strict';this.initializeElements();};ea.prototype.initGSV2Elements=function(){'use strict';var fa=this.element;this.contentKeyword=k.find(fa,"._f7s");this.contentEntity=k.find(fa,"._f7t");this.contentRecent=k.find(fa,"._mn8");this.contentSuggestion=k.find(fa,"._2pl-");this.contentAdminedPages=k.find(fa,"._1e-s");this.keywordResultsContainer=k.create('div');this.entityResultsContainer=k.create('div');this.keywordResults=[];this.entityResults=[];};ea.prototype.initGSV2Construct=function(){'use strict';this.currentKeywordContainer=this.contentKeyword;this.currentEntityContainer=this.contentEntity;this.contentKeyword.appendChild(this.keywordResultsContainer);this.contentEntity.appendChild(this.entityResultsContainer);if(this.entityTop){this.resultsContainer.appendChild(this.contentEntity);this.resultsContainer.appendChild(this.contentKeyword);}else{this.resultsContainer.appendChild(this.contentKeyword);this.resultsContainer.appendChild(this.contentEntity);}};ea.prototype.initializeElements=function(){'use strict';var fa=this.element;this.isGSV2=l.graphSearchV2;this.dynamicRank=this.isGSV2;this.fixedBlendingOrder=l.blendingOrderKeywordFirst||l.blendingOrderEntityFirst;this.entityTop=l.blendingOrderEntityFirst&&!l.renderKeywordsFirst;this.content=k.find(fa,"._21r");this.warningNode=k.find(fa,"._553e");this.blockNotificationNode=k.find(fa,"._2hh");this.resultsContainer=k.create('div');if(this.isGSV2)this.initGSV2Elements();};ea.prototype.initializeList=function(){'use strict';this.renderTypeaheadList();this.content.appendChild(this.resultsContainer);if(this.isGSV2)this.initGSV2Construct();};ea.prototype.initializeLayer=function(){'use strict';this.layer=new j({context:p.byClass(this.causalElement,"_585-"),position:'below',causalElement:this.causalElement},this.element);var fa=this.layer.getContentRoot();this.root=k.find(fa,"._50c9");i.addClass(fa,"_5tlx");if(this.isGSV2)i.addClass(fa,"_5xzd");this.wrapper=fa;};ea.prototype.setInputElement=function(fa){'use strict';this.setAccessibilityControlElement(fa);this.causalElement=fa;this.initializeLayer();this.initializeList();};ea.prototype.setAutoSelect=function(fa){'use strict';this.autoSelect=fa;if(this.index===-1&&fa)this.first();};ea.prototype.getIndexOf=function(fa,ga){'use strict';for(var ha=0;ha<ga.length;ha++)if(fa.semantic===ga[ha].semantic)return ha;return -1;};ea.prototype.handleHighlight=function(fa){'use strict';this.highlight(this.getIndexOf(fa,this.results),false);};ea.prototype.handleSelect=function(fa){'use strict';this.handleHighlight(fa);this.select(true);};ea.prototype.show=function(fa){'use strict';if(!this.visible){this.inform('beforeShow',this.layer);s.set(this.wrapper,'minWidth',fa+'px');var ga=ca.show.call(this);this.first();this.layer.show();this.layer.updatePosition();this.inform('show');h.inform('layer_shown',{type:'FacebarTypeahead'});return ga;}};ea.prototype.hide=function(){'use strict';if(this.visible){this.layer.hide();ca.hide.call(this);this.inform('hide');h.inform('layer_hidden',{type:'FacebarTypeahead'});}return this;};ea.prototype.select=function(fa){'use strict';var ga=this.results&&this.results[this.index];if(!ga){this.inform('quickSelect');return;}var ha=this.inform('beforeSelect',{index:this.index,selected:ga});if(ha!==false){r.setClickPointInfo({click:'Search'});ca.select.call(this,fa);}};ea.prototype.doesResultBelongToEntitySection=function(fa){'use strict';switch(fa.type){case m.keywordType:return false;case m.grammarType:return fa.tags&&fa.tags.displayedSeeMore;default:return true;}};ea.prototype.processGSV2Results=function(fa){'use strict';this.keywordResults=[];this.entityResults=[];var ga=[],ha=[],ia=fa.some(function(ja){return ja.isSingleState;});fa.forEach((function(ja){if(this.doesResultBelongToEntitySection(ja)){this.entityResults.push(ja);}else if(ia){if(ja.alternateSemantic){ha.push(ja);}else ga.push(ja);}else this.keywordResults.push(ja);}).bind(this));if(ia)this.keywordResults=ha.concat(ga);if(this.entityTop)return this.entityResults.concat(this.keywordResults);return this.keywordResults.concat(this.entityResults);};ea.prototype.reGenerateContainer=function(){'use strict';var fa=k.create('div');if(this.entityTop){fa.appendChild(this.currentEntityContainer);fa.appendChild(this.currentKeywordContainer);}else{fa.appendChild(this.currentKeywordContainer);fa.appendChild(this.currentEntityContainer);}return fa;};ea.prototype.buildResultsNoRegeneration=function(fa){'use strict';if(this.dynamicRank)if(fa.length>0&&!this.fixedBlendingOrder&&!l.renderKeywordsFirst)this.entityTop=fa[0].type!==m.keywordType;var ga=String(this.value);fa.forEach(function(ia){ia.query_string=ga;});this.results=fa;if(this.isGSV2)this.results=this.processGSV2Results(fa);var ha=u();this.renderTypeaheadList({results:this.results,loading:this.loading});this.inform('logPerformanceTiming',{field:'build_results_set_props_duration',value:u()-ha});};ea.prototype.buildResults=function(fa){'use strict';this.buildResultsNoRegeneration(fa);if(this.dynamicRank)this.resultsContainer=this.reGenerateContainer();return this.resultsContainer;};ea.prototype.getGSV2Items=function(){'use strict';var fa=ca.getItems.call(this),ga,ha;if(this.entityTop){ha=fa.slice(0,this.entityResults.length);ga=fa.slice(this.entityResults.length+1,-1);fa=ha.concat(ga);}else{ga=fa.slice(0,this.keywordResults.length);ha=fa.slice(this.keywordResults.length+1,-1);fa=ga.concat(ha);}return fa;};ea.prototype.getItems=function(){'use strict';if(this.isGSV2)return this.getGSV2Items();return ca.getItems.call(this).slice(0,-1);};ea.prototype.handleRender=function(){'use strict';this.items=this.getItems();};ea.prototype.render=function(fa,ga,ha,ia){'use strict';this.inform('filter',{results:ga,value:fa});this.seeMoreResult=null;if(fa.getLength()){this.seeMoreResult=this.inform('seeMore',{value:fa,results:ga});if(!this.loading&&this.seeMoreResult)ga.push(this.seeMoreResult);}var ja=!fa||fa instanceof n&&fa.isEmptyOrWhitespace();i.conditionClass(this.wrapper,"_5qz2",!ga.length&&ja&&!this.getMegaphone());var ka=ga[0];if(ia&&!ja){if(!this.isGSV2)this.showWarning(x._("There are no results for '{query}'",[x.param('query',fa.toString())]));}else if(ka&&ka.results_set_type===da){if(!ka.error_info.suppress)this.showWarning(ka.error_info.errorMessage||x._("This search isn't currently supported."));}else this.hideWarning();if(this.inform('removeUnimplementedGrammar')!==false)ga=ga.filter((function(la){return la.results_set_type!==da;}).bind(this));ca.render.call(this,fa,ga,ha);};ea.prototype.reset=function(){'use strict';this.index=-1;this.items=[];this.results=[];this.value='';this.buildResults([]);this.inform('reset');return this;};ea.prototype.resetIndex=function(){'use strict';this.index=-1;};ea.prototype.getMegaphone=function(){'use strict';return k.scry(this.element,'.megaphone_location_gsv2_typeahead')[0];};ea.prototype.showBlockNotification=function(fa){'use strict';var ga=new y('https://www.facebook.com').setPath('/settings').addQueryData('tab','blocking'),ha=q.createElement('div',null,x._("You've blocked {fullName}. For more info on privacy and blocking, go to your {settings}.",[x.param('fullName',fa),x.param('settings',q.createElement(z,{href:{url:ga}},x._("settings")))]));i.show(this.blockNotificationNode);q.render(ha,this.blockNotificationNode);};ea.prototype.hideBlockNotification=function(){'use strict';i.hide(this.blockNotificationNode);k.setContent(this.blockNotificationNode,'');};ea.prototype.showWarning=function(fa){'use strict';i.show(this.warningNode);k.setContent(this.warningNode,fa);this.warningShown=true;this.highlight(-1,false);};ea.prototype.hideWarning=function(){'use strict';i.hide(this.warningNode);this.warningShown=false;this.highlight(this.index,false);};ea.prototype.setLoading=function(fa){'use strict';if(this.loading!=fa){this.loading=fa;if(this.seeMoreResult){if(this.loading){this.results.splice(this.results.indexOf(this.seeMoreResult),1);}else this.results.push(this.seeMoreResult);this.buildResultsNoRegeneration(this.results);}else this.renderTypeaheadList({results:this.results,loading:fa});}};ea.prototype.first=function(){'use strict';this.index=this.autoSelect?0:-1;this.highlight(this.index);};ea.prototype.prev=function(){'use strict';if(this.isGSV2){if(this.index<0||this.index===0&&this.autoSelect)this.index=this.items.length;}else if(this.index<=0)this.index=this.items.length;this.ignoreMouseover=true;ca.prev.call(this);};ea.prototype.next=function(){'use strict';if(this.isGSV2&&this.autoSelect&&this.index>=this.items.length-1)this.index=-1;if(!this.isGSV2&&this.index+1>=this.items.length)this.index=-1;this.ignoreMouseover=true;ca.next.call(this);};ea.prototype.highlight=function(fa,ga){'use strict';ga=ga!==false&&this.index!=fa;if(!ga||this.inform('beforeHighlight')!==false){var ha=this.warningShown||!this.autoSelect?-1:0;ca.highlight.call(this,Math.max(ha,fa),ga);}};ea.prototype.updateCurrentKeywordContainer=function(){'use strict';var fa=this.currentKeywordContainer,ga=!String(this.value).trim();if(ga&&this.hasValidRecentSearches()){this.currentKeywordContainer=this.contentRecent;}else if(ga&&l.hasKeywordSuggestionNullState&&!l.hasGrammarNullState){this.currentKeywordContainer=this.contentSuggestion;}else this.currentKeywordContainer=this.contentKeyword;if(fa&&fa!==this.currentKeywordContainer){i.hide(fa);fa.removeChild(this.keywordResultsContainer);this.currentKeywordContainer.appendChild(this.keywordResultsContainer);}};ea.prototype.updateCurrentEntityContainer=function(){'use strict';var fa=this.currentEntityContainer,ga=!String(this.value).trim();if(ga&&this.entityResults){this.currentEntityContainer=this.contentAdminedPages;}else this.currentEntityContainer=this.contentEntity;if(fa&&fa!=this.currentEntityContainer){i.hide(fa);fa.removeChild(this.entityResultsContainer);this.currentEntityContainer.appendChild(this.entityResultsContainer);}};ea.prototype.hasValidRecentSearches=function(){'use strict';if(!l.hasRecentSearchNullState||!this.keywordResults)return false;return this.keywordResults.some(function(fa){return fa.isRecent;});};ea.prototype.copyProps=function(fa){'use strict';return aa({accessibilityElement:this.accessibilityElement,onRender:this.handleRender,onHighlight:this.handleHighlight,onSelect:this.handleSelect},fa);};ea.prototype.renderList=function(fa,ga){'use strict';q.render(q.createElement(o,this.copyProps(fa)),ga);};ea.prototype.renderGSV2TypeaheadList=function(fa){'use strict';var ga=this.copyProps(Object.assign({},fa,{isKeywordList:true})),ha=this.copyProps(fa);ga.results=this.keywordResults;ha.results=this.entityResults;if(this.entityTop||ha.results.length===0){ha.loading=false;}else ga.loading=false;var ia=this.entityResults.length===0&&ga.loading&&this.keywordResults.length===1&&this.keywordResults[0].exactMatchKeyword;this.renderList(ga,this.keywordResultsContainer);this.renderList(ha,this.entityResultsContainer);this.updateCurrentKeywordContainer();this.updateCurrentEntityContainer();i.conditionShow(this.currentKeywordContainer,!!this.keywordResults.length);i.conditionShow(this.currentEntityContainer,!!this.entityResults.length);i.conditionClass(this.element,"_1z7e",ia);i.conditionClass(this.element,"_3gbv",l.typeaheadkeywordStyle==='relaxed');i.conditionClass(this.element,"_3gbw",l.typeaheadkeywordStyle==='baggy');};ea.prototype.renderTypeaheadList=function(fa){'use strict';fa=fa||{};if(this.isGSV2){this.renderGSV2TypeaheadList(fa);}else this.renderList(fa,this.resultsContainer);};f.exports=ea;},null);
__d('FacebarTypeaheadDecorateEntities',['arrayContains','emptyFunction'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();function j(n){var o=[];n.forEach(function(p){if(p.isType('ent'))o.push(p.getUID());});return o;}function k(n,o){var p=null;n.structure.forEach(function(q){if(q.isType('ent')&&!h(o,q.getUID()))p=q;});return p;}function l(n,o,p){n.forEach(function(q){var r=k(q,o);q.decoration={entity:r&&p.getEntryForFragment(r)};});}function m(n){'use strict';this._typeahead=n;}m.prototype.enable=function(){'use strict';this._typeahead.view.subscribe('filter',(function(n,o){l(o.results,j(this._typeahead.core.getValue()),this._typeahead.data);}).bind(this));};Object.assign(m.prototype,{disable:i});f.exports=m;},null);
__d('FacebarTypeaheadDisambiguateResults',['FacebarDisambiguationDialog','FacebarStructuredFragment','FacebarStructuredText','URI','emptyFunction','getObjectValues'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();function n(w,x){var y={};w.forEach(function(ba){if(ba.type=='grammar'){var ca=x(ba.structure).toLowerCase();y[ca]=y[ca]||[];y[ca].push(ba);}});var z=[];for(var aa in y)if(y[aa].length>1)z.push(y[aa]);return z;}function o(w){var x=[];w.toArray().forEach(function(y,z){if(y.isType('ent'))x.push(z);});return x;}function p(w,x,y){var z={},aa={},ba={};x.forEach(function(da){var ea=w[0].structure.getFragment(da),fa=ea.getHash();aa[fa]=aa[fa]||[];ba[da]=aa[fa];w.forEach(function(ga){var ha=ga.structure.getFragment(da),ia=ha&&ha.getUID();if(ia&&!z.hasOwnProperty(ia)){aa[fa].push(y.getEntryForFragment(ha));z[ia]=true;}});});for(var ca in ba)if(ba[ca].length<=1)delete ba[ca];return ba;}function q(w,x){var y={},z=[];w.forEach(function(aa){var ba=aa.structure.getFragment(x).getUID();if(!y.hasOwnProperty(ba)){y[ba]=z.length;z.push([]);}z[y[ba]].push(aa);});return z;}function r(w,x,y){var z=w.shift();z.ambiguity.entities=x;y.push.apply(y,w);return z;}function s(w,x){var y=[],z=[],aa=false;w.forEach(function(ca){ca.ambiguity={fragment:null,entities:null,text:null};});n(w,function(ca){return ca.getHash();}).forEach(function(ca){var da=ca[0].structure,ea=o(da),fa=p(ca,ea,x);if(aa){r(ca,fa,y);return;}var ga=ea.pop();if(typeof ga=='number'){var ha=q(ca,ga);aa=ha.length>1;if(aa)delete fa[ga];ha.forEach(function(ia){var ja=r(ia,fa,y);if(aa){var ka=ja.structure.getFragment(ga).getUID();ja.ambiguity.entity=x.getEntry(ka);z.push(ja);}});}});y.forEach(function(ca){var da=w.indexOf(ca);da!=-1&&w.splice(da,1);});n(w,function(ca){return ca.toString();}).forEach(function(ca){ca.forEach(function(da){if(!da.ambiguity.entities)da.ambiguity.text=da.queryTypeText;});});var ba=w.indexOf(z[0]);z.slice(1).forEach(function(ca){var da=w.indexOf(ca);if(da!=-1&&da!=(++ba)){w.splice(da,1);w.splice(ba,0,ca);}});}function t(w,x){var y=w&&w.ambiguity&&w.ambiguity.entities,z=y&&Object.keys(y).map(Number),aa=x.core.input;if(!z||z.length===0)return false;var ba=function(ea){x.core.executeQuery(u(w,z,ea));},ca=function(){aa.focus();aa.input.moveSelectionToEnd();};y=y?m(y):[];var da=new h(y,w.uri.getPath(),ba,ca,x.getCore().getSessionID());aa.blur();da.show();return true;}function u(w,x,y){var z=w.structure.toArray(),aa=new k(w.uri),ba=aa.getPath().split('/');x.forEach(function(ca){var da=z[ca],ea=y.shift(),fa=ba.indexOf(String(da.getUID()));if(fa!=-1)ba[fa]=ea.uid;z[ca]=new i({uid:ea.uid,text:ea.text,type:'ent:'+ea.type});});return {uri:aa.setPath(ba.join('/')),structure:new j(z)};}function v(w){'use strict';this._typeahead=w;}v.prototype.enable=function(){'use strict';this._typeahead.view.subscribe('filter',(function(w,x){s(x.results,this._typeahead.data);}).bind(this));this._typeahead.view.subscribe('beforeSelect',(function(w,x){return !t(x.selected,this._typeahead);}).bind(this));};Object.assign(v.prototype,{disable:l});f.exports=v;},null);
__d('FacebarTypeaheadNavigation',['Arbiter','FacebarNavigation','emptyFunction'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();function k(l){'use strict';this._core=l.core;this._preserveQuery=false;this._typeahead=l;}k.prototype.enable=function(){'use strict';i.registerBehavior(this);this._core.subscribe('execute',this.executedUserQuery.bind(this));};k.prototype.executedUserQuery=function(l,m){'use strict';this._preserveQuery=true;};k.prototype.pageTransition=function(){'use strict';if(!this._preserveQuery){this._core.close();this._core.reset();}else this._preserveQuery=false;};k.prototype.setPageQuery=function(l){'use strict';l=this._core.setPageQuery(l);this._typeahead.inform('navigation',l,h.BEHAVIOR_PERSISTENT);};Object.assign(k.prototype,{disable:j});f.exports=k;},null);
__d('FacebarTypeaheadPrefixLengthOrderedCache',['emptyFunction','Arbiter'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();function j(k){'use strict';this._typeahead=k;}j.prototype.enable=function(){'use strict';this._typeahead.data.inform('setSortFunction',function(k,l){if(k.cache_id_length!==l.cache_id_length)return k.cache_id_length-l.cache_id_length;var m=(k.cost||0)-(l.cost||0);if(m!==0)return m;return (k.semantic||'').localeCompare(l.semantic||'');},i.BEHAVIOR_STATE);};Object.assign(j.prototype,{disable:h});f.exports=j;},null);
__d('FacebarTypeaheadQuickSelect',['FacebarStructuredText','URI'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j='/search/web/direct_search.php';function k(l){'use strict';this._core=l.getCore();this._view=l.getView();this._input=this._core.input;this._beforeSelectListener=null;this._quickSelectListener=null;}k.prototype.enable=function(){'use strict';this._beforeSelectListener=this._view.subscribe('beforeSelect',this._quickSelect.bind(this));this._quickSelectListener=this._view.subscribe('quickSelect',this._quickSelect.bind(this));};k.prototype._quickSelect=function(l,m){'use strict';if(m&&m.selected)return true;var n=this._input.getValue().toArray(),o=new h(n),p=o.toString();if(!p)return true;var q=new i(j).addQueryData('q',p),r={input_query:p,type:'quickselect',text:p,position:0,with_mouse:0,semantic:'quickselect('+q.toString()+')',extra_uri_params:{source:'quickselect',sid:this._core.getSessionID()},uri:q};this._core.inform('quickSelectRedirect',r);this._core.executeQuery(r);return false;};k.prototype.disable=function(){'use strict';this._beforeSelectListener&&this._view.unsubscribe(this._beforeSelectListener);this._quickSelectListener&&this._view.unsubscribe(this._quickSelectListener);};f.exports=k;},null);
__d('FacebarTypeaheadRecorderBasic',['FacebarTypeaheadRecorder'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(j){'use strict';this._typeahead=j;}i.prototype.enable=function(){'use strict';var j=this._typeahead;this._recorder=new h(j);};i.prototype.disable=function(){'use strict';this._typeahead.unsubscribe(this._subscription);this._recorder=null;this._subscription=null;};Object.assign(i.prototype,{_subscription:null});f.exports=i;},null);
__d('FacebarTypeaheadSelectAll',['requestAnimationFrame'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(j){'use strict';this._core=j.getCore();this._listener=null;}i.prototype.enable=function(){'use strict';var j=this._core.input;this._listener=this._core.subscribe('focus',function(k,l){var m=l&&l.catchup;m||h(function(){j.selectInput();});});};i.prototype.disable=function(){'use strict';this._listener&&this._core.unsubscribe(this._listener);};f.exports=i;},null);
__d('FacebarTypeaheadShortcut',['FacebarTypeaheadShortcutConfig','KeyEventController','Run','setTimeoutAcrossTransitions'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();function l(m){'use strict';this._input=m.core.input;this._view=m.view;this._listener=null;}l.prototype.enable=function(){'use strict';this._registerListener();};l.prototype.disable=function(){'use strict';};l.prototype._registerListener=function(){'use strict';this._listener&&this._listener.remove();this._listener=i.registerKey('SLASH',this._handleKeydown.bind(this));j.onLeave((function(){k(this._registerListener.bind(this),0);}).bind(this));};l.prototype._handleKeydown=function(m){'use strict';var n=m.getModifiers().shift;if(n&&!h.gkWebShortcut)return;this._selectInput(n);return false;};l.prototype._selectInput=function(m){'use strict';this._view.setAutoSelect(true);this._input.focus();this._input.selectInput();this._input.inform('shortcut',{shift:m});};f.exports=l;},null);
__d('FacebarTypeaheadSizeAdjuster',['getElementChildren','confine','emptyFunction','isTextNode','Style','Vector'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n=12,o=20,p=50,q=200,r=5;function s(u){if(k(u))return 0;return m.getElementDimensions(u).x;}function t(u){'use strict';this._core=u.getCore();this._view=this._core.view;this._input=this._core.input;this._cachedSizes={};this._appliedSize=null;this._defaultSize=this.getDefaultFontSize();this._calculatedSize=this._defaultSize;this._containerWidth=this.getContainerWidth();}t.prototype.enable=function(){'use strict';this._input.subscribe('change',this.adjustFontSize.bind(this));this.adjustFontSize();};t.prototype.getContainerWidth=function(){'use strict';return m.getElementDimensions(this._input.getElement()).x;};t.prototype.getDefaultFontSize=function(){'use strict';var u=l.get(this._input.getElement(),'font-size'),v=/^([\d\.]+)px$/.exec(u),w=v&&Number(v[1]);return Math.max(n,Math.min(o,w));};t.prototype.calculateFontSize=function(){'use strict';var u=this.getTextWidth(),v=this._calculatedSize;if(u>this._containerWidth-p){v--;}else if(u<this._containerWidth-q)v++;this._calculatedSize=i(v,n,this._defaultSize);return this._calculatedSize;};t.prototype.getTextWidth=function(){'use strict';var u=this._calculatedSize+this.getValueKey();if(!this._cachedSizes.hasOwnProperty(u))this._cachedSizes[u]=this.measureTextWidth();return this._cachedSizes[u];};t.prototype.getValueKey=function(){'use strict';var u=this._core.getValue().getHash(),v=r*Math.floor(u.length/r);return u.substr(0,v);};t.prototype.measureTextWidth=function(){'use strict';var u=h(this._input.getRawInputElement());return u.reduce(function(v,w){return v+s(w);},0);};t.prototype.adjustFontSize=function(){'use strict';for(var u=0;u<10;u++){var v=this.calculateFontSize();if(v!=this._appliedSize){this._appliedSize=v;l.set(this._input.getElement(),'font-size',v+'px');l.set(this._view.content,'font-size',v+'px');}else break;}};Object.assign(t.prototype,{disable:j});f.exports=t;},null);
__d('TypeaheadSearchMegaphone',['AsyncRequest','DOM','DOMQuery','Event','Parent'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();function m(n){'use strict';this.$TypeaheadSearchMegaphone1=n;}m.prototype.enable=function(){'use strict';var n=j.scry(this.$TypeaheadSearchMegaphone1.getView().getElement(),'.megaphone_location_gsv2_typeahead')[0];if(!n)return;this.ajaxify=j.scry(n,'a.megaphone_hide_link[ajaxify]')[0].getAttribute('ajaxify');j.scry(n,'a').forEach(this.processLink,this);k.listen(n,'click',this.onClick.bind(this));};m.prototype.disable=function(){'use strict';};m.prototype.processLink=function(n){'use strict';if(n.getAttribute('ajaxify'))return;i.setAttributes(n,{target:'_blank'});};m.prototype.onClick=function(event){'use strict';var n=l.byTag(event.target,'a');if(!n||n.getAttribute('ajaxify'))return;h.bootstrap(this.ajaxify,n);};f.exports=m;},null);