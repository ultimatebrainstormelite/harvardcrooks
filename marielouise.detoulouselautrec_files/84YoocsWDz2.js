/*!CK:152034603!*//*1439175077,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["zTAJQ"]); }

__d('AsyncUploadRequest',['AsyncUploadBase'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i,j;i=h;j=i&&i.prototype;Object.assign(k,i);k.prototype=Object.create(i.prototype);k.prototype.constructor=k;k.__superConstructor__=i;k.prototype.setFiles=function(l){'use strict';this._files=h.parseFiles(l);return this;};k.prototype.abort=function(){'use strict';this._uploads.forEach((function(l){return this._abort(l);}).bind(this),this);};k.prototype.send=function(){'use strict';if(this._inFlight)return;this._inFlight=true;this._uploads=[];for(var l in this._files)this._files[l].forEach((function(m){this._uploads.push(this._createFileUpload(l,m));}).bind(this));this._waiting=this._uploads.slice(0);this._pending=[];if(this._uploads.length){this._processQueue();}else this._processUpload(this._createFileUpload(null,null));};k.prototype._processQueue=function(){'use strict';j._processQueue.call(this);if(!this._pending.length&&!this._waiting.length)this.inform('complete',this._uploads);};k.isSupported=function(){'use strict';return h.isSupported();};function k(){'use strict';i.apply(this,arguments);}f.exports=k;},null);
__d('FileForm',['ArbiterMixin','AsyncRequest','AsyncResponse','AsyncUploadRequest','BehaviorsMixin','CurrentUser','DataStore','DOMQuery','Event','Form','JSONPTransport','Parent','URI','mixin','shield'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){if(c.__markCompiled)c.__markCompiled();var w,x;function y(ba){var ca={},da=o.scry(ba,'input[type="file"]');da.forEach(function(ea){ca[ea.name]=ea.files;});return ca;}function z(ba){var ca=o.scry(ba,'input[type="file"]');ca.forEach(function(da){da.files=null;});}w=u(h,l);x=w&&w.prototype;Object.assign(aa,w);aa.prototype=Object.create(w.prototype);aa.prototype.constructor=aa;aa.__superConstructor__=w;function aa(ba,ca,da){'use strict';x.constructor.call(this);if(ba.getAttribute('rel')==='async')throw new Error('FileForm cannot be used with Primer forms.');if(ba.getAttribute('method').toUpperCase()!=='POST')throw new Error('FileForm must be used with POST forms.');this._form=ba;this._previousEncoding=this._form.enctype;this._form.enctype=this._form.encoding='multipart/form-data';this._files=null;ca&&this.enableBehaviors(ca);this._options=da||{};this.setAllowCrossOrigin(this._options.allowCrossOrigin);this.setAllowCrossPageTransition(this._options.allowCrossPageTransition);this.setUploadInParallel(this._options.uploadInParallel);this.setConcurrentLimit(this._options.concurrentLimit);this.setPreprocessHandler(this._options.preprocessHandler);this.setNetworkErrorRetryLimit(this._options.networkErrorRetryLimit);this._listeners=[p.listen(document.documentElement,'submit',this._submit.bind(this)),p.listen(this._form,'click',this._click.bind(this))];n.set(this._form,'FileForm',this);}aa.prototype.getRoot=function(){'use strict';return this._form;};aa.prototype.setAllowCrossOrigin=function(ba){'use strict';this._allowCrossOrigin=!!ba;return this;};aa.prototype.setAllowCrossPageTransition=function(ba){'use strict';this._allowCrossPageTransition=!!ba;return this;};aa.prototype.setUploadInParallel=function(ba){'use strict';this._uploadInParallel=!!ba;return this;};aa.prototype.setConcurrentLimit=function(ba){'use strict';this._concurrentLimit=ba;return this;};aa.prototype.setPreprocessHandler=function(ba){'use strict';this._preprocessHandler=ba;return this;};aa.prototype.setNetworkErrorRetryLimit=function(ba){'use strict';this._retryLimit=ba;return this;};aa.prototype.setFiles=function(ba){'use strict';this._files=ba;return this;};aa.prototype.canUseXHR=function(){'use strict';var ba=('FormData' in window);if(ba)if(!new t(this._form.action).isSameOrigin()&&!this._allowCrossOrigin)ba=false;return ba;};aa.prototype._submit=function(event){'use strict';if(event.isDefaultPrevented()||event.getTarget()!==this._form)return;if(this.inform('submit')===false){event.prevent();return;}return this.canUseXHR()?this._sendViaXHR(event):this._sendViaFrame(event);};aa.prototype._click=function(event){'use strict';var ba=event.getTarget();while(o.isElementNode(ba)){if(ba.type==='submit'){this._clickTarget=ba;setTimeout(this._unclick.bind(this),0);break;}ba=ba.parentNode;}};aa.prototype._unclick=function(){'use strict';this._clickTarget=null;};aa.prototype._sendViaFrame=function(event){'use strict';var ba=this._request=new i();ba.setStatusElement(this._getStatusElement());ba.addStatusIndicator();ba.setOption('useIframeTransport',true);var ca=ba.handleResponse.bind(ba),da=new r('iframe',this._form.action,ca),ea=da.getTransportFrame(),fa=da.getRequestURI().addQueryData({__iframe:true,__user:m.getID()});this._form.setAttribute('action',fa.toString());this._form.setAttribute('target',ea.name);ba.setJSONPTransport(da);ba.setURI(fa);ba.setHandler(this.success.bind(this,null));ba.setErrorHandler(this.failure.bind(this,null));ba.setInitialHandler(v(this.initial,this,null));};aa.prototype._sendViaXHR=function(event){'use strict';var ba;if(this._uploadInParallel&&k.isSupported()){ba=new k().setPreprocessHandler(this._preprocessHandler).setData(q.serialize(this._form,this._clickTarget)).setNetworkErrorRetryLimit(this._retryLimit);if(this._concurrentLimit)ba.setLimit(this._concurrentLimit);if(this._files){ba.setFiles(this._files);}else ba.setFiles(y(this._form));var ca=[ba.subscribe('progress',(function(ha,ia){this.progress(ia,ia.getProgressEvent());}).bind(this)),ba.subscribe('initial',(function(ha,ia){this.initial(ia,ia.getResponse());}).bind(this)),ba.subscribe('success',(function(ha,ia){this.success(ia,ia.getResponse());}).bind(this)),ba.subscribe('start',(function(ha,ia){this.inform('start',{upload:ia});}).bind(this)),ba.subscribe('failure',(function(ha,ia){this.failure(ia,ia.getResponse());return false;}).bind(this)),ba.subscribe('complete',function(){while(ca.length)ca.pop().unsubscribe();})];}else{var da;if(this._files){da=q.createFormData(q.serialize(this._form,this._clickTarget));var ea=k.parseFiles(this._files);for(var fa in ea){var ga=ea[fa];if(ga.length===1){da.append(fa,ga[0]);}else{fa=fa+'[]';ga.forEach(function(ha){da.append(fa,ha);});}}}else da=q.createFormData(this._form,this._clickTarget);ba=new i().setRawData(da).setHandler(this.success.bind(this,null)).setErrorHandler(this.failure.bind(this,null)).setUploadProgressHandler(this.progress.bind(this,null)).setInitialHandler(v(this.initial,this,null));}ba.setAllowCrossOrigin(this._allowCrossOrigin).setAllowCrossPageTransition(this._allowCrossPageTransition).setRelativeTo(this._form).setStatusElement(this._getStatusElement()).setURI(this._form.action).send();this._request=ba;event&&event.prevent();};aa.prototype.forceSendViaXHR=function(){'use strict';return this._sendViaXHR(null);};aa.prototype.initial=function(ba){'use strict';return this.inform('initial',{upload:ba});};aa.prototype.success=function(ba,ca){'use strict';var da={response:ca,upload:ba};if(this.inform('success',da)!==false)p.fire(this._form,'success',da);this._cleanup();};aa.prototype.failure=function(ba,ca){'use strict';var da={response:ca,upload:ba};if(this.inform('failure',da)!==false)if(p.fire(this._form,'error',da)!==false)j.defaultErrorHandler(ca);this._cleanup();};aa.prototype.progress=function(ba,event){'use strict';this.inform('progress',{event:event,upload:ba});};aa.prototype.abort=function(){'use strict';if(this._request){this._request.abort();this._cleanup();}};aa.prototype.clear=function(){'use strict';z(this._form);};aa.prototype.destroy=function(){'use strict';this._cleanup();while(this._listeners.length)this._listeners.pop().remove();this._listeners=null;this._form.enctype=this._form.encoding=this._previousEncoding;n.remove(this._form,'FileForm');};aa.prototype._cleanup=function(){'use strict';this._request=null;};aa.prototype._getStatusElement=function(){'use strict';return s.byClass(this._form,'stat_elem')||this._form;};aa.getInstance=function(ba){'use strict';return n.get(ba,'FileForm');};Object.assign(aa,{EVENTS:['start','submit','initial','progress','success','failure']});f.exports=aa;},null);
__d('submitForm',['DOM'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=function(j){var k=h.scry(j,'input[type="submit"]')[0];if(k){k.click();}else{k=h.create('input',{type:'submit',className:'hidden_elem'});h.appendContent(j,k);k.click();h.remove(k);}};f.exports=i;},null);
__d('FileInputUploader',['ArbiterMixin','DOM','DTSG','FileForm','Form','mixin','submitForm'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();var o=Object.assign||function(s){for(var t=1;t<arguments.length;t++){var u=arguments[t];for(var v in u)if(Object.prototype.hasOwnProperty.call(u,v))s[v]=u[v];}return s;},p,q;p=m(h);q=p&&p.prototype;Object.assign(r,p);r.prototype=Object.create(p.prototype);r.prototype.constructor=r;r.__superConstructor__=p;function r(s){'use strict';q.constructor.call(this);this._inputElem=s;this._data={};}r.prototype.setInput=function(s){'use strict';this._inputElem=s;return this;};r.prototype.setURI=function(s){'use strict';this._uri=s;return this;};r.prototype.setData=function(s){'use strict';this._data=s;return this;};r.prototype.setPreprocessHandler=function(s){'use strict';this._preprocessHandler=s;return this;};r.prototype.setNetworkErrorRetryLimit=function(s){'use strict';this._retryLimit=s;return this;};r.prototype.setFiles=function(s){'use strict';this._files=s;return this;};r.prototype.setAllowCrossOrigin=function(s){'use strict';this._allowCrossOrigin=!!s;return this;};r.prototype.setAllowCrossPageTransition=function(s){'use strict';this._allowCrossPageTransition=!!s;return this;};r.prototype.setUploadInParallel=function(s){'use strict';this._uploadInParallel=!!s;return this;};r.prototype.setConcurrentLimit=function(s){'use strict';this._concurrentLimit=s;return this;};r.prototype.abort=function(){'use strict';if(this._fileForm){this._fileForm.abort();this._destroyFileForm();}};r.prototype.send=function(){'use strict';this._createForm();var s=this._inputElem.cloneNode(false);i.replace(this._inputElem,s);i.appendContent(this._formElem,this._inputElem);i.appendContent(document.body,this._formElem);n(this._formElem);i.replace(s,this._inputElem);this._removeFormEl();};r.prototype._onFileFormEvent=function(s,t){'use strict';if(s==='success'||s==='failure')this._destroyFileForm();this.inform(s,t);};r.prototype._createForm=function(){'use strict';this._destroyFileForm();this._formElem=i.create('form',{action:this._uri,method:'post'});this._fileForm=new k(this._formElem,null,{allowCrossOrigin:this._allowCrossOrigin,allowCrossPageTransition:this._allowCrossPageTransition,uploadInParallel:this._uploadInParallel,concurrentLimit:this._concurrentLimit,preprocessHandler:this._preprocessHandler,networkErrorRetryLimit:this._retryLimit});if(this._files)this._fileForm.setFiles(this._files);this._fileForm.subscribe(k.EVENTS,this._onFileFormEvent.bind(this));l.createHiddenInputs(o({fb_dtsg:j.getToken()},this._data),this._formElem);};r.prototype._removeFormEl=function(){'use strict';i.remove(this._formElem);this._formElem=null;};r.prototype._destroyFileForm=function(){'use strict';if(this._fileForm){this._fileForm.destroy();this._fileForm=null;}};f.exports=r;},null);
__d('TimelineDrag',['ArbiterMixin','Event','Locale','Style','Vector','mixin'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n,o;n=m(h);o=n&&n.prototype;Object.assign(p,n);p.prototype=Object.create(n.prototype);p.prototype.constructor=p;p.__superConstructor__=n;function p(q,r,s){'use strict';o.constructor.call(this);s=s||{};this._listenOn=s.listenOn;this._offsetInput=r;this._defaultOffset=s.default_offset;this._killClicks=s.killClicks;this._vertical=true;this._RTLXSwitch=false;this.setPicture(q,s);}p.prototype.setPicture=function(q,r){'use strict';if(!q)return false;r=r||{};this._picture=q;this._defaultOffset=r.default_offset;if(r.offsetInput)this._offsetInput=r.offsetInput;if(r.vertical!==undefined)this._vertical=r.vertical;if(r.height)this._containerHeight=r.height;if(r.width)this._containerWidth=r.width;if(this._vertical){this._offsetType='top';this._eventCoord='y';}else{this._RTLXSwitch=j.isRTL();this._offsetType='left';this._eventCoord='x';}if(this._picture.complete){this._initialLoad();}else this._loadListener=i.listen(this._picture,'load',(function(){this._loadListener.remove();this._loadListener=null;this._initialLoad();}).bind(this));};p.prototype.destroy=function(){'use strict';this._stopDrag();this._saveOffset();this._mousedown&&this._mousedown.remove();this._mousedown=null;this._onclick&&this._onclick.remove();this._onclick=null;this._loadListener&&this._loadListener.remove();this._loadListener=null;};p.prototype._initialLoad=function(){'use strict';var q=this._listenOn?this._listenOn:this._picture;this._mousedown&&this._mousedown.remove();this._mousedown=i.listen(q,'mousedown',this._onMouseDown.bind(this));if(this._vertical){this._maxOffset=this._containerHeight-this._picture.offsetHeight;}else this._maxOffset=this._containerWidth-this._picture.offsetWidth;if(this._defaultOffset!==undefined)this._setOffset(this._defaultOffset);this._onclick&&this._onclick.remove();this._onclick=null;if(this._killClicks)this._onclick=i.listen(q,'click',this._onClick.bind(this));this._saveOffset();};p.prototype._onClick=function(event){'use strict';event.kill();};p.prototype._onMouseDown=function(event){'use strict';var q=parseInt(k.get(this._picture,this._offsetType),10)||0;this._pictureStartDragOffset=q-l.getEventPosition(event)[this._eventCoord];this._startDrag();event.kill();};p.prototype._startDrag=function(){'use strict';if(!this._dragStarted){this.inform('startdrag',this);this._dragTokens=[i.listen(document.documentElement,'mouseup',this._onMouseUp.bind(this)),i.listen(document.documentElement,'mousemove',this._onMouseMove.bind(this))];this._dragStarted=true;}};p.prototype._saveOffset=function(){'use strict';var q=parseInt(k.get(this._picture,this._offsetType),10);if(this._RTLXSwitch){this._offsetInput.value=q+this._containerWidth-this._picture.offsetWidth;}else this._offsetInput.value=q;};p.prototype._stopDrag=function(){'use strict';if(this._dragStarted){this.inform('stopdrag',this);this._dragStarted=false;this._dragTokens.forEach(function(q){q.remove();});this._saveOffset();}};p.prototype._onMouseUp=function(event){'use strict';this._stopDrag();event.kill();};p.prototype._setOffset=function(q){'use strict';if(this._RTLXSwitch){q=Math.max(0,Math.min(q,-this._maxOffset));}else q=Math.min(0,Math.max(q,this._maxOffset));k.set(this._picture,this._offsetType,q+'px');};p.prototype._onMouseMove=function(event){'use strict';this._setOffset(this._pictureStartDragOffset+l.getEventPosition(event)[this._eventCoord]);event.kill();};f.exports=p;},null);
__d('TimelineCover',['Arbiter','Button','CSS','DOM','DOMScroll','Event','FileInputUploader','Focus','HTML','PageTransitions','Parent','Run','Style','TimelineDrag','$','cx','fbt','ge','setImmediate','tidyEvent'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa){if(c.__markCompiled)c.__markCompiled();function ba(ca,da,ea){'use strict';this.root=v('fbProfileCover');if(typeof da==='object'){this._coverHeight=da.cover_height;this._coverWidth=da.cover_width;this.previewing=da.previewing;this._isLegacy=false;}else{this._isLegacy=true;this._coverHeight=da;this.previewing=ea;}this._parentSection=r.byClass(this.root,'fbTimelineSection');this.cover=k.find(this.root,'.cover');ba.instance=this;this.editing=false;s.onBeforeUnload(this.onBeforeUnload.bind(this));if(!this._parentSection)this._parentSection=r.byClass(this.root,'fbEventHeader');if(this.previewing)z((function(){this.editMode();this.updateCoverImage(this.previewing);}).bind(this));}ba.prototype.showLoadingIndicator=function(){'use strict';var ca=y('fbCoverImageContainer');if(ca)j.addClass(ca,'opaquedLoading');};ba.prototype.hideLoadingIndicator=function(){'use strict';var ca=y('fbCoverImageContainer');if(ca)j.removeClass(ca,'opaquedLoading');};ba.prototype.onBeforeUnload=function(){'use strict';if(this.isInEditMode())return x._("If you leave this page, your cover photo will not be saved. To save, press the \"save\" button below your cover photo.");};ba.prototype.isCoverImageVerticalFlow=function(ca){'use strict';return !ca.style.height;};ba.prototype.editMode=function(){'use strict';var ca=k.find(this.root,'button.saveButton');i.setEnabled(k.find(this.root,'button.cancelButton'),true);i.setEnabled(ca,true);this.hideLoadingIndicator();this._coverImage=k.scry(this.root,'.coverImage')[0];var da=k.scry(this._coverImage,'.coverWrap')[0];if(da){var ea=k.find(da,'.coverPhotoImg');this._originalIsVertical=this.isCoverImageVerticalFlow(ea);this._originalOffset=t.get(ea,this._originalIsVertical?'top':'left');}j.addClass(this._parentSection,'fbEditCover');l.scrollTo(this.root);if(this.previewing){k.remove(this._coverImage);j.show(this._coverImage);}var fa=k.scry(this._coverImage,'.coverPhotoImg')[0];if(fa)this._createDragger();this.editing=true;o.set(ca);h.inform('CoverPhotoEdit',{sender:this,state:"open"});};ba.prototype._exitEditMode=function(){'use strict';if(this._timelineDrag){this._timelineDrag.destroy();this._timelineDrag=null;}k.find(this.root,'input.hiddenPhotoID').value=null;i.setEnabled(k.find(this.root,'button.cancelButton'),false);i.setEnabled(k.find(this.root,'button.saveButton'),false);j.removeClass(this._parentSection,'fbEditCover');this.hideLoadingIndicator();this.previewing=false;h.inform('CoverPhotoEdit',{sender:this,state:"closed"});this.editing=false;};ba.prototype._createDragger=function(ca){'use strict';var da;if(this._isLegacy){da=k.find(this.root,'input.photoOffsetInput');this._originalIsVertical=true;}else{var ea=ca===undefined?this._originalIsVertical:ca;da=ea?k.find(this.root,'input.photoOffsetYInput'):k.find(this.root,'input.photoOffsetXInput');}this._timelineDrag=new u(k.find(this.root,'.coverImage .coverPhotoImg'),da,{height:this._coverHeight,width:this._coverWidth,listenOn:this.cover,vertical:ea,killClicks:true});};ba.prototype.updateCoverImage=function(ca,da){'use strict';if(da)this.editMode();k.find(this.root,'input.hiddenPhotoID').value=ca;i.setEnabled(k.find(this.root,'button.saveButton'),true);if(da)k.replace(k.find(this.root,'.coverImage'),typeof da==='string'?p(da):da);var ea=k.find(k.find(this.root,'.coverImage'),'.coverPhotoImg'),fa=this.isCoverImageVerticalFlow(ea),ga;if(this._isLegacy){ga=k.find(this.root,'input.photoOffsetInput');}else ga=fa?k.find(this.root,'input.photoOffsetYInput'):k.find(this.root,'input.photoOffsetXInput');if(this._timelineDrag){this._timelineDrag.setPicture(ea,{offsetInput:ga,vertical:fa});}else this._createDragger(fa);this._updateHeader();};ba.prototype.cancelUpdate=function(){'use strict';this._reloadAfterNextUpdate=false;k.remove(k.scry(this.root,'.coverImage')[0]);k.prependContent(this.cover,this._coverImage);if(this._originalOffset!==undefined)t.set(k.find(this._coverImage,'.coverPhotoImg'),this._originalIsVertical?'top':'left',this._originalOffset);this._exitEditMode();this._updateHeader();};ba.staticSaveComplete=function(){'use strict';ba.getInstance().saveComplete();};ba.prototype.saveComplete=function(){'use strict';if(this._reloadAfterNextUpdate)b.location.reload();this._coverImage=k.scry(this.root,'.coverImage')[0];var ca=r.byClass(this.root,'fbTimelineTopSectionBase');ca&&j.removeClass(ca,"_6_5");this._exitEditMode();this._updateHeader();q.rewriteCurrentURI(q.getCurrentURI().getUnqualifiedURI(),q.getCurrentURI().removeQueryData('preview_cover'));};ba.prototype.isInEditMode=function(){'use strict';return this.editing;};ba.prototype._updateHeader=function(){'use strict';var ca=k.scry(this.root,'.coverImage')[0];if(!ca)return;var da=j.hasClass(ca,'coverNoImage'),ea=j.hasClass(this._parentSection,'noCoverImage');if(da!==ea)j.conditionClass(this._parentSection,'noCoverImage',da);};ba.getInstance=function(){'use strict';return ba.instance;};ba.staticUpdateCoverImage=function(ca){'use strict';ba.getInstance().updateCoverImage(null,ca);};ba.prototype.setupFileUpload=function(ca,da,ea){'use strict';ca.subscribe('change',(function(){var fa=new n(ca.getInput()).setURI(da).setAllowCrossOrigin(true);fa.subscribe('failure',function(){ba.showErrorDialog(x._("Cover Upload Failed"),x._("Uploading the new cover picture failed. Please try again."));});fa.subscribe(['success','failure'],(function(){this.hideLoadingIndicator();ca.clear();j.removeClass(ca.getControl(),ea);ca.getInput().disabled=false;}).bind(this));this.showLoadingIndicator();this._reloadAfterNextUpdate=true;fa.send();j.addClass(ca.getControl(),ea);ca.getInput().disabled=true;}).bind(this));};ba.setupFileUpload=function(ca,da,ea){'use strict';this.getInstance().setupFileUpload(ca,da,ea);};ba.imageUploadDone=function(ca,da){'use strict';this.getInstance().updateCoverImage(ca,da);};ba.showErrorDialog=function(ca,da){'use strict';new Dialog().setTitle(ca).setButtons(Dialog.OK).setBody(da).show();this.getInstance().hideLoadingIndicator();};ba.initFileUploadMenu=function(ca){'use strict';ba.showLoadingAfterFileUpload(ca.getForm());};ba.showLoadingAfterFileUpload=function(ca){'use strict';aa(ca.subscribe('submit',function(){ba.getInstance().showLoadingIndicator();}));};ba.instance=null;f.exports=ba;},null);
__d('legacy:TimelineCover',['TimelineCover'],function a(b,c,d,e){if(c.__markCompiled)c.__markCompiled();b.TimelineCover=c('TimelineCover');},3);