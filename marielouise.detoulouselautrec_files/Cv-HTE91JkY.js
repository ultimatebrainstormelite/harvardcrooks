/*!CK:3649646986!*//*1440023813,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["GlYeh"]); }

__d("ChatSidebarSections",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={MORE_ONLINE_FRIENDS:"more_online_friends",MORE_ONLINE_COWORKERS:"more_online_coworkers",OFFLINE_USERS:"offline_users",ORDERED_LIST:"ordered_list",ORDERED_COWORKERS:"ordered_coworkers",TYPEAHEAD:"typeahead",NOW_PINNED_LIST:"now_pinned_list"};},null,{});
__d("MessengerView",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={DETAIL:{COMPOSE:"detail\/compose",THREAD:"detail\/thread"},MASTER:{GROUPS:"master\/groups",PEOPLE:"master\/people",RECENT:"master\/recent"}};},null,{});
__d("P2PBannerType",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={SENDER_NUX:"SENDER_NUX",RECEIVER_NUX:"RECEIVER_NUX",SEVIPER:"SEVIPER"};},null,{});
__d("P2PPasswordProtectionParam",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={STATUS:"status"};},null,{});
__d("P2PPaymentCampaignNames",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={ZANGOOSE:"zangoose",SEVIPER:"seviper"};},null,{});
__d("P2PPaymentLoggerEvent",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={ACTN_ADD_CREDIT_CARD:"Actn_AddCreditCard",ACTN_UPDATE_CREDIT_CARD:"Actn_UpdateCreditCard",ACTN_REMOVE_CREDIT_CARD:"Actn_RemoveCreditCard",ACTN_UNLOCK_CREDIT_CARD:"Actn_UnlockCreditCard",ACTN_VALIDATE_CARD:"Actn_ValidateCard",ACTN_TRANSFER_MONEY:"Actn_TransferMoney",ACTN_TRANSFER_MONEY_WITH_CAMPAIGN:"Actn_TransferMoneyWithCampaign",ACTN_TRANSFER_MONEY_WITH_CAMPAIGN_PARENT_CALL:"Actn_TransferMoneyWithCampaignParentCall",ACTN_TRANSFER_MONEY_CHECK_NEEDS_REVERT:"Actn_TransferMoneyCheckNeedsRevert",ACTN_TRANSFER_MONEY_REVERT:"Actn_TransferMoneyRevert",ACTN_TRANSFER_MONEY_CREATE_CONTEXT:"Actn_TransferMoneyCreateContext",ACTN_TRANSFER_MONEY_CREATE_PLATFORM_ITEM:"Actn_TransferMoneyCreatePlatformItem",ACTN_ACCEPT_MONEY:"Actn_AcceptMoney",ACTN_DECLINE_MONEY:"Actn_DeclineMoney",ACTN_SET_PRIMARY:"Actn_SetPrimary",ACTN_WITHDRAW_MONEY:"Actn_WithdrawMoney",ACTN_GRAPH_API_GENERIC_WRITE:"Actn_GraphApiGenericWrite",ACTN_SEND_TRANSFER_MESSAGE:"Actn_SendTransferMessage",ACTN_SEND_TRANSFER_EMAIL:"Actn_SendTransferEmail",ACTN_SEND_EXPIRE_NOTIFICATIONS:"Actn_SendExpireNotifications",ACTN_SEND_TRANSFER_MESSAGE_QUEUED:"Actn_SendTransferMessageQueued",ACTN_UNCATEGORIZED_EXCEPTION:"Actn_Uncategorized_Exception",ACTN_INCREASE_CAMPAIGN_COUNTER:"Actn_Increase_Campaign_Counter",ACTN_CREATE_PAYMENT_REQUEST:"Actn_CreatePaymentRequest",ACTN_ACCEPT_PAYMENT_REQUEST:"Actn_AcceptPaymentRequest",ACTN_DECLINE_PAYMENT_REQUEST:"Actn_DeclinePaymentRequest",ACTN_AUTH_FOR_SENDER_REVIEW:"Actn_AuthForSenderReview",ACTN_COMPLETE_SENDER_REVIEW:"Actn_CompleteSenderReview",ACTN_COMPLETE_RECEIVER_REVIEW:"Actn_CompleteReceiverReview",ACTN_SUBMIT_VERIFICATION_STEP:"Actn_SubmitVerificationStep",ACTN_COMPLETE_SENDER_VERIFICATION:"Actn_CompleteSenderVerification",ACTN_COMPLETE_RECEIVER_VERIFICATION:"Actn_CancelReceiverVerification",ACTN_CANCEL_SENDER_VERIFICATION:"Actn_CancelSenderVerification",ACTN_CANCEL_RECEIVER_VERIFICATION:"Actn_CancelReceiverVerification",ACTN_CANCEL_SENDER_RISK:"Actn_CancelSenderRisk",ACTN_CANCEL_EXPIRE:"Actn_CancelExpire",ACTN_CANCEL_FOR_SAME_CARD:"Actn_CancelForSameCard",ACTN_CANCEL_BY_CUSTOMER_SERVICE:"Actn_CancelByCustomerService",ACTN_CANCEL_RECEIVER_REVIEW:"Actn_CancelReceiverReview",ACTN_CANCEL_SENDER_REVIEW:"Actn_CancelSenderReview",ACTN_CANCEL_ALL_PENDING_TRANSFERS:"Actn_CancelAllPendingTransfers",ACTN_ADD_PIN:"Actn_AddPIN",ACTN_UPDATE_PIN:"Actn_UpdatePIN",ACTN_REMOVE_PIN:"Actn_RemovePIN",ACTN_RESET_PIN:"Actn_ResetPIN",ACTN_ENABLE_TOUCH_ID:"Actn_EnableTouchID",ACTN_VERIFY_TOUCH_ID:"Actn_VerifyTouchID",ACTN_DISABLE_TOUCH_ID:"Actn_DisableTouchID",ACTN_CHANNEL_NOTIF_CARD_EVENT:"Actn_ChannelNotifCardEvent",ACTN_CHANNEL_NOTIF_TRANSFER_STATUS_EVENT:"Actn_ChannelNotifTransferStatusEvent",ACTN_PLATFORM_BANNER_DISMISSED:"Actn_PlatformBannerDismissed",ACTN_PLATFORM_BANNER_MARK_AS_SOLD:"Actn_PlatformBannerMarkAsSold",UI_ACTN_INITIATE_SEND:"UI_Actn_Initiate_Send",UI_ACTN_CANCEL_SEND:"UI_Actn_Send_Money_Cancelled",UI_ACTN_INITIATE_ADD_CARD:"UI_Actn_Initiate_Add_Card",UI_ACTN_INITIATE_CHOOSE_CARD:"UI_Actn_Initiate_Choose_Card",UI_ACTN_CANCEL_ADD_CARD:"UI_Actn_Cancel_Add_Card",UI_ACTN_CONFIRM_CARD_DETAILS:"UI_Actn_Confirm_Card_Details",UI_ACTN_ACCEPT_MONEY_CANCEL:"UI_Actn_Accept_Money_Cancel",UI_ACTN_ACCEPT_WITH_CARD:"UI_Actn_Accept_With_Card",UI_ACTN_ADD_CARD_SUCCESS:"UI_Actn_Add_Card_Success",UI_ACTN_ADD_CARD_FAIL:"UI_Actn_Add_Card_Fail",UI_ACTN_CONFIRM_SEND:"UI_Actn_Confirm_Send",UI_ACTN_SEND_SUCCESS:"UI_Actn_Send_Success",UI_ACTN_SEND_MONEY_CANCELLED:"UI_Actn_Send_Money_Cancelled",UI_ACTN_SEND_FAIL:"UI_Actn_Send_Fail",UI_ACTN_INITIATE_EDIT_CARD:"UI_Actn_Initiate_Edit_Card",UI_ACTN_CANCEL_EDIT_CARD:"UI_Actn_Cancel_Edit_Card",UI_ACTN_CONFIRM_EDIT_CARD_DETAILS:"UI_Actn_Confirm_Edit_Card_Details",UI_ACTN_EDIT_CARD_SUCCESS:"UI_Actn_Edit_Card_Success",UI_ACTN_EDIT_CARD_FAIL:"UI_Actn_Edit_Card_Fail",UI_ACTN_INITIATE_REMOVE_CARD:"UI_Actn_Initiate_Remove_Card",UI_ACTN_CONFIRM_REMOVE_CARD:"UI_Actn_Confirm_Remove_Card",UI_ACTN_REMOVE_CARD_SUCCESS:"UI_Actn_Remove_Card_Success",UI_ACTN_REMOVE_CARD_FAIL:"UI_Actn_Remove_Card_Fail",UI_ACTN_INITIATE_PASSWORD_PROTECTION_NUX:"UI_Actn_Initiate_Password_Protection_NUX",UI_ACTN_OPT_IN_PASSWORD_PROTECTION_NUX:"UI_Actn_Opt_In_Password_Protection_NUX",UI_ACTN_OPT_OUT_PASSWORD_PROTECTION_NUX:"UI_Actn_Opt_Out_Password_Protection_NUX",UI_ACTN_ENABLED_PASSWORD_PROTECTION_SETTING:"UI_Actn_Enabled_Password_Protection_Setting",UI_ACTN_DISABLED_PASSWORD_PROTECTION_SETTING:"UI_Actn_Disabled_Password_Protection_Setting",UI_ACTN_SEND_CLICKED:"UI_Actn_Send_Clicked",UI_ACTN_VERIFY_CSC:"UI_Actn_Verify_CSC",UI_ACTN_CONFIRM_AMOUNT:"UI_Actn_Confirm_Amount",UI_ACTN_EDIT_CARD:"UI_Actn_Edit_Card",UI_ACTN_CHANGE_CARD:"UI_Actn_Change_Card",UI_ACTN_INITIATE_SEND_TRIGGER:"UI_Actn_Initiate_Send_Trigger",UI_ACTN_INITIATE_GROUP_SEND:"UI_Actn_Initiate_Group_Send",UI_ACTN_GROUP_SEND_CANCELLED:"UI_Actn_Group_Send_Cancelled",UI_ACTN_INITIATE_GROUP_SEND_TRIGGER:"UI_Actn_Initiate_Group_Send_Trigger",UI_ACTN_GROUP_SEND_RECIPIENT_PICKED:"UI_Actn_Group_Send_Recipient_Picked",UI_ACTN_3RD_PARTY_RECEIPT_SHOWN:"UI_Actn_3rd_Party_Receipt_Shown",UI_ACTN_3RD_PARTY_RECEIPT_DISMISSED:"UI_Actn_3rd_Party_Receipt_Dismissed",UI_ACTN_3RD_PARTY_NON_ENABLED_LOG_MESSAGE_CLICKED:"UI_Actn_3rd_Party_Non_Enabled_Log_Message_Clicked",UI_ACTN_3RD_PARTY_NON_ENABLED_LOG_MESSAGE_CANCELLED:"UI_Actn_3rd_Party_Non_Enabled_Log_Message_Cancelled",UI_ACTN_CHAT_THREAD_BANNER_CLICKED:"UI_Actn_Chat_Thread_Banner_Clicked",UI_ACTN_CHAT_THREAD_BANNER_VIEWED:"UI_Actn_Chat_Thread_Banner_Viewed",UI_ACTN_CHAT_THREAD_BANNER_DISMISSED:"UI_Actn_Chat_Thread_Banner_Dismissed",UI_ACTN_INITIATE_MONEYPENNY_ORDER:"UI_Actn_Initiate_Moneypenny_Order",UI_ACTN_CONFIRM_MONEYPENNY_ORDER:"UI_Actn_Confirm_Moneypenny_Order",UI_ACTN_MONEYPENNY_ORDER_FAIL:"UI_Actn_Moneypenny_Order_Fail",UI_ACTN_MONEYPENNY_ORDER_SUCCESS:"UI_Actn_Moneypenny_Order_Success",UI_ACTN_MONEYPENNY_ORDER_CANCEL:"UI_Actn_Moneypenny_Order_Cancel",UI_ACTN_FRIEND_PICKER_SEARCH:"UI_Actn_Friend_Picker_Search",UI_ACTN_FRIEND_PICKER_SELECT:"UI_Actn_Friend_Picker_Select",UI_ACTN_FI_CANCEL:"UI_Actn_FI_Cancel",UI_ACTN_FI_SUCCESS_DIALOG_NEXT:"UI_Action_Success_Dialog_Next",UI_ACTN_FI_BANNER_DISMISSED:"UI_Actn_FI_Banner_Dismissed",UI_ACTN_FI_BANNER_IMPRESSION:"UI_Actn_FI_Banner_Impression",UI_ACTN_INCENTIVE_TRANSFER_SUCCESS:"UI_Actn_Incentive_Transfer_Success",UI_ACTN_INCENTIVE_TRANSFER_FAILURE:"UI_Actn_Incentive_Transfer_Failure",UI_ACTN_PLATFORM_BANNER_DISMISSED:"UI_Actn_Platform_Banner_Dismissed",UI_ACTN_PLATFORM_BANNER_MARK_AS_SOLD:"UI_Actn_Platform_Banner_Mark_As_Sold"};},null,{});
__d("P2PPaymentLoggerEventFlow",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={UI_FLOW_P2P_SEND:"UI_Flow_P2P_Send",UI_FLOW_P2P_RECEIVE:"UI_Flow_P2P_Receive",UI_FLOW_P2P_SETTINGS:"UI_Flow_P2P_Settings",UI_FLOW_P2P_GROUP_SEND:"UI_Flow_P2P_Group_Send",UI_FLOW_RECEIVER_NUX_CHAT_THREAD_BANNER:"UI_Flow_Receiver_NUX_Chat_Thread_Banner",UI_FLOW_SENDER_NUX_CHAT_THREAD_BANNER:"UI_Flow_Sender_NUX_Chat_Thread_Banner",UI_FLOW_MONEYPENNY_CHECKOUT:"UI_Flow_Moneypenny_Checkout",UI_FLOW_FINANCIAL_INCENTIVES:"UI_Flow_Financial_Incentives",UI_FLOW_FINANCIAL_INCENTIVES_ZERO_INDEX_JEWEL:"UI_Flow_Financial_Incentives_Zero_Index_Jewel"};},null,{});
__d("P2PTransferParam",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={TRANSFER_ID:"transfer_id",STATUS:"status",SENDER_STATUS:"sender_status",RECEIVER_STATUS:"receiver_status",RISK_RESULT:"risk_result"};},null,{});
__d('AppsDivebarDisplayController',['AppsDivebarConfigData','AsyncRequest','Arbiter','CSS','UIPagelet','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n='173',o={isVisible:function(){if(typeof this._visible!='undefined')return this._visible;this._visible=!h.hidden;return this._visible;},showApps:function(){this._visible=true;var p={fb_source_category:'sidebar'};l.loadFromEndpoint('GamesDivebarPagelet','pagelet_canvas_nav_content',p);k.show('apps_gripper');k.show('pagelet_canvas_nav_content');k.addClass('pagelet_canvas_nav_content',"_4woj");j.inform('AppsDivebar/show-apps');new i('/ajax/feed/apps/resize').setData({height:''+n,menu:true}).setMethod('POST').send();},hideApps:function(){this._visible=false;k.hide('pagelet_canvas_nav_content');k.hide('apps_gripper');j.inform('AppsDivebar/hide-apps');new i('/ajax/feed/apps/resize').setData({height:'1',menu:true}).setMethod('POST').send();}};f.exports=o;},null);
__d('AsyncLoader',['AsyncRequest','BaseAsyncLoader'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();function j(k,l){this._endpoint=k;this._type=l;}Object.assign(j.prototype,i.prototype);j.prototype.send=function(k,l,m,n,o){new h(k).setData({ids:l}).setHandler(n).setErrorHandler(o).setAllowCrossPageTransition(true).setMethod('GET').setReadOnly(true).send();};f.exports=j;},null);
__d('BuddyListNub',['Arbiter','AvailableList','BootloadedComponent.react','ChannelConnection','ChannelConstants','ChatConfig','ChatSidebarActions','ChatSidebarStore','ChatSidebarVisibility','ChatVisibility','CSS','Dock','DOM','Event','JSLogger','JSResource','KeyEventController','Keys','NubController','OrderedFriendsList','Parent','PresencePrivacy','PresenceStatus','React','Run','SidebarType','Style','Toggler','csx','cx','setTimeoutAcrossTransitions','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma){if(c.__markCompiled)c.__markCompiled();var na,oa,pa=m.get('divebar_new_design',false)&&m.get('divebar_persistent',false),qa=pa?40:32,ra=253,sa=v.create('buddylist_nub');na=z;oa=na&&na.prototype;Object.assign(ta,na);ta.prototype=Object.create(na.prototype);ta.prototype.constructor=ta;ta.__superConstructor__=na;function ta(ua,va,wa,xa){'use strict';oa.constructor.call(this);oa.init.call(this,ua);this.root=ua;this.orderedList=va;this.typeahead=wa;this.button=t.find(ua,'a.fbNubButton');this.unreadCount=t.find(ua,"span._5ayx");this.label=t.find(ua,'span.label');this.body=t.scry(ua,'div.fbNubFlyoutBody')[0];this.container=ba.byClass(ua,"_56ox");this.typeaheadContainer=t.find(ua,'.fbChatTypeaheadViewContainer');var ya=t.find(ua,'div.fbNubFlyoutTitlebar');ia.createInstance(ya).setSticky(false);if(pa)ia.createInstance(ua).setSticky(true);if(xa)fa.onAfterLoad((function(){this.dropdown=ea.render(ea.createElement(j,{bootloadPlaceholder:ea.createElement('span',null),bootloadLoader:w('ChatSidebarDropdown.react'),onToggleSidebar:function(){},sidebarType:ga.BUDDYLIST}),xa);}).bind(this));va.subscribe('render',this.flyoutContentChanged.bind(this));va.setScrollContainer(this.body);i.subscribe('buddylist/availability-changed',this._updateCount.bind(this));h.subscribe('chat/connect',this._handleConnect.bind(this));h.subscribe('chat/option-changed',(function(za,ab){if(ab.name=='hide_groups')this.onResize();}).bind(this));ca.subscribe('privacy-user-presence-changed',this._handleVisibilityChange.bind(this));this.message=t.find(ua,"div._4mq1");this.warningMsgText=null;this.warningMsgEventListener=null;this.showWarningTimeout=null;k.subscribe(k.CONNECTED,this._handleChannelConnected.bind(this));k.subscribe(k.SHUTDOWN,this._handleChannelShutdown.bind(this));k.subscribe(k.RECONNECTING,this._handleChannelReconnecting.bind(this));k.subscribe([k.MUTE_WARNING,k.UNMUTE_WARNING],this._updateView.bind(this));this.subscribe('show',this.onShow.bind(this));this.subscribe('hide',this.onHide.bind(this));this.subscribe('resize',this.onResize.bind(this));u.listen(ua,'keydown',this._onKeyDown.bind(this));u.listen(this.button,'click',this.onButtonClick.bind(this));x.registerKey('q',(function(event){if(this._isOpen){wa.getCore().getElement().focus();}else{this.onButtonClick();this.show();}event.prevent();}).bind(this));wa.getCore().subscribe('escape',this.hide.bind(this));wa.subscribe(['respond','reset'],(function(za,ab){if(this._isOpen){if(ab&&ab.value&&ab.value===wa.getCore().getValue()&&wa.getView().isVisible()){s.setUseMaxHeight(this.root,false);this._hideBuddyList();}else this._showBuddyList();this.flyoutContentChanged();}}).bind(this));h.subscribe('sidebar/show',this.hide.bind(this));h.subscribe('minisidebar/show',this.hide.bind(this));h.subscribe('sidebar/hide',this._onSidebarHide.bind(this));this._orderedListCount=aa.getList().length;if(pa){wa.getCore().subscribe('focus',function(){r.addClass(ya,"_3f5-");});wa.getCore().subscribe('blur',function(){r.removeClass(ya,"_3f5-");});ha.set(this.body,'max-height','285px');this.show();}this._handleVisibilityChange();sa.log('buddylist_initialized');}ta.prototype._handleConnect=function(ua){'use strict';this._updateView(true);};ta.prototype._getShutdownReason=function(ua){'use strict';switch(ua){case l.HINT_AUTH:return ma._("Your session has timed out. Please log in.");case l.HINT_CONN:return ma._("Facebook {Chat} is currently unavailable.",[ma.param('Chat',ma._("Chat"))]);case l.HINT_MAINT:return ma._("Facebook {Chat} is currently down for maintenance.",[ma.param('Chat',ma._("Chat"))]);default:return ma._("Facebook {Chat} is currently unavailable.",[ma.param('Chat',ma._("Chat"))]);}};ta.prototype._getReconnectMsg=function(ua){'use strict';var va;if(ua===null||false===navigator.onLine){va=ma._("Unable to connect to chat. Check your Internet connection.");}else if(ua>l.WARNING_COUNTDOWN_THRESHOLD_MSEC){var wa=t.create('a',{href:'#',className:'fbChatReconnectLink'},ma._("Try again")),xa=t.create('div',null,wa);va=t.create('div',{},ma._("Unable to connect to chat."));t.appendContent(va,xa);}else if(ua>1000){va=ma._("Unable to connect to chat. Reconnecting in {seconds}...",[ma.param('seconds',Math.floor(ua/1000))]);}else va=ma._("Unable to connect to chat. Reconnecting...");return va;};ta.prototype._resetShowWarningTimeout=function(){'use strict';if(this.showWarningTimeout){clearTimeout(this.showWarningTimeout);this.showWarningTimeout=null;}};ta.prototype._handleChannelConnected=function(ua){'use strict';this._resetShowWarningTimeout();if(this.orderedList.isVisible())q.goOnline();this.warningMsgText=null;this._updateView();};ta.prototype._handleChannelShutdown=function(ua,va){'use strict';this._resetShowWarningTimeout();this.warningMsgText=this._getShutdownReason(va);this._updateView();};ta.prototype._handleChannelReconnecting=function(ua,va){'use strict';this._resetShowWarningTimeout();this.warningMsgText=this._getReconnectMsg(va);if(va>1000){if(va>l.WARNING_COUNTDOWN_THRESHOLD_MSEC){if(this.warningMsgEventListener){this.warningMsgEventListener.remove();this.warningMsgEventListener=null;}this.warningMsgEventListener=u.listen(this.message,'click',(function(event){if(r.hasClass(event.getTarget(),'fbChatReconnectLink')){this._tryReconnect();event.kill();}}).bind(this));}this.showWarningTimeout=la(this._handleChannelReconnecting.bind(this,ua,va-1000),1000);}this._updateView();};ta.prototype._tryReconnect=function(){'use strict';if(k.disconnected())k.reconnect();};ta.prototype._handleVisibilityChange=function(){'use strict';this._updateView();if(!q.isOnline())this.hide();};ta.prototype._updateView=function(ua){'use strict';var va=this.container;if(va){r.conditionClass(va,'offline',!q.isOnline());r.conditionClass(va,'error',k.disconnected());}if(k.disconnected())t.setContent(this.message,this.warningMsgText);var wa,xa;if(!q.isOnline()){wa=ma._("{Chat} (Off)",[ma.param('Chat',ma._("Chat"))]);}else if(k.disconnected()){wa=ma._("{Chat} (Disconnected)",[ma.param('Chat',ma._("Chat"))]);}else{var ya=da.getOnlineCount();if(ya){var za=t.create('span',{className:'count'},'('+ya+')');wa=ma._({"*":"{Chat} {number-available}"},[ma.param('Chat',ma._("Chat")),ma.param('number-available',za,[0,ya])]);}else{wa=ma._("Chat");xa=true;}}this._setUnread();this._setLabel(wa,xa);this.buttonContentChanged();};ta.prototype.onButtonClick=function(){'use strict';if(r.shown(this.typeahead.getElement())){var ua=this.subscribe('show',(function(){this.typeahead.getCore().getElement().focus();}).bind(this));setTimeout(this.unsubscribe.bind(this,ua),0);}if(!o.isLoaded()||!o.isInitialized())return true;var va=o.isEnabled(),wa=p.isViewportCapable()&&!p.hasLowFriendCount(),xa=p.isViewportCapableForMiniSidebar()&&!p.hasLowFriendCount();if(!va&&(wa||xa)){n.enable();}else n.show();return !wa&&!xa;};ta.prototype.onHide=function(){'use strict';this._isOpen=false;if(this._buddyListRenderSubscription){this.orderedList.unsubscribe(this._buddyListRenderSubscription);this._buddyListRenderSubscription=null;}this._hideBuddyList();this.typeahead.getCore().reset();h.inform('buddylist/hide');};ta.prototype._onKeyDown=function(event){'use strict';var ua=u.getKeyCode(event);if(ua===y.ESC&&!r.hasClass(this.root,'menuOpened')){this.hide();return false;}else if(ua==y.RETURN)n.enable();};ta.prototype._onSidebarHide=function(event){'use strict';if(pa){this.show();}else this.button.focus();};ta.prototype.onResize=function(){'use strict';var ua=pa?ra:s.getMaxFlyoutHeight(this.root)-60,va=Math.max(250,ua);this.orderedList.setNumTopFriends(Math.floor(va/qa));};ta.prototype._showBuddyList=function(){'use strict';if(!this._buddyListRenderSubscription)this._buddyListRenderSubscription=this.orderedList.subscribe('render',s.setUseMaxHeight.bind(s,this.root,false));r.hide(this.typeaheadContainer);this.orderedList.show();sa.bump('buddylist_show');};ta.prototype._hideBuddyList=function(){'use strict';r.show(this.typeaheadContainer);this.orderedList.hide();sa.bump('buddylist_hide');};ta.prototype.onShow=function(){'use strict';this._isOpen=true;if(k.disconnected()){this._tryReconnect();this._showBuddyList();}else q.goOnline(this._showBuddyList.bind(this));};ta.prototype._setLabel=function(ua,va){'use strict';var wa=this.label.textContent||this.label.innerText;if(wa!==ua){var xa=this.label.cloneNode(true);t.setContent(xa,ua);t.replace(this.label,xa);this.label=xa;}this.throbber&&r.conditionShow(this.throbber,!!va);};ta.prototype._setUnread=function(ua){'use strict';r.conditionShow(this.unreadCount,!!ua);};ta.prototype._updateCount=function(){'use strict';this._updateView();};f.exports=ta;},null);
__d('ChatHovercard',['Arbiter','AsyncLoader','Bootloader','JSLogger','debounce'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m=5,n=new i('/ajax/chat/hovercard/sidebar.php','hover'),o=k.create('chat_hovercard');h.subscribe('Hovercard/dirty',n.reset.bind(n));function p(t,u){n.get(t,function(v){setTimeout(function(){if(!v){o.error('fetch_failure',{id:t});return;}j.loadModules(["Hovercard"],function(w){var x=w.getDialog(v);if(!x){o.error('no_hovercard',{id:t,endpoint:v});return;}if(t==u.getActiveID())u.showHovercard(t,x);});},0);});}function q(t,u){var v=[];function w(z){if(z>=0&&z<t.length)v.push(t[z]);}var x=t.indexOf(u);if(x>-1){w(x);for(var y=1;y<m;y++){w(x+y);w(x-y);}}return v.filter(function(z){return z;});}function r(t,u){var v=u.getActiveID();if(v){var w=t.getShowingUsers(),x=q(w,v);n.get(x,function(){});}}function s(t){var u=t.getHoverController();u.registerDefault(p);u.subscribe('hover',l(r.bind(null,t,u),100));}f.exports=s;},null);
__d('ChatOrderedListHover',['ArbiterMixin','CSS','ErrorUtils','Event','LayerHideOnBlur','Parent','cx','mixin','setTimeoutAcrossTransitions','shield'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();var r,s;function t(w){i.addClass(w,'fetching');}function u(w){i.removeClass(w,'fetching');}r=o(h);s=r&&r.prototype;Object.assign(v,r);v.prototype=Object.create(r.prototype);v.prototype.constructor=v;v.__superConstructor__=r;function v(w){'use strict';s.constructor.call(this);this._orderedList=w;this._root=w.getRoot();k.listen(this._root,'mouseover',this._mouseOver.bind(this));k.listen(this._root,'mouseleave',this._mouseLeave.bind(this));w.subscribe('click',q(this._hide,this));}v.prototype._mouseOver=function(event){'use strict';if(this._paused)return;var w=event.getTarget(),x=m.byClass(w,"_42fz")||m.byClass(w,"_5a58");x&&this._setActiveItem(x);};v.prototype._mouseLeave=function(event){'use strict';this._setActiveItem(null);};v.prototype._clearTimeouts=function(){'use strict';this._showTimeout&&clearTimeout(this._showTimeout);this._showTimeout=null;this._hideTimeout&&clearTimeout(this._hideTimeout);this._hideTimeout=null;};v.prototype._hide=function(){'use strict';if(this._showingDialog){this._showingDialog.hide();this._showingDialog=null;this._showingID=null;}};v.prototype._show=function(){'use strict';var w=this.getActiveID(),x=false;if(this._defaultHandler){x=true;j.applyWithGuard(this._defaultHandler,{},[w,this]);}if(x&&this._showingID!=this.getActiveID())t(this._activeItem);};v.prototype._setActiveItem=function(w){'use strict';if(w!=this._activeItem){this._clearTimeouts();this._activeItem&&u(this._activeItem);this._activeItem=null;var x=w?0:100;this._hideTimeout=p((function(){if(this.getActiveID()!=this._showingID)this._hide();}).bind(this),x);if(w){this._activeItem=w;var y=x+500;this._showTimeout=p((function(){this._show();}).bind(this),y);this.inform('hover');}else this.inform('leave');}};v.prototype.registerDefault=function(w){'use strict';this._defaultHandler=w;};v.prototype.getActiveID=function(){'use strict';var w=this._activeItem&&this._orderedList.getUserForNode(this._activeItem);return w||null;};v.prototype.showHovercard=function(w,x){'use strict';if(w==this.getActiveID()&&w!=this._showingID){this._clearTimeouts();u(this._activeItem);this._hide();this._showingDialog=x;this._showingID=w;var y=x.subscribe('mouseenter',this._setActiveItem.bind(this,this._activeItem)),z=x.subscribe('mouseleave',(function(){y.unsubscribe();this._setActiveItem(null);}).bind(this)),aa=x.subscribe('hide',(function(){this.inform('hovercard_hide');y.unsubscribe();z.unsubscribe();aa.unsubscribe();}).bind(this));x.enableBehavior(l).setContext(this._activeItem).setPosition('left').show();this.inform('hovercard_show');}};Object.assign(v.prototype,{_root:null,_activeItem:null,_hideTimeout:null,_showTimeout:null,_showingDialog:null,_showingID:null,_defaultHandler:null});f.exports=v;},null);
__d('ChatSidebarConstants',['ChatConfig'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=h.get('divebar_new_design',false),j={LITESTAND_CLASSIC_SIZE:32,IMAGE_SIZE:i?32:28};Object.assign(j,{getImageSize:function(k){if(k===false)return j.IMAGE_SIZE;return j.LITESTAND_CLASSIC_SIZE;},getItemHeight:function(k){if(i)return j.IMAGE_SIZE+8;if(k===false)return j.IMAGE_SIZE+4;return j.LITESTAND_CLASSIC_SIZE+4;}});f.exports=j;},null);
__d('ChatSidebarItem.react',['AvailableListConstants','XUIBadge.react','ChatConfig','ChatSidebarConstants','Image.react','Link.react','ReactComponentWithPureRenderMixin','React','SplitImage.react','TextWithEmoticons.react','Timestamp.react','cx','ix'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){if(c.__markCompiled)c.__markCompiled();var u=o.PropTypes,v=j.get('divebar_new_design',false),w=j.get('divebar_rounded_profile',false),x=9,y=o.createClass({displayName:'ChatSidebarItem',mixins:[n],propTypes:{image:u.string,images:u.array,birthday:u.bool,context:u.string,detailedStatus:u.string,href:u.string,imageSize:u.number,name:u.string,onClick:u.func,status:u.number,statusTime:u.string,unreadCount:u.number,nowData:u.object},render:function(){var z="_55ln"+(this.props.context?' '+"_55lo":'')+(this.props.unreadCount?' '+"_5bom":'')+(v?' '+"_55za":'')+(w?' '+"_qhr":''),aa="_55lr"+(this.props.nowData&&this.props.nowData.location?' '+"_3zz8":'');return (o.createElement(m,{className:z,href:{url:this.props.href},onClick:this.props.onClick,rel:'ignore'},o.createElement('div',{className:"_55lp"},o.createElement('div',{className:"_56p9"},o.createElement(p,{size:this.props.imageSize||k.IMAGE_SIZE,srcs:this.props.image||this.props.images}),o.createElement('div',{className:"_568w"})),o.createElement('div',{className:"_5bon"},this.renderBirthday(),this.renderUnreadCount(),this.renderStatus()),o.createElement('div',{className:aa},o.createElement(q,{renderEmoticons:true,renderEmoji:true,text:this.props.name}),this.renderLocation()),o.createElement('div',{className:"_55ls"},this.props.context))));},renderUnreadCount:function(){var z=this.props.unreadCount;if(!z)return null;return (o.createElement(i,{count:z,maxcount:x,type:'regular'}));},renderLocation:function(){if(j.get('badger_www_nub')&&this.props.nowData&&this.props.nowData.location)return (o.createElement('span',{className:"_3zz9"},this.props.nowData.location));return null;},renderStatus:function(){if(j.get('badger_www_nub')&&this.props.nowData&&this.props.nowData.icon&&this.props.nowData.background_color){var z=this.props.nowData,aa={backgroundColor:'#'+z.background_color},ba=z.icon.filepath?'/'+z.icon.filepath:z.icon.uri,ca=o.createElement(l,{className:"_568_ _5jvt",src:ba,style:aa}),da=o.createElement(r,{className:"_568-",minimize:true,time:this.props.nowData.timestamp});return (o.createElement('div',{className:"_568z"},da,ca));}var ea=this.getStatusSrc();if(!ea&&!this.props.statusTime)return null;var fa=ea?o.createElement(l,{className:"_568_",src:ea}):null,ga=true,ha=this.props.unreadCount||0;if(j.get('remove_lat')){fa=this.props.statusTime?null:fa;ga=false;}else if(ha>0){fa=this.props.statusTime?null:fa;ga=false;}return (o.createElement('div',{className:"_568z"},ga?this.renderLastActiveTime():null,this.renderDetailedPresence(),fa));},renderLastActiveTime:function(){return (o.createElement('div',{className:"_568-"},this.props.statusTime));},renderDetailedPresence:function(){if(j.get('remove_surface')){return null;}else{var z=this.props.unreadCount||0;if(z>0)return null;}return (o.createElement('div',{className:"_5t35"},this.props.detailedStatus));},renderBirthday:function(){if(!this.props.birthday)return null;var z=t('/images/gifts/icons/cake_icon.png');return (o.createElement(l,{className:"_5dv3",src:z}));},getStatusSrc:function(){switch(this.props.status){case h.ACTIVE:return v?t('/images/chat/sidebar/buddylist_nub/greenDot.png'):t('/images/litestand_classic/sidebar/online.png');case h.MOBILE:return v?t('/images/chat/sidebar/buddylist_nub/phone.png'):t('/images/litestand_classic/sidebar/pushable.png');}return null;}});f.exports=y;},null);
__d('ChatSidebarThread.react',['ChatSidebarItem.react','ChatOpenTab','WebMessengerPermalinkConstants','React','MercuryThreadMetadataRawRenderer','Tooltip.react','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();var o=k.PropTypes,p=k.createClass({displayName:'ChatSidebarThread',getInitialState:function(){return {maxNumParticipantsToRender:10};},propTypes:{image:o.string,imageSize:o.number,name:o.string,participants:o.array,numOtherParticipants:o.number,referrer:o.string,status:o.number,threadFBID:o.string,unreadCount:o.number},_renderParticipants:function(){var s=[],t=this.props.participants.length,u=this.props.numOtherParticipants,v=Math.min(this.state.maxNumParticipantsToRender,t);if(u-v==1)v--;for(var w=0;w<v;w++){var x=this.props.participants[w];s.push(k.createElement('li',{key:x.id},x.name));}if(v<u)s.push(k.createElement('li',{key:'more-participants'},n._("and {num} more...",[n.param('num',u-v)])));return (k.createElement('ul',null,s));},render:function(){var s=this.props.name,t=q(this.props.threadFBID,this.props.participants,this.props.numOtherParticipants),u=s?t:undefined,v=j.getURIPathForThreadID(this.props.threadFBID),w=r(this.props.image,this.props.participants),x=s?s:t;return (k.createElement(m,{display:'block',position:'above',tooltip:this._renderParticipants()},k.createElement(h,{context:u,href:v,imageSize:this.props.imageSize,image:this.props.image,images:w,name:x,onClick:this._openTab,referrer:this.props.referrer,status:this.props.status,unreadCount:this.props.unreadCount})));},_openTab:function(s){s.preventDefault();i.openThread(this.props.threadFBID,this.props.referrer);}});function q(s,t,u){return l.renderRawParticipantList(s,t,u,{names_renderer:l.renderShortNames});}function r(s,t){if(s)return null;return t.map(function(u){return u.image_src;});}f.exports=p;},null);
__d('ChatSidebarGroupThreadsGroup.react',['ChannelConnection','ChatSidebarThread.react','ChatSidebarSections','ChatSidebarConstants','PresencePrivacy','PresenceStatus','React','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p=n.PropTypes,q=n.createClass({displayName:'ChatSidebarGroupThreadsGroup',propTypes:{groups:p.array.isRequired},render:function(){return (n.createElement('ul',null,this.props.groups.map(this._renderGroup)));},_renderGroup:function(r){var s=r.mercury_thread.participants,t=h.disconnected()||l.isUserOffline();return (n.createElement('li',{className:"_42fz"+(t?' '+"_570-":''),'data-id':r.uid,key:r.uid},n.createElement(i,{image:r.mercury_thread.image_src,imageSize:k.getImageSize(),name:r.mercury_thread.name,participants:r.participants_to_render,numOtherParticipants:s.length-1,referrer:j.ORDERED_LIST,status:m.getGroup(s),threadFBID:r.uid})));}});f.exports=q;},null);
__d('ChatSidebarLog',['AsyncSignal','Banzai','BanzaiLogger','Bootloader','ChatPerfEvent','csx','DOM','ErrorUtils','ModuleDependencies','JSLogger','Run','performanceAbsoluteNow'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){if(c.__markCompiled)c.__markCompiled();var t=Object.assign||function(ia){for(var ja=1;ja<arguments.length;ja++){var ka=arguments[ja];for(var la in ka)if(Object.prototype.hasOwnProperty.call(ka,la))ia[la]=ka[la];}return ia;},u=q.create('chat_sidebar_load'),v=null,w=null,x=false,y=(Math.random()*2147483648|0).toString(36),z=Date.now(),aa=null,ba=false;r.onLoad(function(){x=true;});try{e(['ChatSidebarStore','ChatSidebarVisibility'],function(ia,ja){v=ia;w=ja;});}catch(ca){u.warn('exception',{reason:ca.toString()});}function da(ia,ja){if(ia&&ia.length>ja)return ia[ja];return null;}function ea(ia){if(ia.name=='SyntaxError'||/syntaxerror/i.test(ia.message))ba=true;}function fa(){if(!aa)aa=j.create(t({retry:true},i.VITAL));return aa;}function ga(ia,ja){setTimeout(function(){var ka=p.getMissing('ChatSidebar'),la=k.getErrorUrls(),ma=k.getLoadingUrls(),na=[];for(var oa in ma)na.push({url:oa,time:ma[oa]});na.sort(function(va,wa){return wa.time-va.time;});var pa={};for(var qa=0,ra=na.length;qa<ra;qa++)pa[na.url]=na.time;var sa={start_gap:z-k.getStartTime(),page_loaded:x,page_id:y,timeout:ia,missing_total:ka?ka.length:null,module_1:da(ka,0),module_2:da(ka,1),module_3:da(ka,2),error_url_total:la.length,error_url_1:da(la,0),error_url_2:da(la,1),error_url_3:da(la,2),loading_url_total:na.length,loading_url_1:da(na,0)?da(na,0).url:null,loading_time_1:da(na,0)?da(na,0).time:null,loading_url_2:da(na,1)?da(na,1).url:null,loading_time_2:da(na,1)?da(na,1).time:null,loading_url_3:da(na,2)?da(na,2).url:null,loading_time_3:da(na,2)?da(na,2).time:null},ta=null;if(!v){u.warn('require_'+ia,{missing:ka});ta='require';}if(v&&!v.isInitialized()){u.warn('init_'+ia,{missing:ka});ta='init';}if(v&&v.isInitialized()&&v.isEnabled()&&w&&w.shouldShowSidebar()){var ua=n.scry(ja,"._42fz");if(!ua||ua.length===0){u.warn('render_'+ia,{missing:ka});ta='render';}}if(ta){sa.symptom=ta;new h('/ajax/chat/sidebar_load.php',sa).send();fa().log('SidebarLoadFailureLoggerConfig',{start_gap:z-k.getStartTime(),page_loaded:x,page_id:y,timeout:ia,symptom:ta,has_syntax_error:ba});}},ia);}var ha={start:function(ia){this._serverStartTime=s();o.addListener(ea);ga(5000,ia);ga(10000,ia);ga(15000,ia);ga(30000,ia);ga(60000,ia);},logRendered:function(){if(this._loggedPerformance)return;var ia=s();if(this._serverStartTime)j.log('ChatPerfLoggerConfig',{event:l.SIDEBAR_FROM_SERVER_TTI,duration:ia-this._serverStartTime});var ja=v&&v.getInitTime();if(ja)j.log('ChatPerfLoggerConfig',{event:l.SIDEBAR_FROM_CLIENT_TTI,duration:ia-ja});this._loggedPerformance=true;}};f.exports=ha;},null);
__d('ChatSidebarUser.react',['ChatOpenTab','ChatSidebarItem.react','WebMessengerPermalinkConstants','ReactComponentWithPureRenderMixin','React'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m=l.PropTypes,n=l.createClass({displayName:'ChatSidebarUser',mixins:[k],propTypes:{birthday:m.bool,detailedStatus:m.string,image:m.string,imageSize:m.number,name:m.string,sectionName:m.string.isRequired,slot:m.number,status:m.number,statusTime:m.string,unreadCount:m.number,userID:m.string.isRequired,nowData:m.object},_openTab:function(event){h.openUserTab(this.props.userID,this.props.sectionName,{global_slot:this.props.slot});return event.preventDefault();},render:function(){var o=j.getURIPathForIDOrVanity(this.props.userID);return (l.createElement(i,{onClick:this._openTab,href:o,imageSize:this.props.imageSize,image:this.props.image,name:this.props.name,status:this.props.status,birthday:this.props.birthday,statusTime:this.props.statusTime,detailedStatus:this.props.detailedStatus,context:this.props.context,unreadCount:this.props.unreadCount,nowData:this.props.nowData}));}});f.exports=n;},null);
__d('ChatSidebarUserGroup.react',['AvailableList','AvailableListConstants','ChannelConnection','ChatContexts','ChatSidebarSections','ChatSidebarUser.react','LastMobileActiveTimes','PresencePrivacy','PresenceStatus','React','ShortProfiles','SubscriptionsHandler','WorkModeConfig','cx','shield','ChatUnreadCount'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){if(c.__markCompiled)c.__markCompiled();var w=c('ChatUnreadCount').get(),x=q.PropTypes,y=Object.keys(l).map(function(aa){return l[aa];}),z=q.createClass({displayName:'ChatSidebarUserGroup',propTypes:{ids:x.array.isRequired,sectionName:x.oneOf(y).isRequired,nowDataFetcher:x.func},getInitialState:function(){return {userData:[]};},_onAvailabilityChanged:function(aa,ba){if(!ba||this.props.ids.indexOf(ba)!==-1)this.forceUpdate();},componentWillMount:function(){this.componentWillReceiveProps(this.props);this._subscriptions=new s();this._subscriptions.addSubscriptions(h.subscribe(i.ON_AVAILABILITY_CHANGED,this._onAvailabilityChanged),w.subscribe('unread-count-changed',v(this.forceUpdate,this)));},componentWillUnmount:function(){this._subscriptions.release();},componentWillReceiveProps:function(aa){r.getMulti(aa.ids,(function(ba){var ca=aa.ids.map(function(da){return ba[da];});this.setState({userData:ca});}).bind(this));},_renderProfile:function(aa,ba){var ca=t.is_work_user;if(aa.id===0||!(aa.is_friend||aa.is_messenger_only||ca))return null;var da=p.get(aa.id),ea=da!==i.ACTIVE?n.getShortDisplay(aa.id):null,fa=da===i.ACTIVE?p.getDetailedActivePresence(aa.id):null,ga=j.disconnected()||!o.allows(aa.id),ha=k.getShortDisplay(aa.id),ia=this.props.nowDataFetcher?this.props.nowDataFetcher(aa.id):null;return (q.createElement('li',{className:"_42fz"+(ha?' '+"_52zj":'')+(ga?' '+"_570-":''),'data-id':aa.id,key:aa.id},q.createElement(m,{birthday:aa.is_birthday,context:ha,detailedStatus:fa,image:aa.thumbSrc,imageSize:this.props.imageSize,name:aa.name,sectionName:this.props.sectionName,slot:ba,status:da,statusTime:ea,userID:aa.id,nowData:ia,unreadCount:w.getUnreadCountForUID(aa.id)})));},render:function(){return (q.createElement('ul',this.props,this.state.userData.map(this._renderProfile)));}});f.exports=z;},null);
__d('NowPoller',['Arbiter','Poller','XNowQueryController'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=5000;function l(o,p){'use strict';this.$NowPoller1=o;this.$NowPoller2=new i({interval:k,setupRequest:this.$NowPoller3.bind(this),clearOnQuicklingEvents:false,dontStart:true});this.$NowPoller4=p;this.$NowPoller5=null;}l.prototype.$NowPoller3=function(o){'use strict';this.$NowPoller6=Date.now();o.setHandler(this.$NowPoller7.bind(this)).setErrorHandler(this.$NowPoller8.bind(this)).setOption('suppressErrorAlerts',true).setOption('retries',1).setData({section:this.$NowPoller4,includeusers:this.$NowPoller5}).setURI(j.getURIBuilder().getURI()).setAllowCrossPageTransition(true);};l.prototype.$NowPoller7=function(o){'use strict';var p=o.getPayload();this.$NowPoller1({pinnedfriends:p.pinned,topfriends:p.top_friends,mostrecent:p.most_recent,self:p.self});};l.prototype.$NowPoller8=function(o){'use strict';};l.prototype.setIncludeUsers=function(o){'use strict';this.$NowPoller5=o;};l.prototype.start=function(){'use strict';setTimeout(this.$NowPoller2.start.bind(this.$NowPoller2),0);};l.prototype.restart=function(){'use strict';if(this.$NowPoller2.isMuted()){this.$NowPoller2.resume();this.forceUpdate();}};l.prototype.stop=function(){'use strict';this.$NowPoller2.mute();};l.prototype.forceUpdate=function(){'use strict';this.$NowPoller2.request();};var m,n;l.start=function(){if(!m){m=new l(function(o){h.inform('Now/updatedData',o);},'all');if(n)m.setIncludeUsers(n);m.start();}};l.setIncludeUsers=function(o){n=o;if(m)m.setIncludeUsers(n);};l.forceUpdate=function(){if(m)m.forceUpdate();};l.listenForUpdate=function(o){h.subscribe('Now/updatedData',function(p,q){o(q);});};f.exports=l;},null);
__d('ChatSidebarOrderedList.react',['Animation','BanzaiODS','ChatConfig','ChatQuietLinks','ChatSidebarConstants','ChatSidebarGroupThreadsGroup.react','ChatSidebarLog','ChatSidebarSections','ChatSidebarUserGroup.react','NowPoller','PresencePrivacy','ReactComponentWithPureRenderMixin','React','Scroll','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){if(c.__markCompiled)c.__markCompiled();var x='chat_sidebar_visibility',y=j.get('divebar_new_design',false),z=t.PropTypes;i.setEntitySample(x,.0001);var aa=t.createClass({displayName:'ChatSidebarOrderedList',propTypes:{topUsers:z.array.isRequired,availableUsers:z.array.isRequired,isSidebar:z.bool.isRequired,scrollContainer:z.object,groups:z.array.isRequired,showNow:z.bool},getInitialState:function(){return {nowData:{}};},componentDidMount:function(){n.logRendered&&n.logRendered();k.nukeLinks(t.findDOMNode(this));this._logFriendCount();if(this.props.showNow){q.listenForUpdate((function(ca){return this.setState({nowData:ca});}).bind(this));q.start();}},_scrollToSeparator:function(ca){if(!this.props.scrollContainer)return;var da=this.props.scrollContainer.scrollHeight,ea=this.props.scrollContainer.clientHeight,fa=u.getTop(this.props.scrollContainer),ga=Math.min(ca.offsetTop,da-ea);if(fa!==ga){var ha=Math.abs(ga-fa)/this.props.scrollContainer.clientHeight*500;new h(this.props.scrollContainer).to('scrollTop',ga).ease(h.ease.end).duration(ha).go();}},_renderOfflineSection:function(){var ca=l.getImageSize(this.props.isSidebar),da=this.props.topUsers.filter(function(fa){return !r.allows(fa);});da.splice(-2);var ea=t.createElement('a',{ajaxify:'/ajax/chat/privacy/settings_dialog.php?ref=whitelist_separator',href:'#',rel:'dialog'},w._("Edit"));return [t.createElement('div',{key:'users_separator1',className:"_554m"},t.createElement(ba,null,w._("MORE FRIENDS"))),t.createElement('div',{key:'users_separator2',className:"_554m blackbirdWhitelist"},t.createElement('div',{className:"_554o"},t.createElement('div',{className:"_554n"},t.createElement('div',{className:"_5v-d"},t.createElement('span',{className:"_554t"},w._("These friends can't see you on chat. {=link}",[w.param('=link',ea)])))))),t.createElement(p,{key:o.OFFLINE_USERS,sectionName:o.OFFLINE_USERS,ids:da,imageSize:ca})];},_renderOnlineSection:function(){if(this.props.availableUsers.length===0)return null;var ca=l.getImageSize(this.props.isSidebar);return [t.createElement('div',{key:'users_separator',ref:'usersSeparator',onClick:(function(){return (this._scrollToSeparator(t.findDOMNode(this.refs.usersSeparator)));}).bind(this),className:"_554m moreOnlineFriends"},t.createElement(ba,null,w._("{MORE ONLINE FRIENDS} ({=count})",[w.param('MORE ONLINE FRIENDS',w._("MORE FRIENDS")),w.param('=count',this.props.availableUsers.length)]))),t.createElement(p,{key:o.MORE_ONLINE_FRIENDS,sectionName:o.MORE_ONLINE_FRIENDS,ids:this.props.availableUsers,imageSize:ca})];},_renderGroupsSection:function(){if(this.props.groups.length===0)return null;return [t.createElement('div',{key:'group_separator',ref:'groupSeparator',onClick:(function(){return (this._scrollToSeparator(t.findDOMNode(this.refs.groupSeparator)));}).bind(this),className:"_554m moreOnlineFriends"},t.createElement(ba,null,w._("GROUP CONVERSATIONS"))),t.createElement(m,{key:'group_threads_section',groups:this.props.groups})];},render:function(){var ca=l.getImageSize(this.props.isSidebar),da=this.props.topUsers;if(r.getVisibility()==r.ONLINE)da=this.props.topUsers.filter(function(ka){return r.allows(ka);});var ea=r.getOnlinePolicy()==r.ONLINE_TO_WHITELIST&&r.getVisibility()?this._renderOfflineSection():this._renderOnlineSection(),fa=null,ga=null;if(this.props.showNow&&this.state.nowData){var ha=da,ia=[];if(this.state.nowData.pinnedfriends)ia=this.state.nowData.pinnedfriends.map(function(ka){return ka.user_id;});if(this.state.nowData.topfriends)da=this.state.nowData.topfriends.map(function(ka){return ka.user_id;});ha=ha.filter(function(ka){return ia.indexOf(ka)==-1;});q.setIncludeUsers(ha);ha=ha.filter(function(ka){return da.indexOf(ka)==-1;});ha.forEach(function(ka){da.push(ka);});var ja=(function(ka){var la=null;if(this.state.nowData.pinnedfriends)this.state.nowData.pinnedfriends.forEach(function(ma){if(ma.user_id==ka)la=ma;});if(this.state.nowData.topfriends)this.state.nowData.topfriends.forEach(function(ma){if(ma.user_id==ka)la=ma;});return la;}).bind(this);fa=t.createElement('div',null,t.createElement(ba,null,w._("PINNED FRIENDS")),t.createElement(p,{ids:ia,imageSize:ca,key:o.NOW_PINNED_LIST,nowDataFetcher:ja,sectionName:o.NOW_PINNED_LIST}));ga=t.createElement('div',null,t.createElement(ba,null,w._("TOP FRIENDS")),t.createElement(p,{key:o.ORDERED_LIST,ids:da,imageSize:ca,nowDataFetcher:ja,sectionName:o.ORDERED_LIST}));}else ga=t.createElement(p,{key:o.ORDERED_LIST,ids:da,imageSize:ca,sectionName:o.ORDERED_LIST});return (t.createElement('li',{className:y?"_bxd":null},fa,ga,this._renderGroupsSection(),ea));},_logFriendCount:function(){this._logTimeout=setTimeout((function(){i.bumpEntityKey(x,this.props.availableUsers.length===0?'state_list_empty':'state_list_mounted');}).bind(this),5000);}}),ba=t.createClass({displayName:'ChatSidebarSeparator',mixins:[s],render:function(){var ca=y?null:t.createElement('div',{className:"_554q"},t.createElement('span',{className:"_554r"}));return (t.createElement('div',{className:"_554o"},t.createElement('div',{className:"_554n"},t.createElement('span',{className:"_554p"},this.props.children),ca)));}});f.exports=aa;},null);
__d('ChatSortUsers',['AvailableListConstants','OrderedFriendsList','PresencePrivacy','PresenceStatus','ShortProfiles','TokenizeUtil'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();function n(r,s){var t=j.allows(r),u=j.allows(s);if(t!==u)return t?-1:1;return 0;}var o={};function p(r){if(o[r])return o[r];var s=(l.getNowUnsafe(r)||{}).name;if(s)return o[r]=m.flatten(s);return '~';}var q={sortAlphabetical:function(r,s){var t=p(r),u=p(s);if(t!==u)return t<u?-1:1;return 0;},sortMobile:function(r,s){var t=k.get(r)===h.MOBILE,u=k.get(s)===h.MOBILE;if(t!==u)return u?-1:1;return q.sortAlphabetical(r,s);},sortCoefficient:function(r,s){var t=i.getRank(r),u=i.getRank(s);if(t!==u)return t-u;return q.sortAlphabetical(r,s);},sort:function(r,s){var t=n(r,s);if(t!==0)return t;return q.sortCoefficient(r,s);}};f.exports=q;},null);
__d('ChatOrderedList',['Arbiter','ArbiterMixin','AvailableList','AvailableListConstants','CSS','ChatConfig','ChatOptions','ChatHovercard','ChatOrderedListHover','ChatSidebarConstants','ChatSidebarInboxConfig','ChatSidebarOrderedList.react','ChatSortUsers','ChatVisibility','DOM','DataStore','JSLogger','OrderedFriendsList','Parent','PresencePrivacy','PresenceStatus','React','createObjectFrom','csx','debounceAcrossTransitions','mixin','shield'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha){if(c.__markCompiled)c.__markCompiled();var ia,ja,ka=null;ia=ga(i);ja=ia&&ia.prototype;Object.assign(la,ia);la.prototype=Object.create(ia.prototype);la.prototype.constructor=la;la.__superConstructor__=ia;function la(ma,na){'use strict';ja.constructor.call(this);this._isSidebar=ma;this._root=na;this._isVisible=false;this._excludedIds={};this._numTopFriends=5;this._groups=[];this._hoverController=null;this._orderedList=v.find(this._root,'.fbChatOrderedList');this._scrollableOrderedList=z.byClass(this._root,'scrollableOrderedList');this._scrollableArea=z.byClass(this._root,'scrollable');if(this._isSidebar)new o(this);h.subscribe(x.DUMP_EVENT,(function(oa,pa){pa.chat_lists=pa.chat_lists||{sorted_list:this.getCachedSortedList(),ordered_list:y.getList(),available_list:la.getAvailableList(this._excludedIds),excluded_list:this._excludedIds};}).bind(this));aa.subscribe('privacy-user-presence-changed',ha(this._render,this));j.subscribe(k.ON_AVAILABILITY_CHANGED,ha(this._render,this));}la.prototype.getShowingUsers=function(){'use strict';return v.scry(this._root,"li._42fz,li._5a58").map(this.getUserForNode);};la.prototype.getUserForNode=function(ma){'use strict';return w.get(ma,'id')||w.get(ma,'serverthreadid');};la.prototype.getHoverController=function(){'use strict';if(!this._hoverController)this._hoverController=new p(this);return this._hoverController;};la.prototype.getItemHeight=function(){'use strict';return q.getItemHeight(this._isSidebar);};la.prototype.getRoot=function(){'use strict';return this._root;};la.prototype.getSortedList=function(ma){'use strict';return la.getSortedList(ma||this._excludedIds,this._numTopFriends);};la.prototype.getCachedSortedList=function(ma){'use strict';if(ka==null)ka=this.getSortedList(ma);return ka;};la.prototype.hide=function(){'use strict';if(!this._isVisible)return;this._isVisible=false;l.hide(this._scrollableOrderedList||this._root);this.inform('hide');};la.prototype.setNumTopFriends=function(ma){'use strict';var na=la.getGroups(),oa=ma-na.length;if(oa>m.get('min_top_friends'))ma=oa;if(ma!==this._numTopFriends||na.length!==this._groups.length){this._groups=na;this._numTopFriends=ma;this._render();}};la.prototype._renderOrderedList=function(){'use strict';if(!this._isVisible)return;var ma=la.getSortedList({},this._numTopFriends),na=la.getAvailableList(da(ma));na.sort(t.sortMobile);var oa=r.component;if(oa){ca.render(ca.createElement(oa,{showCount:r.show_count,showPresence:r.show_presence,threadCount:this._numTopFriends}),this._orderedList);}else ca.render(ca.createElement(s,{availableUsers:na,isSidebar:this._isSidebar,scrollContainer:this._scrollContainer,topUsers:ma,groups:la.getGroups(),showNow:m.get('badger_www_nub')}),this._orderedList);this.inform('render');};la.prototype._render=function(){'use strict';this._render=fa(this._renderOrderedList.bind(this),300);this._render();};la.prototype.show=function(){'use strict';if(this._isVisible)return;this._isVisible=true;l.show(this._scrollableOrderedList||this._root);this._render();this.inform('show');};la.prototype.isVisible=function(){'use strict';return this._isVisible;};la.prototype.setScrollContainer=function(ma){'use strict';if(v.contains(ma,this._root))this._scrollContainer=ma;};la.getGroups=function(){'use strict';if(!n.getSetting('hide_groups')){return y.getGroups();}else return [];};la.getSortedList=function(ma,na){'use strict';var oa=y.getList().filter(function(ra){return !(ra in ma)&&aa.getFriendVisibility(ra)!==aa.BLACKLISTED;});if(!u.isOnline())if(aa.getOnlinePolicy()===aa.ONLINE_TO_WHITELIST)oa=this._filterByWhitelist(oa);var pa=oa.slice(0,na);if(pa.length===na){var qa=la.getAvailableList(pa.concat(ma)).length;qa&&pa.splice(-1);}ka=pa.slice();return pa;};la._filterByWhitelist=function(ma){'use strict';var na=ma,oa={},pa,qa;ma=[];for(pa=0;pa<na.length;++pa){qa=na[pa];if(aa.allows(qa)){oa[qa]=true;ma.push(qa);}}var ra=aa.getWhitelist();for(pa=0;pa<ra.length;++pa){qa=ra[pa];if(!(qa in oa))ma.push(qa);}for(pa=0;pa<na.length;++pa){qa=na[pa];if(!aa.allows(qa))ma.push(qa);}return ma;};la.getAvailableList=function(ma){'use strict';var na;if(!na)na=ba.getOnlineIDs();return na.filter(function(oa){return !(oa in ma);});};f.exports=la;},null);
__d('ChatSidebarDropdown',['AppsDivebarDisplayController','Arbiter','AsyncRequest','ChatOptions','ChatSidebarActions','ChatTabActions','ChatVisibility','CSS','FBRTCCallBlockingStore','JSLogger','PresenceState','cx','ge'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){if(c.__markCompiled)c.__markCompiled();function u(v,w,x,y,z){'use strict';this._menu=w;this._popover=v.getPopover();this._selectedValues={};this._menuIsRendered=false;this._editingFavoriteList=false;this._hasAppsOption=z;this._logger=q.create('blackbird');this._menu.subscribe('itemclick',this._onClick.bind(this));this._popover.subscribe('init',this._onLayerInit.bind(this));this._popover.subscribe('show',this._updateTickerVisibility.bind(this));i.subscribe('chat/option-changed',this._onOptionChanged.bind(this));}u.prototype._onLayerInit=function(){'use strict';this._menuIsRendered=true;o.addClass(this._popover.getLayer().getContentRoot(),"_5vm9");this._displayBrowserNotificationsIfNeeded();this._updateVisibility();this._updateVideoCallVisibility();i.subscribe('chat-visibility/go-online',this._updateVisibility.bind(this));i.subscribe('chat-visibility/go-offline',this._updateVisibility.bind(this));p.addListener(this._updateVideoCallVisibility.bind(this));this._updateSelectedItems();if(this._editingFavoriteList)this._updateEditFavoriteListLabel(this._editingFavoriteList);if(this._hasAppsOption)this._registerAppHandlers();};u.prototype._updateSelectedItems=function(){'use strict';this._menu.forEachItem((function(v){var w=v.getValue&&v.getValue();if(w in this._selectedValues){var x=this._selectedValues[w];if(x){v.select();}else v.deselect();}}).bind(this));};u.prototype._registerAppHandlers=function(){'use strict';this._updateAppsVisibility();i.subscribe('AppsDivebar/hide-apps',this._updateAppsVisibility.bind(this));i.subscribe('AppsDivebar/show-apps',this._updateAppsVisibility.bind(this));};u.prototype._updateTickerVisibility=function(){'use strict';var v=t('pagelet_ticker');o.conditionClass(this._popover.getLayer().getContentRoot(),"_2rox",!v||v.offsetHeight===0);};u.prototype._updateAppsVisibility=function(){'use strict';o.conditionClass(this._popover.getLayer().getContentRoot(),"_2vh",!h.isVisible());};u.prototype._updateVisibility=function(){'use strict';o.conditionClass(this._popover.getLayer().getContentRoot(),"_5vma",!n.isOnline());};u.prototype._updateVideoCallVisibility=function(){'use strict';o.conditionClass(this._popover.getLayer().getContentRoot(),"_2jvw",p.getBlockingStatus());};u.prototype._displayBrowserNotificationsIfNeeded=function(){'use strict';if(window.webkitNotifications){var v;this._menu.forEachItem(function(w){if(w.getValue&&w.getValue()==='browser_notif')v=w;});if(v){o.show(v.getRoot());if(window.webkitNotifications.checkPermission()!==0)v.deselect();}}};u.prototype._onChangeSettingResponse=function(v,w,x){'use strict';r.doSync();};u.prototype._onChangeSettingError=function(v,w,x){'use strict';k.setSetting(v,!w,'sidebar_menu_error');};u.prototype._onChangeFinally=function(){'use strict';this._pendingChange=false;};u.prototype._onOptionChanged=function(v,w){'use strict';var x=w.name,y=w.value;if(this._menuIsRendered){this._menu.forEachItem(function(z){if(z.getValue&&z.getValue()===x)if(z.isSelected()&&!y){z.deselect();}else if(!z.isSelected()&&y)z.select();});}else this._selectedValues[x]=y;};u.prototype._onClick=function(v,w){'use strict';if(this._pendingChange)return false;var x=false,y=w.item.getValue(),z=true;switch(y){case 'sidebar':this.toggleSidebar();break;case 'online':if(!n.isOnline()){n.goOnline();}else this._logVisibilityChange(y,true);x=true;break;case 'offline':if(n.isOnline()){n.goOffline();}else this._logVisibilityChange(y,true);x=true;break;case 'videoon':p.turnOnVideoCalling();x=true;break;case 'videooff':x=true;break;case 'advanced_settings':case 'turn_off_dialog':i.inform('chat/advanced-settings-dialog-opened');x=true;this._logVisibilityChange(y,false);break;case 'browser_notif':if(!w.item.isSelected()&&window.webkitNotifications&&window.webkitNotifications.checkPermission()!==0){window.webkitNotifications.requestPermission((function(){this.changeSetting(y,!w.item.isSelected());}).bind(this));}else this.changeSetting(y,!w.item.isSelected());x=true;break;case 'sound':this.changeSetting(y,!w.item.isSelected());x=true;break;case 'close_all_tabs':m.closeAllTabs();this._logVisibilityChange(y,false);x=true;break;case 'show_apps':if(!h.isVisible())h.showApps();x=true;break;case 'hide_apps':if(h.isVisible())h.hideApps();x=true;break;case 'show_ticker':i.inform('ChatSidebarDropdown/openTicker');x=true;break;case 'hide_ticker':i.inform('ChatSidebarDropdown/closeTicker');x=true;break;case 'hide_groups':var aa=w.item.isSelected();this.changeSetting('hide_groups',!aa);x=true;break;}if(x){this.hideMenu();return z;}};u.prototype._logVisibilityChange=function(v,w){'use strict';this._logger.error(w?'sidebar_dropdown_visibility_error':'sidebar_dropdown_set_visibility',{action:v});};u.prototype.changeSetting=function(v,w){'use strict';if(this._pendingChange)return false;this._pendingChange=true;var x={};x[v]=w;k.setSetting(v,w,'sidebar_menu');new j('/ajax/chat/settings.php').setHandler(this._onChangeSettingResponse.bind(this,v,w)).setErrorHandler(this._onChangeSettingError.bind(this,v,w)).setFinallyHandler(this._onChangeFinally.bind(this)).setData(x).setAllowCrossPageTransition(true).send();};u.prototype.hideMenu=function(){'use strict';if(this._menuIsRendered)this._popover.hideLayer();};u.prototype.toggleSidebar=function(){'use strict';l.toggle();this.hideMenu();return false;};f.exports=u;},null);
__d('ChatSidebarTypeaheadDataSource',['MercuryConfig','MercuryTypeaheadDataSource','ShortProfiles'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k,l;k=i;l=k&&k.prototype;Object.assign(m,k);m.prototype=Object.create(k.prototype);m.prototype.constructor=m;m.__superConstructor__=k;function m(n){'use strict';n=n||{};n.kanaNormalization=true;if(h.ScrollableSidebarTypeaheadGK)n.maxResults=30;l.constructor.call(this,n);}m.prototype.init=function(){'use strict';l.init.call(this);this.updateBootstrapData();};m.prototype.bootstrap=function(){'use strict';l.bootstrap.call(this);};m.prototype.updateBootstrapData=function(){'use strict';if(this.isBootstrapped())return;l.updateBootstrapData.call(this);};m.prototype.fetchAll=function(){'use strict';j.fetchAll();};m.prototype.refreshData=function(){'use strict';this.fetchAll();e(['AvailableList'],(function(n){n.update();}).bind(this));};m.prototype.query=function(n,o,p,q){'use strict';this.logQuery({event:'query_dive_bar',query:n});return l.query.call(this,n,o,p,q);};m.prototype.respond=function(n,o,p){'use strict';var q=l.respond.call(this,n,o,p);this.logResponse({event:'query_response_dive_bar',response_query:n,response_uids:o});return q;};f.exports=m;},null);
__d('ChatTypeaheadCore',['Event','Keys','TypeaheadCore','emptyFunction','shield'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m,n;m=j;n=m&&m.prototype;Object.assign(o,m);o.prototype=Object.create(m.prototype);o.prototype.constructor=o;o.__superConstructor__=m;o.prototype.init=function(p,q,r){'use strict';n.init.call(this,p,q,r);this.informBeginActive=false;this.informEndActive=false;this.data.subscribe('respond',(function(){if(this.informBeginActive){this.informBeginActive=false;this.inform('sidebar/typeahead/active',true);}else if(this.informEndActive){this.informEndActive=false;this.inform('sidebar/typeahead/active',false);}}).bind(this));};o.prototype.keydown=function(event){'use strict';this.data.fetchAll();var p=h.getKeyCode(event);if(p===i.ESC){this.view.clearContent();setTimeout(l(this.reset,this),0);if(!this.getValue()){this.element.blur();this.inform('escape');}return event.kill();}return n.keydown.call(this,event);};o.prototype.checkValue=function(){'use strict';var p=this.getValue(),q=this.value;if(p==q)return;if(q&&!p){this.typeaheadActive=false;this.informEndActive=true;}else if(!q&&p){this.typeaheadActive=true;this.informBeginActive=true;this.inform('sidebar/typeahead/preActive');}n.checkValue.call(this);};function o(){'use strict';m.apply(this,arguments);}Object.assign(o.prototype,{handleTab:k});f.exports=o;},null);
__d('ChatSidebarHeader.react',['React','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=Object.assign||function(m){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var p in o)if(Object.prototype.hasOwnProperty.call(o,p))m[p]=o[p];}return m;},l=h.createClass({displayName:'ReactChatSidebarHeader',render:function(){return (h.createElement('div',k({},this.props,{className:j(this.props.className,"_55ob")}),h.createElement('div',{className:"_55oc"},this.props.children)));}});f.exports=l;},null);
__d('ChatTypeaheadRenderer',['AvailableListConstants','ChatConfig','ChatSidebarConstants','ChatSidebarHeader.react','ChatSidebarSections','ChatSidebarThread.react','ChatSidebarUser.react','ChatTypeaheadConstants','DOM','LastMobileActiveTimes','MercuryIDs','PresenceStatus','React','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){if(c.__markCompiled)c.__markCompiled();var v={};function w(ba,ca){if(!(ba in v))v[ba]=p.create('li');t.render(ca,v[ba]);return v[ba];}function x(ba){return w(ba.text,t.createElement(k,{className:i.get('divebar_new_design',false)?"_4ebb":''},ba.text));}function y(ba){var ca=ba.mercury_thread.participants.map(function(da){return r.getUserIDFromParticipantID(da);});return w(ba.uid,t.createElement(m,{image:ba.mercury_thread.image_src,imageSize:j.getImageSize(),name:ba.mercury_thread.name,participants:ba.participants_to_render,numOtherParticipants:ca.length-1,referrer:l.TYPEAHEAD,status:s.getGroup(ca),threadFBID:ba.uid}));}function z(ba){var ca=s.get(ba.uid),da=ca===h.MOBILE?q.getShortDisplay(ba.uid):null,ea=ba.render_type==o.NON_FRIEND_TYPE||ba.render_type==o.PAGE_TYPE||ba.render_type==o.FB4C_TYPE?ba.subtext:null,fa=null;if(ca===h.ACTIVE)fa=s.getDetailedActivePresence(ba.uid);return w(ba.uid,t.createElement(n,{image:ba.photo,imageSize:j.getImageSize(),name:ba.text,sectionName:l.TYPEAHEAD,status:ca,statusTime:da,detailedStatus:fa,userID:ba.uid,context:ea}));}function aa(ba,ca){if(ba.type===o.HEADER_TYPE)return x(ba);if(ba.type==o.THREAD_TYPE)return y(ba);return z(ba);}f.exports=aa;},null);
__d('ChatTypeaheadView',['BucketedTypeaheadView','ChatTypeaheadConstants','CurrentUser','DOM','MercuryConfig','React','ScrollableArea','MercuryThreadSearchUtils','Style','WorkModeConfig','XUISpinner.react','arrayContains','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){if(c.__markCompiled)c.__markCompiled();var v,w;v=h;w=v&&v.prototype;Object.assign(x,v);x.prototype=Object.create(v.prototype);x.prototype.constructor=x;x.__superConstructor__=v;function x(y,z){'use strict';if(l.ScrollableSidebarTypeaheadGK){var aa=n.renderDOM();k.appendContent(y,aa.root);var ba=n.fromNative(aa.root);w.constructor.call(this,aa.content,z);this.$ChatTypeaheadView1=aa;this.$ChatTypeaheadView2=ba;}else w.constructor.call(this,y,z);this.showingLoadingIndicator=false;this.typeObjects={};this.typeObjectsOrder=[];this.typeObjects[i.NON_FRIEND_TYPE]={uid:i.NON_FRIEND_TYPE,type:i.HEADER_TYPE,text:u._("MORE PEOPLE")};this.typeObjectsOrder.push(i.NON_FRIEND_TYPE);this.typeObjects[i.PAGE_TYPE]={disabled:true,uid:i.PAGE_TYPE,type:i.HEADER_TYPE,text:u._("BUSINESSES")};this.typeObjectsOrder.push(i.PAGE_TYPE);this.typeObjects[i.THREAD_TYPE]={uid:i.THREAD_TYPE,type:i.HEADER_TYPE,text:u._("GROUP CONVERSATIONS")};this.typeObjectsOrder.push(i.THREAD_TYPE);this.typeObjects[i.FB4C_TYPE]={uid:i.FB4C_TYPE,type:i.HEADER_TYPE,text:u._("CO-WORKERS")};this.typeObjects[i.FRIEND_TYPE]={disabled:true,uid:i.FRIEND_TYPE,type:i.HEADER_TYPE,text:u._("FRIENDS")};this.typeObjectsOrder.push(i.FB4C_TYPE);this.typeObjectsOrder.push(i.FRIEND_TYPE);}x.prototype.reset=function(){'use strict';if(this.value==='')this.clearContent();this.index=-1;this.items=[];this.results=[];this.value='';this.inform('reset');return this;};x.prototype.clearContent=function(){'use strict';this.hideLoadingIndicator();k.empty(this.content);};x.prototype.buildBuckets=function(y,z){'use strict';var aa=z.filter(function(ba){var ca=ba.render_type||ba.type;if(ca==='thread'){var da='fbid:'+j.getID();if(!s(ba.mercury_thread.participants,da))return false;var ea=ba.participants_to_render.some(function(ga){return o.queryMatchesName(y,ga.name);}),fa=o.queryMatchesName(y,ba.mercury_thread.name);if(!ea&&!fa)return false;}return true;}).reverse();return w.buildBuckets.call(this,y,aa);};x.prototype.getDefaultIndex=function(y){'use strict';if(y.length===0)return -1;var z=y.length-1;while(!this.isHighlightable(y[z])&&z>=0)z--;return z;};x.prototype.showLoadingIndicator=function(){'use strict';if(!this.showingLoadingIndicator){m.render(m.createElement('div',{className:'spinnerContainer'},m.createElement(r,{className:"_3-8i",background:'light',size:'small',paused:false})),this.content);this.showingLoadingIndicator=true;}};x.prototype.hideLoadingIndicator=function(){'use strict';if(this.showingLoadingIndicator){m.unmountComponentAtNode(this.content);this.showingLoadingIndicator=false;}};x.prototype.showNoResults=function(){'use strict';var y=u._("Friend not found.");if(q.is_work_user)y=u._("Co-worker not found.");this.hideLoadingIndicator();k.setContent(this.content,k.create('div',{className:"noResults _3-9a"},y));};x.prototype.hide=function(){'use strict';this.clearContent();return w.hide.call(this);};x.prototype.next=function(){'use strict';w.next.call(this);if(l.ScrollableSidebarTypeaheadGK)this.$ChatTypeaheadView2.scrollIntoView(this.selected,false);};x.prototype.prev=function(){'use strict';w.prev.call(this);if(l.ScrollableSidebarTypeaheadGK)this.$ChatTypeaheadView2.scrollIntoView(this.selected,false);};x.prototype.setMaxHeight=function(y){'use strict';p.set(this.$ChatTypeaheadView1.wrap,'max-height',y+'px');};x.prototype.render=function(y,z,aa){'use strict';if(l.ScrollableSidebarTypeaheadGK)var ba=this.value!==y||this.$ChatTypeaheadView2.isScrolledToBottom();if(!z.length){if(y&&y.length>1)this.showLoadingIndicator();}else this.hideLoadingIndicator();w.render.call(this,y,z,aa);if(l.ScrollableSidebarTypeaheadGK&&ba)this.$ChatTypeaheadView2.scrollToBottom(false);};f.exports=x;},null);
__d('legacy:ChatTypeaheadBehavior',['ChatTypeaheadBehavior'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();if(!b.TypeaheadBehaviors)b.TypeaheadBehaviors={};b.TypeaheadBehaviors.chatTypeahead=function(i){i.enableBehavior(h);};},3);
__d('P2PTriggersUtils',['CurrentEnvironment','MercuryIDs','P2PGKValues'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=/\$((\d{1,3}(,\d{3})*)|\d+)(\.\d{1,2})?(?=\s|\.\s|\,\s|$|\.$|\,$|\?|\!|\")/,l={canSeeTriggers:function(m){if(!j.P2PEnabled)return false;if(i.isGroupChat(m))if(h.messengerdotcom&&!j.P2PGroupSendMessengerDotCom){return false;}else if(h.facebookdotcom&&!j.P2PGroupSendWWW)return false;return true;},getMatches:function(m){return m.match(k);}};f.exports=l;},null);
__d('MessengerURIConstants',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();'use strict';var h={COMPOSE_SUBPATH:'/new',GROUPS_PATH:'/groups',PEOPLE_PATH:'/people',THREAD_PREFIX:'/t/',GROUP_PREFIX:'group-',RESERVED_WORDS:['groups','people','new','messenger','t']};f.exports=h;},null);
__d('MessengerURISerializer',['MessengerStateProcessor','MessengerURIConstants','MessengerView','URI','WWWBase'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();'use strict';var m='/?$',n={serialize:function(w){var x=new k(l.uri);w=h.preprocess(w);switch(w.masterView){case j.MASTER.GROUPS:x.setPath(i.GROUPS_PATH);break;case j.MASTER.PEOPLE:x.setPath(i.PEOPLE_PATH);break;}if(w.detailView===j.DETAIL.COMPOSE){x.setPath(x.getPath()+i.COMPOSE_SUBPATH);}else if(w.threadKey)x.setPath(x.getPath()+i.THREAD_PREFIX+u(w.threadKey));return x;},deserialize:function(w){var x={},y=w.getPath();if(y.match('^'+i.GROUPS_PATH)){x.masterView=j.MASTER.GROUPS;}else if(y.match('^'+i.PEOPLE_PATH)){x.masterView=j.MASTER.PEOPLE;}else x.masterView=j.MASTER.RECENT;if(y.match(i.COMPOSE_SUBPATH+m)){x.detailView=j.DETAIL.COMPOSE;}else{var z=o(y);if(z&&!s(z)){x.threadKey=v(z);x.detailView=j.DETAIL.THREAD;}}return h.postprocess(x);}};function o(w){var x=w.match(i.THREAD_PREFIX+'([^/]+)'+m);return x&&x[1];}var p=i.RESERVED_WORDS.join('|'),q=new RegExp('^('+p+')$'),r=new RegExp('^\\.('+p+')$');function s(w){return !!w.match(q);}function t(w){return !!w.match(r);}function u(w){w=s(w)?'.'+w:w;return k.encodeComponent(w);}function v(w){w=k.decodeComponent(w);return t(w)?w.substr(1):w;}f.exports=n;},null);
__d('MessengerActions',['MessengerDispatcher','MessengerURISerializer','MessengerView','URI','goURI','keyMirror'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();'use strict';var n=m({CHANGE_FOLDER:null,HIDE_DIALOG:null,REPLACE_STATE:null,SHOW_DIALOG:null}),o={Types:n,changeDetailView:function(q){p(function(r){if(r.detailView!==q)return {detailView:q};});},changeMasterView:function(q){p(function(r){if(r.masterView!==q)return {masterView:q};});},selectThread:function(q){p(function(r){if(r.activeThreadID!==q)return {activeThreadID:q,detailView:j.DETAIL.THREAD};});},changeState:function(q){h.dispatch({type:n.REPLACE_STATE,nextState:q});},showDialog:function(q,r){h.dispatch({type:o.Types.SHOW_DIALOG,dialogClass:q,dialogProps:r});},hideDialog:function(q){h.dispatch({type:o.Types.HIDE_DIALOG,dialogClass:q});},changeFolder:function(q){h.dispatch({type:o.Types.CHANGE_FOLDER,folder:q});}};function p(q){var r=i.deserialize(new k(window.location.href)),s=q(r);if(s)l(i.serialize(Object.assign(r,s)));}f.exports=o;},null);
__d('P2PActions',['ChatOpenTab','MessengerActions','P2PActionConstants','P2PDispatcher'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();'use strict';var l={updateCreditCards:function(m){k.dispatch({type:j.CREDIT_CARDS_UPDATED,data:m});},ignoreCreditCardChannelEvents:function(){k.dispatch({type:j.CHANNEL_EVENTS_IGNORED});},allowCreditCardChannelEvents:function(){k.dispatch({type:j.CHANNEL_EVENTS_ALLOWED});},addCreditCard:function(m){k.dispatch({type:j.CREDIT_CARD_ADDED,data:m});},addCreditCardError:function(m){k.dispatch({type:j.CREDIT_CARD_ADDED_ERROR,data:m});},updatePresetCreditCard:function(m){k.dispatch({type:j.PRESET_CREDIT_CARD_UPDATED,data:m});},updatePresetCreditCardError:function(m){k.dispatch({type:j.PRESET_CREDIT_CARD_UPDATED_ERROR,data:m});},updateCreditCard:function(m){k.dispatch({type:j.CREDIT_CARD_UPDATED,data:m});},updateCreditCardError:function(m){k.dispatch({type:j.CREDIT_CARD_UPDATED_ERROR,data:m});},deleteCreditCard:function(m){k.dispatch({type:j.CREDIT_CARD_DELETED,data:m});},deleteCreditCardError:function(m){k.dispatch({type:j.CREDIT_CARD_DELETED_ERROR,data:m});},verifyCreditCard:function(m){k.dispatch({type:j.CREDIT_CARD_VERIFIED,data:m});},verifyCreditCardError:function(m){k.dispatch({type:j.CREDIT_CARD_VERIFIED_ERROR,data:m});},updateTransfers:function(m){k.dispatch({type:j.TRANSFERS_UPDATED,data:m});},updateTransfersError:function(m){k.dispatch({type:j.TRANSFERS_UPDATED_ERROR,data:m});},updateNUXTransfers:function(m){k.dispatch({type:j.NUX_TRANSFERS_UPDATED,data:m});},transferAdded:function(m){k.dispatch({type:j.TRANSFER_ADDED,data:m});},transferAddedError:function(m){k.dispatch({type:j.TRANSFER_ADDED_ERROR,data:m});},transferUpdated:function(m){k.dispatch({type:j.TRANSFER_UPDATED,data:m});},transferUpdatedError:function(m){k.dispatch({type:j.TRANSFER_UPDATED_ERROR,data:m});},transferAccepted:function(){k.dispatch({type:j.TRANSFER_ACCEPTED});},transferDeclined:function(m){k.dispatch({type:j.TRANSFER_DECLINED,data:m});},chatSendViewOpened:function(m){function n(){k.dispatch({type:j.CHAT_SEND_VIEW_OPENED,data:m});}if(h.canOpenTab()){h.openThread(m.threadID,null,null,n);}else{i.selectThread(m.threadID);n();}},chatSendViewClosed:function(m){k.dispatch({type:j.CHAT_SEND_VIEW_CLOSED,data:m});},binNumberValidated:function(m){k.dispatch({type:j.BIN_NUMBER_VALIDATED,data:m});},binNumberValidatedError:function(m){k.dispatch({type:j.BIN_NUMBER_VALIDATED_ERROR,data:m});},friendsListUpdated:function(m){k.dispatch({type:j.FRIENDS_LIST_UPDATED,data:m});},userEligibilityUpdated:function(m){k.dispatch({type:j.USER_ELIGIBILITY_UDPATED,data:m});},showDialog:function(m,n){k.dispatch({type:j.DIALOG_SHOWN,data:{dialogClass:m,dialogProps:n}});},hideDialog:function(){k.dispatch({type:j.DIALOG_CLOSED});},bannerStatesUpdated:function(m){k.dispatch({type:j.BANNER_STATES_UPDATED,data:m});},bannerDismissed:function(m){k.dispatch({type:j.BANNER_DISMISSED,data:m});},bannerCompleted:function(m){k.dispatch({type:j.BANNER_COMPLETED,data:m});},moneypennyTransferCreated:function(m){k.dispatch({type:j.MONEYPENNY_TRANSFER_CREATED,data:m});},moneypennyTransferCreatedError:function(m){k.dispatch({type:j.MONEYPENNY_TRANSFER_CREATED_ERROR,data:m});},productItemBannerUpdated:function(m){k.dispatch({type:j.PRODUCT_ITEM_BANNER_UPDATED,data:m});},productItemBannerDismissed:function(m){k.dispatch({type:j.PRODUCT_ITEM_BANNER_DISMISSED,data:m});},extensiveTransferDetailsLoaded:function(m){k.dispatch({type:j.EXTENSIVE_TRANSFER_DETAILS_UPDATED,data:m});}};f.exports=l;},null);
__d('P2PAPIUtils',['CreditCardFormParam','fbt','guid'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=Object.assign||function(m){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var p in o)if(Object.prototype.hasOwnProperty.call(o,p))m[p]=o[p];}return m;},l={getRandomDigits:function(m){return Math.random().toString().slice(2,2+m);},genRequestID:function(){return 'id:'+j()+':'+Date.now();},genOfflineThreadingID:function(){return Date.now()+''+l.getRandomDigits(6);},getUncaughtErrorMessage:function(){return i._("Sorry, something went wrong. Please try again later.");},prepareCardMutationData:function(m){var n={},o=m[h.CARD_NUMBER].replace(/ /g,'');n[h.CARD_NUMBER]=o;if(typeof m[h.CARD_EXPIRATION]==='string'){var p=m[h.CARD_EXPIRATION].split('/');n[h.MONTH]=p[0];n[h.YEAR]=p[1];n[h.CARD_EXPIRATION]={};n[h.CARD_EXPIRATION][h.MONTH]=n[h.MONTH];n[h.CARD_EXPIRATION][h.YEAR]=n[h.YEAR];}else{n[h.MONTH]=m[h.CARD_EXPIRATION][h.MONTH];n[h.YEAR]=m[h.CARD_EXPIRATION][h.YEAR];}return k({},m,n);}};f.exports=l;},null);
__d("XP2PBannerDismissalsUpdateController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/banner_dismissals\/_update\/",{banner_type:{type:"String",required:true}});},null,{});
__d("XP2PBannerStatesController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/banner_states\/",{});},null,{});
__d("XP2PBannerViewsUpdateController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/banner_views\/_update\/",{banner_type:{type:"String",required:true}});},null,{});
__d("XP2PCardBINValidateController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/card_bin\/validate\/",{bin_number:{type:"String",required:true}});},null,{});
__d("XP2PCreditCardDeleteController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/credit_cards\/_delete\/",{});},null,{});
__d("XP2PCreditCardUpdateController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/credit_cards\/_update\/",{});},null,{});
__d("XP2PCreditCardCreateController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/credit_cards\/_create\/",{});},null,{});
__d("XP2PCreditCardVerifyController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/credit_cards\/_verify\/",{});},null,{});
__d("XP2PCreditCardsController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/credit_cards\/",{});},null,{});
__d("XP2PExtensiveTransferDetailsController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/transaction\/details\/",{id:{type:"String",required:true}});},null,{});
__d("XP2PFriendPickerController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/friend_picker\/",{limit:{type:"Int",defaultValue:100},query:{type:"String"}});},null,{});
__d("XMoneypennyPaymentsCreateController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/moneypenny\/payments\/_create\/",{});},null,{});
__d("XP2PPasswordProtectionStatusController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/password_protection_status\/",{});},null,{});
__d("XP2PPasswordProtectionStatusUpdateController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/password_protection_status\/_update\/",{});},null,{});
__d("XP2PPresetCreditCardSetController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/preset_credit_card\/_set\/",{});},null,{});
__d("XP2PProductItemBannerController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/product_item_banner\/",{other_user_id:{type:"String",required:true}});},null,{});
__d("XP2PTransactionsCampaignCreateController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/transactions\/campaign\/_create\/",{});},null,{});
__d("XP2PTransactionsCancelController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/transactions\/_cancel\/",{});},null,{});
__d("XP2PTransactionsCreateController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/transactions\/_create\/",{});},null,{});
__d("XP2PTransactionsController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/transactions\/",{since:{type:"Int"}});},null,{});
__d("XP2PTransactionsDeclineController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/transactions\/_decline\/",{});},null,{});
__d("XP2PUserEligibilityController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/user_eligibility\/",{user_ids:{type:"StringVector",required:true}});},null,{});
__d('P2PAPI',['AsyncRequest','CreditCardFormParam','P2PActions','P2PAPIUtils','P2PPasswordProtectionParam','P2PPaymentCampaignNames','P2PTransferParam','ImmutableObject','URI','XP2PBannerDismissalsUpdateController','XP2PBannerStatesController','XP2PBannerViewsUpdateController','XP2PCardBINValidateController','XP2PCreditCardDeleteController','XP2PCreditCardUpdateController','XP2PCreditCardCreateController','XP2PCreditCardVerifyController','XP2PCreditCardsController','XP2PExtensiveTransferDetailsController','XP2PFriendPickerController','XMoneypennyPaymentsCreateController','XP2PPasswordProtectionStatusController','XP2PPasswordProtectionStatusUpdateController','XP2PPresetCreditCardSetController','XP2PProductItemBannerController','XP2PTransactionsCampaignCreateController','XP2PTransactionsCancelController','XP2PTransactionsCreateController','XP2PTransactionsController','XP2PTransactionsDeclineController','XP2PUserEligibilityController','emptyFunction','isEmpty'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na){if(c.__markCompiled)c.__markCompiled();'use strict';var oa=Object.assign||function(qa){for(var ra=1;ra<arguments.length;ra++){var sa=arguments[ra];for(var ta in sa)if(Object.prototype.hasOwnProperty.call(sa,ta))qa[ta]=sa[ta];}return qa;},pa={getAllCreditCards:function(){var qa=y.getURIBuilder().getURI();new h().setURI(qa).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true).setHandler((function(ra){var sa=ra.getPayload();if(!sa.error)j.updateCreditCards(sa);}).bind(this)).send();},createTransaction:function(qa){var ra=ia.getURIBuilder().getURI(),sa={},ta=qa.formData,ua=qa.success||ma,va=qa.error||ma;sa[i.CREDENTIAL_ID]=ta[i.CREDENTIAL_ID];sa.amount=ta.amount;sa.receiver_id=ta.receiverId;sa.offline_threading_id=k.genOfflineThreadingID();sa.group_thread_fbid=ta.group_thread_fbid;new h().setData(sa).setMethod('POST').setURI(ra).setAllowCrossPageTransition(true).setHandler((function(wa){var xa=wa?wa.getPayload():{};if(xa.error){va(xa.error);}else{ua(xa);this.getAllCreditCards();}}).bind(this)).setErrorHandler((function(){va({message:k.getUncaughtErrorMessage()});}).bind(this)).send();},addCreditCard:function(qa){j.ignoreCreditCardChannelEvents();var ra=w.getURIBuilder().getURI().getPath(),sa=new p('/ajax/payment/token_proxy.php').addQueryData('tpe',ra);qa=k.prepareCardMutationData(qa);var ta=new o(qa);new h().setData(qa).setMethod('POST').setURI(sa).setHandler((function(ua){var va=ua.getPayload();if(!va.errors){ta=o.set(ta,va);j.addCreditCard(ta);if(va.isPreset)j.transferAccepted();}else j.addCreditCardError(oa({requestID:ta.requestID},va));j.allowCreditCardChannelEvents();}).bind(this)).setErrorHandler((function(){j.addCreditCardError({requestID:ta.requestID,errors:{general:{message:k.getUncaughtErrorMessage()}}});j.allowCreditCardChannelEvents();}).bind(this)).send();},getTransactions:function(qa){qa=qa||{};var ra={},sa=qa,ta=ja.getURIBuilder().getURI(),ua=new o(sa);if(sa.since)ra.since=sa.since;return new h().setData(ra).setURI(ta).setMethod('GET').setReadOnly(true).setHandler((function(va){var wa=va.getPayload();if(!wa.error){j.updateTransfers(wa);}else j.updateTransfersError(oa({requestID:ua.requestID},wa));}).bind(this)).setErrorHandler((function(){j.updateTransfersError({error:{message:k.getUncaughtErrorMessage()},requestID:ua.requestID});}).bind(this)).send();},getExtensiveTransferDetailsByID:function(qa){var ra=z.getURIBuilder().setString('id',qa).getURI();new h().setURI(ra).setMethod('GET').setReadOnly(true).setHandler((function(sa){var ta=sa.getPayload();if(!ta.error)j.extensiveTransferDetailsLoaded(ta);}).bind(this)).send();},getNUXTransactions:function(){var qa=new Date(),ra=Math.round(qa.setDate(qa.getDate()-15)/1000),sa=ja.getURIBuilder().getURI();return new h().setData({since:ra}).setURI(sa).setMethod('GET').setReadOnly(true).setHandler((function(ta){var ua=ta.getPayload();if(!ua.error)j.updateNUXTransfers(ua);}).bind(this)).send();},updatePresetCreditCard:function(qa){var ra=ea.getURIBuilder().getURI();new h().setData(qa).setURI(ra).setMethod('POST').setHandler((function(sa){var ta=sa.getPayload();if(!ta.error){j.updatePresetCreditCard(oa({},ta,{requestID:qa.requestID}));j.transferAccepted();}else j.updatePresetCreditCardError(oa({},ta,{requestID:qa.requestID}));}).bind(this)).setErrorHandler((function(){j.updatePresetCreditCardError({error:{message:k.getUncaughtErrorMessage()},requestID:qa.requestID});}).bind(this)).send();},updateCreditCard:function(qa){j.ignoreCreditCardChannelEvents();var ra=v.getURIBuilder().getURI().getPath(),sa=new p('/ajax/payment/token_proxy.php').addQueryData('tpe',ra);qa=k.prepareCardMutationData(qa);var ta=new o(qa);new h().setData(qa).setMethod('POST').setURI(sa).setHandler((function(ua){var va=ua.getPayload();if(!va.errors){j.updateCreditCard(ta);}else j.updateCreditCardError(oa({},va,{requestID:ta.requestID}));j.allowCreditCardChannelEvents();}).bind(this)).setErrorHandler((function(){j.updateCreditCardError({errors:{general:{message:k.getUncaughtErrorMessage()}},requestID:ta.requestID});j.allowCreditCardChannelEvents();}).bind(this)).send();},deleteCreditCard:function(qa){var ra=u.getURIBuilder().getURI();new h().setData(qa).setMethod('POST').setURI(ra).setHandler((function(sa){var ta=sa.getPayload();if(!ta.error){j.deleteCreditCard(oa({},ta,{requestID:qa.requestID}));}else j.deleteCreditCardError(oa({},ta,{requestID:qa.requestID}));}).bind(this)).setErrorHandler((function(){j.deleteCreditCardError({error:{message:k.getUncaughtErrorMessage()},requestID:qa.requestID});}).bind(this)).send();},getPasswordProtectionSetting:function(qa){var ra=ca.getURIBuilder().getURI(),sa=qa.success||ma,ta=qa.error||ma;new h().setURI(ra).setMethod('GET').setReadOnly(true).setHandler((function(ua){var va=ua?ua.getPayload():[];if(va.error){ta();}else sa(va);}).bind(this)).setErrorHandler((function(){ta();}).bind(this)).send();},setPasswordProtectionSetting:function(qa){var ra=da.getURIBuilder().getURI(),sa=qa.formData,ta=qa.success||ma,ua=qa.error||ma,va={};va[l.STATUS]=sa[l.STATUS];new h().setData(va).setURI(ra).setMethod('POST').setHandler((function(wa){var xa=wa?wa.getPayload():{};if(xa.error){ua(xa.error);}else ta();}).bind(this)).setErrorHandler((function(){ua();}).bind(this)).send();},declineTransaction:function(qa){var ra=ka.getURIBuilder().getURI(),sa=qa.formData,ta=qa.success||ma,ua=qa.error||ma,va={};va[n.TRANSFER_ID]=sa[n.TRANSFER_ID];new h().setData(va).setURI(ra).setMethod('POST').setHandler((function(wa){var xa=wa?wa.getPayload():{},ya={};if(xa.error){ua(xa.error);}else{ta();ya[n.TRANSFER_ID]=va[n.TRANSFER_ID];j.transferDeclined(ya);}}).bind(this)).setErrorHandler((function(){ua();}).bind(this)).send();},cancelTransaction:function(qa){var ra=ha.getURIBuilder().getURI(),sa=qa.formData,ta=qa.success||ma,ua=qa.error||ma,va={};va[n.TRANSFER_ID]=sa[n.TRANSFER_ID];new h().setData(va).setURI(ra).setMethod('POST').setHandler((function(wa){var xa=wa?wa.getPayload():{};if(xa.error){ua(xa.error);}else ta();}).bind(this)).setErrorHandler((function(){ua();}).bind(this)).send();},verifyCreditCard:function(qa){var ra=x.getURIBuilder().getURI().getPath(),sa=new p('/ajax/payment/token_proxy.php').addQueryData('tpe',ra);new h().setData(qa).setMethod('POST').setURI(sa).setHandler((function(ta){var ua=ta.getPayload();if(!ua.error){j.verifyCreditCard(oa({},ua,{requestID:qa.requestID}));}else j.verifyCreditCardError(oa({},ua,{requestID:qa.requestID}));}).bind(this)).setErrorHandler((function(){j.verifyCreditCardError({error:{message:k.getUncaughtErrorMessage()},requestID:qa.requestID});}).bind(this)).send();},validateBINNumber:function(qa){qa=qa||{};var ra=new o(qa),sa=t.getURIBuilder().setString('bin_number',qa.binNumber).getURI();return new h().setURI(sa).setMethod('GET').setReadOnly(true).setHandler((function(ta){var ua=ta.getPayload();if(!ua.error){j.binNumberValidated(oa({},ua,{requestID:qa.requestID}));}else j.binNumberValidatedError(oa({},ua,{requestID:ra.requestID}));}).bind(this)).send();},getUserEligibility:function(qa){qa=qa||{};var ra=la.getURIBuilder().setStringVector('user_ids',qa.userIDs).getURI();return new h().setURI(ra).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true).setHandler((function(sa){var ta=sa.getPayload();if(!ta.error)j.userEligibilityUpdated(ta);}).bind(this)).send();},getFriendsList:function(qa,ra){var sa=aa.getURIBuilder().setInt('limit',qa).setString('query',ra).getURI();return new h().setURI(sa).setMethod('GET').setReadOnly(true).setHandler((function(ta){var ua=ta.getPayload();if(!ua.error)j.friendsListUpdated(ua);}).bind(this)).send();},getBannerStates:function(){var qa=r.getURIBuilder().getURI();new h().setURI(qa).setMethod('GET').setReadOnly(true).setHandler((function(ra){var sa=ra.getPayload();if(!sa.error)j.bannerStatesUpdated(sa);}).bind(this)).send();},incrementBannerViews:function(qa){var ra=s.getURIBuilder().setString('banner_type',qa).getURI();new h().setMethod('POST').setURI(ra).send();},incrementBannerDismissals:function(qa){var ra;j.bannerDismissed(qa);ra=q.getURIBuilder().setString('banner_type',qa).getURI();new h().setMethod('POST').setURI(ra).send();},createMoneypennyTransfer:function(qa){var ra=ba.getURIBuilder().getURI();new h().setMethod('POST').setURI(ra).setData({item_id:qa.item_id,credential_id:qa.credential_id,amount:qa.amount,external_request_id:qa.external_request_id}).setHandler((function(sa){var ta=sa.getPayload();if(!ta.error){j.moneypennyTransferCreated(oa({},ta,{requestID:qa.requestID}));this.getAllCreditCards();}else j.moneypennyTransferCreatedError(oa({},ta,{requestID:qa.requestID}));}).bind(this)).setErrorHandler(function(){j.moneypennyTransferCreatedError({error:{message:k.getUncaughtErrorMessage()},requestID:qa.requestID});}).send();},createFinancialIncentivesTransfer:function(qa){var ra=ga.getURIBuilder().getURI(),sa=qa.success||ma,ta=qa.error||ma,ua={};ua[i.CREDENTIAL_ID]=qa.credential_id;ua.external_request_id=k.genOfflineThreadingID();ua.campaign_name=m.SEVIPER;new h().setData(ua).setURI(ra).setMethod('POST').setHandler(function(va){var wa=va.getPayload();if(wa.error){ta(wa.error);}else sa();}).send();},getProductItemBannerData:function(qa){qa=qa||{};var ra=fa.getURIBuilder().setString('other_user_id',qa.otherUserID).getURI();return new h().setURI(ra).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true).setHandler((function(sa){var ta=sa.getPayload();if(!ta.error&&!na(ta))j.productItemBannerUpdated(ta);}).bind(this)).send();}};f.exports=pa;},null);
__d('P2PUserEligibilityStore',['P2PActionConstants','EventEmitter','MercuryIDs','P2PAPI','P2PDispatcher'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m,n;'use strict';var o,p;m=i;n=m&&m.prototype;Object.assign(q,m);q.prototype=Object.create(m.prototype);q.prototype.constructor=q;q.__superConstructor__=m;function q(){n.constructor.call(this);p={};o=l.register(this.onEventDispatched.bind(this));}q.prototype.onEventDispatched=function(r){var s=r.data,t=r.type;switch(t){case h.USER_ELIGIBILITY_UDPATED:this.handleEligibilityUpdated(s);this.emit('change');break;}};q.prototype.getEligibilityByUserIDs=function(r){var s=[],t,u,v={};for(var w=0;w<r.length;w++){u=r[w];t=p[u];if(t===undefined){p[u]=false;s.push(u);}v[u]=p[u];}if(s.length)k.getUserEligibility({userIDs:s});return v;};q.prototype.getEligibilityByUserID=function(r){var s=this.getEligibilityByUserIDs([r]);return s[r];};q.prototype.getEligibilityByThreadID=function(r){return (this.getEligibilityByUserID(j.getUserIDFromThreadID(r)));};q.prototype.handleEligibilityUpdated=function(r){for(var s=0;s<r.length;s++)p[r[s].user_id]=r[s].p2p_eligible;};f.exports=new q();},null);
__d('P2PAmountUtils',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=10000,i={isAmountOverLegalLimit:function(j){return parseFloat(this.sanitizeAmount(j))>=h;},isAmountZero:function(j){return parseFloat(this.sanitizeAmount(j))===0;},isValidSendAmount:function(j){return !this.isAmountOverLegalLimit(j)&&!this.isAmountZero(j);},sanitizeAmount:function(j){return j.replace(/[^0-9\.]+/g,'');}};f.exports=i;},null);
__d('DOMP2PTrigger',['CurrentEnvironment','JSXDOM','P2PAmountUtils','P2PTriggersUtils','TransformTextToDOMMixin','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n={MAX_ITEMS:40,match:function(o){var p=k.getMatches(o);if(!p||!p.length)return false;var q=p[0];if(!j.isValidSendAmount(q))return false;var r=p.index;return {startIndex:r,endIndex:r+q.length,element:this._element(q)};},_element:function(o){return (i.a({href:"#",className:"_35i0"+(h.facebookdotcom?' '+"_4g4e":''),"data-p2p-trigger":o},o));}};f.exports=Object.assign(n,l);},null);
__d('p2pTriggerJSXDOMToString',['DOMEmoji','DOMEmote','DOMP2PTrigger','JSXDOM','transformTextToDOM'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m=function(n,o,p,q){var r=[];if(q)r.push(j);if(o)r.push(h);if(p)r.push(i);return (k.span(null,l(n,r)).innerHTML);};f.exports=m;},null);
__d('P2PTriggers.react',['DOM','Event','MercuryIDs','P2PActions','P2PUserEligibilityStore','StoreAndPropBasedStateMixin','React','nullthrows','p2pTriggerJSXDOMToString'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){if(c.__markCompiled)c.__markCompiled();'use strict';var q=n.PropTypes,r=n.createClass({displayName:'P2PTriggers',mixins:[m(l)],propTypes:{renderEmoji:q.bool,renderEmoticons:q.bool,text:q.string.isRequired,threadID:q.string.isRequired},getInitialState:function(){return {amount:''};},statics:{calculateState:function(s){var t=j.isGroupChat(s.threadID)||l.getEligibilityByThreadID(s.threadID);return {isThreadEligible:t};}},_clickListeners:null,componentDidMount:function(){this._clickListeners=[];this.bindClickListeners();},componentWillUnmount:function(){this.unbindClickListeners();},bindClickListeners:function(){var s=o(this._clickListeners);if(!s.length){var t=h.scry(n.findDOMNode(this),'[data-p2p-trigger]');for(var u=0,v=t.length;u<v;u++)s.push(i.listen(t[u],'click',this.handleTriggerClick));}},unbindClickListeners:function(){var s;if(this._clickListeners){for(var t=0,u=this._clickListeners.length;t<u;t++){s=this._clickListeners[t];if(s)s.remove();}this._clickListeners=[];}},componentDidUpdate:function(s,t){if(!t.isThreadEligible&&this.state.isThreadEligible)this.bindClickListeners();},getAmountFromTriggerClickEvent:function(s){var t=s.target.getAttribute('data-p2p-trigger')||'';return t.replace(/[^0-9\.]+/g,'');},handleTriggerClick:function(s){s.preventDefault();var t=this.getAmountFromTriggerClickEvent(s);this.setState({amount:t});this.openSendView();},openSendView:function(){k.chatSendViewOpened({threadID:this.props.threadID,amount:this.state.amount});},render:function(){var s=p(this.props.text,this.props.renderEmoji,this.props.renderEmoticons,this.state.isThreadEligible);return (n.createElement('span',{dangerouslySetInnerHTML:{__html:s}}));}});f.exports=r;},null);
__d('TextWithEntitiesAndP2P.react',['BaseTextWithEntities.react','Link.react','P2PTriggers.react','React'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();'use strict';var l=Object.assign||function(n){for(var o=1;o<arguments.length;o++){var p=arguments[o];for(var q in p)if(Object.prototype.hasOwnProperty.call(p,q))n[q]=p[q];}return n;},m=k.createClass({displayName:'TextWithEntitiesAndP2P',_renderText:function(n){return (k.createElement(j,{text:n,renderEmoticons:this.props.renderEmoticons,renderEmoji:this.props.renderEmoji,threadID:this.props.threadID}));},_renderRange:function(n,o){if(this.props.interpolator){return this.props.interpolator(n,o);}else return (k.createElement(i,{href:o.entity},n));},render:function(){return (k.createElement(h,l({},this.props,{textRenderer:this._renderText,rangeRenderer:this._renderRange,ranges:this.props.ranges,imageRanges:this.props.imageRanges,aggregatedRanges:this.props.aggregatedRanges,text:this.props.text})));}});f.exports=m;},null);
__d('getURLRanges',['URI','URLScraper'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();'use strict';function j(k,l){l=l||0;var m=i.match(k);if(!m)return [];var n=m;if(!/^[a-z][a-z0-9\-+.]+:\/\//i.test(m))n='http://'+m;if(!h.isValidURI(n))return [];l+=k.indexOf(m);var o=m.length,p=[{offset:l,length:m.length,entity:{url:n}}];return p.concat(j(k.substr(l+o),l+o));}f.exports=j;},null);
__d('MercuryMessageBody.react',['EmoticonsList','React','Link.react','P2PTriggersUtils','ReactComponentWithPureRenderMixin','SupportedEmoji','TextWithEntities.react','TextWithEntitiesAndP2P.react','URI','URLMatcher','cancelAnimationFrame','cx','fbt','getURLRanges','isFacebookURI','requestAnimationFrame'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){if(c.__markCompiled)c.__markCompiled();var x=Object.assign||function(aa){for(var ba=1;ba<arguments.length;ba++){var ca=arguments[ba];for(var da in ca)if(Object.prototype.hasOwnProperty.call(ca,da))aa[da]=ca[da];}return aa;},y=i.PropTypes,z=i.createClass({displayName:'MercuryMessageBody',mixins:[l],propTypes:{body:y.string,ranges:y.array,threadID:y.string},getInitialState:function(){return {richText:false};},_shouldRenderP2PTriggers:false,componentDidMount:function(){this._raf=w(this.setIsRichText);},targetBlankLinkInterpolator:function(aa,ba){if(ba.entity&&ba.entity.url){var ca=new p(ba.entity.url);if(v(ca)&&!ca.getFragment())ba.entity.url=ca.addQueryData({__mref:'message_bubble'}).toString();}return (i.createElement(j,{href:ba.entity.url,shimhash:ba.entity.shimhash,target:'_blank'},aa));},setIsRichText:function(){delete this._raf;var aa=this.props,ba=aa.body,ca=aa.ranges;ba=ba||'';this._shouldRenderP2PTriggers=!!(this.props.threadID&&k.canSeeTriggers(this.props.threadID)&&k.getMatches(ba));if(ca&&ca.length||h.noncapturingRegexp.test(ba)||m.findEmoji(ba)||q.match(ba)||this._shouldRenderP2PTriggers)this.setState({richText:true});},componentWillUnmount:function(){this._raf&&r(this._raf);},render:function(){var aa=this.props.body||'',ba;if(aa.startsWith('?OTR'))return (i.createElement('span',{className:"_89h"},t._("[encrypted message]")));aa=aa.replace(/\s+$/,'');if(aa.length===0)return null;if(!this.state.richText)return i.createElement('span',{className:this.props.className},aa);var ca=this.props.ranges;if(ca==undefined)ca=u(aa);ba={className:this.props.className,interpolator:this.targetBlankLinkInterpolator,text:aa,ranges:ca,renderEmoticons:true,renderEmoji:true};if(this._shouldRenderP2PTriggers){return (i.createElement(o,x({},ba,{threadID:this.props.threadID})));}else return (i.createElement(n,ba));}});f.exports=z;},null);
__d("XGamesGripperNoteUpdaterController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/async\/games\/gripper_note_viewed\/",{});},null,{});
__d('SidebarAppTickerResizer',['Animation','Arbiter','AsyncRequest','ChatSidebarActions','ChatSidebarStore','CSS','cx','debounce','DOMQuery','Event','SidebarType','SimpleDrag','TickerController','$','queryThenMutateDOM','XGamesGripperNoteUpdaterController'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){if(c.__markCompiled)c.__markCompiled();var w=1e-07,x=1,y=85,z=173,aa=300,ba=46,ca=90,da=82,ea=150;function fa(ga,ha,ia,ja,ka){'use strict';this.$SidebarAppTickerResizer1=u('pagelet_ticker');this.$SidebarAppTickerResizer2=u('pagelet_canvas_nav_content');this.$SidebarAppTickerResizer3=this.$SidebarAppTickerResizer1.parentNode;this.$SidebarAppTickerResizer4=ka;this.$SidebarAppTickerResizer2.style.height=ia;this.$SidebarAppTickerResizer5(ga,ha);if(ia===null)if(ja!==null){this.$SidebarAppTickerResizer6();this.$SidebarAppTickerResizer7(this.$SidebarAppTickerResizer8());}else i.subscribe('AppsDivebar/show-apps',this.$SidebarAppTickerResizer6.bind(this));if(!ka){this.$SidebarAppTickerResizer9();m.hide(ga);}i.subscribe('ChatSidebarDropdown/closeTicker',this.$SidebarAppTickerResizer9.bind(this));i.subscribe('ChatSidebarDropdown/openTicker',this.$SidebarAppTickerResizer10.bind(this));i.subscribe('sidebar/show',this.$SidebarAppTickerResizer11.bind(this));if(ja){var la=p.scry(document.body,'#pagelet_ticker')[0],ma=la&&la.parentNode,na,oa=function(){if(!m.shown(ma))return;var pa=c('XGamesGripperNoteUpdaterController').getURIBuilder().getURI();new j().setURI(pa).send();ja.show();if(na)na.unsubscribe();};if(ma&&m.shown(ma)){oa();}else na=i.subscribe('ticker/show',oa);}this.$SidebarAppTickerResizer12=o(this.$SidebarAppTickerResizer6.bind(this),200);q.listen(window,'resize',this.$SidebarAppTickerResizer12);i.inform('Ticker/resized');}fa.prototype.$SidebarAppTickerResizer11=function(){'use strict';t.show(this.$SidebarAppTickerResizer1);};fa.prototype.$SidebarAppTickerResizer6=function(ga){'use strict';v((function(){this.$SidebarAppTickerResizer13();}).bind(this),(function(){var ha=Math.round(parseFloat(this.$SidebarAppTickerResizer1.style.height));if(ha>Math.round(this.$SidebarAppTickerResizer14())||this.$SidebarAppTickerResizer15&&this.$SidebarAppTickerResizer15>x){var ia=this.$SidebarAppTickerResizer15/this.$SidebarAppTickerResizer16*100,ja=this.$SidebarAppTickerResizer17(0,this.$SidebarAppTickerResizer14()-ia);if(!(ga&&ga.type==='resize'))this.$SidebarAppTickerResizer18(ja);k.show();}}).bind(this));};fa.prototype.$SidebarAppTickerResizer14=function(){'use strict';if(!this.$SidebarAppTickerResizer4)return 0;if(l.getVisibleType()!==r.SIDEBAR)return ca;return Math.min(ca,(this.$SidebarAppTickerResizer16-this.$SidebarAppTickerResizer19-da)*100/this.$SidebarAppTickerResizer16);};fa.prototype.$SidebarAppTickerResizer5=function(ga,ha){'use strict';var ia=new s(ga);ia.subscribe('start',this.$SidebarAppTickerResizer20.bind(this));ia.subscribe(['update','end'],this.$SidebarAppTickerResizer21.bind(this));var ja=new s(ha);ja.subscribe('start',this.$SidebarAppTickerResizer20.bind(this));ja.subscribe('update',this.$SidebarAppTickerResizer22.bind(this));ja.subscribe('end',this.$SidebarAppTickerResizer23.bind(this));};fa.prototype.$SidebarAppTickerResizer20=function(ga,event){'use strict';this.$SidebarAppTickerResizer24=event.clientY;this.$SidebarAppTickerResizer13();this.$SidebarAppTickerResizer25();};fa.prototype.$SidebarAppTickerResizer13=function(){'use strict';this.$SidebarAppTickerResizer19=this.$SidebarAppTickerResizer2.offsetTop;this.$SidebarAppTickerResizer26=this.$SidebarAppTickerResizer1.offsetHeight;this.$SidebarAppTickerResizer16=this.$SidebarAppTickerResizer3.offsetHeight;this.$SidebarAppTickerResizer15=this.$SidebarAppTickerResizer2.offsetHeight;this.$SidebarAppTickerResizer27=this.$SidebarAppTickerResizer15;};fa.prototype.$SidebarAppTickerResizer25=function(){'use strict';m.addClass(this.$SidebarAppTickerResizer3,"_4vfq");};fa.prototype.$SidebarAppTickerResizer28=function(){'use strict';m.removeClass(this.$SidebarAppTickerResizer3,"_4vfq");};fa.prototype.$SidebarAppTickerResizer21=function(ga,event){'use strict';var ha=this.$SidebarAppTickerResizer15/this.$SidebarAppTickerResizer16*100,ia=this.$SidebarAppTickerResizer17(event.clientY-this.$SidebarAppTickerResizer24,this.$SidebarAppTickerResizer14()-ha);if(ga=='end'){this.$SidebarAppTickerResizer28();this.$SidebarAppTickerResizer18(ia);}k.show();};fa.prototype.$SidebarAppTickerResizer22=function(ga,event){'use strict';var ha=-this.$SidebarAppTickerResizer15,ia=this.$SidebarAppTickerResizer8()-this.$SidebarAppTickerResizer15,ja=this.$SidebarAppTickerResizer29(event.clientY-this.$SidebarAppTickerResizer24,ha,ia);this.$SidebarAppTickerResizer17(-ja,this.$SidebarAppTickerResizer14());this.$SidebarAppTickerResizer27=this.$SidebarAppTickerResizer15+ja;this.$SidebarAppTickerResizer27=Math.max(x,this.$SidebarAppTickerResizer27);this.$SidebarAppTickerResizer2.style.height=this.$SidebarAppTickerResizer27+'px';};fa.prototype.$SidebarAppTickerResizer23=function(ga,event){'use strict';var ha=this.$SidebarAppTickerResizer27,ia=this.$SidebarAppTickerResizer30(this.$SidebarAppTickerResizer27),ja=this.$SidebarAppTickerResizer17(this.$SidebarAppTickerResizer15-ia,this.$SidebarAppTickerResizer14());if(this.$SidebarAppTickerResizer15!=ia){this.$SidebarAppTickerResizer7(ia);this.$SidebarAppTickerResizer18(ja);}new h(this.$SidebarAppTickerResizer2).from('height',ha).to('height',ia).duration(aa).go();};fa.prototype.$SidebarAppTickerResizer17=function(ga,ha){'use strict';var ia=this.$SidebarAppTickerResizer26+ga,ja=ia/this.$SidebarAppTickerResizer16*100;ja=Math.max(w,Math.min(ha,ja));this.$SidebarAppTickerResizer1.style.height=ja+'%';if(ja!=w){m.removeClass(this.$SidebarAppTickerResizer1,'hidden_elem');this.$SidebarAppTickerResizer11();}return ja;};fa.prototype.$SidebarAppTickerResizer30=function(ga){'use strict';var ha=this.$SidebarAppTickerResizer31(),ia=this.$SidebarAppTickerResizer8();return ga<ia-ba?ga<ha-ba?x:ha:ia;};fa.prototype.$SidebarAppTickerResizer31=function(){'use strict';return y;};fa.prototype.$SidebarAppTickerResizer8=function(){'use strict';return z;};fa.prototype.$SidebarAppTickerResizer32=function(ga){'use strict';var ha=this.$SidebarAppTickerResizer8();return ga<0?x:ga>ha?ha:ga;};fa.prototype.$SidebarAppTickerResizer29=function(ga,ha,ia){'use strict';return ga<ha?ha:ga>ia?ia:ga;};fa.prototype.$SidebarAppTickerResizer18=function(ga){'use strict';new j('/ajax/feed/ticker/resize').setData({height:''+ga}).setMethod('POST').send();i.inform('Ticker/resized');};fa.prototype.$SidebarAppTickerResizer7=function(ga){'use strict';new j('/ajax/feed/apps/resize').setData({height:''+ga}).setMethod('POST').send();};fa.prototype.$SidebarAppTickerResizer33=function(ga){'use strict';var ha=this.$SidebarAppTickerResizer26,ia=this.$SidebarAppTickerResizer16*ga/100;new h(this.$SidebarAppTickerResizer1).from('height',ha).to('height',ia).duration(ea).ondone((function(){this.$SidebarAppTickerResizer1.style.height=ga+'%';this.$SidebarAppTickerResizer18(ga===0?'0.0':ga);k.show();}).bind(this)).go();};fa.prototype.$SidebarAppTickerResizer9=function(){'use strict';this.$SidebarAppTickerResizer13();this.$SidebarAppTickerResizer33(0);};fa.prototype.$SidebarAppTickerResizer10=function(){'use strict';this.$SidebarAppTickerResizer1.style.height='40px';t.show(this.$SidebarAppTickerResizer1,(function(){this.$SidebarAppTickerResizer13();var ga=(this.$SidebarAppTickerResizer16-this.$SidebarAppTickerResizer19-da-this.$SidebarAppTickerResizer15)*50/this.$SidebarAppTickerResizer16;this.$SidebarAppTickerResizer33(ga);}).bind(this));};f.exports=fa;},null);
__d('ChatAnimatedGifs',['URI'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i={shouldHideBody:function(j){if(!j.has_attachment)return false;for(var k=0;k<j.attachments.length;k++){var l=j.attachments[k];if(l.preview_url){var m=i.getRawUrlFromSafeUrl(l.preview_url);if(j.body==m)return true;}}return false;},getRawUrlFromSafeUrl:function(j){return new h(j).getQueryData().url;}};f.exports=i;},null);
__d('ChatPrivacyActionController',['ChatVisibility','JSLogger','PresencePrivacy'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=function(l,m){this._userID=l;this._logger=i.create('blackbird');this._getState=function(){if(h.isOnline())return j.allows(this._userID)?k.NORMAL:k.BLOCKED;return k.OFFLINE;};this._togglePrivacy=function(){var n=this._getState();switch(this._getState()){case k.OFFLINE:if(h.isOnline()){this._logger.error('tabs_already_online');break;}this._logger.log('tabs_go_online',{tab_id:this._userID});h.goOnline((function(){if(!j.allows(this._userID)){if(this._getState()!==k.BLOCKED)this._logger.error('privacy_action_controller_blocked_inconsistency');this._togglePrivacy();}}).bind(this));break;case k.BLOCKED:j.allow(this._userID);this._logger.log('tabs_unblock',{tab_id:this._userID});break;case k.NORMAL:j.disallow(this._userID);this._logger.log('tabs_block',{tab_id:this._userID});break;}};setTimeout((function(){var n=(function(){m&&m(this._getState());}).bind(this);n();this._subscribeToken=j.subscribe('privacy-changed',n);}).bind(this),0);};k.OFFLINE='offline';k.BLOCKED='blocked';k.NORMAL='normal';Object.assign(k.prototype,{togglePrivacy:function(){this._logger.log('gear_menu_toggle_privacy',{tab_id:this._userID});this._togglePrivacy();},destroy:function(){this._subscribeToken&&j.unsubscribe(this._subscribeToken);}});f.exports=k;},null);
__d('ChatDateBreak.react',['ChatConfig','React','Timestamp.react','cx','formatDate','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n=Object.assign||function(q){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var t in s)if(Object.prototype.hasOwnProperty.call(s,t))q[t]=s[t];}return q;},o=i.PropTypes,p=i.createClass({displayName:'ChatDateBreak',propTypes:{date:o.instanceOf(Date).isRequired},shouldComponentUpdate:function(q){return this.props.date.getTime()!==q.date.getTime();},render:function(){var q=this.props.date,r;if(h.get('webmessenger_chat_tab_redesign')){r=l(this.props.date,{today:'g:ia',withinWeek:'D g:ia',thisYear:'M jS, g:ia',older:'m/d/Y g:ia'});return (i.createElement('time',{className:m(this.props.className,"_5w-5")},i.createElement('span',{className:"_5w-6"},r)));}r=l(q,{today:'g:ia',withinWeek:'l g:ia',thisYear:'F jS, g:ia',older:'F j, Y g:i a'});var s=Math.round(q.getTime()/1000);return (i.createElement('div',n({},this.props,{className:m(this.props.className,"_5w-5")}),i.createElement('div',{className:"_5w-6"},i.createElement(j,{time:s,verbose:r,text:r}))));}});f.exports=p;},null);
__d('ChatAuthorPhotoBlock.react',['MercuryParticipants','React','cx','fbt','formatDate','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n=Object.assign||function(r){for(var s=1;s<arguments.length;s++){var t=arguments[s];for(var u in t)if(Object.prototype.hasOwnProperty.call(t,u))r[u]=t[u];}return r;},o=i.PropTypes,p=86400000,q=i.createClass({displayName:'ChatAuthorPhotoBlock',propTypes:{authorID:o.string.isRequired,className:o.string,hideName:o.bool,hidePhoto:o.bool,timestamp:o.number},getInitialState:function(){return {author:{id:null,name:'',href:'#',image_src:''}};},componentDidMount:function(){this.updateAuthor(this.props.authorID);},componentWillReceiveProps:function(r){if(r.authorID!=this.state.author.id)this.updateAuthor(r.authorID);},render:function(){return (i.createElement('div',n({},this.props,{className:m(this.props.className,"_5yt9")}),this.renderAuthorName(),this.renderAuthorPhoto(),this.props.children));},renderAuthorName:function(){if(!this.props.hideName)return (i.createElement('div',{className:"_5ys-",ref:'name'},this.state.author.name));},renderAuthorPhoto:function(){if(!this.props.hidePhoto){var r=null;if(this.props.timestamp){var s=this._getFormat(this.props.timestamp);r=l(new Date(this.props.timestamp),s);}var t=k._("{name} {time}",[k.param('name',this.state.author.name),k.param('time',r)]);return (i.createElement('a',{'aria-label':t,className:"_5ys_",'data-hover':'tooltip','data-tooltip-position':'left',href:this.state.author.href||'#',ref:'link'},i.createElement('img',{src:this.state.author.image_src,ref:'image'})));}},updateAuthor:function(r){h.get(r,(function(s){this.isMounted()&&this.setState({author:s});}).bind(this));},_getFormat:function(r){if(Date.now()-this.props.timestamp<p){return 'g:ia';}else if(new Date().getFullYear()===new Date(r).getFullYear()){return 'M jS, g:ia';}else return 'M j, Y g:ia';}});f.exports=q;},null);
__d('MessageBubbleMixin',['DOMDimensions','React'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();'use strict';var j=2,k={getInitialState:function(){return {bubbleWidth:null};},componentDidMount:function(){this._restyleBubble(this.props);},componentDidUpdate:function(l){if(l.maxWidth!==this.props.maxWidth||l.body!==this.props.body||!l.attachments&&this.props.attachments)this._restyleBubble(l);},_restyleBubble:function(l){if(this.props.attachments){this.setState({bubbleWidth:null});return;}var m=i.findDOMNode(this.refs.bubble);if(l.maxWidth!==this.props.maxWidth||h.getElementDimensions(m).width>this.props.maxWidth){var n=this.props.maxWidth;this.setState({bubbleWidth:n},this._shrinkBubble);return;}this._shrinkBubble();},_shrinkBubble:function(){var l=i.findDOMNode(this.refs.bubble),m=h.getElementDimensions(l).width,n=i.findDOMNode(this.refs.content),o=n?h.getElementDimensions(n).width+h.measureElementBox(i.findDOMNode(this.refs.contentWrapper),'width',true,false,false):0,p=o+j;if(o>0&&p<this.props.maxWidth&&m-p-this.getBoxWidth()>0)this.setState({bubbleWidth:p});}};f.exports=k;},null);
__d('ChatBubble.react',['ChatConfig','DOMDimensions','MercuryMessageBody.react','MessageBubbleMixin','React','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();'use strict';var o=Object.assign||function(s){for(var t=1;t<arguments.length;t++){var u=arguments[t];for(var v in u)if(Object.prototype.hasOwnProperty.call(u,v))s[v]=u[v];}return s;},p=l.PropTypes,q=null,r=l.createClass({displayName:'ChatBubble',mixins:[k],propTypes:{attachments:p.node,body:p.string,maxWidth:p.number.isRequired,threadID:p.string},_renderContent:function(){if(!this.props.body)return null;return (l.createElement('div',{className:"_d97",ref:'contentWrapper'},l.createElement('span',{className:"_5yl5",ref:'content'},l.createElement(j,{body:this.props.body,ranges:this.props.ranges,threadID:this.props.threadID}))));},render:function(){return (l.createElement('div',o({},this.props,{className:n("_5w1r"+(h.get('webmessenger_chat_tab_redesign')?' '+"_3_om":''),this.props.className),ref:'bubble',style:{maxWidth:this.props.maxWidth,width:this.state.bubbleWidth}}),this._renderContent(),this.props.attachments));},contentWraps:function(){var s=l.findDOMNode(this.refs.content),t=s.getClientRects(),u=i.getElementDimensions(s).height;return t&&t.length>1&&t[0].height<u;},getBoxWidth:function(){if(!q)q=i.measureElementBox(l.findDOMNode(this.refs.bubble),'width',true,true,false);return q;}});f.exports=r;},null);
__d('ChatMessage.react',['BootloadedComponent.react','ChatAnimatedGifs','ChatAuthorPhotoBlock.react','ChatBubble.react','ChatConfig','CSS','CurrentUser','ImmutableObject','JSResource','MercuryAttachment','MercuryAttachmentType','MercuryErrorInfo','MercuryIDs','MercuryMessageError.react','MercuryMessageInfo','MercuryShareStyleMap','MercuryThreads','MercuryDisplayTimeFilterMessageRenderer','React','XUISpinner.react','cx','isRTL','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da){if(c.__markCompiled)c.__markCompiled();'use strict';var ea=Object.assign||function(ia){for(var ja=1;ja<arguments.length;ja++){var ka=arguments[ja];for(var la in ka)if(Object.prototype.hasOwnProperty.call(ka,la))ia[la]=ka[la];}return ia;},fa=z.PropTypes,ga=z.createClass({displayName:'ChatMessage',propTypes:{message:fa.instanceOf(o).isRequired,maxBubbleWidth:fa.number.isRequired,onAttachmentLoad:fa.func,onStickerClick:fa.func},componentDidMount:function(){m.conditionClass(z.findDOMNode(this),"_2cnu",this.isOneLine());},isOneLine:function(){var ia=this.props.message;return (v.isInbound(ia)&&!this.refs.attachmentsInside&&this.refs.bubble&&!this.refs.bubble.contentWraps());},shouldComponentUpdate:function(ia,ja){return ia.message!==this.props.message;},render:function(){var ia=this.props.message,ja=q.get(ia).length>0,ka=v.isInbound(ia),la=t.isGroupChat(ia.thread_id),ma=ca(ia.body),na=s.hasErrorStatus(ia),oa="_5wd4"+(ka?' '+"_1nc7":'')+(!ka?' '+"_1nc6":'')+(ja?' '+"_2_-t":'')+(ka&&la?' '+"_5ysy":'')+(na?' '+"_1zcs":'')+(ma?' '+"direction_rtl":'')+(!ma?' '+"direction_ltr":'');if(l.get('webmessenger_chat_tab_redesign'))return (z.createElement('div',{className:da(this.props.className,oa)},this._renderInner(),this._renderUndertext()));return (z.createElement(j,ea({},this.props,{authorID:ia.author,className:da(this.props.className,oa),hideName:!ka||!la,hidePhoto:!ka,timestamp:ia.timestamp}),this._renderInner(),this._renderUndertext()));},_renderInner:function(){var ia=this.props.message;if(ia.is_filtered_content)return (z.createElement('div',{className:"_5wd9 _5wdc uiBoxYellow clearfix",ref:'inner'},y.renderFilteredContent(ia)));return (z.createElement('div',{className:"_5wd9",ref:'inner'},this._renderBubble(),this._renderAttachments('outside')));},_renderUndertext:function(){if(this.props.message.is_filtered_content)return null;return (z.createElement('div',{className:"_3ry4",ref:'undertext'},z.createElement(u,{className:"_5wda clearfix",message:this.props.message,ref:'status'}),this._renderSpoofWarning()));},_renderSpoofWarning:function(){return (this.props.message.is_spoof_warning?z.createElement(h,{bootloadPlaceholder:z.createElement('span',null),bootloadLoader:p('MercurySpoofWarning.react'),authorID:this.props.message.author,className:"_5wdb"}):null);},_getAttachmentPlaceholder:function(){return (z.createElement('div',{style:{padding:'20px',text_align:'center'}},z.createElement(aa,null)));},_renderAttachments:function(ia){var ja=this.props.message,ka=x.getForFBID(n.getID()).getThreadMetaNow(ja.thread_id),la=ka?ka.custom_like_icon:null,ma=ia=='inside'?'attachmentsInside':'attachmentsOutside',na=q.get(ja).filter(function(oa){var pa=q.isBubblePreferred(oa);if(!l.get('webmessenger_chat_tab_redesign'))pa=pa||ja.body;return pa&&ia==='inside'||!pa&&ia==='outside';});if(na.length>0)return (z.createElement(h,{bootloadPlaceholder:this._getAttachmentPlaceholder(),bootloadLoader:p('MercuryAttachments.react'),className:(ia==='outside'?"_3e7u":'')+(!!ja.body?' '+"_16ys":'')+(l.get('webmessenger_chat_tab_redesign')?' '+"_n4o":''),attachments:na,customLike:la,isChat:true,maxWidth:this.props.maxBubbleWidth,message:ja,onAttachmentLoad:this.props.onAttachmentLoad,onStickerClick:this.props.onStickerClick,ref:ma}));},_renderBubble:function(){var ia=this.props.message,ja=ia.body,ka=this._renderAttachments('inside'),la=v.isInbound(ia);if(i.shouldHideBody(ia))ja='';if(ja||ka)return (z.createElement('div',{className:"_5wde"+(l.get('webmessenger_chat_tab_redesign')?' '+"_n4o":'')},z.createElement(k,{attachments:ka,body:ja,className:"_5wdf"+(ha(ia,la)?' '+"_3okg":''),maxWidth:this.props.maxBubbleWidth,ranges:ia.ranges,ref:'bubble',threadID:ia.thread_id})));}});function ha(ia,ja){if(l.get('webmessenger_chat_tab_redesign'))return false;var ka=q.get(ia);if(!ia.body&&ka)return !ka.some(function(la){if(la.attach_type!==r.SHARE||!la.share)return false;var ma=w.getStyleFactory(la.share);if(ma){var na=ma.factory;return (na.requiresNoBubbleTail&&na.requiresNoBubbleTail(la,ja));}return false;});return true;}f.exports=ga;},null);
__d('MercuryLogMessage.react',['DOM','Event','ImmutableObject','MercuryLogMessageRenderer','MercuryConfig','MercuryLogMessageType','React','cx','fbt','emptyFunction','formatDate','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){if(c.__markCompiled)c.__markCompiled();'use strict';var t=Object.assign||function(w){for(var x=1;x<arguments.length;x++){var y=arguments[x];for(var z in y)if(Object.prototype.hasOwnProperty.call(y,z))w[z]=y[z];}return w;},u=n.PropTypes,v=n.createClass({displayName:'MercuryLogMessage',propTypes:{loadMoreMessages:u.func,maxWidth:u.number,message:u.instanceOf(j).isRequired,onImageLoad:u.func},getDefaultProps:function(){return {onImageLoad:q};},getInitialState:function(){return {messageText:null};},componentDidMount:function(){this.componentWillReceiveProps(this.props);},_renderErrorMessage:function(){return (n.createElement('a',{onClick:this._loadMoreMessages},p._("Show previous messages.")));},_loadMoreMessages:function(){var w=this.props.loadMoreMessages();if(w){this.setState({messageText:this._renderErrorMessage()});}else{var x=p._("Couldn't find previous messages.");this.setState({messageText:x});}},componentWillReceiveProps:function(w){if(w.message.log_message_type===m.SERVER_ERROR){this._loadMoreMessages();return;}k.renderText(w.message,(function(x){this.setState({messageText:x});}).bind(this));},shouldComponentUpdate:function(w,x){return (this.state.messageText!=x.messageText||w.maxWidth!==this.props.maxWidth);},componentDidUpdate:function(){var w=n.findDOMNode(this.refs.attachment);k.renderAttachmentLegacy(w,this.props.message);h.scry(w,'img').forEach((function(x){var y=i.listen(x,'load',(function(){this.props.onImageLoad(x);y.remove();}).bind(this));}).bind(this));},render:function(){return (n.createElement('div',t({},this.props,{className:s(this.props.className,"_5ye6"),style:t({},this.props.style,this._getStyle()),title:r(new Date(this.props.message.timestamp),'g:ia')}),l.ChatTabMessengerStyle?null:k.renderIcon(this.props.message),n.createElement('div',{className:"_5ye7"},l.ChatTabMessengerStyle?k.renderIcon(this.props.message):null,this.state.messageText),n.createElement('div',{className:"_5ye8",ref:'attachment'})));},_getStyle:function(){return this.props.maxWidth?{maxWidth:this.props.maxWidth}:null;}});f.exports=v;},null);
__d('ChatMessageGroup.react',['immutable','ImmutableObject','MercuryParticipants','ChatDateBreak.react','ChatMessage.react','cx','fbt','React','StoreAndPropBasedStateMixin'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){if(c.__markCompiled)c.__markCompiled();'use strict';var q=o.PropTypes,r=new i({name:'',href:'#',image_src:''}),s=o.createClass({displayName:'ChatMessageGroup',mixins:[p(j)],propTypes:{activeMessageID:q.string,author:q.string,hasDateBreak:q.bool,isCanonical:q.bool,isFromViewer:q.bool,isPageMessage:q.bool,maxBubbleWidth:q.number,messages:q.instanceOf(h.List).isRequired,onAttachmentLoad:q.func},statics:{calculateState:function(u){return {participants:t(u)};}},shouldComponentUpdate:function(u,v){return (this.props.activeMessageID!==u.activeMessageID||this.props.isFromViewer!==u.isFromViewer||!h.is(this.props.messages,u.messages)||!h.is(this.state.participants,v.participants));},render:function(){return (o.createElement('div',{className:"_4tdt"},this._renderProfileColumn(),this._renderName(),o.createElement('div',{className:"_4tdv"},this._renderMessages())));},_renderProfileColumn:function(){if(this.props.isFromViewer)return null;var u=this.state.participants.get(this.props.author)||r,v=n._("{name}",[n.param('name',u.name)]);return (o.createElement('div',{className:"_31o4"},o.createElement('a',{'aria-label':v,className:"_4tdw",'data-hover':'tooltip','data-tooltip-position':'left',href:u.href,ref:'link'},o.createElement('img',{src:u.image_src,ref:'image'}))));},_renderName:function(){if(this.props.isCanonical||this.props.isFromViewer)return null;var u=this.state.participants.get(this.props.messages.first().author);if(!u)return null;return (o.createElement('div',{className:"_4tdx"},u.short_name));},_renderMessages:function(){var u=this.props.messages.size,v=[];this.props.messages.forEach((function(w,x,y){var z=w.message_id===this.props.activeMessageID;if(z&&!(x===0&&this.props.hasDateBreak))v.push(o.createElement(k,{date:new Date(w.timestamp),key:'db:'+w.message_id}));v.push(o.createElement(l,{isFromViewer:this.props.isFromViewer,key:w.message_id,maxBubbleWidth:this.props.maxBubbleWidth,message:w,nextTimestamp:this._getNextTimestamp(y,u,x),onAttachmentLoad:this.props.onAttachmentLoad}));}).bind(this));return v;},_getNextTimestamp:function(u,v,w){return w<v-1?u.get(w+1).timestamp:this.props.nextTimestamp;}});function t(u){return h.Map().withMutations(function(v){u.readReceipts.forEach(function(w,x){v.set(x,j.getOrFetch(x));});v.set(u.author,j.getOrFetch(u.author));});}f.exports=s;},null);
__d('MessengerDomIDs',['uniqueID'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();'use strict';var i={CONVERSATION:h(),THREAD_INFO_PANEL:h()};f.exports=i;},null);
__d('MessageList.react',['immutable','MercuryActionType','MercuryIDs','MercuryMessageGroup','MercuryShareAttachmentRenderLocations','MessengerDomIDs','ReactComponentWithPureRenderMixin','React','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){if(c.__markCompiled)c.__markCompiled();'use strict';var q=o.PropTypes,r=1000*60*60,s=o.createClass({displayName:'MessageList',mixins:[n],propTypes:{DateBreak:q.func.isRequired,deliveryTimestamp:q.number.isRequired,isCanonical:q.bool,isPageMessage:q.bool,location:q.string.isRequired,LogMessage:q.func.isRequired,loadMoreMessages:q.func,MessageGroup:q.func.isRequired,messages:q.instanceOf(h.List).isRequired,onAttachmentLoad:q.func,readReceipts:q.instanceOf(h.OrderedMap).isRequired,viewer:q.string.isRequired},getInitialState:function(){return {activeMessageID:null,messageGroups:k.calculateMessageGroups(this.props.messages,this.props.location)};},componentWillReceiveProps:function(y){if(y.messages!==this.props.messages)this.setState({messageGroups:k.calculateMessageGroups(y.messages,y.location)});},render:function(){var y=this.props,z=y.DateBreak,aa=y.location,ba=y.LogMessage,ca=y.MessageGroup,da=[],ea=this.state.activeMessageID,fa=this.state.messageGroups,ga=fa.length,ha=this.props.readReceipts,ia=ha.last()||0,ja=j.getParticipantIDFromUserID(this.props.viewer);for(var ka=0;ka<ga;ka++){var la=ka>0?fa[ka-1]:null,ma=la&&la.length>0?la[la.length-1]:null,na=fa[ka],oa=na[0],pa=na[na.length-1],qa=false;if(!ma||oa.timestamp-ma.timestamp>r){qa=true;da.push(o.createElement(z,{date:new Date(oa.timestamp),key:'db:'+oa.message_id}));}if(oa.action_type==i.LOG_MESSAGE){da.push(o.createElement(ba,{className:aa===l.CHAT?"_5w0o":null,key:oa.message_id,loadMoreMessages:this.props.loadMoreMessages,message:oa,onImageLoad:this.props.onAttachmentLoad,viewer:this.props.viewer}));continue;}na=h.List(na);var ra=u(fa,ga,ka),sa=!w(ha,na,ra),ta=v(ia,pa),ua=x(this.props.deliveryTimestamp,pa);da.push(o.createElement(ca,{activeMessageID:t(ea,na),author:na.first().author,deliveryTimestamp:ua,hasDateBreak:qa,isCanonical:this.props.isCanonical,isFromViewer:ja===oa.author,isPageMessage:this.props.isPageMessage,key:'mg:'+oa.message_id,lastReadTimestamp:ta,maxBubbleWidth:this.props.maxBubbleWidth,messages:na,nextTimestamp:ra,onAttachmentLoad:this.props.onAttachmentLoad,onMessageDeselect:this._handleMessageDeselect,onMessageSelect:this._handleMessageSelect,readReceipts:sa?ha:h.OrderedMap()}));}return (o.createElement('div',{id:aa===l.MESSENGER?m.CONVERSATION:null},da));},_handleMessageDeselect:function(y){this.setState(function(z){return {activeMessageID:z.activeMessageID===y?null:z.activeMessageID};});},_handleMessageSelect:function(y){this.setState({activeMessageID:y});}});function t(y,z){return z.find(function(aa){return aa.message_id===y;})?y:null;}function u(y,z,aa){return aa<z-1?y[aa+1][0].timestamp:Infinity;}function v(y,z){return z.timestamp>y?y:Infinity;}function w(y,z,aa){return (z.isEmpty()||y.last()<z.first().timestamp||y.first()>=aa);}function x(y,z){return z.timestamp>y?y:Infinity;}f.exports=s;},null);
__d('ChatConversation.react',['ChatConfig','ChatDateBreak.react','ChatMessage.react','immutable','MercuryActionType','MercuryLogMessage.react','MercuryShareAttachmentRenderLocations','React','cx','invariant','ChatMessageGroup.react','MessageList.react'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();'use strict';var r,s;if(h.get('webmessenger_chat_tab_redesign')){r=c('ChatMessageGroup.react');s=c('MessageList.react');}var t=o.PropTypes,u=1000*60*60,v=o.createClass({displayName:'ChatConversation',propTypes:{contextBanner:t.object,isCanonical:t.bool.isRequired,loadMoreMessages:t.func,maxBubbleWidth:t.number.isRequired,messages:t.instanceOf(k.List).isRequired,onAttachmentLoad:t.func,onStickerClick:t.func,viewer:t.string.isRequired},componentWillReceiveProps:function(w){!(w.maxBubbleWidth===this.props.maxBubbleWidth)?q(0):undefined;},render:function(){if(h.get('webmessenger_chat_tab_redesign'))return (o.createElement('div',null,this.props.contextBanner,o.createElement(s,{DateBreak:i,deliveryTimestamp:0,isCanonical:this.props.isCanonical,location:n.CHAT,LogMessage:m,loadMoreMessages:this.props.loadMoreMessages,maxBubbleWidth:this.props.maxBubbleWidth,MessageGroup:r,messages:this.props.messages,onAttachmentLoad:this.props.onAttachmentLoad,readReceipts:k.OrderedMap(),viewer:this.props.viewer})));var w=this.props.messages.toArray(),x=[];for(var y=0;y<w.length;y++){var z=w[y],aa=y>0?w[y-1]:null;if(!aa||z.timestamp-aa.timestamp>u)x.push(o.createElement(i,{date:new Date(z.timestamp),key:'db:'+z.message_id}));if(z.action_type==l.LOG_MESSAGE){x.push(o.createElement(m,{className:"_5w0o",key:z.message_id,message:z,onImageLoad:this.props.onAttachmentLoad}));}else x.push(o.createElement(j,{key:z.message_id,message:z,maxBubbleWidth:this.props.maxBubbleWidth,onAttachmentLoad:this.props.onAttachmentLoad,onStickerClick:this.props.onStickerClick}));}return (o.createElement('div',null,this.props.contextBanner,x));}});f.exports=v;},null);
__d('MercuryTypingAnimation.react',['React','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();'use strict';var k=h.PropTypes,l=h.createClass({displayName:'MercuryTypingAnimation',propTypes:{color:k.oneOf(['light','dark'])},getDefaultProps:function(){return {color:'dark'};},render:function(){var m="_4a0v"+(this.props.color==='light'?' '+"_4a0w":'')+(this.props.color==='dark'?' '+"_4a0x":'');return (h.createElement('div',{className:j(this.props.className,m)},h.createElement('div',{className:"_4b0g"},h.createElement('div',{className:"_5pd7"}),h.createElement('div',{className:"_5pd7"}),h.createElement('div',{className:"_5pd7"}))));}});f.exports=l;},null);
__d('ChatTypingIndicator.react',['ChatAuthorPhotoBlock.react','ChatConfig','MercuryParticipants','MercuryTypingAnimation.react','ReactComponentWithPureRenderMixin','React','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p=m.PropTypes,q=m.createClass({displayName:'ChatTypingIndicator',mixins:[l],propTypes:{userID:p.string,showName:p.bool},render:function(){var r=this.props,s=r.userID,t=r.showName;if(i.get('webmessenger_chat_tab_redesign'))return (m.createElement('div',{className:"_4tdt"},this._renderPhoto(s),this._renderBubble()));return (m.createElement(h,{authorID:s,className:"_5wd4"+(' '+"_1nc7")+(t?' '+"_5ysy":''),hideName:!t},m.createElement('div',{className:"_5wd9"},m.createElement(k,{className:"_3e2s",ref:'bubble'}))));},getBubble:function(){return this.refs.bubble;},_renderBubble:function(){var r=this.props.showName;return (m.createElement('div',{className:"_4tdv"},m.createElement('div',{className:"_5wd4"+(' '+"_1nc7")+(' '+"_2cnu")+(r?' '+"_5ysy":'')},m.createElement('div',{className:"_5wd9"+(i.get('webmessenger_chat_tab_redesign')?' '+"_n4o":'')},m.createElement('div',{className:"_5w1r"+(' '+"_5wdf")+(' '+"_3_om")},m.createElement(k,{className:"_5x7x",ref:'bubble'}))))));},_renderPhoto:function(r){var s=j.getNow(r),t=o._("{name}",[o.param('name',s.name)]);return (m.createElement('div',{className:"_31o4"},m.createElement('a',{'aria-label':t,className:"_4tdw",'data-hover':'tooltip','data-tooltip-position':'left',href:s.href||'#',ref:'link'},m.createElement('img',{src:s.image_src,ref:'image'}))));}});f.exports=q;},null);
__d('ChatTypingIndicators.react',['ChatTypingIndicator.react','DOM','MercuryIDs','MercuryThreadInformer','MercuryTypingReceiver','MercuryParticipants','React','SubscriptionsHandler','TooltipData','createObjectFrom','emptyFunction','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){if(c.__markCompiled)c.__markCompiled();var t=n.PropTypes,u=n.createClass({displayName:'ChatTypingIndicators',propTypes:{indicatorClass:t.func,indicatorsWillShow:t.func,indicatorsDidShow:t.func,rootClassName:t.string,threadID:t.string.isRequired,viewer:t.string.isRequired},getDefaultProps:function(){return {indicatorClass:h,indicatorsWillShow:r,indicatorsDidShow:r};},getInitialState:function(){return {typingUserIDs:[]};},componentDidMount:function(){var v=k.getForFBID(this.props.viewer),w=l.getForFBID(this.props.viewer);this._subscriptions=new o();this._subscriptions.addSubscriptions(w.addRetroactiveListener('state-changed',this.typingStateChanged),v.subscribe('messages-received',this.messagesReceived));},componentWillReceiveProps:function(v){if(v.threadID!=this.props.threadID)this.setState({typingUserIDs:[]});},componentWillUpdate:function(v,w){if(w.typingUserIDs.length>0)this.props.indicatorsWillShow();},componentDidUpdate:function(){if(this.state.typingUserIDs.length>0)this.props.indicatorsDidShow();m.getMulti(this.state.typingUserIDs,(function(v){if(this.isMounted())this.state.typingUserIDs.forEach((function(w){var x=v[w],y=this.refs[w].getBubble();if(y)p.set(n.findDOMNode(y),this.renderTooltip(x.short_name),'above','left');}).bind(this));}).bind(this));},componentWillUnmount:function(){this._subscriptions.release();},render:function(){var v=j.isGroupChat(this.props.threadID);return (n.createElement('div',{className:this.props.rootClassName},this.state.typingUserIDs.map((function(w){return (this._renderTypingIndicator(w,!!v));}).bind(this))));},_renderTypingIndicator:function(v,w){var x=this.props.indicatorClass;return (n.createElement(x,{key:v,ref:v,showName:w,userID:v}));},renderTooltip:function(v){var w=i.create('span');n.render(n.createElement('span',null,s._("{name} is typing...",[s.param('name',v)])),w);return w;},typingStateChanged:function(v){if(this.props.threadID in v)this.setState({typingUserIDs:v[this.props.threadID].slice().sort()});},messagesReceived:function(v,w){if(this.props.threadID in w){var x=w[this.props.threadID],y=q(x.map(function(z){return z.author;}));this.setState({typingUserIDs:this.state.typingUserIDs.filter(function(z){return !y[z];}).sort()});}}});f.exports=u;},null);
__d('MercuryMessageList',['immutable','LogHistory','Map','setTimeoutAcrossTransitions'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();'use strict';var l=i.getInstance('mercury_message_list');function m(o){this.$MercuryMessageList1=h.List(o||[]);this.$MercuryMessageList2();}m.prototype.append=function(o){var p;this.$MercuryMessageList1=(p=this.$MercuryMessageList1).push.apply(p,o);this.$MercuryMessageList2();n('append',o);};m.prototype.prepend=function(o){var p;this.$MercuryMessageList1=(p=this.$MercuryMessageList1).unshift.apply(p,o);this.$MercuryMessageList2();n('prepend',o);};m.prototype.update=function(o){var p=o.filter((function(q){return this.contains(q);}).bind(this));if(p.length===0)return;this.$MercuryMessageList1=this.$MercuryMessageList1.withMutations((function(q){p.forEach((function(r){var s=this.$MercuryMessageList3.get(r.message_id);if(s!==undefined)q.set(s,r);}).bind(this));}).bind(this));n('update',p);};m.prototype.reorder=function(o){this.$MercuryMessageList1=h.List(o);this.$MercuryMessageList2();n('reorder',o);};m.prototype.at=function(o){return this.$MercuryMessageList1.get(o);};m.prototype.contains=function(o){return this.$MercuryMessageList3.has(o.message_id);};m.prototype.toArray=function(){return this.$MercuryMessageList1.toArray();};m.prototype.toMap=function(){return new j(h.Seq(this.$MercuryMessageList1).map(function(o){return [o.message_id,o];}));};m.prototype.$MercuryMessageList2=function(){this.$MercuryMessageList3=new j(h.Seq(this.$MercuryMessageList1).map(function(o,p){return [o.message_id,p];}));};function n(event,o){k(function(){l.debug(event,{messageIDs:o.map(function(p){return p.message_id;})});},0);}f.exports=m;},null);
__d('MercuryMessageStore',['MercuryAPIArgsSource','LogHistory','MercuryMessages','MercuryViewer','MercuryMessageList','SubscriptionsHandler','MercuryThreadInformer','MercuryThreadlistConstants','mixInEventEmitter','setImmediate','setTimeoutAcrossTransitions','MercuryThreads'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){if(c.__markCompiled)c.__markCompiled();'use strict';var s=Object.assign||function(x){for(var y=1;y<arguments.length;y++){var z=arguments[y];for(var aa in z)if(Object.prototype.hasOwnProperty.call(z,aa))x[aa]=z[aa];}return x;},t=c('MercuryThreads').get(),u=i.getInstance('mercury_message_store');function v(x,y,z){this.$MercuryMessageStore1=x;this.$MercuryMessageStore2=new l();this.$MercuryMessageStore3=z?j.getForFBID(z):j.get();this.$MercuryMessageStore4=1;this.$MercuryMessageStore5=null;this.$MercuryMessageStore6=0;this.$MercuryMessageStore7=y||o.RECENT_MESSAGES_LIMIT;this.$MercuryMessageStore8=z?n.getForFBID(z):n.get();this.$MercuryMessageStore9=new m();this.$MercuryMessageStore9.addSubscriptions(this.$MercuryMessageStore8.subscribe('messages-received',(function(aa,ba){return this.$MercuryMessageStore10(ba);}).bind(this)),this.$MercuryMessageStore8.subscribe('messages-updated',(function(aa,ba){return ba[this.$MercuryMessageStore1]&&this.$MercuryMessageStore11(ba[this.$MercuryMessageStore1]);}).bind(this)),this.$MercuryMessageStore8.subscribe('messages-reordered',(function(aa,ba){return ba[this.$MercuryMessageStore1]&&this.$MercuryMessageStore12();}).bind(this)));u.debug('constructed',{threadID:this.$MercuryMessageStore1});this.$MercuryMessageStore13();}v.prototype.setNewThreadID=function(x){this.$MercuryMessageStore14=x;};v.prototype.destroy=function(){this.$MercuryMessageStore9&&this.$MercuryMessageStore9.release();u.debug('destroyed',{threadID:this.$MercuryMessageStore1});};v.prototype.subscribe=function(x){return this.addRetroactiveListener('updated',x);};v.prototype.fetchMoreMessages=function(){if(this.hasFetchedAll())return false;this.$MercuryMessageStore13();return true;};v.prototype.hasFetchedAll=function(){if(this.$MercuryMessageStore3.hasLoadedExactlyNMessages(this.$MercuryMessageStore1,this.$MercuryMessageStore6)&&this.$MercuryMessageStore3.hasLoadedAllMessages(this.$MercuryMessageStore1))return true;return t.isNewEmptyLocalThread(this.$MercuryMessageStore1);};v.prototype.$MercuryMessageStore13=function(){var x=this.$MercuryMessageStore6+this.$MercuryMessageStore7*this.$MercuryMessageStore4;u.debug('fetching',{threadID:this.$MercuryMessageStore1,limit:x});this.$MercuryMessageStore3.getThreadMessagesRange(this.$MercuryMessageStore1,0,x,this.$MercuryMessageStore15.bind(this),null,h.MERCURY);if(this.$MercuryMessageStore4<10)this.$MercuryMessageStore4+=1;if(this.$MercuryMessageStore3.hasLoadedNMessages(this.$MercuryMessageStore1,x))q((function(){this.$MercuryMessageStore12();}).bind(this));};v.prototype.$MercuryMessageStore15=function(x){if(x&&x.length){this.$MercuryMessageStore5=x[0].timestamp;this.$MercuryMessageStore6=x.length;u.debug('fetched',{threadID:this.$MercuryMessageStore1,earliestMessageTimestamp:this.$MercuryMessageStore5,count:this.$MercuryMessageStore6});}else if(x&&!x.length&&!this.$MercuryMessageStore6)this.$MercuryMessageStore16(v.THREAD_IS_EMPTY);};v.prototype.$MercuryMessageStore10=function(x){var y=[],z=x[this.$MercuryMessageStore1];if(z&&z.length)y=y.concat(z);if(this.$MercuryMessageStore14){var aa=x[this.$MercuryMessageStore14];if(aa&&aa.length){y=y.concat(aa);this.$MercuryMessageStore14=null;}}if(y.length){this.$MercuryMessageStore2.append(y);this.$MercuryMessageStore6+=y.length;var ba=y.every(function(ca){return ca.author!=k.getID();});this.$MercuryMessageStore16(v.MESSAGES_RECEIVED,{allFromOthers:ba});}};v.prototype.$MercuryMessageStore11=function(x){this.$MercuryMessageStore2.update(this.$MercuryMessageStore3.getMessagesFromIDs(Object.keys(x)));this.$MercuryMessageStore17();this.$MercuryMessageStore16(v.MESSAGES_CHANGED);};v.prototype.$MercuryMessageStore12=function(){if(!this.$MercuryMessageStore5)return;this.$MercuryMessageStore2.reorder(this.$MercuryMessageStore3.getThreadMessagesSinceTimestamp(this.$MercuryMessageStore1,this.$MercuryMessageStore5));this.$MercuryMessageStore17();this.$MercuryMessageStore16(v.MESSAGES_REORDERED);};v.prototype.$MercuryMessageStore16=function(x,y){var z=this.$MercuryMessageStore2.toArray();this.releaseHeldEventType('updated');this.emitAndHold('updated',s({messages:z,eventType:x},y));w(this.$MercuryMessageStore1,x,z);};v.prototype.$MercuryMessageStore17=function(){var x=this.$MercuryMessageStore2.at(0);if(x)this.$MercuryMessageStore5=x.timestamp;};function w(x,y,z){r(function(){u.debug('update:'+y,{threadID:x,messageIDs:z.map(function(aa){return aa.message_id;})});},0);}Object.assign(v,{MESSAGES_FETCHED:'fetched',MESSAGES_CHANGED:'changed',MESSAGES_RECEIVED:'received',MESSAGES_REORDERED:'reordered',THREAD_IS_EMPTY:'thread-is-empty'});p(v,{updated:true});f.exports=v;},null);
__d('ChatTabMessagesView',['Animation','Arbiter','BanzaiLogger','CSS','ChatConversation.react','ChatPerfInstrumentation','ChatTabViewEvents','ChatTypingIndicators.react','ChatWelcomeMessage','CurrentUser','DOM','Event','immutable','MercuryLastMessageIndicator.react','LiveTimer','MercuryIDs','MercuryViewer','MercuryMessageStore','MessengerContextBannerBootloader','MessengerHotLikePreviewEvents','React','ReactComponentRenderer','MercuryShareAttachmentRenderLocations','Scroll','ServerTime','StickerActions','StickerState','StickerStoreController','Style','SubscriptionsHandler','UserAgent_DEPRECATED','arrayContains','getElementPosition','throttle'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa){if(c.__markCompiled)c.__markCompiled();'use strict';var pa=64,qa=null,ra=20;function sa(ua){if(qa===null){var va=ua.childNodes[0];ja.set(ua,'overflow','scroll');qa=va.clientWidth-pa;ja.set(ua,'overflow','');}return qa;}function ta(ua,va,wa,xa,ya,za,ab,bb,cb){this.loadingIcon=ya;this.threadID=ua;this.sheetController=va;this.scrollContainer=wa;this.conversationElem=xa;this.contextBannerEligible=cb;this.contextBannerElem=null;this.tabView=bb;v.restart(fa.get()/1000);this._loadingMoreMessages=false;this._initialLoadFinished=false;function db(){n.inform('interaction-with-tab',ua);}this._subscriptions=new ka();this._subscriptions.addSubscriptions(i.subscribe('overflow-applied-to-body',this.scrollToBottom.bind(this)),s.listen(this.scrollContainer,'mousedown',db));if(la.firefox()){var eb='WheelEvent' in window?'wheel':'DOMMouseScroll';this.scrollContainer.addEventListener(eb,db,false);}else this._subscriptions.addSubscriptions(s.listen(this.scrollContainer,'mousewheel',db));this._subscriptions.addSubscriptions(s.listen(this.scrollContainer,'scroll',oa(this.scrolling,50,this)));var fb;ba.render(ba.createElement(o,{threadID:this.threadID,indicatorsWillShow:(function(){return (fb=this.isScrolledToBottom());}).bind(this),indicatorsDidShow:(function(){return (fb&&this.scrollToBottom(true));}).bind(this),viewer:q.getID()}),ab);var gb;this.lastMessageIndicatorNode=za;this.lastMessageIndicator=ba.render(ba.createElement(u,{threadID:this.threadID,hideTyping:true,indicatorWillShow:(function(){return (gb=this.isScrolledToBottom());}).bind(this),indicatorDidShow:(function(){return (gb&&this.scrollToBottom(true));}).bind(this)}),this.lastMessageIndicatorNode);this.initializeConversation();}Object.assign(ta.prototype,{initializeConversation:function(){this._store=new y(this.threadID);this._conversation=new ca(l,this.conversationElem);this._conversation.setProps({isCanonical:w.isCanonical(this.threadID),loadMoreMessages:this._loadMoreMessages.bind(this),maxBubbleWidth:sa(this.scrollContainer),messages:t.List(),onAttachmentLoad:(function(ua){var va=this.scrollContainer,wa=ea.getTop(va)+va.clientHeight;if(wa+ua>=va.scrollHeight)this.scrollToBottom();}).bind(this),onStickerClick:this._onStickerClick.bind(this),viewer:q.getID()});this._subscriptions.addSubscriptions(this._store.subscribe(this._updateMessageFromStore.bind(this)),aa.addListener(aa.START,(function(ua,va){if(this.threadID!==va)return;this._likePreview=ua;this._conversation.setProps({messages:this._getNormalizedMessages()},this.scrollToBottom.bind(this));this.scrollToBottom();clearInterval(this._scrollToBottomInterval);this._scrollToBottomInterval=setInterval(this.scrollToBottom.bind(this),50);}).bind(this)),aa.addListener(aa.STOP,(function(ua){if(this.threadID!==ua)return;this._likePreview=null;}).bind(this)),aa.addListener(aa.FINISH_ANIMATION,(function(ua){clearInterval(this._scrollToBottomInterval);}).bind(this)),aa.addListener(aa.REMOVE,(function(ua){if(this.threadID!==ua)return;clearInterval(this._scrollToBottomInterval);this._likePreview=null;this._conversation.setProps({messages:this._getNormalizedMessages()});}).bind(this)));},_updateMessageFromStore:function(ua){if(ua.eventType==y.MESSAGES_RECEIVED&&ua.allFromOthers&&!this.isScrolledToBottom()){this.sheetController.openNewMessagesSheet();this._newMessagesSheetOpened=true;}if(ua.eventType==y.MESSAGES_REORDERED){this._loadingMoreMessages=false;k.hide(this.loadingIcon);}var va=this.isScrolledToBottom(),wa=this._getLoadingHeight(),xa=this.scrollContainer.scrollHeight,ya=ea.getTop(this.scrollContainer);this._messages=ua.messages;var za=p.getWelcomeMessage(this.threadID);if(za)this._messages.push(za);this._conversation.setProps({messages:this._getNormalizedMessages()},(function(){if(va||this._shouldScrollToBottom){this.scrollToBottom();this.setShouldScrollToBottom(false);}else if(ua.eventType==y.MESSAGES_REORDERED)this.scrollToPosition(this.scrollContainer.scrollHeight-xa-wa+ya);if(!this._initialLoadFinished){this._initialLoadFinished=true;m.logCHAT_CONVERSATION_TTI();}if(this._store.hasFetchedAll()&&this.contextBannerEligible)this.renderContextBanner(this.threadID);}).bind(this));this.lastMessageIndicator.setProps({lastMessage:this._messages.length>0?this._messages[this._messages.length-1]:null});if(ua.eventType==y.MESSAGES_RECEIVED&&this._shouldShowStickerReplyNUX(this._messages)&&this.tabView&&this.tabView.isFocused())this.tabView.showStickerReplyNUX();if(ua.eventType==y.MESSAGES_CHANGED)this._checkToAnimateSticker();},setShouldScrollToBottom:function(ua){this._shouldScrollToBottom=ua;},scrolling:function(){this._checkToAnimateSticker();if(this.isScrolledNearTop()&&!this._loadingMoreMessages&&!this.isScrolledToBottom()&&!this.tabView._isDragDropActive)if(this._store.fetchMoreMessages()){k.show(this.loadingIcon);this._loadingMoreMessages=true;}if(!this._newMessagesSheetOpened)return;if(this.isScrolledToBottom()){this.sheetController.closeNewMessagesSheet();this._newMessagesSheetOpened=false;}},getScrollTop:function(){return this.scrollContainer&&ea.getTop(this.scrollContainer);},destroy:function(){r.scry(this.conversationElem,'.stickerContainer').forEach(function(ua){return ba.unmountComponentAtNode(ua);});this.unmountContextBanner();ba.unmountComponentAtNode(this.conversationElem);this._subscriptions&&this._subscriptions.release();ba.unmountComponentAtNode(this.lastMessageIndicatorNode);delete this.lastMessageIndicator;this._store&&this._store.destroy();this.destroyed=true;},_getLoadingHeight:function(){return this.loadingHeight||this.loadingIcon.clientHeight;},_shouldShowStickerReplyNUX:function(ua){if(!ha.shouldShowStickerReplyNUX()||!ua.length)return false;var va=ua[ua.length-1];if(va.author===x.getID())return false;if(va.has_attachment)return va.attachments.some(function(wa){return wa.attach_type==='sticker';});return false;},isScrolledToBottom:function(ua){var va=this.scrollContainer;ua=ua||ra;return ea.getTop(va)+va.clientHeight>=va.scrollHeight-ua;},isScrolledNearTop:function(){return ea.getTop(this.scrollContainer)<this.scrollContainer.clientHeight;},scrollToBottom:function(ua){this.scrollToPosition(this.scrollContainer.scrollHeight,ua);},scrollToPosition:function(ua,va){this._scrollTopAnimation&&this._scrollTopAnimation.stop();if(va===true){this._scrollTopAnimation=new h(this.scrollContainer).to('scrollTop',ua).ease(h.ease.end).duration(400).go();}else ea.setTop(this.scrollContainer,ua);},_loadMoreMessages:function(){return this._store.fetchMoreMessages();},_onStickerClick:function(ua,va){if(!ua)return;j.log('StickersLoggerConfig',{event:'click_sticker',packid:ua,stickerid:va});var wa=this.tabView;ha.onTrayDataReady(function(){if(ma(ha.getPackIDsInTray(),ua)){var xa=ha.getPack(ua);if(xa&&xa.isPromoted)ga.addPack(ua);wa.setStickersFlyoutPackID(ua);}else ia.showStore(ua);});},_checkToAnimateSticker:function(){var ua=na(this.scrollContainer);i.inform('chatScrolled/'+this.threadID,{scrollTop:ea.getTop(this.scrollContainer),top:ua.y,viewHeight:ua.height});},setNewThreadID:function(ua){this._store.setNewThreadID(ua);},_getNormalizedMessages:function(){if(this._likePreview){this._messages.push(this._likePreview);}else this._messages=this._messages.filter(function(ua){return !ua.is_like_preview;});return t.List(this._messages);},renderContextBanner:function(ua,va){z.getBootloadedComponent(ua,da.CHAT,(function(wa){ja.set(this.conversationElem,'padding-top','80px');this._conversation.setProps({contextBanner:wa});}).bind(this),va,(function(wa){ja.set(this.conversationElem,'padding-top',wa+'px');}).bind(this));},unmountContextBanner:function(){if(this._conversation)this._conversation.setProps({contextBanner:null});}});f.exports=ta;},null);
__d('ChatTabOfficeStatus',['fbt','formatDate','CSS'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();'use strict';var k=1,l=2,m=3,n={update:function(o,p){if(!o||!p||!p.officeStatus)return;this._updateIcon(o,p);this._updateTooltip(o,p);},_updateIcon:function(o,p){j.removeClass(o,'officeStatusNone');j.removeClass(o,'officeStatusAvailable');j.removeClass(o,'officeStatusSporadic');j.removeClass(o,'officeStatusOutOfOffice');switch(p.officeStatus){case k:j.addClass(o,'officeStatusAvailable');break;case l:j.addClass(o,'officeStatusSporadic');break;case m:j.addClass(o,'officeStatusOutOfOffice');break;default:j.addClass(o,'officeStatusNone');break;}},_updateTooltip:function(o,p){var q='';switch(p.officeStatus){case k:q+=h._("AVAILABLE");q+='\n';break;case l:q+=h._("SPORADIC");q+='\n';break;case m:q+=h._("OFF THE GRID");q+='\n';break;default:q+=h._("UNKNOWN");q+='\n';break;}if(p.officeStatusComment)q+=p.officeStatusComment;if(p.officeStatusLocation)q+=' ('+p.officeStatusLocation+')';if(p.officeStatusComment||p.officeStatusLocation)q+='\n';if(p.officeStatusEndDate){var r=i(p.officeStatusEndDate,'M d, Y');q+=h._("Until {date}",[h.param('date',r)]);}o.setAttribute('aria-label',q);o.setAttribute('data-hover','tooltip');}};f.exports=n;},null);
__d('ChatAddToThreadButton.react',['Link.react','ReactComponentWithPureRenderMixin','React','TrackingNodes','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();'use strict';var n=j.PropTypes,o=j.createClass({displayName:'ChatAddToThreadButton',mixins:[i],propTypes:{isFBAtWork:n.bool,onClick:n.func,shown:n.bool},render:function(){var p=this.props.isFBAtWork?m._("Add more co-workers to chat"):m._("Add more friends to chat"),q=k.getTrackingInfo(k.types.ADD_TO_THREAD);return (j.createElement(h,{'aria-label':p,className:"addToThread"+(' '+"button")+(!this.props.shown?' '+"hidden_elem":''),'data-ft':q,'data-hover':'tooltip','data-tooltip-alignv':'top',onClick:this.props.onClick}));}});f.exports=o;},null);
__d('ChatArchiveWarning.react',['Image.react','ReactComponentWithPureRenderMixin','React','cx','ix'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();'use strict';var m=j.PropTypes,n=j.createClass({displayName:'ChatArchiveWarning',mixins:[i],propTypes:{isFBAtWork:m.bool,shown:m.bool},render:function(){var o=this.props.isFBAtWork?l('images/chat/tab/archive-grey.png'):l('images/chat/tab/archive.png');return (j.createElement(h,{src:o,className:"titanArchiveWarning"+(' '+"button")+(!this.props.shown?' '+"hidden_elem":''),'data-hover':'tooltip','data-tooltip-alignh':'center','aria-label':'All employee-to-employee conversations will be archived'}));}});f.exports=n;},null);
__d('ChatCloseButton.react',['Link.react','ReactComponentWithPureRenderMixin','React','TrackingNodes','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();'use strict';var m=j.PropTypes,n=j.createClass({displayName:'ChatCloseButton',mixins:[i],propTypes:{onClick:m.func,onKeyUp:m.func,onMouseDown:m.func,active:m.bool},getDefaultProps:function(){return {active:false};},render:function(){var o=k.getTrackingInfo(k.types.CLOSE_BUTTON),p=l._("Press Esc to close"),q=l._("Close tab");return (j.createElement(h,{'aria-label':this.props.active?p:q,className:'close button','data-ft':o,'data-hover':'tooltip','data-tooltip-position':'above',onClick:this.props.onClick,onKeyUp:this.props.onKeyUp,onMouseDown:this.props.onMouseDown}));}});f.exports=n;},null);
__d('ChatPhotoUploader.react',['Bootloader','Image.react','InlineBlock.react','Link.react','MercuryConfig','Promise','React','SubscriptionsHandler','cx','emptyFunction','fbt','ix','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){if(c.__markCompiled)c.__markCompiled();'use strict';var u=n.PropTypes,v=n.createClass({displayName:'ChatPhotoUploader',propTypes:{actionURI:u.string,allowCrossPage:u.bool,disabled:u.bool,imageClassName:u.string,imagesOnly:u.bool,linkClassName:u.string,onSubmit:u.func,onAllUploadsComplete:u.func,onLastUploadFail:u.func,onLastUploadCancel:u.func,onUploadError:u.func},getDefaultProps:function(){return {actionURI:l.upload_url,allowCrossPage:true,disabled:false,imageClassName:"_509w",imagesOnly:true,linkClassName:'',onSubmit:q,onAllUploadsComplete:q,onLastUploadFail:q,onLastUploadCancel:q};},shouldComponentUpdate:function(w,x){return w.actionURI!=this.props.actionURI||w.disabled!==this.props.disabled;},componentDidUpdate:function(w,x){if(this._uploader)this._uploader.setAllowCrossPage(this.props.allowCrossPage);},componentWillUnmount:function(){if(!this.isUploading()||!this.props.allowCrossPage)this._cleanup();},render:function(){var w=this.props.imagesOnly?r._("Add Photos"):r._("Add Files");return (n.createElement('form',{action:this.props.actionURI,className:"_vzk",title:w,method:'post',onClick:(function(x){x.stopPropagation();if(this.props.disabled)x.preventDefault();}).bind(this),ref:'form'},n.createElement('input',{type:'hidden',name:'attach_id',ref:'attachID'}),n.createElement('input',{type:'hidden',name:'images_only',value:this.props.imagesOnly}),n.createElement(j,{onClick:this._bootloadChatAutoSendPhotoUploader,className:"_m _4q60 _3rzn"},n.createElement(k,{className:t("_4q61 _5f0v _509v",this.props.linkClassName)},n.createElement(i,{className:this.props.imageClassName,src:s('/images/chat/chat_camera_icon.png'),alt:r._("Camera")})),n.createElement('input',{disabled:this.props.disabled,type:'file',className:"_n",name:'attachment[]',multiple:'true',accept:this.props.imagesOnly?'image/*':'*',ref:'input',title:w}))));},_handleSubmit:function(w,x){this.props.onSubmit(w,x);},_handleAllUploadsCompleted:function(w,x){this.props.onAllUploadsComplete(w,x);if(!this.isMounted())this._cleanup();},_handleLastUploadFailed:function(w,x){this.props.onLastUploadFail(w,x);if(!this.isMounted())this._cleanup();},_handleLastUploadCanceled:function(w,x){this.props.onLastUploadCancel(w,x);if(!this.isMounted())this._cleanup();},_handleUploadError:function(){this.props.onUploadError();if(!this.isMounted())this._cleanup();},isUploading:function(){return (this._uploader&&this._uploader.isUploading()||this._uploaderPromiseIsResolving);},_bootloadChatAutoSendPhotoUploader:function(){if(!this._uploaderPromise){this._uploaderPromiseIsResolving=true;this._uploaderPromise=new m((function(w){h.loadModules(["ChatAutoSendPhotoUploader"],(function(x){this._uploaderPromiseIsResolving=false;this._uploader=new x(n.findDOMNode(this.refs.form),n.findDOMNode(this.refs.input),n.findDOMNode(this.refs.attachID));this._uploader.setAllowCrossPage(this.props.allowCrossPage);this._subscriptions=new o();this._subscriptions.addSubscriptions(this._uploader.subscribe('submit',this._handleSubmit),this._uploader.subscribe('all-uploads-completed',this._handleAllUploadsCompleted),this._uploader.subscribe('last-upload-failed',this._handleLastUploadFailed),this._uploader.subscribe('last-upload-canceled',this._handleLastUploadCanceled),this._uploader.subscribe('file-upload-error',this._handleUploadError));w(this._uploader);}).bind(this));}).bind(this));}return this._uploaderPromise;},uploadFile:function(w){this._bootloadChatAutoSendPhotoUploader().then(function(x){x.uploadFile(w);});},uploadURL:function(w){this._bootloadChatAutoSendPhotoUploader().then(function(x){x.uploadURL(w);});},_cleanup:function(){this._subscriptions&&this._subscriptions.release();this._uploader&&this._uploader.destroy();}});f.exports=v;},null);
__d('StickerContextualDialog.react',['ContextualLayerAutoFlipHorizontal','ReactAbstractContextualDialog','ReactLayer','cx'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();'use strict';var l=47,m=j.createClass(i.createSpec({addedBehaviors:[h],displayName:'StickerXUIContextualDialog',theme:{wrapperClassName:"_53ii",arrowDimensions:{offset:l,length:16}}}));m.WIDTH={NORMAL:312,WIDE:400};f.exports=m;},null);
__d('ChatStickerButton.react',['BootloadedComponent.react','Link.react','JSResource','ReactComponentWithPureRenderMixin','React','ReactLayeredComponentMixin','StickerActions','StickerContextualDialog.react','StickerStateStore','StoreAndPropBasedStateMixin','XUISpinner.react','cx','emptyFunction','fbt','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){if(c.__markCompiled)c.__markCompiled();'use strict';var w=l.PropTypes,x=278,y=l.createClass({displayName:'ChatStickerButton',_clickGuard:false,mixins:[k,m,q(p)],propTypes:{className:w.string,ContextualDialogClass:w.func.isRequired,disabled:w.bool,flyoutClassName:w.string,flyoutWidth:w.number,onStickerSelect:w.func.isRequired,onEmoticonSelect:w.func.isRequired,onFlyoutShown:w.func,onFlyoutHidden:w.func,threaadID:w.string},statics:{calculateState:function(z){var aa=p.getState();return {shown:aa.showTray&&z.threadID===aa.threadID};}},getDefaultProps:function(){return {ContextualDialogClass:o,disabled:false,flyoutWidth:x,onStickerSelect:t,onEmoticonSelect:t};},componentWillUnmount:function(){if(this.state.shown)this._hideFlyout();},render:function(){return (l.createElement(i,{className:v(this.props.className,this.state.shown?"open":''),onClick:this.showFlyout,onMouseDown:this._prepareForClick,title:u._("Choose a sticker or emoticon"),ref:'link'},l.createElement('i',{className:"_4l9x"})));},renderLayers:function(){var z=this.props.ContextualDialogClass;return {contextualDialog:l.createElement(z,{alignment:this.props.flyoutAlignment,className:"_5e-r",contextRef:(function(){return this.refs.link;}).bind(this),onBlur:this._hideFlyout,position:'above',shown:this.state.shown,width:this.props.flyoutWidth},l.createElement(h,{bootloadPlaceholder:l.createElement('div',{style:{padding:'30px',textAlign:'center'}},l.createElement(r,{size:'large'})),bootloadLoader:j('StickersFlyout.react'),className:this.props.flyoutClassName,onShown:(function(aa){if(this.props.onFlyoutShown)this.props.onFlyoutShown(aa);}).bind(this),onHidden:(function(){if(this.props.onFlyoutHidden)this.props.onFlyoutHidden();}).bind(this),onEscKeyDown:this._hideFlyout,onStickerSelect:this._handleStickerSelected,onEmoticonSelect:this._handleEmoticonSelected,shown:this.state.shown}))};},_prepareForClick:function(){this._clickGuard=this.state.shown;},showFlyout:function(z){z&&z.stopPropagation();if(this._clickGuard||this.props.disabled){this._clickGuard=false;return;}n.showStickerTray(this.props.threadID);},_hideFlyout:function(){n.hideStickerTray();},_handleStickerSelected:function(z){this.props.onStickerSelect(z);},_handleEmoticonSelected:function(z){this._hideFlyout();this.props.onEmoticonSelect(z);}});f.exports=y;},null);
__d('ChatFileUploaderMixin',['SubscriptionsHandler','React'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=i.PropTypes,k={propTypes:{attachmentsShelf:j.object,onFileUploaderMounted:j.func,onUploadFinished:j.func,onUpdateAttachmentsShelf:j.func,onSubmit:j.func},setUpSubscriptionsHandler:function(l){this._uploader=l;this._subscriptions=new h();this._subscriptions.addSubscriptions(this._uploader.subscribe(['all-uploads-completed','upload-canceled'],this._handleUploadFinished),this._uploader.subscribe('dom-updated',this._handleUpdateAttachmentsShelf),this._uploader.subscribe('submit',this._handleSubmit));this.props.onFileUploaderMounted(this._uploader);},componentWillUnmount:function(){this._subscriptions&&this._subscriptions.release();if(!this.props.uploaderIsFromHigherLevel)this._uploader&&this._uploader.destroy();},isUploading:function(){return this._uploader.isUploading();},getAttachments:function(){return this._uploader.getAttachments();},getImageFiles:function(){return this._uploader.getImageFiles();},getVideoFiles:function(){return this._uploader.getVideoFiles();},getAudioFiles:function(){return this._uploader.getAudioFiles();},getFiles:function(){return this._uploader.getFiles();},removeAttachments:function(){return this._uploader.removeAttachments();},_handleUploadFinished:function(){if(this.props.onUploadFinished)this.props.onUploadFinished();},_handleUpdateAttachmentsShelf:function(){if(this.props.onUpdateAttachmentsShelf)this.props.onUpdateAttachmentsShelf();},_handleSubmit:function(){if(this.props.onSubmit)this.props.onSubmit();}};f.exports=k;},null);
__d('ChatFileUploader.react',['ChatFileUploaderMixin','InlineBlock.react','MercuryConfig','React','cx','createCancelableFunction','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();'use strict';var o=k.createClass({displayName:'ChatFileUploader',mixins:[h],getDefaultProps:function(){return {uploaderIsFromHigherLevel:true};},shouldComponentUpdate:function(){return false;},componentDidMount:function(){this._uploaderCallback=m(this.setUpSubscriptionsHandler);this.props.initFileUploaderFn(k.findDOMNode(this.refs.form),k.findDOMNode(this.refs.input),k.findDOMNode(this.refs.attachID)).then(this._uploaderCallback);},componentWillUnmount:function(){if(this._uploaderCallback)this._uploaderCallback.cancel();},render:function(){return (k.createElement('form',{ref:'form',action:j.upload_url,method:'post'},k.createElement('input',{type:'hidden',ref:'attachID',name:'attach_id'}),k.createElement(i,{className:"_m _4q60 itemLabel"},k.createElement('input',{type:'file',className:"_n",name:'attachment[]',multiple:'true',ref:'input'}),k.createElement('span',{className:"_4q61 itemAnchor"},n._("Add Files...")))));}});f.exports=o;},null);
__d('ChatTabMenu.react',['AsyncDialog','AsyncRequest','Bootloader','ChatFileUploader.react','ChatPrivacyActionController','ChatTabActions','Dialog','MercuryConfig','MercuryIDs','MercuryLogMessageType','MercuryMessengerBlockingUtils','MercuryParticipants','MercuryThreadMuter','MercuryViewer','MercurySourceType','NFXChatHeadGK','Promise','ReactComponentWithPureRenderMixin','React','PopoverMenu.react','ReactMenu','MenuSeparator.react','Run','Toggler','TrackingNodes','URI','WebMessengerDeleteThreadDialog','WebMessengerThreadPermalinks','XNFXStartForMessageThreadController','NotificationSettingsDialog','MessengerNotificationSettingsGKModule','cx','fbt','goURI','MercuryMessageObject','MercuryThreadIDMap','MercuryThreadActions','MercuryThreads','MercuryMessageActions'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa){if(c.__markCompiled)c.__markCompiled();'use strict';var pa=c('MercuryMessageObject').get(),qa=c('MercuryThreadIDMap').get(),ra=c('MercuryThreadActions').get(),sa=c('MercuryThreads').get(),ta=c('MercuryMessageActions').get(),ua=ba.Item,va=z.PropTypes,wa=z.createClass({displayName:'ChatTabMenu',_privacyActionController:undefined,_fileUploaderPromise:undefined,mixins:[y],propTypes:{attachmentsShelf:va.object,nameConversationFunc:va.func,isGroupChat:va.bool,isEmptyChat:va.bool,hasMessageBlocked:va.bool,onFileUploaderMounted:va.func,onSubmit:va.func,onUpdateAttachmentsShelf:va.func,onUploadFinished:va.func,otherUserID:va.string,sheetController:va.object.isRequired,showAddFriend:va.func,threadID:va.string.isRequired},getInitialState:function(){return {url:null,privacyText:'',muted:false};},getDefaultProps:function(){return {show:true,isMuted:false,hasSwitchToWork:false};},componentDidMount:function(){ia.getThreadURI(this.props.threadID,(function(xa){this.isMounted()&&this.setState({url:xa});}).bind(this));if(!this.props.isGroupChat)this._privacyActionController=new l(p.getUserIDFromThreadID(this.props.threadID),(function(xa){return this._updatePrivacyLink(xa);}).bind(this));},componentDidUpdate:function(xa,ya){if(this.props.isMuted&&!xa.isMuted){this.props.sheetController.openThreadIsMutedTabSheet();}else if(!this.props.isMuted&&xa.isMuted)this.props.sheetController.closeThreadIsMutedTabSheet();if(this.props.hasMessageBlocked){this.props.sheetController.openMessageBlockedTabSheet();}else this.props.sheetController.closeMessageBlockedTabSheet();},_initFileUploader:function(xa,ya,za){if(this._fileUploaderPromise){this._fileUploaderPromise.then(function(ab){ab.updateElements(xa,ya,za);});}else this._fileUploaderPromise=new x((function(ab,bb){da.onAfterLoad((function(){j.loadModules(["MercuryFileUploader"],(function(cb){var db=new cb(this.props.attachmentsShelf,xa,ya,za);ab(db);}).bind(this));}).bind(this));}).bind(this));return this._fileUploaderPromise;},componentWillUnmount:function(){this._privacyActionController&&this._privacyActionController.destroy();this._fileUploaderPromise&&this._fileUploaderPromise.then(function(xa){xa.destroy();});},_unmuteThread:function(){ra.unmute(this.props.threadID);ea.hide();},_togglePrivacyFunc:function(){this._privacyActionController&&this._privacyActionController.togglePrivacy();},_renderFileUploader:function(){return (z.createElement(ua,{className:"_37_x"},z.createElement(k,{onFileUploaderMounted:this.props.onFileUploaderMounted,attachmentsShelf:this.props.attachmentsShelf,initFileUploaderFn:this._initFileUploader,onUploadFinished:this.props.onUploadFinished,onUpdateAttachmentsShelf:this.props.onUpdateAttachmentsShelf,onSubmit:this.props.onSubmit})));},_renderOpenFullConversation:function(){if(this.state.url)return (z.createElement(ua,{onclick:(function(){return oa(this.state.url);}).bind(this)},na._("See Full Conversation")));return null;},_renderAddFriend:function(){if(!this.props.showAddFriend)return null;return (z.createElement(ua,{onclick:this.props.showAddFriend},na._("Add Friends to Chat...")));},_renderTogglePrivacy:function(){if(!this.props.isGroupChat&&this.state.privacyText)return (z.createElement(ua,{onclick:this._togglePrivacyFunc},this.state.privacyText));return null;},_renderNotificationSettings:function(){if(la.inGK){var xa=ka.show.bind(null,this.props.threadID);return (z.createElement(ua,{onclick:xa},na._("Notification Settings...")));}return null;},_renderMuteConversation:function(){if(!this.props.isMuted){var xa=t.showMuteChangeDialog.bind(null,this.props.threadID,null);return (z.createElement(ua,{onclick:xa},na._("Mute Conversation...")));}else return (z.createElement(ua,{onclick:this._unmuteThread},na._("Unmute Conversation")));},_renderDeleteConversation:function(){return (z.createElement(ua,{onclick:this._deleteConversation},na._("Delete Conversation...")));},_renderReportSpam:function(){if(!this.props.isGroupChat)return (z.createElement(ua,{onclick:this._reportSpamClicked},na._("Report as Spam or Abuse...")));return null;},_blockMessagesItem:function(){if(!this.props.isGroupChat&&r.gk_result&&!this.props.hasMessageBlocked)return (z.createElement(ua,{onclick:this._messageBlockedClicked},na._("Block Messages...")));if(!this.props.isMultichat&&r.gk_result&&this.props.hasMessageBlocked)return (z.createElement(ua,{onclick:this._messageUnblockedClicked},na._("Unblock Messages...")));return null;},_renderCreateGroup:function(){if(this.props.isGroupChat)return (z.createElement(ua,{onclick:this._createGroupClicked},na._("Create Group")));return null;},_renderSwitchToWork:function(){if(this.props.hasSwitchToWork)return (z.createElement(ua,{onclick:this._switchToWorkUserClicked},na._("Move to Work Account")));return null;},_renderConversationName:function(){if(this.props.isGroupChat&&this.state.url)return (z.createElement(ua,{onclick:this.props.nameConversationFunc},na._("Edit Conversation Name")));return null;},_renderLeaveConversation:function(){if(this.props.isGroupChat)return (z.createElement(ua,{onclick:this._unsubscribeLinkClicked},na._("Leave Conversation...")));return null;},_renderEnableDesktopNotifications:function(){if(o.DesktopNotificationsGK&&"Notification" in window&&window.Notification.permission!=="granted")return (z.createElement(ua,{onclick:this._enableDesktopNotif},na._("Enable Desktop Notifications")));return null;},_renderPeopleList:function(){if(this.props.isGroupChat&&this.state.url)return (z.createElement(ua,{onclick:this._showParticipants},na._("Edit Participants...")));return null;},render:function(){var xa=this._renderReportSpam(),ya=this._blockMessagesItem(),za=this._renderCreateGroup(),ab=z.createElement(ba,{className:"chatReact"+(!this.props.show?' '+"hidden_elem":'')},this._renderOpenFullConversation(),this._renderFileUploader(),this._renderAddFriend(),this._renderTogglePrivacy(),this._renderConversationName(),this._renderPeopleList(),z.createElement(ca,null),this._renderNotificationSettings(),this._renderSwitchToWork(),this._renderMuteConversation(),this._renderDeleteConversation(),this._renderLeaveConversation(),xa||ya?z.createElement(ca,null):null,ya,xa,za?z.createElement(ca,null):null,za,this._renderEnableDesktopNotifications()),bb=na._("Options"),cb=fa.getTrackingInfo(fa.types.DROPDOWN_BUTTON);return (z.createElement(aa,{menu:ab},z.createElement('a',{'data-ft':cb,'data-hover':'tooltip','aria-label':bb,'data-tooltip-alignh':'center',className:"button"+(this.props.isEmptyChat?' '+"hidden_elem":'')})));},getFileUploaderPromise:function(){return this._fileUploaderPromise;},_updatePrivacyLink:function(xa){var ya;if(xa==l.OFFLINE){ya=na._("Go online");this.setState({privacyText:ya});return;}if(this.props.isGroupChat||this.props.otherUserID===undefined)return;var za='fbid:'.concat(this.props.otherUserID);s.get(za,(function(ab){if(!ab.is_friend){ya=null;}else if(xa==l.BLOCKED){ya=na._("Turn On Chat for {name}",[na.param('name',ab.short_name)]);}else ya=na._("Turn Off Chat for {name}",[na.param('name',ab.short_name)]);this.setState({privacyText:ya});}).bind(this));},_showParticipants:function(){qa.getFBIDFromClientID(this.props.threadID,function(xa){h.send(new i(new ga('/ajax/browser/dialog/multichat_members/').addQueryData({id:xa})));});},_unsubscribeLinkClicked:function(){var xa=[];xa.push({name:'unsubscribe',label:na._("Leave Conversation"),handler:(function(){return this._unsubscribeToThread();}).bind(this)});xa.push(n.CANCEL);new n().setTitle(na._("Leave Conversation?")).setBody(na._("You will stop receiving messages from this conversation and people will see that you left.")).setButtons(xa).show();},_unsubscribeToThread:function(){if(!sa.isEmptyLocalThread(this.props.threadID)){var xa=pa.constructLogMessageObject(v.CHAT_WEB,this.props.threadID,q.UNSUBSCRIBE,{removed_participants:[u.getID()]});ta.send(xa);}m.closeTab(this.props.threadID,'unsubscribed');return true;},_deleteConversation:function(){ha.show(this.props.threadID);},_reportSpamClicked:function(){var xa=new ga('/ajax/chat/report.php').addQueryData({id:this.props.otherUserID}).addQueryData({src:'top_report_link'});if(w.result)xa=ja.getURIBuilder().setString('thread_fbid',this.props.otherUserID).setEnum('location','www_chat_head').getURI();h.send(new i(xa));},_messageBlockedClicked:function(){ra.blockMessages(this.props.threadID);},_messageUnblockedClicked:function(){ra.unblockMessages(this.props.threadID);},_createGroupClicked:function(){sa.getThreadMeta(this.props.threadID,function(xa){if(!xa.is_canonical){var ya=new ga('/ajax/groups/create_get.php').addQueryData({ref:'web_messenger_dock',parent_id:'0'}),za=xa.participants.map(function(ab){return p.getUserIDFromParticipantID(ab);}).filter(function(ab){return ab;});ya.addQueryData({members:za});if(xa.name)ya.addQueryData({name:xa.name});h.send(new i(ya));}});},_switchToWorkUserClicked:function(){var xa=[];xa.push({name:'move',label:na._("Move Conversation"),handler:(function(){return this._switchToWork();}).bind(this)});xa.push(n.CANCEL);new n().setTitle(na._("Move Conversation to Work Account?")).setBody(na._("Do you want to move this conversation so that it shows in your work account instead?")).setButtons(xa).show();},_switchToWork:function(){if(!sa.isEmptyLocalThread(this.props.threadID)){var xa=pa.constructLogMessageObject(v.CHAT_WEB,this.props.threadID,q.SWITCH_TO_WORK,{removed_participants:[u.getID()]});ta.send(xa);}m.closeTab(this.props.threadID,'unsubscribed');return true;},_enableDesktopNotif:function(){b.Notification.requestPermission();}});f.exports=wa;},null);
__d('ChatTabSheetListener',['ChatPrivacyActionController','MercuryIDs','MercuryParticipants','MercuryThreadInformer','MercuryThreads','MercuryViewer'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();'use strict';function n(o,p){this.$ChatTabSheetListener1=p;this.$ChatTabSheetListener2=o;this.$ChatTabSheetListener3=i.getUserIDFromThreadID(this.$ChatTabSheetListener2);k.get().subscribe('threads-updated',(function(){return this.$ChatTabSheetListener4();}).bind(this));if(this.$ChatTabSheetListener3)this.$ChatTabSheetListener5=new h(this.$ChatTabSheetListener3,(function(q){return this.$ChatTabSheetListener6(q);}).bind(this));}n.prototype.destroy=function(){this.$ChatTabSheetListener5&&this.$ChatTabSheetListener5.destroy();};n.prototype.$ChatTabSheetListener4=function(){var o=l.get();o.getThreadMeta(this.$ChatTabSheetListener2,(function(p){var q=m.getID(),r=p.participants.filter(function(s){return s!==q;});r.length<1&&!o.isNewEmptyLocalThread(this.$ChatTabSheetListener2)?this.$ChatTabSheetListener1.openNoRecipientsSheet():this.$ChatTabSheetListener1.closeNoRecipientsSheet();}).bind(this));};n.prototype.$ChatTabSheetListener6=function(o){switch(o){case h.OFFLINE:this.$ChatTabSheetListener1.closeUserBlockedSheet();this.$ChatTabSheetListener1.openOfflineSheet();break;case h.NORMAL:this.$ChatTabSheetListener1.closeUserBlockedSheet();this.$ChatTabSheetListener1.closeOfflineSheet();break;case h.BLOCKED:this.$ChatTabSheetListener1.closeOfflineSheet();j.get(i.getParticipantIDFromUserID(this.$ChatTabSheetListener3),(function(p){p.is_friend?this.$ChatTabSheetListener1.openUserBlockedSheet():this.$ChatTabSheetListener1.closeUserBlockedSheet();}).bind(this));break;}};f.exports=n;},null);
__d('ChatTabSheetController',['Bootloader','ChatTabSheetListener','Deferred','MercuryIDs'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=function(m,n,o,p){this._threadID=m;this._rootElement=n;this._tabElement=o;this._view=p;this._deferred=new j();this._isLoading=false;this._listener=new i(this._threadID,this);};Object.assign(l.prototype,{openAddFriendsSheet:function(){this._load((function(){this._addFriendsTabSheet.open();}).bind(this));},openMessageBlockedTabSheet:function(){this._load((function(){this._threadIsMessageBlockedSheet.open();}).bind(this));},getAddFriendsParticipants:function(){return this._addFriendsTabSheet?this._addFriendsTabSheet.getParticipants():[];},openNameConversationSheet:function(m){this._load((function(){this._nameConversationTabSheet.open(m);}).bind(this));},openReadOnlySheet:function(){this._load((function(){this._readOnlyTabSheet.open();}).bind(this));},openNewMessagesSheet:function(){this._load((function(){this._newMessagesTabSheet.open();}).bind(this));},openUploadWarningTabSheet:function(){this._load((function(){this._uploadWarningTabSheet.open();}).bind(this));},openThreadIsMutedTabSheet:function(){this._load((function(){this._threadIsMutedTabSheet.open();}).bind(this));},openEmployeeAwaySheet:function(){this._load((function(){this._employeeAwaySheet.open();}).bind(this));},openOfflineSheet:function(){this._load((function(){this._offlineTabSheet.open();}).bind(this));},openUserBlockedSheet:function(){this._load((function(){this._userBlockedTabSheet.open();}).bind(this));},openNoRecipientsSheet:function(){this._load((function(){this._noRecipientsTabSheet.open();}).bind(this));},closeAddFriendsSheet:function(){this._lazy((function(){this._addFriendsTabSheet.close();}).bind(this));},closeAutomaticNameConversationSheet:function(){this._lazy((function(){if(this._nameConversationTabSheet&&this._nameConversationTabSheet.isAutomatic())this._nameConversationTabSheet.close();}).bind(this));},closeMessageBlockedTabSheet:function(){this._lazy((function(){this._threadIsMessageBlockedSheet.close();}).bind(this));},closeThreadIsMutedTabSheet:function(){this._lazy((function(){this._threadIsMutedTabSheet.close();}).bind(this));},closeNewMessagesSheet:function(){this._lazy((function(){this._newMessagesTabSheet.close();}).bind(this));},closeUploadWarningTabSheet:function(){this._lazy((function(){this._uploadWarningTabSheet.close();}).bind(this));},closeOfflineSheet:function(){this._lazy((function(){this._offlineTabSheet.close();}).bind(this));},closeUserBlockedSheet:function(){this._lazy((function(){this._userBlockedTabSheet.close();}).bind(this));},onClickMessagesBlockedSheet:function(m){this._lazy((function(){this._unblockMessagesSub=this._threadIsMessageBlockedSheet.subscribe('clicked',m);}).bind(this));},closeNoRecipientsSheet:function(){this._lazy((function(){this._noRecipientsTabSheet.close();}).bind(this));},onClickNewMessagesSheet:function(m){this._lazy((function(){this._newMessageClickSub=this._newMessagesTabSheet.subscribe('clicked',m);}).bind(this));},onClickThreadIsMutedSheet:function(m){this._lazy((function(){this._threadIsMutedClickSub=this._threadIsMutedTabSheet.subscribe('clicked',m);}).bind(this));},onResize:function(m){this._lazy((function(){this._sheetView.subscribe('resize',m);}).bind(this));},onTokensChanged:function(m){this._lazy((function(){this._addFriendsTabSheet.subscribe('chat/tokens-changed',m);}).bind(this));},onEscape:function(m){this._lazy((function(){this._addFriendsTabSheet.subscribe('esc-pressed',m);}).bind(this));},destroy:function(){this._listener&&this._listener.destroy();this._sheetView&&this._sheetView.destroy();this._offlineTabSheet&&this._offlineTabSheet.destroy();this._userBlockedTabSheet&&this._userBlockedTabSheet.destroy();this._newMessageClickSub&&this._newMessageClickSub.unsubscribe();this._threadIsMutedClickSub&&this._threadIsMutedClickSub.unsubscribe();},_load:function(m){this._bootload();this._deferred.then(m);},_lazy:function(m){this._deferred.then(m);},_bootload:function(){if(this._isLoading)return;this._isLoading=true;h.loadModules(["ChatAddFriendsTabSheet","ChatEmployeeAwaySheet","ChatNameConversationTabSheet","ChatNewMessagesTabSheet","ChatNoRecipientsTabSheet","ChatOfflineTabSheet","ChatReadOnlyTabSheet","ChatThreadIsMessageBlockedSheet","ChatThreadIsMutedTabSheet","ChatUploadWarningTabSheet","ChatUserBlockedTabSheet","MercurySheetView"],(function(m,n,o,p,q,r,s,t,u,v,w,x){this._sheetView=new x(this._threadID,this._rootElement,this._tabElement);var y=this._threadID,z=this._rootElement,aa=this._sheetView,ba=this._view;this._addFriendsTabSheet=new m(y,z,aa,ba);this._employeeAwaySheet=new n(y,z,aa);this._nameConversationTabSheet=new o(y,z,aa);this._newMessagesTabSheet=new p(y,z,aa);this._offlineTabSheet=new r(y,z,aa);this._readOnlyTabSheet=new s(y,z,aa);this._threadIsMessageBlockedSheet=new t(y,z,aa);this._threadIsMutedTabSheet=new u(y,z,aa);this._uploadWarningTabSheet=new v(y,z,aa);this._userBlockedTabSheet=new w(y,z,aa);if(!k.getUserIDFromThreadID(this._threadID))this._noRecipientsTabSheet=new q(y,z,aa);this._deferred.resolve();}).bind(this));}});f.exports=l;},null);
__d('ChatTitleLink.react',['Link.react','MercuryThreadTitle.react','React','TrackingNodes','cx'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();'use strict';var m=j.PropTypes,n=j.createClass({displayName:'ChatTitleLink',propTypes:{href:m.string,isNewThread:m.bool,thread:m.object,viewer:m.string},getDefaultProps:function(){return {href:null};},getTitle:function(){return this.refs.threadTitle.getTitle();},render:function(){if(!this.props.thread)return null;return (j.createElement(h,{'aria-level':'3',className:"titlebarText"+(this.props.href===null?' '+"noLink":''),'data-ft':k.getTrackingInfo(k.types.TITLE),'data-hover':'tooltip',href:this.props.href},j.createElement(i,{ref:'threadTitle',isNewThread:this.props.isNewThread,thread:this.props.thread,useAndSeparator:true,useShortName:!this.props.thread.is_canonical,viewer:this.props.viewer})));}});f.exports=n;},null);
__d('ChatVideoCallButton.react',['Link.react','React','TrackingNodes','FBRTCCallabilityStore','StoreAndPropBasedStateMixin','MercuryIDs','MercuryParticipants','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();'use strict';var p=i.PropTypes,q=i.createClass({displayName:'ChatVideoCallButton',mixins:[l(k,n)],statics:{calculateState:function(r){var s=m.getParticipantIDFromUserID(r.userID),t=n.getOrFetch(s);return {user:t,isCallable:k.isCallable(r.userID)};}},propTypes:{onClick:p.func,onKeyUp:p.func,shown:p.bool,isAudio:p.bool},getClassName:function(){return (!this.props.isAudio?"_1fu3":'')+(this.props.isAudio?' '+"_1fu4":'')+(this.state.isCallable?' '+"_1kza":'')+(' '+"button")+(!this.props.shown?' '+"hidden_elem":'');},getTooltipLabel:function(){var r=this.state.user;if(!r)return undefined;if(this.props.isAudio){return k.voiceCallButtonTooltip(this.props.userID,r.short_name);}else return k.callButtonTooltip(this.props.userID,r.short_name);},render:function(){var r=j.getTrackingInfo(this.props.isAudio?j.types.VIDEOCHAT:j.types.VOICECHAT),s=JSON.stringify({videochat:'call_clicked_bhat_tab'});return (i.createElement(h,{'aria-label':this.getTooltipLabel(),className:this.getClassName(),'data-ft':r,'data-gt':s,'data-hover':'tooltip','data-tooltip-position':'above',onClick:this.props.onClick,onKeyUp:this.props.onKeyUp}));}});f.exports=q;},null);
__d('EmoticonUtils',['EmoticonsList','Parent'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j='emoticon_',k=h.symbols,l={getEmoteFromTarget:function(m){var n=i.byClass(m,'emoticon');if(!n)return null;var o=null;n.className.split(' ').forEach(function(p){if(p.startsWith(j))o=p.substring(j.length);});return k[o]||null;},insertEmoticon:function(m,n,o){var p=n.substring(0,o.start),q=n.substring(o.end);if(o.start>0&&!p.endsWith(' '))m=' '+m;if(!q.startsWith(' '))m+=' ';var r=p+m+q;o.start+=m.length;o.end=o.start;return {result:r,start:o.start,end:o.end};}};f.exports=l;},null);
__d('MessengerHotLikeButton.react',['Image.react','ImmutableObject','Keys','KeyStatus','Link.react','MercurySourceType','MessengerHotLikePreviewEvents','MessengerHotLikeUtils','ReactComponentWithPureRenderMixin','React','StickerActions','StickerConstants','cx','fbt','MercuryMessageObject'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){if(c.__markCompiled)c.__markCompiled();'use strict';var v=c('MercuryMessageObject').get(),w=q.PropTypes,x=q.createClass({displayName:'MessengerHotLikeButton',mixins:[p],componentDidMount:function(){this._subscription=n.addListener(n.FINISH_ANIMATION,(function(y,z){if(y===this.props.threadID)this.props.sendSticker(z);}).bind(this));},componentWillUnmount:function(){this._subscription&&this._subscription.remove();},propTypes:{onMouseDown:w.func,customLike:w.string,sendSticker:w.func.isRequired,threadID:w.string,disabled:w.bool},render:function(){if(this.props.customLike)return (q.createElement(l,{'aria-label':u._("Send a Like"),className:this.props.className,disabled:this.props.disabled,onClick:this._handleClickEvent,onMouseDown:this._handleMouseDown,onMouseLeave:this._cancelSend,onMouseUp:this._handleMouseUp,title:u._("Send a Like")},q.createElement('i',{className:"_1l48 _30yy"},q.createElement(h,{src:this.props.customLike}))));return (q.createElement(l,{'aria-label':u._("Send a Like"),className:this.props.className,disabled:this.props.disabled,onClick:this._handleClickEvent,onMouseDown:this._handleMouseDown,onMouseLeave:this._cancelSend,onMouseUp:this._handleMouseUp,title:u._("Send a Like")},q.createElement('i',{className:"_2y9i _30yy"})));},_handleMouseDown:function(y){if(this.props.disabled||this._pressedSince){y.preventDefault();y.stopPropagation();}if(this.props.disabled||y.button!==0)return;r.hideStickerTray();this.props.onMouseDown&&this.props.onMouseDown();if(this.props.customLike)return;this._pressedSince=Date.now();this._informPreviewStart();this._preparePop();},_handleMouseUp:function(){if(!this.props.threadID)return;if(!this._pressedSince)return;this._pressedSince=0;this._cancelPop();this._informPreviewStop();},_informPreviewStart:function(){n.emit(n.START,this._getFakeMessage(),this.props.threadID);},_informPreviewStop:function(){n.emit(n.STOP,this.props.threadID);},_informPreviewPop:function(){n.emit(n.POP,this.props.threadID);},_getFakeMessage:function(){var y=v.constructStickerMessageObject(s.HOT_LIKE_SMALL_STICKER_ID,m.MESSENGER_WEB,this.props.threadID);v.normalizeNewMessage(y);y.is_like_preview=true;y.like_preview_since=this._pressedSince;y.body='';return new i(y);},_preparePop:function(){this._cancelPop();this._popTimeout=setTimeout(this._informPreviewPop,o.SizeTimes.large);},_cancelSend:function(){if(this._pressedSince){this._pressedSince=0;this._cancelPop();this._informPreviewPop();}},_cancelPop:function(){clearTimeout(this._popTimeout);},_handleClickEvent:function(y){y.stopPropagation();if(this.props.disabled)return;if(k.getKeyDownCode()===j.RETURN||this.props.customLike)this.props.sendSticker(o.getStickerIDForTime(1));}});f.exports=x;},null);
__d('P2PBannerStore',['EventEmitter','P2PActionConstants','P2PAPI','P2PDispatcher','invariant'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m,n;'use strict';var o,p={},q=false,r=false;m=h;n=m&&m.prototype;Object.assign(s,m);s.prototype=Object.create(m.prototype);s.prototype.constructor=s;s.__superConstructor__=m;function s(){n.constructor.call(this);o=k.register(this.onEventDispatched.bind(this));}s.prototype.onEventDispatched=function(t){var u=t.type,v=t.data;switch(u){case i.BANNER_STATES_UPDATED:this.handleBannerStatesUpdated(v);this.emit('change');break;case i.BANNER_DISMISSED:this.handleBannerDismissed(v);this.emit('change');break;case i.BANNER_COMPLETED:this.handleBannerCompleted(v);this.emit('change');break;}};s.prototype.handleBannerStatesUpdated=function(t){q=true;p=t;};s.prototype.handleBannerDismissed=function(t){var u=this.getBannerState(t);u.hasBeenDismissed=true;};s.prototype.shouldShowBanner=function(t){var u;if(!r){j.getBannerStates();r=true;return false;}if(!q)return false;u=this.getBannerState(t);return (u.eligible&&!u.hasBeenDismissed);};s.prototype.handleBannerCompleted=function(t){var u=this.getBannerState(t);u.eligible=false;};s.prototype.getBannerState=function(t){var u=p[t];!u?l(0):undefined;return u;};f.exports=new s();},null);
__d('P2PProductItemBannerStore',['CurrentUser','EventEmitter','ImmutableObject','Map','MercuryIDs','P2PActionConstants','P2PAPI','P2PDispatcher','P2PGKValues'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){if(c.__markCompiled)c.__markCompiled();var q,r;'use strict';var s,t=new k();q=i;r=q&&q.prototype;Object.assign(u,q);u.prototype=Object.create(q.prototype);u.prototype.constructor=u;u.__superConstructor__=q;function u(){r.constructor.call(this);s=o.register(this.onEventDispatched.bind(this));}u.prototype.onEventDispatched=function(v){var w=v.type,x=v.data;switch(w){case m.PRODUCT_ITEM_BANNER_UPDATED:this.handleProductItemBannerUpdated(x);this.emit('change');break;case m.PRODUCT_ITEM_BANNER_DISMISSED:this.handleBannerDismissed(x);this.emit('change');break;}};u.prototype.handleProductItemBannerUpdated=function(v){t.set(this.getOtherUserIDForProduct(v),new j(v));};u.prototype.handleBannerDismissed=function(v){var w,x;t.forEach(function(y,z){if(y.p2pPlatformItemId===v){w=y;x=z;}});if(w){if(this.isViewerSellerForProduct(w)){w=j.set(w,{shouldShowToSeller:false});}else if(this.isViewerBuyerForProduct(w))w=j.set(w,{shouldShowToBuyer:false});t.set(x,w);}};u.prototype.shouldShowBanner=function(v){var w;if(!p.P2PPlatformProductItemBanner||!v)return false;w=this.getProductItemByOtherUserID(v);if(!w){t.set(v,new j({}));n.getProductItemBannerData({otherUserID:v});return false;}return !!(this.isViewerSellerForProduct(w)&&w.shouldShowToSeller||this.isViewerBuyerForProduct(w)&&w.shouldShowToBuyer);};u.prototype.isViewerSellerForProduct=function(v){return v.sellerID===h.getID();};u.prototype.isViewerBuyerForProduct=function(v){return v.buyerID===h.getID();};u.prototype.getOtherUserIDForProduct=function(v){return (this.isViewerSellerForProduct(v)?v.buyerID:v.sellerID);};u.prototype.getProductItemByOtherUserID=function(v){return t.get(v);};u.prototype.getThreadIDFromProductItem=function(v){var w=this.getOtherUserIDForProduct(v);return l.getThreadIDFromUserID(w);};f.exports=new u();},null);
__d('P2PProductItemChatThreadBanner.react',['BackgroundImage.react','Layout.react','LineClamp.react','Link.react','P2PActions','P2PProductItemBannerStore','ReactComponentWithPureRenderMixin','React','XUIGrayText.react','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){if(c.__markCompiled)c.__markCompiled();'use strict';var s=i.Column,t=i.FillColumn,u=o.PropTypes,v=o.createClass({displayName:'P2PProductItemChatThreadBanner',mixins:[n],propTypes:{item:u.object.isRequired},handleDismissClick:function(w){w.preventDefault();l.productItemBannerDismissed(this.props.item.p2pPlatformItemId);},handleSoldClick:function(w){w.preventDefault();},handlePayClick:function(w){w.preventDefault();var x=this.props.item,y=m.getThreadIDFromProductItem(x);l.chatSendViewOpened({threadID:y,amount:x.formattedAmount,platformItemID:x.p2pPlatformItemId});},renderAction:function(){var w=this.props.item,x;if(!w.isAvailable)return null;if(m.isViewerSellerForProduct(w)){x=o.createElement(k,{href:'#',onClick:this.handleSoldClick},r._("Mark as Sold"));}else x=o.createElement(k,{href:'#',onClick:this.handlePayClick},r._("Pay"));return o.createElement('div',null,x);},renderAskingPriceRow:function(){var w=this.props.item;if(this.isCompactMode())return null;return (o.createElement(j,{lines:1,lineHeight:16},o.createElement(p,{shade:'light'},r._("Asking price: {price of the item}",[r.param('price of the item',w.formattedAmount)]))));},renderSmallPrice:function(){var w=this.props.item,x,y;if(!this.isCompactMode())return null;if(!w.isAvailable){x='light';y=r._("SOLD");}else{x='dark';y=w.formattedAmount;}return (o.createElement(p,{shade:x},'('+y+') '));},renderNameLine:function(){var w=this.props.item,x='dark',y;if(!w.isAvailable){x='light';y=r._("SOLD");}else if(this.isCompactMode())y=w.formattedAmount;return (o.createElement(p,{shade:x},y?'('+y+') ':null,w.name));},renderImageColumn:function(){var w=this.props.item;if(this.isCompactMode())return null;return (o.createElement(s,null,o.createElement('div',{className:"_5qnr"},o.createElement('div',{className:"_5qn-"},o.createElement(k,{href:w.refURL||'#'},o.createElement(h,{backgroundPosition:'50% 50%',backgroundSize:'cover',height:45,src:w.image,width:45}))))));},isCompactMode:function(){var w=this.props.item;return !w.image||!w.isAvailable;},render:function(){return (o.createElement('div',{className:"_319c"+(this.isCompactMode()?' '+"_5qn_":'')},o.createElement(i,null,this.renderImageColumn(),o.createElement(t,null,o.createElement('div',{className:(!this.isCompactMode()?"_2pis":'')+(' '+"_5qo0")},o.createElement('div',{className:"_5qo1"},o.createElement(j,{lines:1,lineHeight:16},this.renderNameLine()),this.renderAskingPriceRow(),this.renderAction()))),o.createElement(s,null,o.createElement(k,{className:"_4xl8",href:'#',onClick:this.handleDismissClick},r._("Hide"))))));}});f.exports=v;},null);
__d('P2PLogger',['BanzaiLogger'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();'use strict';var i=Object.assign||function(l){for(var m=1;m<arguments.length;m++){var n=arguments[m];for(var o in n)if(Object.prototype.hasOwnProperty.call(n,o))l[o]=n[o];}return l;},j='P2PPaymentLoggerConfig',k={log:function(l,m){m=i({event:l},m);h.log(j,m);}};f.exports=k;},null);
__d('P2PChatThreadBanner.react',['Image.react','Layout.react','P2PAPI','P2PLogger','P2PPaymentLoggerEvent','React','Set','cx','ix'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){if(c.__markCompiled)c.__markCompiled();'use strict';var q=Object.assign||function(w){for(var x=1;x<arguments.length;x++){var y=arguments[x];for(var z in y)if(Object.prototype.hasOwnProperty.call(y,z))w[z]=y[z];}return w;},r=i.FillColumn,s=i.Column,t=new n(),u=m.PropTypes,v=m.createClass({displayName:'P2PChatThreadBanner',propTypes:{bannerType:u.string.isRequired,bodyText:u.string,loggerEventFlow:u.string.isRequired,onClick:u.func,titleText:u.string.isRequired},_isRendered:false,componentDidMount:function(){var w=this.props.bannerType;if(!t.has(w)){t.add(w);this._isRendered=true;this.log(l.UI_ACTN_CHAT_THREAD_BANNER_VIEWED,{});j.incrementBannerViews(this.props.bannerType);}},log:function(w,x){k.log(w,q({www_event_flow:this.props.loggerEventFlow},x));},handleClick:function(w){w.stopPropagation();if(this.props.onClick)this.props.onClick();this.log(l.UI_ACTN_CHAT_THREAD_BANNER_CLICKED,{});j.incrementBannerDismissals(this.props.bannerType);},handleClose:function(w){w.stopPropagation();this.log(l.UI_ACTN_CHAT_THREAD_BANNER_DISMISSED,{});j.incrementBannerDismissals(this.props.bannerType);},hasRenderedSameBanner:function(){return !this._isRendered&&t.has(this.props.bannerType);},render:function(){var w;if(this.hasRenderedSameBanner())return null;if(this.props.bodyText)w=m.createElement('div',{className:"_1w2e"},this.props.bodyText);return (m.createElement('div',{className:"_1w2f",onClick:this.handleClick},m.createElement('div',{className:"_3jht",onClick:this.handleClose},m.createElement(h,{className:"_47dg",height:9,src:p('/images/p2p/chat-thread-banner-close.png'),width:9})),m.createElement(i,null,m.createElement(s,{className:"_1w2g"},m.createElement(h,{className:"_1w2h",height:15,src:p('/images/p2p/thread-banner-dollar.png'),width:15})),m.createElement(r,{className:"_1w2i"},m.createElement('div',{className:"_1w2j"+(!!w?' '+"_1w2k":'')},this.props.titleText),w))));}});f.exports=v;},null);
__d('P2PSendMoneyNUXChatThreadBanner.react',['MercuryIDs','P2PActions','P2PChatThreadBanner.react','P2PUserEligibilityStore','React','StoreAndPropBasedStateMixin'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();'use strict';var n=Object.assign||function(q){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var t in s)if(Object.prototype.hasOwnProperty.call(s,t))q[t]=s[t];}return q;},o=l.PropTypes,p=l.createClass({displayName:'P2PSendMoneyNUXChatThreadBanner',mixins:[m(k)],propTypes:{bannerType:o.string.isRequired,bodyText:o.string,loggerEventFlow:o.string.isRequired,threadID:o.string.isRequired,titleText:o.string.isRequired},statics:{calculateState:function(q){var r=h.isGroupChat(q.threadID)||k.getEligibilityByThreadID(q.threadID);return {isThreadEligible:r};}},handleClick:function(){i.chatSendViewOpened({threadID:this.props.threadID});},render:function(){if(!this.state.isThreadEligible)return null;return (l.createElement(j,n({},this.props,{onClick:this.handleClick})));}});f.exports=p;},null);
__d('P2PReceiverNUXChatThreadBanner.react',['P2PBannerType','P2PPaymentLoggerEventFlow','P2PSendMoneyNUXChatThreadBanner.react','React','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();'use strict';var m=k.PropTypes,n=k.createClass({displayName:'P2PReceiverNUXChatThreadBanner',propTypes:{threadID:m.string.isRequired},render:function(){return (k.createElement(j,{bannerType:h.RECEIVER_NUX,bodyText:l._("It's free and secure."),loggerEventFlow:i.UI_FLOW_RECEIVER_NUX_CHAT_THREAD_BANNER,threadID:this.props.threadID,titleText:l._("You Can Send Money to Friends!")}));}});f.exports=n;},null);
__d('P2PSenderNUXChatThreadBanner.react',['P2PBannerType','P2PPaymentLoggerEventFlow','P2PSendMoneyNUXChatThreadBanner.react','React','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();'use strict';var m=k.PropTypes,n=k.createClass({displayName:'P2PSenderNUXChatThreadBanner',propTypes:{threadID:m.string.isRequired},render:function(){return (k.createElement(j,{bannerType:h.SENDER_NUX,bodyText:l._("It's free and secure."),loggerEventFlow:i.UI_FLOW_SENDER_NUX_CHAT_THREAD_BANNER,threadID:this.props.threadID,titleText:l._("Now You Can Send Money!")}));}});f.exports=n;},null);
__d('P2PChatThreadBannerContainer.react',['P2PBannerStore','P2PBannerType','P2PProductItemBannerStore','P2PProductItemChatThreadBanner.react','P2PReceiverNUXChatThreadBanner.react','P2PSenderNUXChatThreadBanner.react','StoreAndPropBasedStateMixin','React'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();'use strict';var p=o.PropTypes,q=o.createClass({displayName:'P2PChatThreadBannerContainer',mixins:[n(h,j)],propTypes:{isVisible:p.bool,otherUserID:p.string,threadID:p.string},statics:{calculateState:function(r){return {productItemBannerShown:j.shouldShowBanner(r.otherUserID),receiverNUXBannerShown:h.shouldShowBanner(i.RECEIVER_NUX),senderNUXBannerShown:h.shouldShowBanner(i.SENDER_NUX)};}},renderReceiverNUXBanner:function(){if(!this.props.threadID||!this.props.isVisible)return null;return (o.createElement(l,{threadID:this.props.threadID}));},renderSenderNUXBanner:function(){if(!this.props.threadID||!this.props.isVisible)return null;return (o.createElement(m,{threadID:this.props.threadID}));},renderProductItemBanner:function(){var r=this.props.otherUserID,s;if(r)s=j.getProductItemByOtherUserID(r);if(!s)return null;return (o.createElement(k,{item:s}));},render:function(){var r;if(this.state.productItemBannerShown){r=this.renderProductItemBanner();}else if(this.state.senderNUXBannerShown){r=this.renderSenderNUXBanner();}else if(this.state.receiverNUXBannerShown)r=this.renderReceiverNUXBanner();return (o.createElement('div',null,r));}});f.exports=q;},null);
__d('P2PAbstractSendMoneyButton.react',['React','TooltipLink.react','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();'use strict';var l=h.PropTypes,m=h.createClass({displayName:'P2PAbstractSendMoneyButton',propTypes:{isDialogOpen:l.bool.isRequired,isDisabled:l.bool.isRequired,isMessenger:l.bool.isRequired,onClick:l.func.isRequired,onMouseOver:l.func,recipientName:l.string},_clickGuard:false,render:function(){return (h.createElement(i,{alignH:'center',className:(this.props.isDialogOpen?"open":'')+(this.props.isDisabled?' '+"disabled":'')+(!this.props.isMessenger?' '+"_5uqy":'')+(this.props.isMessenger?' '+"_3ggc":''),href:'#',onClick:this._handleClick,onMouseDown:this._prepareForClick,onMouseOver:this.props.onMouseOver,position:'above',title:this._getLinkTitle(),tooltip:this._getDisabledTitle()},h.createElement('i',{className:"_5s8l"})));},_getLinkTitle:function(){if(this.props.isDisabled)return null;return k._("Send Money");},_getDisabledTitle:function(){if(!this.props.isDisabled)return null;return k._("{receiverName} isn't able to receive money right now.",[k.param('receiverName',this.props.recipientName)]);},_prepareForClick:function(){this._clickGuard=this.props.isDialogOpen;},_handleClick:function(n){n.stopPropagation();if(this._clickGuard){this._clickGuard=false;return;}this.props.onClick();}});f.exports=m;},null);
__d('P2PSendMoneyButton.react',['Bootloader','CurrentEnvironment','DeferredComponent.react','P2PAbstractSendMoneyButton.react','React','Run','emptyFunction'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();'use strict';var o=Object.assign||function(u){for(var v=1;v<arguments.length;v++){var w=arguments[v];for(var x in w)if(Object.prototype.hasOwnProperty.call(w,x))u[x]=w[x];}return u;},p=l.PropTypes,q=i.messengerdotcom,r=l.createClass({displayName:'P2PSendMoneyButton',propTypes:{isNewEmptyLocalThread:p.bool,isGroupChat:p.bool,onTrigger:p.func,participants:p.arrayOf(p.object),threadID:p.string,threadFBID:p.string},getDefaultProps:function(){return {participants:[]};},render:function(){return (l.createElement(j,o({deferredComponent:s,deferredPlaceholder:this._renderPlaceholder()},this.props)));},_renderPlaceholder:function(){return (l.createElement(k,{isDialogOpen:false,isDisabled:true,isMessenger:q,onClick:n,onMouseOver:t,recipientName:this._getRecipientName()}));},_getRecipientName:function(){var u=this.props.participants;if(!this.props.isGroupChat&&u&&u.length>0)return u[0].short_name;return null;}});function s(u){m.onAfterLoad(function(){h.loadModules(["P2PSendMoneyButtonImpl.react"],u);});}function t(){h.loadModules(["P2PSendMoneyButtonImpl.react"],n);}f.exports=r;},null);
__d('P2PSendMoneyDialogStore',['P2PActionConstants','EventEmitter','P2PDispatcher'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k,l;'use strict';var m,n;k=i;l=k&&k.prototype;Object.assign(o,k);o.prototype=Object.create(k.prototype);o.prototype.constructor=o;o.__superConstructor__=k;function o(){l.constructor.call(this);n={};m=j.register(this.onEventDispatched.bind(this));}o.prototype.onEventDispatched=function(p){var q=p.data,r=p.type;switch(r){case h.CHAT_SEND_VIEW_OPENED:this.handleChatSendViewOpened(q);this.emit('change');break;case h.CHAT_SEND_VIEW_CLOSED:this.handleChatSendViewClosed(q);this.emit('change');break;}};o.prototype.getStateByThreadID=function(p){return n[p];};o.prototype.handleChatSendViewOpened=function(p){n[p.threadID]={amount:p.amount,groupSendRecipient:p.groupSendRecipient,groupSendReceiptDetails:p.groupSendReceiptDetails,groupThreadFBID:p.groupThreadFBID,platformItemID:p.platformItemID,sendMoneyDialogShown:true};};o.prototype.handleChatSendViewClosed=function(p){n[p.threadID]={amount:'',groupSendRecipient:null,groupSendReceiptDetails:null,groupThreadFBID:'',platformItemID:null,sendMoneyDialogShown:false};};f.exports=new o();},null);
__d("XPagesMercuryIndicatorController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/pages\/messaging\/mercury\/indicator\/",{});},null,{});
__d('PagesMercuryChatTabIndicatorHandler',['Animation','AsyncRequest','AvailableListConstants','DOM','FBID','MercuryIDs','XPagesMercuryIndicatorController'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();o.tryCreateHandler=function(p,q,r){'use strict';if(!q)return null;var s=m.getUserIDFromThreadID(p);if(!s||l.isUser(s))return null;return new o(s,q,r);};function o(p,q,r){'use strict';this.$PagesMercuryChatTabIndicatorHandler1=false;this.$PagesMercuryChatTabIndicatorHandler2=q;this.$PagesMercuryChatTabIndicatorHandler3=false;this.$PagesMercuryChatTabIndicatorHandler4=false;this.$PagesMercuryChatTabIndicatorHandler5=r;this.$PagesMercuryChatTabIndicatorHandler6=false;this.$PagesMercuryChatTabIndicatorHandler7=p;}o.prototype.checkResponsiveness=function(){'use strict';if(this.$PagesMercuryChatTabIndicatorHandler3)return;var p=n.getURIBuilder().getURI();this.$PagesMercuryChatTabIndicatorHandler3=true;new i().setURI(p).setMethod('POST').setData({page_id:this.$PagesMercuryChatTabIndicatorHandler7}).setHandler((function(q){this.$PagesMercuryChatTabIndicatorHandler3=false;var r=q.payload;if(r.responsiveness)this.$PagesMercuryChatTabIndicatorHandler8(r.responsiveness,r.enableTimeSwitch);}).bind(this)).send();};o.prototype.hideIndicator=function(){'use strict';this.$PagesMercuryChatTabIndicatorHandler9(false);};o.prototype.hideIndicatorAndPreventFutureShow=function(){'use strict';this.$PagesMercuryChatTabIndicatorHandler9(true);};o.prototype.$PagesMercuryChatTabIndicatorHandler9=function(p){'use strict';if(this.$PagesMercuryChatTabIndicatorHandler2&&this.$PagesMercuryChatTabIndicatorHandler4)new h(this.$PagesMercuryChatTabIndicatorHandler2).to('height',0).duration(100).hide().checkpoint(1,(function(){this.$PagesMercuryChatTabIndicatorHandler4=false;if(p)this.$PagesMercuryChatTabIndicatorHandler6=true;}).bind(this)).go();};o.prototype.showIndicator=function(){'use strict';if(this.$PagesMercuryChatTabIndicatorHandler2&&!this.$PagesMercuryChatTabIndicatorHandler4&&this.$PagesMercuryChatTabIndicatorHandler5===j.OFFLINE&&this.$PagesMercuryChatTabIndicatorHandler10){k.setContent(this.$PagesMercuryChatTabIndicatorHandler2,this.$PagesMercuryChatTabIndicatorHandler10);new h(this.$PagesMercuryChatTabIndicatorHandler2).show().to('height',20).duration(100).checkpoint(1,(function(){this.$PagesMercuryChatTabIndicatorHandler4=true;}).bind(this)).go();}};o.prototype.getEnableTimeSwitch=function(){'use strict';return this.$PagesMercuryChatTabIndicatorHandler1;};o.prototype.notifyPageOnlineStatusChanged=function(p){'use strict';this.$PagesMercuryChatTabIndicatorHandler5=p;if(!this.$PagesMercuryChatTabIndicatorHandler1)return;switch(p){case j.ACTIVE:this.hideIndicator();break;default:this.showIndicator();break;}};o.prototype.$PagesMercuryChatTabIndicatorHandler8=function(p,q){'use strict';this.$PagesMercuryChatTabIndicatorHandler10=p;this.$PagesMercuryChatTabIndicatorHandler1=q;this.showIndicator();};f.exports=o;},null);
__d('SelectionPosition',['Event','InputSelection','SubscriptionsHandler'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=Object.assign||function(m){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var p in o)if(Object.prototype.hasOwnProperty.call(o,p))m[p]=o[p];}return m;};function l(m){'use strict';this.$SelectionPosition1=m;this.$SelectionPosition2={start:0,end:0};this.$SelectionPosition3=new j();this.$SelectionPosition4=false;this.updatePos();this.enable();}l.prototype.getPos=function(){'use strict';return k({},this.$SelectionPosition2);};l.prototype.setPos=function(m,n){'use strict';this.$SelectionPosition2={start:m,end:n};this.restore();};l.prototype.updatePos=function(){'use strict';this.$SelectionPosition2=i.get(this.$SelectionPosition1);};l.prototype.restore=function(){'use strict';i.set(this.$SelectionPosition1,this.$SelectionPosition2.start,this.$SelectionPosition2.end);};l.prototype.enable=function(){'use strict';if(!this.$SelectionPosition4){this.$SelectionPosition3.addSubscriptions(h.listen(this.$SelectionPosition1,'keyup',this.updatePos.bind(this)),h.listen(this.$SelectionPosition1,'click',this.updatePos.bind(this)));this.$SelectionPosition4=true;}};l.prototype.disable=function(){'use strict';if(this.$SelectionPosition4){this.$SelectionPosition3.release();this.$SelectionPosition4=false;}};f.exports=l;},null);
__d("XStickerReplyNUXController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/stickers\/tooltip\/",{});},null,{});
__d('ChatTabView',['AsyncRequest','AsyncSignal','AvailableList','AvailableListConstants','BanzaiODS','BootloadedComponent.react','Bootloader','CSS','ChatAddToThreadButton.react','ChatArchiveWarning.react','ChatBehavior','ChatCloseButton.react','ChatConfig','ChatEmployeeAwayWarning','ChatOpenTab','ChatPhotoUploader.react','ChatQuietLinks','ChatStickerButton.react','ChatTabActions','ChatTabMenu.react','ChatTabMessagesView','ChatTabOfficeStatus','ChatTabSheetController','ChatTabViewEvents','ChatTabViewInstances','ChatTitleLink.react','ChatVideoCallButton.react','ChatVisibility','MercuryConstants','CurrentLocale','CurrentUser','DOM','DOMEvent','DOMQuery','DeferredComponent.react','Dialog','Dock','DragDropTarget','EmoticonUtils','EmoticonsList','Event','FBID','FBRTCCallabilityStore','Focus','ImmutableObject','Input','JSResource','Keys','Locale','LogHistory','MercuryConfig','MercuryIDs','MercuryMessengerBlockingUtils','MercuryParticipants','MercuryShareAttachmentRenderLocations','MercurySourceType','MercuryThreadInfo','MercuryTypingAnimation.react','MercuryThreadTitle.react','MercuryViewer','MessengerHotLikeButton.react','MessagingTag','NubController','P2PChatThreadBannerContainer.react','P2PGKValues','P2PSendMoneyButton.react','P2PSendMoneyDialogStore','PagesMercuryChatTabIndicatorHandler','Parent','PhotosUploadWaterfall','PresenceStatus','Promise','React','ReactComponentRenderer','Run','Scroll','SelectionPosition','StickerActions','StickerConstants','StickerState','Style','SubscriptionsHandler','SyntheticMouseEvent','ChatTabTemplates','TextAreaControl','Toggler','TooltipData','TypingDetectorController','URLScraper','URI','UserAgent_DEPRECATED','WaterfallIDGenerator','WebMessengerDeleteThreadDialog','WebMessengerThreadPermalinks','XStickerReplyNUXController','XUISpinner.react','cancelAnimationFrame','createCancelableFunction','csx','cx','emptyFunction','fbt','getActiveElement','isEmpty','requestAnimationFrame','requireWeak','setIntervalAcrossTransitions','ChatReactInput','MercuryBlockedParticipants','MercuryTypingReceiver','MercuryMessageActions','MercuryMessages','MercuryMessageObject','MercuryThreadIDMap','MercuryServerRequests','MercuryThreadInformer','MercuryThreadActions','MercuryThreads'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb,xb,yb,zb,ac,bc,cc,dc,ec,fc,gc,hc,ic,jc,kc,lc,mc,nc,oc,pc,qc,rc,sc,tc,uc,vc,wc,xc,yc,zc,ad,bd,cd,dd,ed,fd,gd,hd,id,jd){if(c.__markCompiled)c.__markCompiled();'use strict';var kd=Object.assign||function(af){for(var bf=1;bf<arguments.length;bf++){var cf=arguments[bf];for(var df in cf)if(Object.prototype.hasOwnProperty.call(cf,df))af[df]=cf[df];}return af;},ld=c('ChatReactInput').module,md=c('MercuryBlockedParticipants').get(),nd=c('MercuryTypingReceiver').get(),od=c('MercuryMessageActions').get(),pd=c('MercuryMessages').get(),qd=c('MercuryMessageObject').get(),rd=c('MercuryThreadIDMap').get(),sd=c('MercuryServerRequests').get(),td=c('MercuryThreadInformer').get(),ud=c('MercuryThreadActions').get(),vd=c('MercuryThreads').get(),wd,xd=new ac(function(af){id('P2PTransferStore',function(bf){wd=bf;af(bf);});}),yd=/^\s*$/,zd=fa,ae,be=10,ce=960,de=eb.getInstance('chat_tab_view');function ee(af,bf){var cf=ma.create('div');bf=bf&&bf.filter(function(ff){return ff!=ob.getID();});if(gd(bf))return pc.remove(af);var df=bf.length,ef=df-be;if(ef>1)bf=bf.slice(0,be);ib.getMulti(bf,function(ff){for(var gf in ff){var hf=ff[gf],jf=mc[':fb:mercury:chat:multichat-tooltip-item'].build();ma.setContent(jf.getNode('name'),hf.name);var kf=gb.getUserIDFromParticipantID(gf),lf=kf&&zb.get(kf)==k.ACTIVE;o.conditionShow(jf.getNode('icon'),lf);o.conditionClass(jf.getNode('name'),'tooltipItemWithIcon',lf);ma.appendContent(cf,jf.getRoot());}if(ef>1){var mf=ed._("and {number of hidden chat participants} more.",[ed.param('number of hidden chat participants',ef)]);ma.appendContent(cf,ma.create('div',{},mf));}pc.set(af,cf,'above');});}var fe={},ge=null,he=false;function ie(af,bf,cf){if(cf){fe[af]=bf;if(!ge)ge=jd(je,600);}else{o.removeClass(bf,'highlightTitle');delete fe[af];}}function je(){for(var af in fe){var bf=fe[af];if(bf.parentNode){o.conditionClass(bf,'highlightTitle',he);}else delete fe[af];}he=!he;if(!Object.keys(fe).length){clearInterval(ge);ge=null;}}function ke(af){var bf=gb.tokenize(af);switch(bf.type){case 'user':return mc[':fb:mercury:chat:user-tab'].build();}return mc[':fb:mercury:chat:multichat-tab'].build();}function le(af){var bf=af._getInputValue(),cf=af._fileUploader,df=cf?cf.getAttachments():[];if(re(af))ne(af,bf,df,function(ef){ef=ze(ef,cf);od.send(ef,function(ff){var gf=vd.getThreadMetaNow(ff);if(fb.CoreGraphEnabled&&gf&&gf.folder===qb.PENDING)ud.movePendingToInbox(ff);});cf&&cf.removeAttachments();if(af._sharePreview)af._sharePreview.setProps({share:null,uri:null});if(!t.get('chat_react_input'))af._getNode('input').value='';af._typingDetector&&af._typingDetector.resetState();af._messagesView&&af._messagesView.setShouldScrollToBottom(true);});}function me(af,bf){if(bf===0)return;te(af,yb.POST_PUBLISHED,{count:bf});af._waterfallID=uc.generate();}function ne(af,bf,cf,df){vd.getThreadMeta(af._threadID,function(ef){if(ef&&ef.is_canonical&&!lb.canReply(ef)&&hb.gk_result){af._showMessageBlockedDialog(ef);return;}var ff=kb.CHAT_WEB,gf=qd.constructUserGeneratedMessageObject(bf,ff,af._threadID);if(cf.length>0){gf.has_attachment=true;gf.raw_attachments=cf;}if(af._sharePreview){var hf=af._sharePreview.component.getShareData();if(hf){gf.has_attachment=true;gf.shareable_attachment=hf;}}if(vd.isNewEmptyLocalThread(af._threadID)){var jf=af._sheetController.getAddFriendsParticipants();af._sheetController.closeAddFriendsSheet();if(jf===null||jf.length===0)return;jf=jf.filter(function(mf){return mf!=ob.getID();});if(jf.length===0){gf.thread_id=gb.getThreadIDFromUserID(la.getID());}else if(jf.length===1){gf.thread_id=gb.getThreadIDFromParticipantID(jf[0]);}else ud.addParticipants(af._threadID,jf);}if(vd.isEmptyLocalThread(af._threadID)){gf.threading_id=gb.tokenize(af._threadID).value;var kf=vd.getThreadMetaNow(ef.thread_id);gf.specific_to_list=Array.from(kf.participants);}if(typeof gf!='undefined')gf.signatureID=af._signatureID;gf.ui_push_phase=ja.UIPushPhase;df(gf);if(af._threadID!==gf.thread_id&&!af._photoUploader.isUploading()){var lf=af._getInputValue();z.closeTab(af._threadID);v.openThread(gf.thread_id,'ChatTabView',null,bf?dd:function(mf){return mf.appendTextToInput(lf);});}});}function oe(af){af._blocked=true;af._sheetController.openUploadWarningTabSheet();}function pe(af){return !!(af._fileUploader&&(af._fileUploader.isUploading()||af._photoUploader.isUploading()||af._sharePreview&&af._sharePreview.component.isLoading()));}function qe(af){return (af._fileUploader&&af._fileUploader.isUploading()||af._sharePreviewLoading);}function re(af){var bf=af._getInputValue();if(!yd.test(bf))return true;if(af._fileUploader&&(af._fileUploader.getAttachments().length>0||af._fileUploader.getImageFiles().length>0||af._fileUploader.getAnimatedImageFiles().length>0||af._fileUploader.getVideoFiles().length>0||af._fileUploader.getAudioFiles().length>0||af._fileUploader.getFiles().length>0))return true;if(af._sharePreview&&af._sharePreview.component.getShareData())return true;return false;}function se(af){af._nubController.flyoutContentChanged();var bf=af._getNode('attachmentShelf');ec.setTop(bf,bf.scrollHeight);}function te(af,bf,cf){yb.sendSignal(kd({qn:af._waterfallID,step:bf,uploader:yb.APP_CHAT},cf||{}));}function ue(af,bf,cf,df,ef){if(bf)sd.ensureThreadIsFetched(bf);this._threadID=af;this._signatureID=cf;this._eventListeners=[];this._onlineStatus=k.OFFLINE;this._tabTemplate=ke(af);this._tabElem=this._tabTemplate.getRoot();if(ef&&ef.getTabElem()){this.insertBefore(ef);}else this.appendTo(df);this._stickersFlyoutShown=false;this._messagesView=null;this._titlebar=this._getNode('nubFlyoutTitlebar');this._iconsContainerNode=this._getNode('iconsContainer');this._inputContainerNode=this._getNode('inputContainer');this._pagesMessageIndicator=this._getNode('pagesMessageIndicator');this._waterfallID=uc.generate();this._subscriptionsHandler=new kc();this._initializeSheetController();var ff=[dd,this._initializeHotLike.bind(this),this._initializeHeader.bind(this),this._initializeUIListeners.bind(this),this._initializeAutoSendPhotoUploader.bind(this),this._initializeTitleHREF.bind(this),this._initializeP2P.bind(this),this._initializeInput.bind(this),this._initializeStickers.bind(this),this._initializeContentSearch.bind(this),(function(){vd.getThreadMeta(this._threadID,(function(nf){this._updateMutingSettings(nf);this._updateMessageBlockSettings(nf);}).bind(this));x.removeEmptyHrefs(this._tabElem);}).bind(this),(function(){this.updateAvailableStatus();this.updateTab();this._setCloseTooltip(false);}).bind(this),this._initializeUnloadListeners.bind(this),this._initializeDragDropTarget.bind(this),this._initializePageMessagingIndicator.bind(this),this._initializeP2PChatThreadBannerContainer.bind(this)];xd.then(this._onP2PTransferStoreLoaded.bind(this));if(t.get('chat_defer_initialization',false)){var gf=(function(nf){if(!nf.length){delete this._initFrame;return;}var of=nf.shift();this._initFrame=hd(function(){gf(nf);});of();}).bind(this);gf(ff);}else for(var hf=ff,jf=Array.isArray(hf),kf=0,hf=jf?hf:hf[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var lf;if(jf){if(kf>=hf.length)break;lf=hf[kf++];}else{kf=hf.next();if(kf.done)break;lf=kf.value;}var mf=lf;mf();}zd.set(af,this);this._logOpenTab();}function ve(af){if(af._photoUploader.isUploading())te(af,yb.CANCEL_DURING_UPLOAD);}function we(){for(var af=zd.values(),bf=Array.isArray(af),cf=0,af=bf?af:af[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var df;if(bf){if(cf>=af.length)break;df=af[cf++];}else{cf=af.next();if(cf.done)break;df=cf.value;}var ef=df;ef.updateAvailableStatus();ef.updateMultichatTooltip();}}function xe(){for(var af=zd.values(),bf=Array.isArray(af),cf=0,af=bf?af:af[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var df;if(bf){if(cf>=af.length)break;df=af[cf++];}else{cf=af.next();if(cf.done)break;df=cf.value;}var ef=df;ef.updateCallLink();}}j.subscribe(k.ON_AVAILABILITY_CHANGED,we);xa.addListener(xe);r.subscribe(r.ON_CHANGED,function(){for(var af=zd.keys(),bf=Array.isArray(af),cf=0,af=bf?af:af[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var df;if(bf){if(cf>=af.length)break;df=af[cf++];}else{cf=af.next();if(cf.done)break;df=cf.value;}var ef=df;vd.getThreadMeta(ef,function(ff){zd.get(ef)._updateUnreadCount(ff);});}});nd.addRetroactiveListener('state-changed',function(af){for(var bf in af){var cf=af[bf]&&af[bf].length,df=zd.get(bf);df&&df.showTypingIndicator(cf);}});td.subscribe('threads-updated',function(af,bf){for(var cf=zd.keys(),df=Array.isArray(cf),ef=0,cf=df?cf:cf[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var ff;if(df){if(ef>=cf.length)break;ff=cf[ef++];}else{ef=cf.next();if(ef.done)break;ff=ef.value;}var gf=ff,hf=zd.get(gf);bf[gf]&&hf.updateTab();if(hf._newThreadIDFromPhotoUpload&&!hf._photoUploader.isUploading()&&bf[hf._newThreadIDFromPhotoUpload]){z.closeTab(hf._threadID);v.openThread(hf._newThreadIDFromPhotoUpload,'ChatTabView');hf._newThreadIDFromPhotoUpload=null;}}});td.subscribe('threads-deleted',function(af,bf){for(var cf=zd.keys(),df=Array.isArray(cf),ef=0,cf=df?cf:cf[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var ff;if(df){if(ef>=cf.length)break;ff=cf[ef++];}else{ef=cf.next();if(ef.done)break;ff=ef.value;}var gf=ff;bf[gf]&&z.closeTab(gf,'thread_deleted');}});Object.assign(ue.prototype,{getThreadID:function(){return this._threadID;},getTabElem:function(){return this._tabElem;},showAddFriend:function(){setTimeout((function(){this._sheetController.openAddFriendsSheet();}).bind(this),0);},showNameConversation:function(af){setTimeout((function(){this._sheetController.openNameConversationSheet(af);}).bind(this),0);},hideAutomaticNameConversation:function(){setTimeout((function(){this._sheetController.closeAutomaticNameConversationSheet();}).bind(this),0);},isVisible:function(){return o.shown(this._tabElem);},setVisibleState:function(af,bf){var cf=o.shown(this._tabElem),df=o.hasClass(this._tabElem,'opened');o.conditionShow(this._tabElem,af);o.conditionClass(this._tabElem,'opened',bf);if(!(cf&&df)&&af&&bf){if(!this._messagesView){var ef=gb.tokenize(this._threadID);this._messagesView=new ba(this._threadID,this._sheetController,this._getNode('scrollingArea'),this._getNode('conversation'),this._getNode('loadingIndicator'),this._getNode('lastMessageIndicator'),this._getNode('typingIndicator'),this,fb.ShowContextBanner&&ef.type==='user');}this._nubController.flyoutContentChanged();this._messagesView.scrollToBottom();this.setP2PChatThreadBannerContainerVisibility();}},focus:function(){if(o.hasClass(this._tabElem,'opened')){this._focusInput();}else this._getNode('dockButton').focus();},isFocused:function(){var af=fd();return xb.byClass(af,"_50mz")===this._tabElem;},hasEmptyInput:function(){return yd.test(this._getInputValue());},getInputElem:function(){if(t.get('chat_react_input')){if(!this._chatInput||!this._chatInput.isMounted())return null;return bc.findDOMNode(this._chatInput);}else return this._getNode('input');},setStickersFlyoutPackID:function(af){if(this._stickerButton){this._setPackIDReact(af);}else this._setPackIDLegacy(af);},loadShareFromParams:function(af,bf){this._getSharePreview().then(function(cf){cf.setProps({share:{params:bf,type:af},uri:null});});},_linkDropped:function(af){this._getSharePreview().then(function(bf){bf.setProps({share:null,uri:af});});},_filesDropped:function(af){if(this._fileUploader){this._fileUploader.addDroppedFiles(af);}else{var bf=this._reactChatTabMenu.component.getFileUploaderPromise();if(bf)bf.then(function(cf){cf.addDroppedFiles(af);});}},_setPackIDLegacy:function(af){var bf=this._stickersFlyout;if(!this._stickersFlyoutToggler||!bf||!bf.component.isMounted())return;gc.selectPack(af);this._toggleStickersFlyoutShownLegacy(true);},_setPackIDReact:function(af){if(!this._stickerButton.isMounted())return;gc.selectPack(af);this._toggleStickersFlyoutShownReact(true);},_toggleStickersFlyoutShownReact:function(af){this._stickerButton.showFlyout();this._stickersFlyoutShown=af;},_toggleStickersFlyoutShownLegacy:function(af){if(af){oc.show(this._stickersFlyoutToggler);}else oc.hide(this._stickersFlyoutToggler);this._stickersFlyoutShown=af;},_hideStickersFlyoutIfShown:function(){if(this._stickersFlyoutToggler&&this._stickersFlyout&&this._stickersFlyoutShown)this._toggleStickersFlyoutShownLegacy(false);},showStickerReplyNUX:function(){if(ae)return;var af=this._getNode('stickerButtonContainer')||this._getNode('emoticons');new h(xc.getURIBuilder().getURI()).setRelativeTo(af).setData({thread_id:this._threadID}).setHandler(function(bf){ic.clearShowStickerReplyNUX();}).send();},insertBefore:function(af){ma.insertBefore(af.getTabElem(),this._tabElem);},appendTo:function(af){ma.appendContent(af,this._tabElem);},nextTabIs:function(af){var bf=af&&af.getTabElem();return this._tabElem.nextSibling==bf;},getScrollTop:function(){return ec.getTop(ma.find(this._tabElem,'.fbNubFlyoutBody.scrollable'));},setScrollTop:function(af){ec.setTop(ma.find(this._tabElem,'.fbNubFlyoutBody.scrollable'),af);},destroy:function(){this._initFrame&&zc(this._initFrame);this._selectionPosition&&this._selectionPosition.disable();while(this._eventListeners.length)this._eventListeners.pop().remove();if(this._dropTarget)this._dropTarget.disable();this._checkUnsentMessages&&this._checkUnsentMessages.cancel();this._logUnsentPhotos&&this._logUnsentPhotos.cancel();this._messagesView&&this._messagesView.destroy();this._sheetController&&this._sheetController.destroy();bc.unmountComponentAtNode(this._getNode('animationContainer'));bc.unmountComponentAtNode(this._getNode('menuContainer'));if(t.get('chat_react_header')){if(this._addToThreadButton){this._addToThreadButton.unmount();this._addToThreadButton=null;}if(this._archiveWarning){this._archiveWarning.unmmount();this._archiveWarning=null;}if(this._videoCallButton){this._videoCallButton.unmmount();this._videoCallButton=null;}if(this._closeButton){this._closeButton.unmount();this._closeButton=null;}if(this._title){this._title.unmount();this._title=null;}}if(this._sharePreview){this._sharePreview.unmount();this._sharePreview=null;}try{bc.unmountComponentAtNode(this._getNode('photoUploaderContainer'));}catch(af){l.bumpEntityKey('chat.web','chattab.unmount_failed');}if(t.get('chat_react_sticker_button')){bc.unmountComponentAtNode(this._getNode('stickerButtonContainer'));}else{this._stickersFlyout.unmount();this._stickersFlyout=null;}this._subscriptionsHandler&&this._subscriptionsHandler.release();if(t.get('chat_react_input')){bc.unmountComponentAtNode(this._getNode('inputContainer'));}else ab.reset(this._getNode('input'));if(this._getNode('hotLikeContainer'))bc.unmountComponentAtNode(this._getNode('hotLikeContainer'));bc.unmountComponentAtNode(this._getNode('name'));if(!t.get('chat_react_header'))bc.unmountComponentAtNode(this._getNode('titlebarText'));if(this._orionTriggerContainer){if(this._orionTrigger)this._orionTrigger.unmount();this._orionTriggerContainer=null;this._orionTrigger=null;}if(this._p2pChatThreadBannerContainerEl){bc.unmountComponentAtNode(this._p2pChatThreadBannerContainerEl);this._p2pChatThreadBannerContainerEl=null;}this._unsubscribeP2PSendMoneyDialogStore();this._unsubscribeP2PTransferStore();ma.remove(this._tabElem);zd['delete'](this._threadID);ra.unregisterNubController(this._nubController);},updateAvailableStatus:function(){vd.getThreadMeta(this._threadID,(function(af){var bf=k.OFFLINE,cf=this._getCanonicalUserID();if(cf){bf=zb.get(cf);}else{var df=af.participants.map(function(ff){return gb.getUserIDFromParticipantID(ff);});bf=zb.getGroup(df);}if(!ia.isOnline())bf=k.OFFLINE;this.updateCallLink();o.conditionClass(this._tabElem,"_5238",bf===k.ACTIVE);o.conditionClass(this._tabElem,"_5239",bf===k.MOBILE);var ef=this._getNode('presenceIndicator');this._onlineStatus=bf;this._pagesMessageIndicatorHandler&&this._pagesMessageIndicatorHandler.notifyPageOnlineStatusChanged(bf);switch(bf){case k.ACTIVE:ef.setAttribute('alt',ed._("Online"));break;case k.MOBILE:ef.setAttribute('alt',ed._("Mobile"));break;default:ef.removeAttribute('alt');break;}}).bind(this));},updateTab:function(){vd.getThreadMeta(this._threadID,(function(af){var bf=[this._getNode('name')];if(!t.get('chat_react_header')){bf.push(this._getNode('titlebarText'));}else if(this._title)this._title.setProps({thread:af},(function(){this._getNode('chatWrapper').setAttribute('aria-label',this._title.component.getTitle());}).bind(this));for(var cf=bf,df=Array.isArray(cf),ef=0,cf=df?cf:cf[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var ff;if(df){if(ef>=cf.length)break;ff=cf[ef++];}else{ef=cf.next();if(ef.done)break;ff=ef.value;}var gf=ff;bc.render(bc.createElement(nb,{isNewThread:vd.isNewEmptyLocalThread(this._threadID),thread:af,useAndSeparator:true,useShortName:!af.is_canonical,viewer:la.getID()}),gf);}this._updateControls(af);this._updateMessageBlockSettings(af);this._updateMutingSettings(af);this._updateUnreadCount(af);this.updateMultichatTooltip();this._updateArchiveWarning(af);this._updateEmployeeAwayWarning(af);this._updateOfficeStatus(af);this._updateNewThread(af);this._updateNameConversationSheet(af);this._updateReadOnlySheet(af);this._updateSwitchToWork(af);}).bind(this));},_updateNameConversationSheet:function(af){if(lb.canReply(af)&&!af.name&&!af.is_canonical&&!af.name_conversation_sheet_dismissed&&!af.has_email_participant&&!af.read_only&&!vd.isEmptyLocalThread(af.thread_id)){this.showNameConversation(true);}else this.hideAutomaticNameConversation();},_updateReadOnlySheet:function(af){var bf=lb.showComposer(af),cf=lb.canReply(af),df=vd.isEmptyLocalThread(af.thread_id);if(!cf&&!bf&&!df)this._sheetController.openReadOnlySheet();},updateSignatureID:function(af){this._signatureID=af;},_updateMessageBlockSettings:function(af){this._updateMenuPropsSafe({hasMessageBlocked:md.isMessageBlocked(af)});},_updateMutingSettings:function(af){var bf=lb.isMuted(af);this._updateMenuPropsSafe({isMuted:bf});},_updateMenuPropsSafe:function(af){if(this._reactChatTabMenu&&this._reactChatTabMenu.component&&this._reactChatTabMenu.component.isMounted())this._reactChatTabMenu.setProps(af);},_updateArchiveWarning:function(af){if(la.isEmployee())ib.getMulti(af.participants,this._showArchiveWarningIfAllParticipantsAreEmployees.bind(this));},_updateEmployeeAwayWarning:function(af){u.updateEmployeeAwayWarning(af,(function(){this._sheetController.openEmployeeAwaySheet();}).bind(this),function(){});},_updateOfficeStatus:function(af){var bf=this._getNode('officeStatus');if(!bf||gb.isGroupChat(af.thread_id))return;var cf=gb.getParticipantIDFromUserID(af.canonical_fbid);ib.get(cf,function(df){ca.update(bf,df);});},_updateSwitchToWork:function(af){if(la.isEmployee()&&la.hasWorkUser()&&gb.isGroupChat(af.thread_id)){ib.getMulti(af.participants,(function(bf){var cf=this._isEmployeesOnly(bf);this._updateMenuPropsSafe({hasSwitchToWork:cf});}).bind(this));}else this._updateMenuPropsSafe({hasSwitchToWork:false});},_updateControls:function(af,bf,cf){var df=false;if(af&&af.thread_id){var ef=gb.tokenize(af.thread_id);if(ef.type==='user'){var ff=ef.value;df=!wa.isUser(ff);}}var gf=lb.showComposer(af)&&(!gd(af.participants)||!!bf);o.conditionShow(this._inputContainerNode,gf);o.conditionShow(this._iconsContainerNode,gf);this._updateMenuPropsSafe({isEmptyChat:vd.isNewEmptyLocalThread(af.thread_id),show:gf});if(df)this._updateMenuPropsSafe({showAddFriend:null});var hf=gf&&!df;if(t.get('chat_react_header')){this._addToThreadButton&&this._addToThreadButton.setProps({shown:hf});}else o.conditionShow(this._getNode('addToThreadLink'),hf);if(cf&&cf.length===1&&fb.ShowContextBanner&&fb.ShowContextBannerNullState){this._messagesView&&this._messagesView.renderContextBanner(null,cf[0].info&&cf[0].info.uid);}else this._messagesView&&this._messagesView.unmountContextBanner();this._resizeInputContainer();this._updateOrionTrigger();},_updateOrionTrigger:function(){if(this._orionTrigger){this._setOrionTriggerProps();}else this._renderOrionTrigger();},_setOrionTriggerProps:function(){this.getParticipantIDsForOrionNUX((function(af,bf){ib.getMulti(af,(function(cf){var df=[],ef,ff=vd.isNewEmptyLocalThread(this._threadID);for(var gf in cf){ef=this._getUserIdFromParticipantID(gf);if(ef!==la.getID())df.push(za.set(cf[gf],{userID:ef}));}this._orionTrigger.setProps(kd({participants:df,isNewEmptyLocalThread:ff,isGroupChat:gb.isGroupChat(this._threadID)&&!ff,threadID:this._threadID,threadFBID:bf},vb.getStateByThreadID(this._threadID)));}).bind(this));}).bind(this));},_getUserIdFromParticipantID:function(af){return gb.getUserIDFromParticipantID(af);},_onP2PSendMoneyDialogStoreChange:function(){this._updateOrionTrigger();},_unsubscribeP2PSendMoneyDialogStore:function(){if(this._sendMoneyDialogStoreSub){this._sendMoneyDialogStoreSub.remove();this._sendMoneyDialogStoreSub=null;}},_onP2PTransferStoreChange:function(){this._renderOrionTrigger();if(this._canP2PSend())this._unsubscribeP2PTransferStore();},_unsubscribeP2PTransferStore:function(){if(this._transferStoreSub){this._transferStoreSub.remove();this._transferStoreSub=null;}},_isP2PEnabled:function(){return tb.P2PEnabled;},_canP2PSend:function(){return (this._isP2PEnabled()||wd&&wd.hasTransfers()||wd&&wd.hasAccepted());},_renderOrionTrigger:function(){if(gb.isGroupChat(this._threadID)&&!tb.P2PGroupSendWWW)return false;var af=this._getCanonicalUserID();if(this._canP2PSend()&&af!==la.getID()){this._orionTriggerContainer=this._getNode('orionTriggerContainer');this._orionTrigger=new cc(ub,this._orionTriggerContainer);this._orionTrigger.setProps({onTrigger:this._orionTriggered.bind(this)});o.addClass(this._inputContainerNode,"_11d6");this._setOrionTriggerProps();}},getParticipantIDsForOrionNUX:function(af){var bf=this._sheetController.getAddFriendsParticipants(),cf=this._getCanonicalUserID();if(cf){af([gb.getParticipantIDFromUserID(cf)]);}else if(vd.isNewEmptyLocalThread(this._threadID)&&bf){af(bf);}else vd.getThreadMeta(this._threadID,(function(df){af(df.participants,df.thread_fbid);}).bind(this));},_resizeInputContainer:function(){var af=this._tabElem.clientWidth,bf=2,cf=af-(this._inputContainerNode.clientWidth+bf),df=db.isRTL()?'left':'right';jc.set(this._iconsContainerNode,df,cf+'px');if(!t.get('chat_react_input'))nc.getInstance(this._getNode('input')).update();},_updateNewThread:function(af){if(vd.isNewEmptyLocalThread(af.thread_id))this.showAddFriend();},_isEmployeesOnly:function(af){for(var bf in af)if(!af[bf].employee)return false;return true;},_showArchiveWarningIfAllParticipantsAreEmployees:function(af){var bf=this._isEmployeesOnly(af),cf=t.get('chat_react_header'),df=cf?this._getNode('archiveContainer'):this._getNode('titanArchiveWarning');if(df){if(this._titlebarTooltipAnchor)o.conditionClass(this._titlebarTooltipAnchor,'narrowTitleBar',bf);if(cf){this._archiveWarning&&this._archiveWarning.setProps({shown:bf});}else o.conditionShow(df,bf);}},updateMultichatTooltip:function(){vd.getThreadMeta(this._threadID,(function(af){if(!af.is_canonical){var bf;if(t.get('chat_react_header')){bf=bc.findDOMNode(this._title.component);}else bf=this._titlebarTooltipAnchor;ee(bf,af.participants);}}).bind(this));},_getNode:function(af){return this._tabTemplate.getNode(af);},_getCanonicalUserID:function(){return gb.getUserIDFromThreadID(this._threadID);},_listen:function(af,event,bf,cf){var df=this._getNode(af);if(df){this._eventListeners.push(va.listen(df,event,bf.bind(this)));}else if(!cf)throw new Error('Could not find node "'+af+'"');},_closePreClicked:function(af){this._closeMouseDown=true;},_closeClicked:function(af){ve(this);z.closeTab(this._threadID);if(af instanceof lc){af.stopPropagation();return;}af.kill();},_closeEnter:function(af){if(af.keyCode===cb.RETURN)this._closeClicked(af);},_nubClicked:function(af){af.kill();return ea.inform('nub-activated',this._threadID);},_dockKeyDown:function(event){if(event.keyCode===cb.RETURN||event.keyCode===cb.SPACE){ea.inform('nub-activated',this._threadID);event.kill();}else this._handleHotkeyPressed(event);},_handleHotkeyPressed:function(event){if(event.keyCode===cb.ESC){this._handleEscape();if(t.get('chat_react_input'))event=new na(event);event.kill();}else if(event.keyCode===cb.TAB)this._handleTabPressed(event);},_handleTabPressed:function(event){if(!event.ctrlKey){var af=ea.inform('tab-pressed',{id:this._threadID,shiftPressed:event.shiftKey});if(t.get('chat_react_input'))event=new na(event);!af&&event.kill();return true;}},_handleEscape:function(){if(this._stickersFlyoutShown){this._stickerButton?this._toggleStickersFlyoutShownReact(false):this._toggleStickersFlyoutShownLegacy(false);return;}ve(this);if(this.hasEmptyInput()){ea.inform('esc-pressed',this._threadID);}else{var af=ed._("Are you sure you want to close this chat window?"),bf=ed._("You haven't sent your message."),cf=new qa().setTitle(af).setBody(bf).setButtons([qa.CLOSE,qa.CANCEL]).setHandler(ea.inform.bind(ea,'esc-pressed',this._threadID,null)).setModal(true).show(),df=cf.getButtonElement('yes');df&&ya.set(df);}},_titleClicked:function(event){var af=event.getTarget();if(!xb.byClass(af,'titlebarText')&&!xb.byClass(af,'uiSelector')&&!xb.byClass(af,'addToThread')&&!xb.byClass(af,'optionMenu')&&!xb.byClass(af,'videoicon')&&!xb.byClass(af,'phoneicon')&&!xb.byClass(af,"_1fu3")&&!xb.byClass(af,"_1fu4")&&!xb.byClass(af,'close')){event.kill();z.lowerTab(this._threadID);this.focus();}},_callEnter:function(af){if(af.keyCode===cb.RETURN)this._callClicked(af);},_callClicked:function(af){if(af.target)af.target.blur();var bf=this._getCanonicalUserID();if(this._videoCallLinkEnabled){var cf;if(af.target&&(o.hasClass(af.target,'phoneicon')||o.hasClass(af.target,"_1fu4"))){cf='chat_tab_voice_icon';}else cf='chat_tab_icon';ea.inform('video-call-clicked',{threadID:this._threadID,userID:bf,clickSource:cf,audioOnly:cf==='chat_tab_voice_icon'});}if(t.get('chat_react_header')){af.stopPropagation();}else return false;},_addFriendLinkClicked:function(){this.showAddFriend();},_getUserParticipants:function(af){var bf=[];af.forEach(function(cf){var df=gb.getUserIDFromParticipantID(cf);df&&bf.push(df);});return bf;},_enableDesktopNotif:function(){Notification.requestPermission();},_inputPasted:function(event){if(tc.chrome()){var af=event.clipboardData||event.originalEvent.clipboardData;if(!af||!af.items||af.items.length<1)return;var bf=af.items[0].type;if(bf!=='image/png')return;if(af.items[0].getAsFile){var cf=af.items[0].getAsFile();this._photoUploader.uploadFile(cf);}}},_focusInput:function(){if(t.get('chat_react_input')){this._chatInput&&this._chatInput.isMounted()&&this._chatInput.focus();}else this._getNode('input').focus();},_focusTab:function(){o.addClass(this._tabElem,'focusedTab');this.tryMarkAsRead();this._closeMouseDown=false;this._setCloseTooltip(true);ea.inform('focus-tab',this._threadID);},_blurTab:function(){o.removeClass(this._tabElem,'focusedTab');!this._closeMouseDown&&this._setCloseTooltip(false);},_setCloseTooltip:function(af){if(t.get('chat_react_header')){this._closeButton&&this._closeButton.setProps({active:af});return;}var bf=this._getNode('titlebarCloseButton'),cf=af?ed._("Press Esc to close"):ed._("Close tab");pc.set(bf,cf,'above');},_inputKeyDown:function(event){this.tryMarkAsRead();if(event.keyCode===cb.RETURN&&!event.shiftKey){if(qe(this)){oe(this);event.kill&&event.kill();return;}le(this);event.kill&&event.kill();return;}if(event.keyCode===cb.DOWN&&event.shiftKey&&this.hasEmptyInput()){event.kill&&event.kill();z.lowerTab(this._threadID);this.focus();return;}this._handleHotkeyPressed(event);},_showMessageBlockedDialog:function(af){var bf=this._getCanonicalUserID();if(!bf)return;if(!t.get('chat_react_input'))this._getNode('input').blur();var cf='fbid:'+bf;ib.get(cf,function(df){n.loadModules(["MessageBlockedDialog"],function(ef){ef.show(af.thread_id,af.can_reply,md.isMessageBlocked(af),df.short_name);});});},_initializeInput:function(){if(!t.get('chat_react_input')){var af=this._inputContainerNode.clientHeight;nc.getInstance(this._getNode('input')).subscribe('resize',(function(){var bf=this._inputContainerNode.clientHeight;if(bf!=af)this._nubController.flyoutContentChanged();af=bf;}).bind(this));this._listen('input','focus',this._focusTab);this._listen('input','blur',this._blurTab);this._listen('input','paste',this._inputPasted);if(tc.firefox()&&ka.get()=='ko_KR'){this._listen('input','keyup',this._inputKeyDown);}else this._listen('input','keydown',this._inputKeyDown);this._initializeThingsWithInputFn(this._tabTemplate.getNode('input'));}else this._chatInput=bc.render(bc.createElement(ld,{initializeThingsWithInputFn:this._initializeThingsWithInputFn.bind(this),inputKeyDown:this._inputKeyDown.bind(this),onAddMention:this._onAddMention.bind(this),onBlur:this._blurTab.bind(this),onEscape:this._handleEscape.bind(this),onFocus:this._focusTab.bind(this),onTab:this._handleTabPressed.bind(this),openFlyoutFn:this._toggleStickersFlyoutShownLegacy.bind(this,true),resizeFn:(function(bf){jc.set(this._getNode('inputContainer'),'height',bf+'px');this._nubController.flyoutContentChanged();}).bind(this),uploadPhotoFn:(function(bf){this._photoUploader&&this._photoUploader.uploadFile(bf);}).bind(this)}),this._getNode('chatInputContainer'));},_initializeSharePreview:function(af,bf){va.listen(af,'keyup',(function(){var cf=bf?bf():af.value;if(!cf.length){this._urlScraper.reset();delete this._urlScraperData;}}).bind(this));this._urlScraper=new rc(af,bf);this._urlScraper.subscribe('match',(function(cf,df){this._urlScraperData=df;this._getSharePreview().then((function(ef){var ff=this._urlScraperData;ef.setProps({share:null,uri:ff&&ff.url});}).bind(this));}).bind(this));},_getSharePreview:function(){if(!this._sharePreview&&!this._sharePreviewPromise){this._sharePreviewLoading=true;this._sharePreviewPromise=new ac((function(af){n.loadModules(["MercurySharePreview.react"],(function(bf){this._sharePreview=new cc(bf,this._getNode('shareAttachmentShelf'));this._sharePreview.setProps({imageSize:{width:ce,height:ce},location:jb.CHAT_PREVIEW,onClose:this._focusInput.bind(this),onUpdate:(function(){se(this);this._unblockSend();}).bind(this)});this._sharePreviewLoading=false;af(this._sharePreview);}).bind(this));}).bind(this));}return this._sharePreviewPromise;},_initializeThingsWithInputFn:function(af,bf){this._initializeSharePreview(af,bf);vd.getThreadMeta(this._threadID,(function(cf){if(fb.CoreGraphEnabled&&cf&&cf.folder===qb.PENDING){o.hide(this._getNode('footer'));var df=ma.create('div');ma.appendContent(this._getNode('chatConv'),df);bc.render(bc.createElement(m,{bootloadPlaceholder:bc.createElement('div',{style:{height:27}}),bootloadLoader:bb('ChatPendingActions.react'),onDeleteClick:(function(ef){vc.show(this._threadID);}).bind(this),onReplyClick:(function(ef){ma.remove(df);o.show(this._getNode('footer'));this._updateControls(cf);}).bind(this)}),df);}rd.getFBIDFromClientID(this._threadID,(function(ef){this._typingDetector=new qc(this._getCanonicalUserID(),af,'mercury-chat',null,ef,bf);}).bind(this));}).bind(this));},_getInputValue:function(){if(t.get('chat_react_input')){if(!this._chatInput||!this._chatInput.isMounted())return '';return this._chatInput.getValue()||'';}else return this._tabTemplate.getNode('input').value||'';},appendTextToInput:function(af){if(t.get('chat_react_input')){if(this._chatInput&&this._chatInput.isMounted())this._chatInput.appendText(af);}else this._getNode('input').value+=af;},_hasUnfinishedPost:function(){return re(this)||pe(this);},tryMarkAsRead:function(){if(!this._messagesView||this._messagesView.isScrolledToBottom()){ud.markRead(this._threadID);ud.markSeen(this._threadID);return true;}return false;},_chatConvClicked:function(af){this.tryMarkAsRead();if(xb.byTag(af.getTarget(),'a')||ma.getSelection())return;this.focus();},_inputContainerClicked:function(af){this.tryMarkAsRead();this.focus();},_initializePageMessagingIndicator:function(){if(!this._pagesMessageIndicator)return;o.hide(this._pagesMessageIndicator);this._pagesMessageIndicatorHandler=wb.tryCreateHandler(this._threadID,this._pagesMessageIndicator,this._onlineStatus);this._pagesMessageIndicatorHandler&&this._pagesMessageIndicatorHandler.checkResponsiveness();},showTypingIndicator:function(af){this._renderTypingIndicator();o.conditionClass(this._tabElem,"_54m8",af);},_renderTypingIndicator:function(){var af=o.hasClass(this._tabElem,'highlightTab')?'light':'dark';bc.render(bc.createElement(mb,{color:af}),this._getNode('animationContainer'));},_updateUnreadCount:function(af){var bf=af.unread_count;if(typeof bf!='undefined'){var cf=!!bf&&(!r.showsTabUnreadUI||r.showsTabUnreadUI()),df=this._getNode('numMessages');o.conditionShow(df,cf);o.conditionClass(this._tabElem,'highlightTab',cf);this._renderTypingIndicator();ie(this._threadID,this._tabElem,cf);ma.setContent(df,bf);}},updateCallLink:function(){var af=this._getCanonicalUserID();if(!af||af===la.getID()||!wa.isUser(af)){if(t.get('chat_react_header')){if(this._videoCallButton)this._videoCallButton&&this._videoCallButton.setProps({shown:false});if(this._voiceCallButton)this._voiceCallButton.isMounted()&&this._voiceCallButton.setProps({shown:false});}else{var bf=this._getNode('videoCallLink');if(bf)o.hide(bf);var cf=this._getNode('voiceCallLink');if(cf)o.hide(cf);}this._videoCallLinkEnabled=false;return;}this._videoCallLinkEnabled=xa.isCallable(af);if(!t.get('chat_react_header')){o.conditionClass(this._tabElem,"_4hwz",this._videoCallLinkEnabled);ib.get(gb.getParticipantIDFromUserID(af),(function(df){xa.callButtonTooltip(af,df.short_name);this._setCallButtonTooltips(af,df.short_name);}).bind(this));}},_setCallButtonTooltips:function(af,bf){var cf=xa.callButtonTooltip(af,bf),df=xa.voiceCallButtonTooltip(af,bf);pc.set(this._getNode('videoCallLink'),cf);var ef=this._getNode('voiceCallLink');if(ef)pc.set(ef,df);},_initializeSheetController:function(){this._sheetController=new da(this._threadID,this._getNode('sheet'),this._tabElem,this);this._sheetController.onClickMessagesBlockedSheet((function(){ud.unblockMessages(this._threadID);this.focus();}).bind(this));this._sheetController.onClickNewMessagesSheet((function(){this._messagesView&&this._messagesView.scrollToBottom();this.focus();this.tryMarkAsRead();}).bind(this));this._sheetController.onClickThreadIsMutedSheet((function(){ud.unmute(this._threadID);this.focus();}).bind(this));this._sheetController.onTokensChanged((function(af,bf){vd.getThreadMeta(this._threadID,(function(cf){this._updateControls(cf,bf.token_count,bf.tokens);}).bind(this));}).bind(this));this._nubController=new rb().init(this._tabElem);this._sheetController.onResize((function(){this._nubController.flyoutContentChanged();}).bind(this));this._nubController.subscribe('resize',(function(){this._resizeInputContainer();}).bind(this));},_initializeHeader:function(){this._initializeReactMenu(this._getNode('fileAttachmentShelf'));this._initializeArchiveWarning();this._initializeAddToThreadButton();this._initializeVideoCallButton();this._initializeCloseButton();this._initializeTitle();},_initializeReactMenu:function(af){var bf=gb.isGroupChat(this._threadID),cf=vd.isNewEmptyLocalThread(this._threadID),df=this._sheetController.openAddFriendsSheet.bind(this._sheetController);this._reactChatTabMenu=new cc(aa,this._getNode('menuContainer'));this._reactChatTabMenu.setProps({sheetController:this._sheetController,onFileUploaderMounted:this.setFileUploader.bind(this),nameConversationFunc:(function(){return this.showNameConversation();}).bind(this),isGroupChat:bf,isEmptyChat:cf,showAddFriend:df,threadID:this._threadID,otherUserID:this._getCanonicalUserID(),attachmentsShelf:af,onUploadFinished:this._unblockSend.bind(this),onUpdateAttachmentsShelf:se.bind(this,this),onSubmit:this._focusInput.bind(this)});},_initializeArchiveWarning:function(){if(t.get('chat_react_header')){this._archiveWarning=new cc(q,this._getNode('archiveContainer'));this._archiveWarning.setProps({isFBAtWork:t.IsWorkUser,shown:true});}},_initializeAddToThreadButton:function(){if(t.get('chat_react_header')){this._addToThreadButton=new cc(p,this._getNode('addToThreadContainer'));this._addToThreadButton.setProps({isFBAtWork:t.get('IsWorkUser',false),onClick:this._addFriendLinkClicked.bind(this),shown:true});}else this._listen('addToThreadLink','click',this._addFriendLinkClicked,true);},_initializeVideoCallButton:function(){if(!gb.getUserIDFromThreadID(this._threadID))return;if(t.get('chat_react_header')){var af=this._getCanonicalUserID();this._videoCallButton=new cc(ha,this._getNode('videoCallButtonContainer'));this._videoCallButton.setProps({shown:true,isAudio:false,userID:af,onClick:this._callClicked.bind(this),onKeyUp:this._callEnter.bind(this)});this._voiceCallButton=new cc(ha,this._getNode('voiceCallButtonContainer'));this._voiceCallButton.setProps({shown:true,isAudio:true,userID:af,onClick:this._callClicked.bind(this),onKeyUp:this._callEnter.bind(this)});}else{this._listen('videoCallLink','click',this._callClicked,true);this._listen('videoCallLink','keyup',this._callEnter,true);if(this._getNode('voiceCallLink')){this._listen('voiceCallLink','click',this._callClicked,true);this._listen('voiceCallLink','keyup',this._callEnter,true);}}},_initializeCloseButton:function(){if(t.get('chat_react_header')){this._closeButton=new cc(s,this._getNode('closeButtonContainer'));this._closeButton.setProps({onClick:this._closeClicked.bind(this),onKeyUp:this._closeEnter.bind(this),onMouseDown:this._closePreClicked.bind(this)});}else{this._listen('titlebarCloseButton','click',this._closeClicked);this._listen('titlebarCloseButton','keyup',this._closeEnter);this._listen('titlebarCloseButton','mousedown',this._closePreClicked);}},_initializeTitle:function(){if(t.get('chat_react_header')){var af=vd.getThreadMetaNow(this._threadID);this._title=new cc(ga,this._getNode('titleContainer'));this._title.setProps({isNewThread:vd.isNewEmptyLocalThread(this._threadID),thread:af,viewer:la.getID()});}},_initializeTitleHREF:function(){wc.getThreadURI(this._threadID,(function(bf){return this._setTitleHref(bf);}).bind(this));if(!gb.getUserIDFromThreadID(this._threadID))this._titlebarTooltipAnchor=this._getNode('titlebarText');var af=this._getCanonicalUserID();if(this._getCanonicalUserID())ib.get(gb.getParticipantIDFromUserID(af),(function(bf){if(bf.href)this._setTitleHref(bf.href);}).bind(this));},_initializeUIListeners:function(){if(this._pagesMessageIndicator)this._listen('scrollingArea','scroll',(function(event){var af=event.target;if(af.scrollHeight-af.offsetHeight!==af.scrollTop)this._pagesMessageIndicatorHandler&&this._pagesMessageIndicatorHandler.hideIndicatorAndPreventFutureShow();}).bind(this));this._listen('closeButton','click',this._closeClicked);this._listen('dockButton','click',this._nubClicked);this._listen('dockButton','keydown',this._dockKeyDown);this._listen('nubFlyoutTitlebar','click',this._titleClicked);this._listen('chatConv','click',this._chatConvClicked);this._listen('inputContainer','click',this._inputContainerClicked);this._listen('sheet','keydown',(function(event){if(!event.getModifiers().any&&event.keyCode===cb.TAB){this._focusInput();event.kill();}if(event.keyCode===cb.ESC)this._handleEscape();}).bind(this));if(this._getNode('officeStatus'))this._listen('officeStatus','click',function(){return false;},true);},setFileUploader:function(af){this._fileUploader=af;},_initializeAutoSendPhotoUploader:function(){this._photoUploader=bc.render(bc.createElement(w,{onSubmit:this._handlePUSubmit.bind(this),onAllUploadsComplete:this._handlePUAllUploadsCompleted.bind(this),onLastUploadFail:this._handlePULastUploadFailed.bind(this),onLastUploadCancel:this._handlePULastUploadCanceled.bind(this)}),this._getNode('photoUploaderContainer'));},_initializeStickers:function(){this._stickersFlyoutToggler=this._getNode('emoticons');if(ic.shouldShowStickerSearchNUX())this._listen('emoticons','click',function(){if(ic.shouldShowStickerSearchNUX()){gc.selectPack(hc.SEARCH_PACK_ID);ic.clearShowStickerSearchNUX();}},true);if(t.get('chat_react_sticker_button')){this._stickerButton=bc.render(bc.createElement(y,{className:"_4vui",flyoutAlignment:'left',onFlyoutShown:this._onFlyoutShown.bind(this),onFlyoutHidden:this._onFlyoutHidden.bind(this),onStickerSelect:this._stickerSelected.bind(this),onEmoticonSelect:this._emoticonSelected.bind(this),threadID:this._threadID}),this._getNode('stickerButtonContainer'));l.bumpEntityKey('chat.web','sticker_button.mounting_attempted');}else{var af=this._getNode('stickers');if(af)var bf=new ac((function(df){this._stickersFlyout=new cc(pa,af);this._stickersFlyout.setProps({deferredPlaceholder:bc.createElement('div',{style:{padding:'30px',textAlign:'center'}},bc.createElement(yc,{size:'large'})),deferredComponent:function(ef){df(ef);},onStickerSelect:(function(ef){this._stickerSelected(ef);}).bind(this),onShown:this._onFlyoutShown.bind(this),onHidden:this._onFlyoutHidden.bind(this),onEmoticonSelect:this._emoticonSelected.bind(this),onEscKeyDown:this._hideStickersFlyoutIfShown.bind(this)});}).bind(this)),cf=oc.listen('show',this._stickersFlyoutToggler,function(){oc.unsubscribe(cf);bf.then(function(df){n.loadModules(["StickersFlyout.react"],df);});});}},_initializeContentSearch:function(){var af=this._getNode('contentSearchContainer');if(af){bc.render(bc.createElement(m,{bootloadPlaceholder:bc.createElement('div',{style:{height:27}}),bootloadLoader:bb('ChatContentSearchButton.react'),className:"_4vui _2ksk",getInput:(function(){return this.getInputElem();}).bind(this),getQuery:(function(){return this._getInputValue();}).bind(this),onLoad:(function(bf){this._contentSearchButton=bf;}).bind(this),onSelect:(function(bf,cf){var df=this.getInputElem();df&&df.select&&df.select();if(bf.platformFBID.toString()===fb.MessengerAppID){this._stickerSelected(bf.resultID.toString());}else{this._photoUploader&&this._photoUploader.uploadURL({attribution_app_id:bf.platformFBID,errorDialogParams:{body:ed._("There was a problem sending this GIF. Choose another one and try again."),title:ed._("Couldn't Send GIF")},external_image_url:bf.source.url,preview_url:bf.media.preview?bf.media.preview.url:bf.media.thumbnail.url,source:bf.source});this._messagesView&&this._messagesView.scrollToBottom();}}).bind(this)}),af);o.addClass(this._inputContainerNode,"_35li");l.bumpEntityKey('chat.web','content_search_button.mounting_attempted');}},_initializeDragDropTarget:function(){var af=oa.scry(this._tabElem,"._1ia");if(af&&af.length>0){this._dropTarget=new sa(af[0]);this._dropTarget.setOnFilesDropCallback(this._filesDropped.bind(this));this._dropTarget.setOnURLDropCallback(this._linkDropped.bind(this));this._dropTarget.enable();}},_initializeP2PChatThreadBannerContainer:function(){var af=oa.scry(this._tabElem,"._2hc2");if(af&&af.length>0){this._p2pChatThreadBannerContainerEl=af[0];this._p2pChatThreadBannerContainer=new cc(sb,this._p2pChatThreadBannerContainerEl);this._p2pChatThreadBannerContainer.setProps({isVisible:this.isChatViewable(),otherUserID:gb.getUserIDFromThreadID(this._threadID),threadID:this._threadID});}},setP2PChatThreadBannerContainerVisibility:function(){if(this._p2pChatThreadBannerContainer)this._p2pChatThreadBannerContainer.setProps({isVisible:this.isChatViewable()});},isChatViewable:function(){return (this._tabElem&&o.hasClass(this._tabElem,'opened')&&!o.hasClass(this._tabElem,'hidden_elem'));},_initializeP2P:function(){this._sendMoneyDialogStoreSub=vb.addListener('change',this._onP2PSendMoneyDialogStoreChange.bind(this));if(this._isP2PEnabled())this._renderOrionTrigger();},_onP2PTransferStoreLoaded:function(){if(!this._isP2PEnabled()){this._transferStoreSub=wd.addListener('change',this._onP2PTransferStoreChange.bind(this));}else this._renderOrionTrigger();},_initializeHotLike:function(){var af=vd.getThreadMetaNow(this._threadID),bf=af?af.custom_like_icon:null;if(this._getNode('hotLikeContainer')){bc.render(bc.createElement(pb,{className:"_3s0d",customLike:bf,onMouseDown:(function(){oc.hide(this._stickersFlyoutToggler);if(this._contentSearchButton)this._contentSearchButton.hideFlyout();}).bind(this),sendSticker:this._stickerSelected.bind(this),threadID:this._threadID}),this._getNode('hotLikeContainer'));o.addClass(this._inputContainerNode,"_n4k");}},_initializeUnloadListeners:function(){this._checkUnsentMessages=ad((function(){if(this._hasUnfinishedPost())return ed._("You haven't sent your message yet. Do you want to leave without sending?");if(pd.getNumberLocalMessages(this._threadID))return ed._("Your message is still being sent. Are you sure you want to leave?");return null;}).bind(this));dc.onBeforeUnload(this._checkUnsentMessages,false);this._logUnsentPhotos=ad(ve.bind(null,this));dc.onUnload(this._logUnsentPhotos);},_handlePUSubmit:function(af,bf){te(this,yb.UPLOAD_START,bf);ne(this,'',[],(function(cf){if(this._threadID!==cf.thread_id){this._newThreadIDFromPhotoUpload=cf.thread_id;if(this._messagesView)this._messagesView.setNewThreadID(cf.thread_id);}cf.content_attachment=null;od.addAttachmentPlaceholder(cf,bf.upload_id,bf);}).bind(this));ye('submit',bf);this._focusInput();},_handlePULastUploadFailed:function(af,bf){te(this,yb.CLIENT_ERROR,bf);ye('failed',bf);od.cancelAttachmentPlaceholder(bf.upload_id,bf);var cf=ed._("Photo Upload Failed"),df=ed._("Please try again. Make sure you are uploading a valid photo.");if(bf.errorDialogParams){cf=bf.errorDialogParams.title||cf;df=bf.errorDialogParams.body||df;}new qa().setTitle(cf).setBody(df).setButtons(qa.OK).show();},_handlePULastUploadCanceled:function(af,bf){te(this,yb.CANCEL_DURING_UPLOAD,bf);ye('canceled',bf);od.cancelAttachmentPlaceholder(bf.upload_id,bf);},_handlePUAllUploadsCompleted:function(af,bf){te(this,yb.ALL_UPLOADS_DONE,bf);ye('completed',bf);od.confirmAttachmentPlaceholder(bf.upload_id,bf);var cf=bf.image_ids.length||bf.attachments.length;me(this,cf);},_stickerSelected:function(af){ne(this,'',[],(function(bf){bf.has_attachment=true;bf.sticker_id=af;od.send(bf);this.focus();}).bind(this));this._messagesView&&this._messagesView.scrollToBottom();},_emoticonSelected:function(af){var bf=ua.symbols[af];if(!bf)return;if(t.get('chat_react_input')){this._chatInput.insertEmoticon(bf);return;}this._selectionPosition=this._selectionPosition||new fc(this._getNode('input'));var cf=nc.getInstance(this._getNode('input')),df=cf.getValue(),ef=ta.insertEmoticon(bf,df,this._selectionPosition.getPos());cf.setValue(ef.result);this._selectionPosition.setPos(ef.start,ef.end);},_orionTriggered:function(){ne(this,'',[],(function(af){this.focus();}).bind(this));this._messagesView&&this._messagesView.scrollToBottom();},_addStickerSearchNUXIndicator:function(){o.addClass(this._getNode('emoticonIndicator'),'nux');ae=false;},_onFlyoutShown:function(af){if(t.get('chat_react_sticker_button')){var bf=this._stickersFlyout.props.packID;if(bf!==hc.SEARCH_PACK_ID)this.focus();}af();this._stickersFlyoutShown=true;},_searchStickers:function(af,bf){this._stickersFlyout&&this._stickersFlyout.setProps({packID:hc.SEARCH_PACK_ID,trigger:af},bf);},_onFlyoutHidden:function(){this._stickersFlyoutShown=false;this.focus();},_setTitleHref:function(af){if(t.get('chat_react_header')){this._title&&this._title.setProps({href:af});}else{var bf=this._getNode('titlebarText');bf.setAttribute('href',af);bf.removeAttribute('rel');o.removeClass(bf,'noLink');}},_onAddMention:function(af){this._linkDropped(new sc(af.getURI()).getQualifiedURI().toString());},_unblockSend:function(){if(!this._blocked||qe(this))return;this._blocked=false;le(this);this._sheetController.closeUploadWarningTabSheet();},_logOpenTab:function(){new i('/ajax/chat/opentab_tracking.php',{threadID:this._threadID,userID:this._getCanonicalUserID(),signatureID:this._signatureID}).send();}});function ye(af,bf){de.debug('photo_uploader:'+af,kd({},bf));}function ze(af,bf){if(!bf)return af;var cf=bf.getImageFiles();if(cf.length>0){af.image_ids=cf;af.has_attachment=true;}var df=bf.getAnimatedImageFiles();if(df.length>0){af.gif_ids=df;af.has_attachment=true;}var ef=bf.getVideoFiles();if(ef.length>0){af.video_ids=ef;af.has_attachment=true;}var ff=bf.getAudioFiles();if(ff.length>0){af.audio_ids=ff;af.has_attachment=true;}var gf=bf.getFiles();if(gf.length>0){af.file_ids=gf;af.has_attachment=true;}return af;}f.exports=ue;},null);